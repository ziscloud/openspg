(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["31bd6db0"],{"0a75b646":function(e,t,l){"use strict";l.d(t,"__esModule",{value:!0}),l.d(t,"default",{enumerable:!0,get:function(){return r;}});var a=l("777fffbe"),o=l("32b7a2cf"),d=a._(l("d5b565e0")),n=a._(l("0c8a2b89")),r=a._(l("4d0e37ae")).default.memo(e=>{let{tip:t,tooltipProps:l,children:a,...r}=e;return(0,o.jsx)(n.default,{...l,title:t,children:(0,o.jsx)(d.default,{...r,children:a})});});},"24c8531b":function(e,t,l){l.d(t,"__esModule",{value:!0}),l.e(t,{default:function(){return w;}});var a=l("777fffbe"),o=l("852bbaa9"),d=l("32b7a2cf"),n=l("5b5ed4a9"),r=l("5661e780"),i=a._(r),s=l("4d0e37ae"),u=o._(s),c=l("c5f39a1b"),f=a._(c),m=l("f02131d0"),p=a._(m),g=l("3fe68e88"),v=a._(g),h=l("fd7ca954"),b=l("4c1838f3"),C=a._(b);let{Item:j}=v.default,x=n.styled.div`
  .ant-breadcrumb {
    position: relative;
    left: -8px;
    ol > li {
      .ant-breadcrumb-separator {
        margin: 0;
      }
      .ant-breadcrumb-link {
        .link-breadcrumb-item {
          border-radius: 4px;
          padding: 4px 4px;
          margin-inline: 4px;
          color: var(--deep-blue-47);
          &:hover {
            color: var(--deep-blue-68);
            background-color: var(--hover-color);
          }
        }
      }
      .span-breadcrumb-item {
        color: var(--deep-blue-65);
        padding: 4px var(--padding-mini);
      }
    }
  }
`;var _=l("5e00c259");let y=(0,n.styled)(e=>{let{items:t,wrapperStyle:l,...a}=e,o=(0,n.useSelectedRoutes)(),r=(0,n.useNavigate)(),[i]=(0,n.useSearchParams)(),s=(0,u.useMemo)(()=>{if(t)return t;let e=[];return null==o||o.forEach((t,l)=>{var a,d,n,r,i,s,u,c;(null==t?void 0:null===(a=t.route)||void 0===a?void 0:a.name)&&((0,C.default)(null==t?void 0:null===(d=t.route)||void 0===d?void 0:d.name)?e.push({key:t.pathnameBase,title:p.default.get(null==t?void 0:null===(n=t.route)||void 0===n?void 0:n.name),href:l+1!==o.length?(null==t?void 0:null===(r=t.route)||void 0===r?void 0:r.navPath)||(null==t?void 0:null===(i=t.route)||void 0===i?void 0:i.path):void 0}):e.push({key:t.pathnameBase,title:null==t?void 0:null===(s=t.route)||void 0===s?void 0:s.name,href:l+1!==o.length?(null==t?void 0:null===(u=t.route)||void 0===u?void 0:u.navPath)||(null==t?void 0:null===(c=t.route)||void 0===c?void 0:c.path):void 0}));}),e;},[o]),c=e=>{r((0,h.urlPathWithQuery)(e,[],i));};return(0,d.jsx)(x,{style:{...l},children:(0,d.jsx)(v.default,{...a,children:s.map(e=>(0,d.jsx)(j,{children:e.href?(0,d.jsx)("a",{className:"link-breadcrumb-item",onClick:()=>c(e.href),children:e.title}):(0,d.jsx)("span",{className:"span-breadcrumb-item",children:e.title})},e.key))})});})`
  &.breadcrumb {
    margin-bottom: 10px;
  }
`,P=n.styled.div`
  position: relative;
  padding: 0 var(--padding-lg) var(--padding-lg);
  &.layout-with-breadcrumb {
    padding-top: 12px;
  }
  &.layout-without-breadcrumb {
    padding-top: 24px;
  }
`,w=({children:e,breadcrumb:t=!1,loading:l,title:a,goBack:o,showBack:n,titleProps:r,className:s,...u})=>{if(l)return(0,d.jsx)(i.default,{active:!0});let c=!!t;return(0,d.jsxs)(P,{...u,className:(0,f.default)([{"layout-without-breadcrumb":!c},{"layout-with-breadcrumb":c},s]),children:[!1!==t&&(0,d.jsx)(y,{className:"breadcrumb",...t}),(a||(null==r?void 0:r.title))&&(0,d.jsx)(_.Title,{level:"page",title:a,goBackCb:o,showBack:n,...r}),e]});};},"2f4b013b":function(e,t,l){"use strict";l.d(t,"__esModule",{value:!0}),l.d(t,"default",{enumerable:!0,get:function(){return b;}});var a=l("777fffbe"),o=l("32b7a2cf"),d=a._(l("24c8531b")),n=l("cd8b2a5f"),r=l("df7e9d64"),i=a._(l("f02131d0")),s=a._(l("fe0a4152")),u=l("4c4535f5"),c=l("5b5ed4a9"),f=a._(l("2b798761")),m=a._(l("c60e02e5")),p=a._(l("1e70bad6")),g=l("4d0e37ae"),v=l("fc1f4356"),h=l("3f9cbbdf"),b=()=>{var e;let t=(0,c.useNavigate)(),l=(0,g.useRef)(null),{userInfo:a}=(0,r.useUserInfo)(),[b]=a.permissionList,C=(null==b?void 0:null===(e=b.accountRoleInfo)||void 0===e?void 0:e.roleName)==="SUPER",{config:j,isFetching:x}=(0,h.useGlobalConfig)(),{run:_,loading:y}=(0,c.useRequest)(u.create,{manual:!0,formatResult:e=>(e.success&&(f.default.success(i.default.get({id:"spg.Home.CreateNew.NewSuccess",dm:"\u65B0\u5EFA\u6210\u529F"})),t("/home")),e)}),P=()=>t("/home"),w=(0,v.isEmpty)(null==j?void 0:j.llm_select)||!(null==j?void 0:j.llm_select.find(e=>!!e.default));return(0,n.useUpdateEffect)(()=>{!x&&w&&m.default.confirm({title:C?i.default.get({id:"spg.Home.CreateNew.TheDefaultModelIsNot",dm:"\u672A\u914D\u7F6E\u9ED8\u8BA4\u6A21\u578B\uFF0C\u65E0\u6CD5\u65B0\u5EFA\u77E5\u8BC6\u5E93\uFF0C\u8BF7\u5148\u524D\u5F80\u5168\u5C40\u914D\u7F6E\u4E2D\u8BBE\u7F6E\u9ED8\u8BA4\u6A21\u578B"}):i.default.get({id:"spg.Home.CreateNew.TheDefaultModelIsNot.1",dm:"\u672A\u914D\u7F6E\u9ED8\u8BA4\u6A21\u578B\uFF0C\u65E0\u6CD5\u65B0\u5EFA\u77E5\u8BC6\u5E93\uFF0C\u8BF7\u5148\u8054\u7CFB\u7BA1\u7406\u5458\u8BBE\u7F6E\u9ED8\u8BA4\u6A21\u578B"}),okText:C?i.default.get({id:"spg.Home.CreateNew.GoToSettings",dm:"\u53BB\u8BBE\u7F6E"}):i.default.get({id:"spg.Home.CreateNew.IKnow",dm:"\u6211\u77E5\u9053\u4E86"}),cancelText:i.default.get({id:"spg.Home.CreateNew.Cancel",dm:"\u53D6\u6D88"}),cancelButtonProps:{style:C?{}:{display:"none"}},onOk(){C&&t("/home/globalConfig");}});},[w,x]),(0,o.jsx)(d.default,{titleProps:{title:i.default.get({id:"spg.Home.components.CreateNewProject.NewKnowledgeBase",dm:"\u65B0\u5EFA\u77E5\u8BC6\u5E93"}),showBack:!0},goBack:P,children:(0,o.jsx)(p.default,{spinning:y||x,children:(0,v.isEmpty)(j)?null:(0,o.jsx)(s.default,{ableEdit:!w,ref:l,onSubmit:()=>{var e;null===(e=l.current)||void 0===e||e.form.validateFields().then(e=>{let t={graph_store:e.graph_store||{},vectorizer:e.vectorizer||{},prompt:e.prompt||{},llm_select:(null==j?void 0:j.llm_select)||[],llm:((null==j?void 0:j.llm_select)||[]).find(e=>!!e.default)||{}};_({name:e.name,description:e.description,namespace:e.namespace,config:JSON.stringify(t)});});},onCancel:P,globalConfig:j})})});};},"3f9cbbdf":function(e,t,l){"use strict";l.d(t,"__esModule",{value:!0}),l.e(t,{useGlobalConfig:function(){return u;},useGlobalConfigTitle:function(){return s;}});var a=l("852bbaa9"),o=l("5ef61bc1"),d=l("240ff6a0"),n=l("5b5ed4a9"),r=l("4d0e37ae");let{json2Object:i}=a._(l("073a1148")),s=()=>{let{isFetching:e,data:t}=(0,n.useQuery)({queryFn:async()=>{let e=await (0,d.getConfigListByCondition)({configId:"KAG_ENV",version:"1"});return e.success&&e.result?i(e.result.config||"{}").configTitle:{};},queryKey:["KAG_GlobalConfigTitle"]});return{isFetching:e,data:t||{}};},u=()=>{let e=o.globalConfigId,{isFetching:t,data:l={id:0,configName:"",configId:e,config:{},showProfilePicture:!1,showUserConfig:!1},refetch:a}=(0,n.useQuery)({queryFn:async()=>{let t=await (0,d.getConfigListByCondition)({configId:e,version:"1"});if(t.success&&t.result){var l,a,o,n;return{config:i(t.result.config||"{}"),id:null===(l=t.result)||void 0===l?void 0:l.id,configName:null===(a=t.result)||void 0===a?void 0:a.configName,showProfilePicture:!!(null===(o=t.result)||void 0===o?void 0:o.showProfilePicture),showUserConfig:!!(null===(n=t.result)||void 0===n?void 0:n.showUserConfig)};}},queryKey:["KAG_GlobalConfig"],enabled:!1,retry:!1});return(0,r.useEffect)(()=>{a();},[]),{isFetching:t,refetch:a,data:l,config:l.config,configId:e,version:"1"};};},"5e00c259":function(e,t,l){"use strict";l.d(t,"__esModule",{value:!0}),l.d(t,"Title",{enumerable:!0,get:function(){return r;}});var a=l("32b7a2cf"),o=l("5b5ed4a9");l("4d0e37ae");var d=l("fc1f4356");let n=o.styled.div`
  .header {
    color: var(--dark-shade-85);
    font-weight: var(--font-medium);
    font-size: ${({$level:e})=>"page"===e?"var(--h1-font-size)":"var(--h3-font-size)"};
    line-height: ${({$level:e})=>"page"===e?"28px":"24px"};
  }
`,r=({className:e,style:t,level:l="page",title:r,titleExtra:i,showBack:s=!1,goBackCb:u,children:c})=>{let f=(0,o.useNavigate)();return(0,a.jsxs)(n,{$level:l,className:e,style:t,children:[(0,a.jsxs)("div",{className:"flex-row mb16",children:[(0,a.jsxs)("div",{className:"header",children:[s&&(0,a.jsx)(o.Icon,{className:"icon mr8 pointer",icon:"ant-design:arrow-left-outlined",onClick:()=>(0,d.isFunction)(u)?u():f(-1)}),r]}),(0,a.jsx)("div",{children:i})]}),(0,a.jsx)("div",{children:c})]});};},c5f39a1b:function(e,t,l){"use strict";l.d(t,"__esModule",{value:!0}),l.d(t,"default",{enumerable:!0,get:function(){return a;}});var a=l("777fffbe")._(l("85d9e535")).default;},fe0a4152:function(e,t,l){l.d(t,"__esModule",{value:!0}),l.e(t,{default:function(){return k;}});var a=l("777fffbe"),o=l("852bbaa9"),d=l("32b7a2cf"),n=l("0a75b646"),r=a._(n),i=l("f02131d0"),s=a._(i),u=l("3f9cbbdf"),c=l("d5b565e0"),f=a._(c),m=l("8f891262"),p=a._(m),g=l("673e678e"),v=a._(g),h=l("097087ae"),b=a._(h),C=l("1e70bad6"),j=a._(C),x=l("4d0e37ae"),_=o._(x),y=l("5b5ed4a9"),P=l("80411155"),w=a._(P);let N=y.styled.div`
  width: 632px;
  margin-left: 50%;
  transform: translate(-50%);

  .bottom-btns {
    position: sticky;
    bottom: 0;
    background: #fff;
    margin: 0;
    padding: 24px 0;

    .submit-btn {
      margin-right: 12px;
    }
  }
`,I=(0,y.styled)(w.default)`
  height: calc(100vh - 164px);
  overflow: auto;

  .ant-card-body {
    padding-bottom: 0;
  }
`;var k=(0,_.forwardRef)((e,t)=>{let{ableEdit:l,disabledTip:a="",initConfig:o,globalConfig:n,onSubmit:i,onCancel:c}=e,{data:m,isFetching:g}=(0,u.useGlobalConfigTitle)(),[h]=p.default.useForm(),C={namespace:(null==o?void 0:o.namespace)||"",name:(null==o?void 0:o.name)||"",description:(null==o?void 0:o.description)||"",graph_store:{source_type:"default",...(null==n?void 0:n.graph_store)||{},...(null==o?void 0:o.graph_store)||{}},vectorizer:{source_type:"default",...(null==n?void 0:n.vectorizer)||{},...(null==o?void 0:o.vectorizer)||{}},prompt:{source_type:"default",...(null==n?void 0:n.prompt)||{},...(null==o?void 0:o.prompt)||{}},llm_select:(null==o?void 0:o.llm_select)||(null==n?void 0:n.llm_select)||[]};(0,_.useImperativeHandle)(t,()=>({form:h}));let x=(e,t)=>{let l=o||n;"default"===e.target.value&&(null==l?void 0:l[t])&&h.setFieldsValue({[t]:{...l[t],source_type:"default"}}),"custom"===e.target.value&&(null==o?void 0:o[t])&&h.setFieldsValue({[t]:{...o[t],source_type:"custom"}});};return(0,d.jsx)(j.default,{spinning:g,children:(0,d.jsx)(I,{children:(0,d.jsx)(N,{children:(0,d.jsxs)(p.default,{disabled:!l,layout:"vertical",initialValues:C,form:h,scrollToFirstError:{behavior:e=>{e.forEach(({el:e,top:t,left:l})=>{e.scrollTop=t,t>0&&(e.scrollTop=t+150),e.scrollLeft=l;});}},children:[(0,d.jsx)(p.default.Item,{label:s.default.get({id:"spg.Home.components.CreateNewProject.ChineseNameOfKnowledgeBase",dm:"\u77E5\u8BC6\u5E93\u4E2D\u6587\u540D\u79F0"}),name:"name",rules:[{required:!0,message:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})}],children:(0,d.jsx)(v.default,{placeholder:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})})}),(0,d.jsx)(p.default.Item,{label:s.default.get({id:"spg.Home.components.CreateNewProject.EnglishNameOfKnowledgeBase",dm:"\u77E5\u8BC6\u5E93\u82F1\u6587\u540D\u79F0"}),name:"namespace",rules:[{required:!0,message:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})},{pattern:/^[A-Z][A-Za-z0-9]{2,}$/,message:s.default.get({id:"spg.Home.components.CreateNewProject.MustStartWithAnUppercase",dm:"\u5FC5\u987B\u4EE5\u5927\u5199\u5B57\u6BCD\u5F00\u5934\uFF0C\u4E14\u4EC5\u652F\u6301\u5B57\u6BCD\u548C\u6570\u5B57\u7EC4\u5408\uFF0C\u81F3\u5C11\u4E09\u4E2A\u5B57\u7B26"})}],children:(0,d.jsx)(v.default,{disabled:!!(null==o?void 0:o.namespace),placeholder:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})})}),(0,d.jsx)(p.default.Item,{label:s.default.get({id:"spg.components.ProjectConfigComp.KnowledgeBaseDescription",dm:"\u77E5\u8BC6\u5E93\u63CF\u8FF0"}),name:"description",children:(0,d.jsx)(v.default.TextArea,{placeholder:s.default.get({id:"spg.components.ProjectConfigComp.PleaseEnterADescriptionOf",dm:"\u8BF7\u8F93\u5165\u77E5\u8BC6\u5E93\u63CF\u8FF0\uFF0C\u5728\u77E5\u8BC6\u62BD\u53D6\u548C\u77E5\u8BC6\u95EE\u7B54\u65F6\u4F5C\u4E3Aprompt\uFF1B\u4F8B\uFF1A\u8FD9\u662F\u4E00\u4E2A\u6CD5\u5B66\u77E5\u8BC6\u5E93\uFF0C \u4E3B\u8981\u63CF\u8FF0\u6CD5 \u5F8B\u76F8\u5173\u7684\u77E5\u8BC6"}),rows:5})}),(0,d.jsxs)(p.default.Item,{label:s.default.get({id:"spg.Home.components.CreateNewProject.FigureStorageConfiguration",dm:"\u56FE\u50A8\u5B58\u914D\u7F6E"}),name:"graph_store",children:[(0,d.jsx)(p.default.Item,{name:["graph_store","source_type"],children:(0,d.jsxs)(b.default.Group,{onChange:e=>x(e,"graph_store"),children:[(0,d.jsx)(b.default,{value:"default",children:s.default.get({id:"spg.components.ProjectConfigComp.DefaultConfiguration",dm:"\u9ED8\u8BA4\u914D\u7F6E"})}),(0,d.jsx)(b.default,{value:"custom",children:s.default.get({id:"spg.components.ProjectConfigComp.CustomConfiguration",dm:"\u81EA\u5B9A\u4E49\u914D\u7F6E"})})]})}),(0,d.jsx)(p.default.Item,{noStyle:!0,shouldUpdate:!0,children:()=>{var e;let t="default"===h.getFieldValue(["graph_store","source_type"]);return((null==m?void 0:null===(e=m.graph_store)||void 0===e?void 0:e.title)||[]).map(({cname:e,ename:l,defaultValue:a,required:o,formProps:n})=>(0,d.jsx)(p.default.Item,{label:e,initialValue:a,rules:[{required:o,message:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})}],name:["graph_store",l],children:(0,d.jsx)(v.default,{disabled:t,placeholder:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"}),...n})},l));}})]}),(0,d.jsxs)(p.default.Item,{label:s.default.get({id:"spg.Home.components.CreateNewProject.VectorConfiguration",dm:"\u5411\u91CF\u914D\u7F6E"}),name:"vectorizer",children:[(0,d.jsx)(p.default.Item,{name:["vectorizer","source_type"],children:(0,d.jsxs)(b.default.Group,{onChange:e=>x(e,"vectorizer"),children:[(0,d.jsx)(b.default,{value:"default",children:s.default.get({id:"spg.components.ProjectConfigComp.DefaultConfiguration",dm:"\u9ED8\u8BA4\u914D\u7F6E"})}),(0,d.jsx)(b.default,{value:"custom",children:s.default.get({id:"spg.components.ProjectConfigComp.CustomConfiguration",dm:"\u81EA\u5B9A\u4E49\u914D\u7F6E"})})]})}),(0,d.jsx)(p.default.Item,{noStyle:!0,shouldUpdate:!0,children:()=>{var e;let t="default"===h.getFieldValue(["vectorizer","source_type"]);return((null==m?void 0:null===(e=m.vectorizer)||void 0===e?void 0:e.title)||[]).map(({cname:e,ename:l,defaultValue:a,required:o,formProps:n})=>(0,d.jsx)(p.default.Item,{label:e,initialValue:a,rules:[{required:o,message:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"})}],name:["vectorizer",l],children:(0,d.jsx)(v.default,{disabled:t,placeholder:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"}),...n})},l));}})]}),(0,d.jsxs)(p.default.Item,{label:s.default.get({id:"spg.Home.components.CreateNewProject.PromptWordsInChineseAnd",dm:"\u63D0\u793A\u8BCD\u4E2D\u82F1\u6587\u914D\u7F6E"}),name:"prompt",children:[(0,d.jsx)(p.default.Item,{name:["prompt","source_type"],children:(0,d.jsxs)(b.default.Group,{onChange:e=>x(e,"prompt"),children:[(0,d.jsx)(b.default,{value:"default",children:s.default.get({id:"spg.components.ProjectConfigComp.DefaultConfiguration",dm:"\u9ED8\u8BA4\u914D\u7F6E"})}),(0,d.jsx)(b.default,{value:"custom",children:s.default.get({id:"spg.components.ProjectConfigComp.CustomConfiguration",dm:"\u81EA\u5B9A\u4E49\u914D\u7F6E"})})]})}),(0,d.jsx)(p.default.Item,{noStyle:!0,shouldUpdate:!0,children:()=>{var e;let t="default"===h.getFieldValue(["prompt","source_type"]);return((null==m?void 0:null===(e=m.prompt)||void 0===e?void 0:e.title)||[]).map(({cname:e,ename:l,defaultValue:a,required:o,formProps:n})=>(0,d.jsx)(p.default.Item,{label:e,initialValue:a,rules:[{required:o,message:s.default.get({id:"spg.components.ProjectConfigComp.PleaseEnterCname",dm:"\u8BF7\u8F93\u5165 {cname}"},{cname:e})}],name:["prompt",l],children:(0,d.jsx)(v.default,{disabled:t,placeholder:s.default.get({id:"spg.Home.components.CreateNewProject.PleaseEnter",dm:"\u8BF7\u8F93\u5165"}),...n})},l));}})]}),(0,d.jsxs)(p.default.Item,{className:"bottom-btns",children:[(0,d.jsx)(r.default,{disabled:!l,tip:l?"":a,className:"submit-btn",type:"primary",htmlType:"submit",onClick:i,children:s.default.get({id:"spg.components.ProjectConfigComp.Save",dm:"\u4FDD\u5B58"})}),c&&(0,d.jsx)(f.default,{onClick:c,children:s.default.get({id:"spg.components.ProjectConfigComp.Cancel",dm:"\u53D6\u6D88"})})]})]})})})});});}}]);
