(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["shared_E3SLea0f"],{"0fddaff6":function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"Sample",{enumerable:!0,get:function(){return E;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=r._(a("f02131d0")),i=a("4c70c3ed"),d=r._(a("3ba80fd7")),o=a("1a998156"),s=a("52fb4bb8"),c=a("0b69d691"),u=a("48fdd872"),p=a("5b5ed4a9"),m=r._(a("b916d24f")),g=r._(a("1e70bad6")),f=r._(a("c7f4f8e9")),h=r._(a("6d1765ea")),y=a("fc1f4356"),v=a("3834a44f"),b=a("8e68a90d"),x=r._(a("4bb2999e"));let{Text:S}=h.default,{Panel:T}=x.default,D=(0,p.styled)(g.default)`
  flex: 1;

  .ant-spin-container {
    height: 100%;
  }
`,N=(0,p.styled)(T)`
  .ant-motion-collapse {
    .ant-table-thead {
      top: 0;
    }
  }
  .ant-table-thead {
    position: sticky !important;
    top: 82px;
    z-index: 1;
  }
`,E=()=>{let e=Number((0,v.getProjectId)()),[{schemaDetail:t}]=(0,s.useProxyState)(b.knowledgeModelDataState),a={name:null==t?void 0:t.name,limit:10,projectId:e},{data:{result:r=[]}={},isLoading:g}=(0,p.useQuery)(["getSampleData",a],()=>(0,c.getSampleData)(a),{enabled:!(0,y.isEmpty)(t)}),{data:{result:h={}}={},isLoading:T}=(0,p.useQuery)(["getSchemaNameMap",{projectId:e}],()=>(0,u.getSchemaNameMap)({projectId:e}),{enabled:!!e}),E=[{title:l.default.get({id:"spg.components.SchemaDrawer.Sample.Property",dm:"\u5C5E\u6027"}),dataIndex:"attributes",width:"50%",render:(e,t)=>{let a=(0,n.jsx)(S,{style:{width:294},ellipsis:!0,children:(0,i.getMixedLocaleFieldValue)(t,{fileName:"attributes",onlyLocale:!0})});return(null==t?void 0:t.propType)==="cprop"?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Icon,{icon:"ant-design:enter-outlined",rotate:90}),a]}):a;}},{title:l.default.get({id:"spg.components.SchemaDrawer.Sample.PropertyValue",dm:"\u5C5E\u6027\u503C"}),dataIndex:"value",width:"50%",render:e=>{if(e){let t=e;try{"string"!=typeof e&&(t=JSON.stringify(e));}catch(e){t=l.default.get({id:"spg.components.SchemaDrawer.Sample.SampleDataErrorPleaseTry",dm:"\u62BD\u6837\u6570\u636E\u9519\u8BEF\uFF0C\u8BF7\u91CD\u8BD5"});}return(0,n.jsx)(d.default,{text:e,showTextInMessage:!0,children:(0,n.jsx)(S,{style:{width:294},ellipsis:!0,children:t})});}return"-";}}],C=e=>{let a=null==t?void 0:t.name,r=[];return e&&Object.keys(e).forEach(t=>{if("_label"!==t&&h&&h.hasOwnProperty(`${a}.${t}`)){let n=t.includes(".");r.push({key:`${e.id}_${h[t]}`,attributes:t,attributesZh:h[`${a}${n?"_":"."}${t}`]||h[t],value:e[t],propType:n?"cprop":"prop",propNameEn:t});}else Object.keys(o.baseSchemePropertyNameMap).includes(t)&&r.push({key:`${e.id}_${h[t]}`,attributes:t,attributesZh:o.baseSchemePropertyNameMap[t],value:e[t],propType:"prop",propNameEn:t});}),(0,y.isEmpty)(r)?[]:r.sort((e,t)=>{var a,r;return(null==e?void 0:null===(a=e.propNameEn)||void 0===a?void 0:a.charCodeAt(0))-(null==t?void 0:null===(r=t.propNameEn)||void 0===r?void 0:r.charCodeAt(0));});};return(0,n.jsx)(D,{spinning:g||T,children:(null==r?void 0:r.length)?(0,n.jsx)(x.default,{stickyHeight:49,collapseAll:!0,children:r.map((e,t)=>(0,n.jsx)(N,{header:e.properties&&(e.properties.name||e.properties.id),children:(0,n.jsx)(f.default,{className:"sample-table",dataSource:C(e.properties),columns:E,pagination:!1})},e.id||t))}):(0,n.jsx)(m.default,{image:m.default.PRESENTED_IMAGE_SIMPLE})});};},"144bf41d":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{Relation:function(){return I;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("1a998156"),i=a("4d0e37ae");r._(i);var d=a("4bb2999e"),o=r._(d),s=a("52fb4bb8"),c=a("f02131d0"),u=r._(c),p=a("8e68a90d"),m=a("c7f4f8e9"),g=r._(m),f=a("4c70c3ed"),h=a("5b5ed4a9"),y=a("fc1f4356");let v=h.styled.span`
  line-height: 24px;
  .endNodeTag {
    display: inline-block;
    width: 40px;
    height: 22px;
    font-size: 12px;
    line-height: 22px;
    text-align: center;
    background-color: rgba(0, 0, 0, 4%);
    border: 1px solid rgba(0, 0, 0, 15%);
    border-radius: 2px;
  }
`,b=e=>{let{name:t,record:{endEntity:a,startEntity:r,direction:l}}=e,{name:i,nameZh:d}=r,{name:o,nameZh:s}=a,c="",p="";return i===t&&o===t?(c=(0,f.getMixedLocaleFieldValue)({name:o,nameZh:s}),p=u.default.get({id:"spg.SchemaDrawer.Relation.Label.SelfLoop",dm:"\u81EA\u73AF"})):i===t?(c=(0,f.getMixedLocaleFieldValue)({name:o,nameZh:s}),p=u.default.get({id:"spg.SchemaDrawer.Relation.Label.End",dm:"\u7EC8\u70B9"})):(c=(0,f.getMixedLocaleFieldValue)({name:i,nameZh:d}),p=u.default.get({id:"spg.SchemaDrawer.Relation.Label.StartingPoint",dm:"\u8D77\u70B9"})),(null==l?void 0:l.toLowerCase())==="both"&&(p=u.default.get({id:"spg.SchemaDrawer.Relation.Label.Bidirectional",dm:"\u53CC\u5411"})),(0,n.jsxs)(v,{children:[!(0,y.isEmpty)(p)&&(0,n.jsx)("span",{className:"endNodeTag mr8",children:p}),c]});},{Panel:x}=o.default,S=e=>{let[{schemaDetail:{name:t="",relations:a=[]}={}}]=(0,s.useProxyState)(p.knowledgeModelDataState),r=a.filter(e=>e.relationCategory===l.RELATION_CATEGORY.CONCEPT),i=[{title:u.default.get({id:"spg.SchemaDrawer.Relation.Concept.RelationshipNameChinese",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u4E2D\u6587\uFF09"}),dataIndex:"nameZh",width:"33%",ellipsis:!0,render:(e,{nameZh:t,typeZh:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Concept.RelationshipNameEnglish",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u82F1\u6587\uFF09"}),dataIndex:"name",width:"33%",ellipsis:{showTitle:!0},render:(e,{name:t,type:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Concept.StartEnd",dm:"\u8D77\u70B9/\u7EC8\u70B9"}),dataIndex:"endNode",width:"33%",ellipsis:{showTitle:!0},render:(e,a)=>(0,n.jsx)(b,{name:t,record:a})}];return(0,n.jsx)(x,{...e,header:u.default.get({id:"spg.SchemaDrawer.Relation.Concept.ConceptSemanticRelationsDatasourcelength",dm:"\u6982\u5FF5\u8BED\u4E49\u5173\u7CFB ({dataSourceLength})"},{dataSourceLength:r.length}),children:(0,n.jsx)(g.default,{dataSource:r,columns:i,pagination:!1})});},{Panel:T}=o.default,D=e=>{let[{schemaDetail:{name:t="",relations:a=[]}={}}]=(0,s.useProxyState)(p.knowledgeModelDataState),r=a.filter(e=>e.relationCategory===l.RELATION_CATEGORY.EVENT),i=[{title:u.default.get({id:"spg.SchemaDrawer.Relation.Basic.RelationshipNameChinese",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u4E2D\u6587\uFF09"}),dataIndex:"nameZh",width:"33%",ellipsis:!0,render:(e,{nameZh:t,typeZh:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Basic.RelationshipNameEnglish",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u82F1\u6587\uFF09"}),dataIndex:"name",width:"33%",ellipsis:!0,render:(e,{name:t,type:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Basic.StartEnd",dm:"\u8D77\u70B9/\u7EC8\u70B9"}),dataIndex:"endNode",width:"33%",ellipsis:!0,render:(e,a)=>(0,n.jsx)(b,{name:t,record:a})}];return(0,n.jsx)(T,{...e,header:u.default.get({id:"",dm:"\u4E8B\u4EF6\u7C7B\u578B\u5173\u7CFB ({dataSourceLength})"},{dataSourceLength:r.length}),children:(0,n.jsx)(g.default,{dataSource:r,columns:i,pagination:!1})});};var N=a("81ea1a90"),E=a("4a4bb4c2");let{Panel:C}=o.default,w=e=>{let[{schemaDetail:{id:t,name:a=""}={},schemaData:r={nodes:[],edges:[]}}]=(0,s.useProxyState)(p.knowledgeModelDataState),l=(0,N.getOneLevelFromGraphDataByName)((0,N.transformToFusionGraphData)({nodes:(0,y.cloneDeep)(r.nodes||[]),edges:(0,y.cloneDeep)(r.edges||[])}),a),i={id:E.LayoutId.Radial,options:{type:E.LayoutId.Radial,focusNode:String(t),unitRadius:150,linkDistance:50}};return(0,n.jsx)(C,{...e,header:u.default.get({id:"spg.SchemaDrawer.Relation.OneLevel.OnceUnfoldedRelationship",dm:"\u4E00\u5EA6\u5C55\u5F00\u5173\u7CFB"}),children:(0,n.jsx)(E.Graph,{defaultLayout:i,isMergeEdge:!0,isSchema:!0,locale:(0,h.getLocale)(),options:{autoFit:"center"},schemaData:l,style:{height:346},children:(0,n.jsx)(E.Toolbar,{simple:!0,style:{position:"absolute",top:4,right:4},items:[E.ToolbarKey.FullScreen]})})});},{Panel:P}=o.default,_=e=>{let[{schemaDetail:{name:t="",relations:a=[]}={}}]=(0,s.useProxyState)(p.knowledgeModelDataState),r=a.filter(e=>[l.RELATION_CATEGORY.PROPERTY,l.RELATION_CATEGORY.ENTITY].includes(e.relationCategory)),i=[{title:u.default.get({id:"spg.SchemaDrawer.Relation.Property.RelationshipNameChinese",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u4E2D\u6587\uFF09"}),dataIndex:"nameZh",width:"33%",ellipsis:!0,render:(e,{nameZh:t,typeZh:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Property.RelationshipNameEnglish",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u82F1\u6587\uFF09"}),dataIndex:"name",width:"33%",ellipsis:{showTitle:!0},render:(e,{name:t,type:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Property.StartEnd",dm:"\u8D77\u70B9/\u7EC8\u70B9"}),dataIndex:"endNode",width:"33%",ellipsis:{showTitle:!0},render:(e,a)=>(0,n.jsx)(b,{name:t,record:a})}];return(0,n.jsx)(P,{...e,header:u.default.get({id:"spg.SchemaDrawer.Relation.Property.EntityTypeRelationshipsDatasourcelength",dm:"\u5B9E\u4F53\u7C7B\u578B\u5173\u7CFB ({dataSourceLength})"},{dataSourceLength:r.length}),children:(0,n.jsx)(g.default,{dataSource:r,columns:i,pagination:!1})});};var O=a("0c8a2b89"),R=r._(O);let{Panel:j}=o.default,M=e=>{let[{schemaDetail:{name:t="",relations:a=[]}={},schemaData:r={nodes:[],edges:[]}}]=(0,s.useProxyState)(p.knowledgeModelDataState),{edges:i}=(0,N.getOneLevelFromGraphDataByName)((0,y.cloneDeep)(r),t),d=a.filter(e=>e.relationCategory===l.RELATION_CATEGORY.STANDARD),o=[{title:u.default.get({id:"spg.SchemaDrawer.Relation.Standard.RelationshipNameChinese",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u4E2D\u6587\uFF09"}),dataIndex:"nameZh",fixed:"left",width:"25%",ellipsis:!0,render:(e,{nameZh:t,typeZh:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Standard.RelationshipNameEnglish",dm:"\u5173\u7CFB\u540D\u79F0\uFF08\u82F1\u6587\uFF09"}),dataIndex:"name",width:"25%",ellipsis:!0,render:(e,{name:t,type:a})=>t||a},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Standard.StandardType",dm:"\u6807\u51C6\u7C7B\u578B"}),dataIndex:"standardType",width:"25%",ellipsis:!0,render:(e,{endEntity:t})=>(0,f.getMixedLocaleFieldValue)(t)},{title:u.default.get({id:"spg.SchemaDrawer.Relation.Standard.AssociatedEntityType",dm:"\u5173\u8054\u5B9E\u4F53\u7C7B\u578B"}),dataIndex:"entityType",width:"25%",ellipsis:{showTitle:!1},render:(e,t)=>{let a=null==i?void 0:i.filter(e=>{var a;return(null==e?void 0:e.targetName)===(null==t?void 0:null===(a=t.endEntity)||void 0===a?void 0:a.name);}).map(e=>{let t={name:e.sourceName,nameZh:e.sourceNameZh};return(0,f.getMixedLocaleFieldValue)(t);}),r=(null==a?void 0:a.length)?null==a?void 0:a.join("\u3001"):(0,f.getMixedLocaleFieldValue)(t.startEntity),l=(null==a?void 0:a.length)?null==a?void 0:a.map(e=>(0,n.jsx)("div",{children:e})):(0,f.getMixedLocaleFieldValue)(t.startEntity);return(0,n.jsx)(R.default,{title:l,placement:"topLeft",children:r});}}];return(0,n.jsx)(j,{...e,header:u.default.get({id:"spg.SchemaDrawer.Relation.Standard.StandardSemanticRelationshipsDatasourcelength",dm:"\u6807\u51C6\u8BED\u4E49\u5173\u7CFB ({dataSourceLength})"},{dataSourceLength:d.length}),children:(0,n.jsx)(g.default,{dataSource:d,columns:o,pagination:!1})});},I=()=>{let e=[l.RELATION_CATEGORY.ONE_LEVEL,l.RELATION_CATEGORY.CONCEPT,l.RELATION_CATEGORY.STANDARD,l.RELATION_CATEGORY.ENTITY,l.RELATION_CATEGORY.EVENT],t=e.map(e=>{switch(e){case l.RELATION_CATEGORY.EVENT:return(0,n.jsx)(D,{},l.RELATION_CATEGORY.EVENT);case l.RELATION_CATEGORY.CONCEPT:return(0,n.jsx)(S,{},l.RELATION_CATEGORY.CONCEPT);case l.RELATION_CATEGORY.STANDARD:return(0,n.jsx)(M,{},l.RELATION_CATEGORY.STANDARD);case l.RELATION_CATEGORY.ENTITY:return(0,n.jsx)(_,{},l.RELATION_CATEGORY.ENTITY);case l.RELATION_CATEGORY.ONE_LEVEL:return(0,n.jsx)(w,{},l.RELATION_CATEGORY.ONE_LEVEL);default:return(0,n.jsx)(n.Fragment,{});}});return(0,n.jsx)(o.default,{defaultActiveKey:e,children:t});};},"19a2cef9":function(e,t,a){"use strict";var r,n;a.d(t,"__esModule",{value:!0}),a.d(t,"TabTypeEnum",{enumerable:!0,get:function(){return r;}}),(n=r||(r={})).Description="Description",n.Property="Property",n.Relation="Relation",n.Sample="Sample",n.Rule="Rule",n.ConceptDescription="ConceptDescription",n.ConceptProperty="ConceptProperty";},"1b2ef78d":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{ModeSelect:function(){return g;},SchemaDrawer:function(){return J;}});var r=a("777fffbe"),n=a("852bbaa9"),l=a("32b7a2cf"),i=a("fc5eb767"),d=a("f02131d0"),o=r._(d),s=a("5b5ed4a9"),c=a("4d0e37ae"),u=n._(c),p=a("a5eab18a");let m=[{label:o.default.get({id:"spg.KnowledgeModeling.components.ModeSelect.PunctatePattern",dm:"\u70B9\u72B6\u6A21\u5F0F"}),value:i.GraphMode.normal},{label:o.default.get({id:"spg.KnowledgeModeling.components.ModeSelect.TreePattern",dm:"\u6811\u72B6\u6A21\u5F0F"}),value:i.GraphMode.tree}],g=()=>{let[e,t]=(0,s.useSearchParams)();return(0,l.jsx)(p.RadioGroup,{options:m,onChange:a=>{let r=a.target.value||i.GraphMode.normal;e.set("mode",r),t(e);},value:e.get("mode")||i.GraphMode.normal,optionType:"button"});};var f=a("52fb4bb8"),h=a("cd8b2a5f"),y=a("1e70bad6"),v=r._(y),b=a("e6fc687f"),x=r._(b),S=a("6d1765ea"),T=r._(S),D=a("fe5d4d35"),N=a("8e68a90d"),E=a("8a175809"),C=a("4c70c3ed"),w=a("1a998156"),P=a("9ffd6a0f"),_=r._(P),O=a("2ed4c134"),R=r._(O),j=a("673e678e"),M=r._(j),I=a("341ea61c"),L=r._(I),A=a("6f249d5c"),F=a("554f69e4");let k=s.styled.div`
  margin-top: -12px;
  height: calc(100vh - 520px);
  .constraints-detail {
    background-color: var(--shadow-color);
    padding: var(--margin-mini);
    div {
      margin-top: 8px;
      &:first-of-type {
        margin-top: 0;
      }
    }
  }
  .dsl-editor {
    border: var(--solid-border);
    border-radius: var(--border-radius-lg);
    height: 100%;
    overflow: hidden;
  }
`,G=_.default.Item,U=({})=>{let[{advancedPropertyData:e},t]=(0,f.useProxyState)(N.knowledgeModelUiState),{nameZh:a,name:r,description:n,rangeNameZh:i,rangeName:d,rangeEntityNameZh:s,rangeEntityName:c,constraints:u=[],logicRule:m}=e||{},g=u.find(e=>e.id===w.CONSTRAINT_TYPE.ENUM),h=u.find(e=>e.id===w.CONSTRAINT_TYPE.REGULAR),y=u.find(e=>e.id===w.CONSTRAINT_TYPE.MINIMUM_GT),v=u.find(e=>e.id===w.CONSTRAINT_TYPE.MINIMUM_GT_OE),b=u.find(e=>e.id===w.CONSTRAINT_TYPE.MAXIMUM_LT),x=u.find(e=>e.id===w.CONSTRAINT_TYPE.MAXIMUM_LT_OE),S=g||h||y||v||b||x,T=[{key:"nameZh",label:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.AttributeNameChinese",dm:"\u5C5E\u6027\u540D\u79F0\uFF08\u4E2D\u6587\uFF09"}),value:a},{key:"name",label:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.AttributeNameEnglish",dm:"\u5C5E\u6027\u540D\u79F0\uFF08\u82F1\u6587\uFF09"}),value:r},{key:"",label:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.AttributeType",dm:"\u5C5E\u6027\u7C7B\u578B"}),value:c?`${c}(${s})`:`${d}(${i})`},{key:"description",label:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.Description",dm:"\u63CF\u8FF0"}),value:n||"-"},{key:"constraints",label:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.ConstraintType",dm:"\u7EA6\u675F\u7C7B\u578B"}),value:(0,l.jsx)("div",{children:u.map(e=>(0,C.getMixedLocaleFieldValue)(e,{onlyLocale:!0})).join("; ")||o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.None",dm:"\u65E0"})})}];return(0,l.jsxs)(R.default,{getContainer:!1,title:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.AdvancedConfiguration",dm:"\u9AD8\u7EA7\u914D\u7F6E"}),placement:"right",mask:!1,onClose:()=>{t("advancedPropertyData",void 0);},open:!!e,children:[(0,l.jsx)(p.StyledDescriptions,{column:1,children:T.map(e=>(0,l.jsx)(G,{label:e.label,children:e.value},e.key))}),(0,l.jsxs)(k,{children:[S&&(0,l.jsxs)("div",{className:"constraints-detail",children:[g&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{children:(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.EnumConstraintValue",dm:"\u300C\u679A\u4E3E\u300D\u7EA6\u675F\u503C"})})}),(0,l.jsx)(M.default.TextArea,{value:(0,F.formatEnumValueToString)((null==g?void 0:g.value)||{})})]}),h&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{children:(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.RegularMatchConstraintValue",dm:"\u300C\u6B63\u5219\u5339\u914D\u300D\u7EA6\u675F\u503C"})})}),(0,l.jsx)(M.default.TextArea,{value:h.value})]}),y&&(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.GreaterThanConstraintValue",dm:"\u300C\u5927\u4E8E\u300D\u7EA6\u675F\u503C\uFF1A"})}),y.value]}),v&&(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.GreaterThanOrEqualTo",dm:"\u300C\u5927\u4E8E\u7B49\u4E8E\u300D\u7EA6\u675F\u503C\uFF1A"})}),v.value]}),b&&(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.LessThanConstraintValue",dm:"\u300C\u5C0F\u4E8E\u300D\u7EA6\u675F\u503C\uFF1A"})}),b.value]}),x&&(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.LessThanOrEqualTo",dm:"\u300C\u5C0F\u4E8E\u7B49\u4E8E\u300D\u7EA6\u675F\u503C\uFF1A"})}),x.value]})]}),!(0,L.default)(m)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"mt12",children:o.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.DslRules",dm:"DSL \u89C4\u5219"})}),(0,l.jsx)("div",{className:"dsl-editor",children:(0,l.jsx)(A.DSLEditor,{options:{readOnly:!0},value:m.expression})})]})]})]});};var V=a("1043743b"),Y=r._(V),Z=a("02b696d0"),$=n._(Z),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},K=a("833883d6"),z=r._(K),q=$.forwardRef(function(e,t){return $.createElement(z.default,(0,Y.default)((0,Y.default)({},e),{},{ref:t,icon:B}));}),Q=a("d2ee7e38");let H=e=>{let{title:t}=e,[{schemaInfo:a,schemaData:r}]=(0,f.useProxyState)(N.knowledgeModelDataState),[n,i]=(0,u.useState)((null==a?void 0:a.name)||""),d=(0,u.useMemo)(()=>{let e=r.edges;if(a&&a.isSchema&&"edge"===a.type&&e.length){let t=e.filter(e=>e.sourceName===a.fromName&&e.targetName===a.toName).map(e=>({value:e.type,label:(0,C.getMixedLocaleFieldValue)(e),record:e}));return t.length&&i(a.name),t;}return[];},[a,r.edges]),o=(0,h.useMemoizedFn)((e,t)=>{if(t.record){let a=t.record;(0,N.setSchemaInfo)({type:"edge",isSchema:!0,id:String(a.originId),name:a.type,nameZh:a.typeZh,fromName:a.sourceName,toName:a.targetName}),i(e);}});return d.length>1?(0,l.jsx)(Q.RelationTitleSelect,{bordered:!1,options:d,dropdownMatchSelectWidth:!1,suffixIcon:(0,l.jsx)(q,{rotate:-90}),value:n,onSelect:o}):(0,l.jsx)(l.Fragment,{children:t});};var W=a("2cca46ec");let J=()=>{let[{schemaDrawerOpen:e},t]=(0,f.useProxyState)(N.knowledgeModelUiState),[{schemaInfo:a,schemaDetail:r}]=(0,f.useProxyState)(N.knowledgeModelDataState),[{conceptDetail:n}]=(0,f.useProxyState)(E.conceptModelDataState),{tabOptions:i,tabItems:d}=(0,u.useMemo)(()=>(0,W.getTabUI)(a,n,r),[a,n,r]),c=(0,h.useMemoizedFn)(async()=>{if(a){if(a.isSchema){let{needFetch:e=!0}=a;return e?await (0,N.fetchSchemaDetail)(a):{};}return await (0,E.fetchConceptDetail)(a);}return{};}),{isLoading:m}=(0,s.useQuery)({queryFn:c,queryKey:[a],cacheTime:0});(0,u.useEffect)(()=>()=>{(0,N.setSchemaInfo)(),(0,E.clearConceptDetail)(),(0,N.closeSchemaDrawer)();},[]);let g=(0,l.jsxs)(l.Fragment,{children:[(0,W.getSchemaTitle)(a),(null==r?void 0:r.isLLMExtract)&&(0,l.jsx)(Q.Tag,{children:o.default.get({id:"spg.components.SchemaDrawer.LargeModel",dm:"\u5927\u6A21\u578B"})})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.DrawerStyle,{}),(0,l.jsx)(D.Drawer,{id:"property-drawer",width:700,title:(0,l.jsx)(T.default.Title,{style:{marginBottom:0},level:5,copyable:{tooltips:!1,text:(0,W.getSchemaTitle)(a)},children:(null==a?void 0:a.isSchema)&&"edge"===a.type?(0,l.jsx)(H,{title:g}):g}),placement:"right",onClose:N.closeSchemaDrawer,open:e,getContainer:!1,mask:!1,style:{transform:"translateX(0)"},children:(0,l.jsx)(v.default,{spinning:!!m,children:e&&(0,l.jsx)(x.default,{defaultActiveKey:"1",renderTabBar:e=>{let{activeKey:t,onTabClick:a}=e;return(0,l.jsx)(p.TabBar,{options:i,onChange:e=>a(e.target.value,e),value:t,optionType:"button"});},items:d,onChange:()=>{t("advancedPropertyData",void 0);}})})}),(0,l.jsx)(U,{})]});};},"2cca46ec":function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.e(t,{getSchemaTitle:function(){return y;},getTabUI:function(){return D;},propertyByGroup:function(){return E;},toViewConceptPropertyList:function(){return C;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("fc5eb767"),i=a("4c70c3ed"),d=r._(a("f02131d0")),o=r._(a("21b133d7")),s=a("a4a66ae7"),c=a("76b2776a"),u=a("19a2cef9"),p=a("72137535"),m=a("b8ef6610"),g=a("144bf41d"),f=a("e8effefa"),h=a("0fddaff6");let y=e=>e?(0,i.getMixedLocaleFieldValue)(e):"",v=e=>[{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Description",dm:"\u63CF\u8FF0"}),value:"Description"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Property",dm:"\u5C5E\u6027"}),value:"Property"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Relationship",dm:"\u5173\u7CFB"}),value:"Relation"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Sampling",dm:"\u62BD\u6837"}),value:"Sample",disabled:null==e?void 0:e.isLLMExtract}],b=e=>{var t;return[{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Description",dm:"\u63CF\u8FF0"}),value:"Description"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Property",dm:"\u5C5E\u6027"}),value:"Property"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Rules",dm:"\u89C4\u5219"}),value:"Rule",disabled:!(null==e?void 0:null===(t=e.logicRuleDTO)||void 0===t?void 0:t.expression)}];},x=e=>{var t;let a=[{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Description",dm:"\u63CF\u8FF0"}),value:"ConceptDescription"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Property",dm:"\u5C5E\u6027"}),value:"ConceptProperty"}];return a.push({label:d.default.get({id:"spg.components.SchemaDrawer.utils.Rules",dm:"\u89C4\u5219"}),value:"Rule",disabled:!(null==e?void 0:null===(t=e.properties)||void 0===t?void 0:t.dslRule)}),a;},S={[u.TabTypeEnum.Description]:(0,n.jsx)(p.Description,{}),[u.TabTypeEnum.Property]:(0,n.jsx)(m.Property,{}),[u.TabTypeEnum.Relation]:(0,n.jsx)(g.Relation,{}),[u.TabTypeEnum.Sample]:(0,n.jsx)(h.Sample,{}),[u.TabTypeEnum.Rule]:(0,n.jsx)(f.Rule,{}),[u.TabTypeEnum.ConceptDescription]:(0,n.jsx)(s.ConceptDescription,{}),[u.TabTypeEnum.ConceptProperty]:(0,n.jsx)(c.ConceptProperty,{})},T=(e,t,a)=>{if(!e)return[];let{isSchema:r,type:n}=e;if(r)switch(n){case"combo":return v(a);case"node":if(e.name.startsWith("STD"))return[{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Description",dm:"\u63CF\u8FF0"}),value:"Description"},{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Relationship",dm:"\u5173\u7CFB"}),value:"Relation"}];return v(a);case"edge":return b(a);}return"node"===n?x(t):[{label:d.default.get({id:"spg.components.SchemaDrawer.utils.Description",dm:"\u63CF\u8FF0"}),value:"ConceptDescription"}];},D=(e,t,a)=>{let r=T(e,t,a);return{tabItems:r.map(e=>{let t=e.value;return{label:e.label,key:t,children:S[t],disabled:e.disabled};}),tabOptions:r};},N=(e,t)=>{let a=e.name||"",r=e.nameZh||"",n=a.includes(t),l=r.includes(t);return n||l;},E=(e,t,a="")=>{let{inheritedPropertyList:r=[],propertyList:i=[]}=e,d=[...r,...i].filter(e=>N(e,a));if(!d.length)return[];let s=t;return s||(s={"1_\u57FA\u7840\u5C5E\u6027":r.map(e=>`${e.name}_true`).concat(i.map(e=>`${e.name}_false`))}),Object.entries(s).map(([e,t])=>{let a=[l.PropertyGroupName.PROPERTY_GROUP_SUBJECT_NAME,l.PropertyGroupName.PROPERTY_GROUP_OBJECT_NAME].includes(e),[r,i]=e.split("_");return{index:Number(r),groupName:i,propertyList:t.map(e=>{let[t,a]=e.split("_"),r=d.find(e=>e.name===t);return r||(r=void 0),{name:t,inherit:"true"===a,attrInfo:r};}).filter(e=>!!e.attrInfo).map(({name:e,inherit:t,attrInfo:r})=>{let l=(Array.isArray(null==r?void 0:r.subPropertyList)?null==r?void 0:r.subPropertyList:[]).map(t=>({key:`${e}_${(null==t?void 0:t.name)||""}`,name:null==t?void 0:t.name,inherit:!1,nameShow:null==t?void 0:t.name,nameZhShow:(0,n.jsxs)("span",{children:[(0,n.jsx)(o.default,{rotate:90}),null==t?void 0:t.nameZh]}),typeShowName:(null==t?void 0:t.rangeEntityNameZh)||(null==t?void 0:t.rangeEntityName)||(null==t?void 0:t.rangeNameZh)||(null==t?void 0:t.rangeName)||"",...t||{}})),i=e,d=null==r?void 0:r.nameZh;return a&&(d="",i=(0,n.jsxs)("span",{children:[(0,n.jsx)(o.default,{rotate:90}),e]})),{key:e,inherit:t,nameShow:i,nameZhShow:d,typeShowName:(null==r?void 0:r.rangeEntityNameZh)||(null==r?void 0:r.rangeEntityName)||(null==r?void 0:r.rangeNameZh)||(null==r?void 0:r.rangeName)||"",name:e,nameZh:null==r?void 0:r.nameZh,...r,...l.length>0?{children:l}:{}};})};}).filter(e=>e.propertyList.length).sort((e,t)=>e.index-t.index);},C=(e,t)=>{if(!(null==e?void 0:e.properties))return[];let{parentProps:a,properties:r}=e,n=[],l=t.find(t=>e.label===t.name),i=[];return l&&(i=[...l.propertyList||[],...l.inheritedPropertyList||[]]),Object.keys(r).forEach(e=>{if(!e.endsWith("Zh")){let t="";if(null==i?void 0:i.length){let a=i.find(t=>t.name===e);a&&(t=a.nameZh);}n.push({id:e,name:e,value:r[e],nameZh:t,inherit:a&&Reflect.has(a,e),hasValue:!!r[e]});}}),n.sort(({value:e},{value:t})=>e&&!t?-1:!e&&t?1:0),n;};},"2f862a98":function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.e(t,{Badge:function(){return d;},Empty:function(){return s;},Tag:function(){return o;}});var r=a("777fffbe"),n=a("5b5ed4a9"),l=r._(a("b916d24f")),i=r._(a("5f54387e"));let d=n.styled.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  border-top: 16px solid #ef7100;
  border-right: 16px solid transparent;
`,o=(0,n.styled)(i.default)`
  color: rgba(0, 0, 0, 0.65) !important;
  font-size: 12px !important;
  margin: 0 !important;
  margin-left: 8px !important;
  background-color: rgba(0, 0, 0, 0.04) !important;
  border: 1px solid rgba(0, 0, 0, 0.15) !important;
  border-radius: 2px !important;
`,s=(0,n.styled)(l.default)`
  height: 150px;
  display: flex;
  justify-content: center;
  flex-direction: column;
  .ant-collapse-image,
  .ant-collapse-description {
    display: flex;
    justify-content: center;
  }
  .ant-collapse-description {
    color: var(--deep-blue-47);
  }
`;},"4bb2999e":function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"default",{enumerable:!0,get:function(){return p;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("5b5ed4a9"),i=r._(a("e388b5c1")),d=a("fc1f4356");let{Panel:o}=i.default,s=(0,l.styled)(i.default)`
  .ant-collapse-header {
    position: ${({$stickyHeight:e})=>e?"sticky !important":"relative"};
    ${({$stickyHeight:e})=>e?"top:"+e+"px":""};
    z-index: 5;
  }
`,c=(0,l.styled)(l.Icon)`
  > svg {
    transition: all 0.3s ease-out;
    transform: ${({$active:e})=>e?"none":"rotate(-90deg)"};
  }
`,u=({collapseAll:e=!1,stickyHeight:t,...a})=>{let{children:r}=a,l=[];return!e&&r&&(l=(0,d.isArray)(r)?r.map(e=>e.key):[r.key]),(0,n.jsx)(s,{$stickyHeight:t,defaultActiveKey:l,expandIcon:e=>(0,n.jsx)(c,{icon:"ant-design:caret-down-filled",className:"icon",$active:e.isActive}),...a});};u.Panel=o;var p=u;},"554f69e4":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{columns:function(){return O;},expandable:function(){return R;},formatEnumValueToString:function(){return L;},getPropertyAdvanceConfigsTag:function(){return I;},getRowClassName:function(){return j;}});var r=a("777fffbe"),n=a("852bbaa9"),l=a("32b7a2cf"),i=a("fc5eb767"),d=a("3ba80fd7"),o=r._(d),s=a("f02131d0"),c=r._(s),u=a("8e68a90d"),p=a("d5b565e0"),m=r._(p),g=a("0c8a2b89"),f=r._(g),h=a("1043743b"),y=r._(h),v=a("02b696d0"),b=n._(v),x=a("95a5136e"),S=r._(x),T=a("833883d6"),D=r._(T),N=b.forwardRef(function(e,t){return b.createElement(D.default,(0,y.default)((0,y.default)({},e),{},{ref:t,icon:S.default}));}),E=a("4d0e37ae");r._(E);var C=a("fc1f4356"),w=a("483403ba"),P=a("d2ee7e38"),_=a("2f862a98");let O=[{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.PropertyChinese",dm:"\u5C5E\u6027(\u4E2D\u6587)"}),dataIndex:"nameZhShow",key:"name",width:"28%",render:(e,t)=>t.inherit?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.default,{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.InheritedProperties",dm:"\u7EE7\u627F\u7684\u5C5E\u6027"}),children:(0,l.jsx)(_.Badge,{})}),(0,l.jsx)(o.default,{text:e,showTextInMessage:!0,children:(0,l.jsx)("span",{style:{display:"inline-flex",width:"calc(100% - 14px)"},children:(0,l.jsx)(w.EllipsisTextTip,{text:e})})})]}):(0,l.jsx)(o.default,{text:e,showTextInMessage:!0,children:(0,l.jsxs)("span",{style:{display:"inline-flex",width:"calc(100% - 14px)"},children:[(0,l.jsx)(w.EllipsisTextTip,{text:e}),t.isLLMExtract&&(0,l.jsx)(P.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.LargeModel",dm:"\u5927\u6A21\u578B"})})]})})},{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.AttributesEnglish",dm:"\u5C5E\u6027(\u82F1\u6587)"}),dataIndex:"nameShow",key:"name",width:"22%",render:e=>(0,l.jsx)(o.default,{text:e,showTextInMessage:!0,children:(0,l.jsx)("span",{children:(0,l.jsx)(w.EllipsisTextTip,{text:e})})})},{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.AttributeType",dm:"\u5C5E\u6027\u7C7B\u578B"}),dataIndex:"typeShowName",key:"name",render:(e,t)=>{let a=M(t),r=(0,l.jsxs)(l.Fragment,{children:[e,a]});return t.propertyCategoryEnum&&[i.PropertyCategory.CONCEPT,i.PropertyCategory.ENTITY,i.PropertyCategory.EVENT].includes(t.propertyCategoryEnum)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("a",{onClick:()=>{t.rangeId&&(0,u.setFocusNodeId)(String(t.rangeId));},children:e}),a]}):r;}},{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.Operation",dm:"\u64CD\u4F5C"}),key:"action",width:132,render:(e,t)=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.default,{onClick:()=>{(0,u.setAdvancedPropertyData)(t);},className:"pl0 pr0",type:"link",children:c.default.get({id:"spg.SchemaDrawer.Property.utils.AdvancedConfiguration",dm:"\u9AD8\u7EA7\u914D\u7F6E"})}),I(t)]})}],R={defaultExpandAllRows:!0,expandIcon:({expanded:e,onExpand:t,record:a})=>(0,C.isEmpty)(a.children)||!(0,C.isArray)(a.children)?null:(0,l.jsx)(N,{rotate:e?90:0,onClick:e=>t(a,e)})},j=e=>{var t;return(null===(t=e.children)||void 0===t?void 0:t.length)?"with-children":"";},M=e=>{let{propertyCategoryEnum:t}=e;switch(t){case i.PropertyCategory.CONCEPT:return(0,l.jsx)(f.default,{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.ForConceptTypePropertiesPlease",dm:"\u6982\u5FF5\u7C7B\u578B\u5C5E\u6027\uFF0C\u8BF7\u70B9\u51FB\u3010\u9AD8\u7EA7\u914D\u7F6E\u3011\u67E5\u770B\u8BE6\u60C5"}),children:(0,l.jsx)(_.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.Concept",dm:"\u6982\u5FF5"})})});case i.PropertyCategory.STANDARD:return(0,l.jsx)(f.default,{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.StandardSemanticTypePropertiesPlease",dm:"\u6807\u51C6\u8BED\u4E49\u7C7B\u578B\u5C5E\u6027\uFF0C\u8BF7\u70B9\u51FB\u3010\u9AD8\u7EA7\u914D\u7F6E\u3011\u67E5\u770B\u8BE6\u60C5"}),children:(0,l.jsx)(_.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.StandardSemantics",dm:"\u6807\u51C6\u8BED\u4E49"})})});case i.PropertyCategory.ENTITY:return(0,l.jsx)(f.default,{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.EntityTypePropertiesPleaseClick",dm:"\u5B9E\u4F53\u7C7B\u578B\u5C5E\u6027\uFF0C\u8BF7\u70B9\u51FB\u3010\u9AD8\u7EA7\u914D\u7F6E\u3011\u67E5\u770B\u8BE6\u60C5"}),children:(0,l.jsx)(_.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.Entity",dm:"\u5B9E\u4F53"})})});case i.PropertyCategory.EVENT:return(0,l.jsx)(f.default,{title:c.default.get({id:"spg.SchemaDrawer.Property.utils.EventTypePropertiesPleaseClick",dm:"\u4E8B\u4EF6\u7C7B\u578B\u5C5E\u6027\uFF0C\u8BF7\u70B9\u51FB\u3010\u9AD8\u7EA7\u914D\u7F6E\u3011\u67E5\u770B\u8BE6\u60C5"}),children:(0,l.jsx)(_.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.Event",dm:"\u4E8B\u4EF6"})})});default:return(0,l.jsx)(l.Fragment,{});}},I=e=>{let{constraints:t,transformerEnumCode:a,maskType:r,editSourceLevel:n,logicRule:d}=e,o=null==n?void 0:n.find(e=>"EDIT"===e.source),s=[];return((null==t?void 0:t.length)&&s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.Constraints",dm:"\u7EA6\u675F"})),(0,C.isEmpty)(d)||s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.DslRules",dm:"DSL \u89C4\u5219"})),a===i.AlgorithmOperatorTypeEnum.ENTITY_LINK?s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.ChainRefersToOperator",dm:"\u94FE\u6307\u7B97\u5B50"})):a===i.AlgorithmOperatorTypeEnum.PROPERTY_NORMALIZE&&s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.StandardizedOperator",dm:"\u6807\u5316\u7B97\u5B50"})),r&&"NONE"!==r.toUpperCase()&&s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.DesensitizationMode",dm:"\u8131\u654F\u65B9\u5F0F"})),o&&s.push(c.default.get({id:"spg.SchemaDrawer.Property.utils.Source",dm:"\u6E90"})),s.length)?(0,l.jsx)(f.default,{title:(()=>{let e=s.join("\u3001");return c.default.get({id:"spg.SchemaDrawer.Property.utils.ThereAreConfigtypesstrConfigurationsPlease",dm:"\u6709 {configTypesStr} \u914D\u7F6E, \u8BF7\u70B9\u51FB\u9AD8\u7EA7\u914D\u7F6E\u67E5\u770B"},{configTypesStr:e});})(),placement:"topRight",children:(0,l.jsx)(_.Tag,{children:c.default.get({id:"spg.SchemaDrawer.Property.utils.High",dm:"\u9AD8"})})}):(0,l.jsx)(l.Fragment,{});},L=e=>Object.keys(e).reduce((t,a)=>t+=`${a}:${e[a]}
`,"");},72137535:function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{Description:function(){return D;}});var r=a("777fffbe"),n=a("852bbaa9"),l=a("32b7a2cf"),i=a("f02131d0"),d=r._(i),o=a("52fb4bb8"),s=a("4d0e37ae"),c=n._(s),u=a("8e68a90d"),p=a("4bb2999e"),m=r._(p),g=a("4c70c3ed"),f=a("1a998156"),h=a("d5b565e0"),y=r._(h),v=a("9ffd6a0f"),b=r._(v),x=a("a5eab18a");let S=({data:e,columns:t})=>{let a=(0,c.useMemo)(()=>t||("node"===e.type?[f.INFO_COLUMN.NAME,f.INFO_COLUMN.DESCRIPTION]:[f.INFO_COLUMN.NAME,f.INFO_COLUMN.DESCRIPTION,f.INFO_COLUMN.SOURCE,f.INFO_COLUMN.TARGET]),[e]),r=(e,t)=>{switch(e){case f.INFO_COLUMN.NAME:return{label:f.infoColumnMapping[f.INFO_COLUMN.NAME],key:f.INFO_COLUMN.NAME,value:(0,g.getMixedLocaleFieldValue)(t)};case f.INFO_COLUMN.DESCRIPTION:return{label:f.infoColumnMapping[f.INFO_COLUMN.DESCRIPTION],key:f.INFO_COLUMN.DESCRIPTION,value:(0,l.jsxs)(l.Fragment,{children:[t.description,t.yuQueUrl&&(0,l.jsx)(y.default,{type:"link",onClick:()=>{window.open(t.yuQueUrl,"_blank");},children:d.default.get({id:"spg.SchemaDrawer.Description.Info.Documentation",dm:"\u8BF4\u660E\u6587\u6863"})}),!!(!t.description&&!t.yuQueUrl)&&"-"]})};case f.INFO_COLUMN.MODIFY_TIME:return{label:f.infoColumnMapping[f.INFO_COLUMN.MODIFY_TIME],key:f.INFO_COLUMN.MODIFY_TIME,value:t.modifiedTime||d.default.get({id:"spg.SchemaDrawer.Description.Info.None",dm:"\u65E0"})};case f.INFO_COLUMN.KNOWLEDGE_COUNT:return{label:f.infoColumnMapping[f.INFO_COLUMN.KNOWLEDGE_COUNT],key:f.INFO_COLUMN.KNOWLEDGE_COUNT,value:(0,l.jsxs)("span",{children:[t.baseCount||0,t.baseDate&&(0,l.jsx)("span",{className:"ant-descriptions-item-content-extra",children:d.default.get({id:"spg.SchemaDrawer.Description.Info.StatisticalDeadlineDatabasedate",dm:"(\u7EDF\u8BA1\u622A\u6B62\u65F6\u95F4\uFF1A{dataBaseDate})"},{dataBaseDate:t.baseDate})})]})};case f.INFO_COLUMN.SOURCE:return{label:f.infoColumnMapping[f.INFO_COLUMN.SOURCE],key:f.INFO_COLUMN.SOURCE,value:(0,g.getMixedLocaleFieldValue)(t.startEntity)};case f.INFO_COLUMN.TARGET:return{label:f.infoColumnMapping[f.INFO_COLUMN.TARGET],key:f.INFO_COLUMN.TARGET,value:(0,g.getMixedLocaleFieldValue)(t.endEntity)};case f.INFO_COLUMN.RELATION_DIRECTION:return{label:f.infoColumnMapping[f.INFO_COLUMN.RELATION_DIRECTION],key:f.INFO_COLUMN.RELATION_DIRECTION,value:f.relationDirectionMapping[t.direction||f.RELATION_DIRECTION.NULL]};default:return e;}};return(0,l.jsx)(x.StyledDescriptions,{column:1,children:a.map(t=>{let a=r(t,e);return(0,l.jsx)(b.default.Item,{label:a.label,children:a.value},a.key);})});},{Panel:T}=m.default,D=()=>{let[{schemaInfo:e,schemaDetail:t}]=(0,o.useProxyState)(u.knowledgeModelDataState);return(0,l.jsx)("div",{children:(0,l.jsx)(m.default,{children:(0,l.jsx)(T,{header:d.default.get({id:"spg.SchemaDrawer.Description.KnowledgeDescription",dm:"\u77E5\u8BC6\u63CF\u8FF0"}),children:(0,l.jsx)(S,{data:{...t,type:null==e?void 0:e.type}})},"info")})});};},"76b2776a":function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"ConceptProperty",{enumerable:!0,get:function(){return f;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("52fb4bb8"),i=r._(a("f02131d0")),d=a("5b5ed4a9"),o=a("4d0e37ae"),s=a("8e68a90d"),c=a("8a175809"),u=a("a5eab18a"),p=a("2cca46ec");let m=d.styled.div`
  padding: var(--padding-sm) var(--padding-md);
`,g=[{dataIndex:"nameZh",title:i.default.get({id:"spg.components.SchemaDrawer.ConceptProperty.PropertyChinese",dm:"\u5C5E\u6027(\u4E2D\u6587)"}),width:"30%"},{dataIndex:"name",title:i.default.get({id:"spg.components.SchemaDrawer.ConceptProperty.AttributesEnglish",dm:"\u5C5E\u6027(\u82F1\u6587)"}),width:"30%"},{dataIndex:"value",title:i.default.get({id:"spg.components.SchemaDrawer.ConceptProperty.DetermineTheValue",dm:"\u786E\u5B9A\u503C"}),width:"40%"}],f=()=>{let[{conceptDetail:e={}}={}]=(0,l.useProxyState)(c.conceptModelDataState),[{schemaData:t}]=(0,l.useProxyState)(s.knowledgeModelDataState),a=(0,o.useMemo)(()=>(0,p.toViewConceptPropertyList)(e,t.nodes).filter(e=>"dslRule"!==e.name),[e,t.nodes]);return(0,n.jsx)(m,{children:(0,n.jsx)(u.PropertyTable,{columns:g,dataSource:a,pagination:a.length>10&&{position:["bottomRight"],showSizeChanger:!0,size:"small"}})});};},"81ea1a90":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{getOneLevelFromGraphDataByName:function(){return o;},insertUniqueNodes:function(){return d;},isFusionNode:function(){return r;},isStandardPropertyEdge:function(){return i;},transformToFusionGraphData:function(){return n;}});let r=e=>!!e&&"FUSE"===e.category&&!!e.fuseConfig,n=e=>{var t;let a=[];e.nodes.forEach(e=>{var t,r;let n=(null===(r=e.fuseConfig)||void 0===r?void 0:null===(t=r.sourceTypes)||void 0===t?void 0:t.map(e=>String(e.id)))||[];a.push(...n);});let n=e.nodes.filter(e=>!a.includes(String(e.id))).map(t=>{var a;if(!r(t))return t;let n=null===(a=t.fuseConfig.sourceTypes)||void 0===a?void 0:a.map(t=>e.nodes.find(e=>String(e.id)===String(t.id)));return{...t,fusionSourceNodes:n,isFusionTarget:!0,isFusionSource:!1,shape:"GroupNode",cluster:`${t.name}-GroupNode`,coreNode:!0,children:n.map(e=>({...e,virtual:!0}))};}),l=(null==e?void 0:null===(t=e.edges)||void 0===t?void 0:t.slice())??[];return e.nodes.forEach(e=>{var t,a;((null===(a=e.fuseConfig)||void 0===a?void 0:null===(t=a.fuse)||void 0===t?void 0:t.copyEdges)||[]).forEach(t=>{var a;null==t||null===(a=t.spo)||void 0===a||a.forEach(t=>{var a,r;let n=l.findIndex(e=>String(e.id)===String(t.relTypeId)),i=l[n];if(!i){console.error(`Edge ${t.relTypeId} not found!`);return;}let d=(null===(r=e.fuseConfig)||void 0===r?void 0:null===(a=r.sourceTypes)||void 0===a?void 0:a.map(e=>String(e.id)))||[],o={};d.includes(i.source)&&(o={source:e.id,sourceName:e.name,sourceNameZh:e.nameZh});let s={};d.includes(i.target)&&(s={target:e.id,targetName:e.name,targetNameZh:e.nameZh});let c={...i,_isFusedEdge:!0,...o,...s};l.splice(n,1,c);});});}),{nodes:n,edges:l};};var l=a("55734e13");let i=({relationCategory:e})=>e===l.RELATION_CATEGORY.STANDARD,d=(e,t)=>(e.find(e=>e.name===t.name)||e.push(t),e),o=(e,t)=>{let{nodes:a=[],edges:r=[]}=e,n=[],l=r.reduce((e,a)=>{let{sourceName:r,targetName:l}=a;return(r===t||l===t)&&(e.push(a),i(a)&&n.push(r===t?l:r)),e;},[]);return r.forEach(e=>{let{sourceName:t,targetName:a}=e;(n.includes(t)||n.includes(a))&&!l.find(t=>t.id===e.id)&&l.push(e);}),{nodes:l.reduce((e,t)=>{let r=a.find(e=>e.name===t.sourceName);e=r?d(e,r):e;let n=a.find(e=>e.name===t.targetName);return e=n?d(e,n):e;},[a.find(e=>e.name===t)].filter(e=>e)),edges:l};};},"8a175809":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{clearConceptDetail:function(){return b;},conceptModelDataState:function(){return y;},expandConcept:function(){return x;},fetchConceptDetail:function(){return S;},fetchConceptTree:function(){return v;}});var r=a("777fffbe"),n=a("f02131d0"),l=r._(n),i=a("fc5eb767"),d=a("05ecbb5b");async function o(e,t){return(0,d.request)("/concept/api/expandConcept.json",{method:"GET",params:{...e},...t||{}});}async function s(e,t){return(0,d.request)("/concept/api/getConceptDetail.json",{method:"GET",params:{...e},...t||{}});}async function c(e,t){return(0,d.request)("/concept/api/getConceptTree.json",{method:"GET",params:{...e},...t||{}});}var u=a("5b5ed4a9"),p=a("2b798761"),m=r._(p),g=a("3834a44f"),f=a("8dec2e97");let h=(0,i.transformConceptTreeData)({children:[],conceptRes:{conceptDescription:"",conceptDescriptionZh:"",conceptParentType:"-1",id:"",label:"-1",metaConcept:!1,name:"virtualConcept",nameZh:l.default.get({id:"spg.states.data.concept.Concept",dm:"\u6982\u5FF5"}),originId:"",parentId:""}}),y=(0,u.proxy)({conceptTreeData:h,conceptGraphData:{nodes:[],edges:[]}}),v=async()=>{let e=Number((0,g.getProjectId)());y.fetching=!0;let{result:t,success:a}=await c({projectId:e});if(a&&t){let e=(0,i.transformConceptTreeData)(t);return y.conceptTreeData=e,y.fetching=!1,e;}return y.conceptTreeData=h,y.fetching=!1,h;},b=()=>{y.conceptDetail=void 0;},x=async(e,t)=>{var a;y.fetching=!0;let{result:r,success:n}=await o(e);if(!n||!r){y.fetching=!1;return;}let d=(0,i.transformConceptTreeData)(r),{children:s}=d;(0,i.concatConceptTree)(s,y.conceptTreeData,t),(null===(a=d.children)||void 0===a?void 0:a.length)||m.default.info(l.default.get({id:"spg.states.data.concept.NoExpansionDataForCurrent",dm:"\u5F53\u524D\u8282\u70B9\u65E0\u5C55\u5F00\u6570\u636E"})),y.fetching=!1;},S=async e=>{if(!e)return;let{type:t}=e,a={success:!0,result:void 0};if(!e.isSchema)switch(t){case"node":a=await s({metaType:e.metaType,primaryKey:e.primaryKey});break;case"edge":a=(0,f.getConceptRelationDetail)({name:e.name,startEntity:e.startEntity,endEntity:e.endEntity});}let{success:r,result:n}=a;if(r&&n){y.conceptDetail=n;return;}y.conceptDetail=void 0;};},a4a66ae7:function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"ConceptDescription",{enumerable:!0,get:function(){return b;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("4c70c3ed"),i=a("52fb4bb8"),d=r._(a("f02131d0")),o=a("48fdd872"),s=a("5b5ed4a9"),c=r._(a("9ffd6a0f")),u=a("4d0e37ae"),p=a("3834a44f"),m=a("6f249d5c"),g=a("8e68a90d"),f=a("8a175809"),h=a("a5eab18a");let y=s.styled.div`
  padding: var(--padding-md);
  .dsl-editor {
    border: var(--solid-border);
    border-radius: var(--border-radius-lg);
    height: 100%;
    overflow: hidden;
  }
`,v=c.default.Item,b=()=>{let[{schemaInfo:e,schemaData:t}]=(0,i.useProxyState)(g.knowledgeModelDataState),[{conceptDetail:a={}}={}]=(0,i.useProxyState)(f.conceptModelDataState),r=Number((0,p.getProjectId)()),{data:{result:c={}}={}}=(0,s.useQuery)(["getSchemaNameMap",{projectId:r}],()=>(0,o.getSchemaNameMap)({projectId:r}),{enabled:!!r}),b=(0,u.useMemo)(()=>{if((null==e?void 0:e.type)==="node"&&!e.isSchema){let r=t.nodes.find(t=>t.name===e.metaType),n=(0,l.getMixedLocaleFieldValue)(r||{name:e.metaType,nameZh:c[e.metaType]}),i=n,o=((null==a?void 0:a.primaryKey)||"").split("-");if(Array.isArray(o)&&o.length>1){let[e,t]=o;i=e;}return[{key:"name",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.ConceptName",dm:"\u6982\u5FF5\u540D\u79F0"}),value:(0,l.getMixedLocaleFieldValue)(a,{onlyLocale:!0})||"-"},{key:"description",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.DescriptionOfConcept",dm:"\u6982\u5FF5\u63CF\u8FF0"}),value:(0,l.getMixedLocaleFieldValue)(a,{fileName:"description",onlyLocale:!0})||"-"},{key:"concept-parent",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.ParentConcept",dm:"\u7236\u6982\u5FF5"}),value:i||"-"},{key:"meta-type",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.MetaConcept",dm:"\u5143\u6982\u5FF5"}),value:n||"-"},{key:"alias-name",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.Alias",dm:"\u522B\u540D"}),value:(0,l.getMixedLocaleFieldValue)(a,{fileName:"aliasName",onlyLocale:!0})||"-"}];}return[{key:"name",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.RelationshipName",dm:"\u5173\u7CFB\u540D\u79F0"}),value:(0,l.getMixedLocaleFieldValue)(a,{onlyLocale:!0})||"-"},{key:"startEntity",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.StartingPoint",dm:"\u8D77\u70B9"}),value:(0,l.getMixedLocaleFieldValue)(null==a?void 0:a.startEntity,{onlyLocale:!0})||"-"},{key:"endEntity",label:d.default.get({id:"spg.components.SchemaDrawer.ConceptDescription.End",dm:"\u7EC8\u70B9"}),value:(0,l.getMixedLocaleFieldValue)(null==a?void 0:a.endEntity,{onlyLocale:!0})||"-"}];},[e,a,t,c]);return(0,n.jsxs)(y,{children:[(0,n.jsx)(h.StyledDescriptions,{column:1,children:b.map(e=>(0,n.jsx)(v,{label:e.label,children:e.value},e.key))}),(null==a?void 0:a.dslRule)&&(0,n.jsxs)(y,{children:[(0,n.jsx)("p",{children:d.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.DslRules",dm:"DSL \u89C4\u5219"})}),(0,n.jsx)("div",{className:"dsl-editor",children:(0,n.jsx)(m.DSLEditor,{options:{readOnly:!0},value:null==a?void 0:a.dslRule})})]})]});};},b8ef6610:function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"Property",{enumerable:!0,get:function(){return h;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("52fb4bb8"),i=r._(a("f02131d0")),d=r._(a("673e678e")),o=a("4d0e37ae"),s=a("3834a44f"),c=a("8e68a90d"),u=r._(a("4bb2999e")),p=a("a5eab18a"),m=a("2cca46ec"),g=a("2f862a98"),f=a("554f69e4");let h=()=>{let[{schemaDetail:e,dynamicConfig:t}]=(0,l.useProxyState)(c.knowledgeModelDataState),[a,r]=(0,o.useState)(""),[h,y]=(0,o.useState)([]),{groupList:v}=(0,o.useMemo)(()=>{if(e){var r;let n=e.inheritedPropertyList||[],l=e.propertyList||[],i=(0,m.propertyByGroup)({inheritedPropertyList:n,propertyList:l},null==t?void 0:null===(r=t[(0,s.getProjectId)()])||void 0===r?void 0:r.propertyGroup,a),d=i.map(({groupName:e,index:t})=>`${t}_${e}`);return y(d),{groupList:i,defaultActiveKey:d};}return y([i.default.get({id:"spg.SchemaDrawer.Property.BasicProperties",dm:"1_\u57FA\u7840\u5C5E\u6027"})]),{groupList:[{index:1,groupName:i.default.get({id:"spg.SchemaDrawer.Property.BaseAttributes",dm:"\u57FA\u7840\u5C5E\u6027"}),propertyList:[]}],defaultActiveKey:[i.default.get({id:"spg.SchemaDrawer.Property.BasicProperties",dm:"1_\u57FA\u7840\u5C5E\u6027"})]};},[e,a]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(p.PropertyTitle,{level:"block",title:i.default.get({id:"spg.SchemaDrawer.Property.AttributeList",dm:"\u5C5E\u6027\u5217\u8868"}),titleExtra:(0,n.jsx)(d.default.Search,{placeholder:i.default.get({id:"spg.SchemaDrawer.Property.SearchAttributeNameChineseEnglish",dm:"\u641C\u7D22\u5C5E\u6027\u540D\u79F0(\u652F\u6301\u4E2D/\u82F1\u6587)"}),allowClear:!0,style:{width:250},onSearch:r})}),(0,n.jsx)(u.default,{stickyHeight:97,bordered:!1,activeKey:h,onChange:e=>y(Array.isArray(e)?e:[e]),children:v.length?v.map(e=>{let{groupName:t,index:a,propertyList:r}=e;return(0,n.jsx)(u.default.Panel,{header:t,children:(0,n.jsx)(p.PropertyTable,{columns:f.columns,dataSource:r,rowClassName:f.getRowClassName,expandable:f.expandable,pagination:r.length>10&&{position:["bottomRight"],showSizeChanger:!0,size:"small"}})},`${a}_${t}`);}):(0,n.jsx)(g.Empty,{image:g.Empty.PRESENTED_IMAGE_SIMPLE})})]});};},d2ee7e38:function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.e(t,{RelationTitleSelect:function(){return d;},Tag:function(){return o;}});var r=a("777fffbe"),n=a("5b5ed4a9"),l=r._(a("fc1e2430")),i=r._(a("5f54387e"));let d=(0,n.styled)(l.default)`
  .ant-select-selector {
    padding: 0 !important;
    z-index: 10;

    .ant-select-selection-item {
      font-size: 16px;
      font-weight: 600;
      margin-right: 8px;
    }
  }
  .ant-select-arrow {
    color: rgba(0, 0, 0, 0.85);
  }
`,o=(0,n.styled)(i.default)`
  font-weight: normal;
  color: #1890ff;
  background: #e6f7ff;
  border: 1px solid #91d5ff;
  margin-left: 8px;
  margin-right: 0;
`;},e8effefa:function(e,t,a){"use strict";a.d(t,"__esModule",{value:!0}),a.d(t,"Rule",{enumerable:!0,get:function(){return p;}});var r=a("777fffbe"),n=a("32b7a2cf"),l=a("52fb4bb8"),i=r._(a("f02131d0")),d=a("5b5ed4a9");a("4d0e37ae");var o=a("6f249d5c"),s=a("8e68a90d"),c=a("8a175809");let u=d.styled.div`
  padding: var(--padding-sm) var(--padding-md) var(--padding-md);
  > p {
    line-height: 1;
  }
  .dsl-editor {
    border: var(--solid-border);
    border-radius: var(--border-radius-lg);
    height: calc(100vh - 340px);
    overflow: hidden;
  }
`,p=()=>{var e,t;let[{schemaInfo:a,schemaDetail:r}]=(0,l.useProxyState)(s.knowledgeModelDataState),[{conceptDetail:d}]=(0,l.useProxyState)(c.conceptModelDataState),p=(null==a?void 0:a.isSchema)?null==r?void 0:null===(e=r.logicRuleDTO)||void 0===e?void 0:e.expression:null==d?void 0:null===(t=d.properties)||void 0===t?void 0:t.dslRule;return(0,n.jsxs)(u,{children:[(0,n.jsx)("p",{children:i.default.get({id:"spg.SchemaDrawer.Property.AdvancedProperty.DslRules",dm:"DSL \u89C4\u5219"})}),(0,n.jsx)("div",{className:"dsl-editor",children:(0,n.jsx)(o.DSLEditor,{options:{readOnly:!0},value:p})})]});};}}]);
