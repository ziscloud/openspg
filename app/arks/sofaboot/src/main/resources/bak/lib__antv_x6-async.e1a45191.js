(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["lib_@antv/x6"],{"070d527f":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Path",{enumerable:!0,get:function(){return o;}});var n=i("b6be2189"),r=i("c540a28c"),s=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let o=r.Base.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(e){let{path:t}=e,i=s(e,["path"]);return t&&n.ObjectExt.setByPath(i,"attrs/body/refD",t),i;}});},"09a35859":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{SourceAnchor:function(){return h;},TargetAnchor:function(){return c;}});var n=i("852bbaa9"),r=i("b6be2189"),s=i("748e16f0"),o=i("43bcb3fd"),l=n._(i("c0026991"));class a extends o.ToolsView.ToolItem{get type(){return this.options.type;}onRender(){r.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update();}update(){let e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this;}updateAnchor(){let e=this.childNodes;if(!e)return;let t=e.anchor;if(!t)return;let i=this.type,n=this.cellView,r=this.options,s=n.getTerminalAnchor(i),o=n.cell.prop([i,"anchor"]);t.setAttribute("transform",`translate(${s.x}, ${s.y})`);let l=o?r.customAnchorAttrs:r.defaultAnchorAttrs;l&&Object.keys(l).forEach(e=>{t.setAttribute(e,l[e]);});}updateArea(){let e=this.childNodes;if(!e)return;let t=e.area;if(!t)return;let i=this.type,n=this.cellView,s=n.getTerminalView(i);if(s){let e,o,l;let a=s.cell,h=n.getTerminalMagnet(i),c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),s.isEdgeElement(h)?(e=s.getBBox(),o=0,l=e.getCenter()):(e=s.getUnrotatedBBoxOfElement(h),o=a.getAngle(),l=e.getCenter(),o&&l.rotate(-o,a.getBBox().getCenter())),e.inflate(c),r.Dom.attr(t,{x:-e.width/2,y:-e.height/2,width:e.width,height:e.height,transform:`translate(${l.x}, ${l.y}) rotate(${o})`});}}toggleArea(e){if(this.childNodes){let t=this.childNodes.area;t&&(t.style.display=e?"":"none");}}onMouseDown(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}));}resetAnchor(e){let t=this.type,i=this.cell;e?i.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):i.removeProp([t,"anchor"],{ui:!0,toolId:this.cid});}onMouseMove(e){let t;let i=this.type,n=this.cellView,o=n.getTerminalView(i);if(null==o)return;let l=this.normalizeEvent(e),a=o.cell,h=n.getTerminalMagnet(i),c=this.graph.coord.clientToLocalPoint(l.clientX,l.clientY),u=this.options.snap;if("function"==typeof u){let e=r.FunctionExt.call(u,n,c,o,h,i,n,this);c=s.Point.create(e);}if(this.options.restrictArea){if(o.isEdgeElement(h)){let e=o.getClosestPoint(c);e&&(c=e);}else{let e=o.getUnrotatedBBoxOfElement(h),t=a.getAngle(),i=a.getBBox().getCenter(),n=c.clone().rotate(t,i);e.containsPoint(n)||(c=e.getNearestPointToPoint(n).rotate(-t,i));}}let g=this.options.anchor;"function"==typeof g&&(t=r.FunctionExt.call(g,n,c,o,h,i,n,this)),this.resetAnchor(t),this.update();}onMouseUp(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);let t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid});}onDblClick(){let e=this.options.resetAnchor;e&&this.resetAnchor(!0===e?void 0:e),this.update();}}!function(e){e.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:l.getAnchor,snap(e,t,i,n,r,s){let o=s.options.snapRadius||0,l="source"===n,a=this.cell.getVertexAt(l?0:-1)||this.getTerminalAnchor(l?"target":"source");return a&&(Math.abs(a.x-e.x)<o&&(e.x=a.x),Math.abs(a.y-e.y)<o&&(e.y=a.y)),e;}});}(a||(a={}));let h=a.define({name:"source-anchor",type:"source"}),c=a.define({name:"target-anchor",type:"target"});},"09cd1629":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"DefsManager",{enumerable:!0,get:function(){return a;}});var n=i("b6be2189"),r=i("534efe08"),s=i("ca3299f3"),o=i("a43747d2"),l=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class a extends o.Base{get cid(){return this.graph.view.cid;}get svg(){return this.view.svg;}get defs(){return this.view.defs;}isDefined(e){return null!=this.svg.getElementById(e);}filter(e){let t=e.id,i=e.name;if(t||(t=`filter-${i}-${this.cid}-${n.StringExt.hashcode(JSON.stringify(e))}`),!this.isDefined(t)){let o=r.Filter.registry.get(i);if(null==o)return r.Filter.registry.onNotFound(i);let l=o(e.args||{}),a=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});n.Vector.create(s.Markup.sanitize(l),a).appendTo(this.defs);}return t;}gradient(e){let t=e.id,i=e.type;if(t||(t=`gradient-${i}-${this.cid}-${n.StringExt.hashcode(JSON.stringify(e))}`),!this.isDefined(t)){let r=e.stops.map(e=>{let t=null!=e.opacity&&Number.isFinite(e.opacity)?e.opacity:1;return`<stop offset="${e.offset}" stop-color="${e.color}" stop-opacity="${t}"/>`;}),s=`<${i}>${r.join("")}</${i}>`,o=Object.assign({id:t},e.attrs);n.Vector.create(s,o).appendTo(this.defs);}return t;}marker(e){let{id:t,refX:i,refY:r,markerUnits:s,markerOrient:o,tagName:a,children:h}=e,c=l(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]),u=t;if(u||(u=`marker-${this.cid}-${n.StringExt.hashcode(JSON.stringify(e))}`),!this.isDefined(u)){"path"!==a&&delete c.d;let e=n.Vector.create("marker",{refX:i,refY:r,id:u,overflow:"visible",orient:null!=o?o:"auto",markerUnits:s||"userSpaceOnUse"},h?h.map(e=>{var{tagName:t}=e,i=l(e,["tagName"]);return n.Vector.create(`${t}`||"path",n.Dom.kebablizeAttrs(Object.assign(Object.assign({},c),i)));}):[n.Vector.create(a||"path",n.Dom.kebablizeAttrs(c))]);this.defs.appendChild(e.node);}return u;}remove(e){let t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t);}}},"0f725314":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Config",{enumerable:!0,get:function(){return n;}});let n={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix:e=>`${n.prefixCls}-${e}`};},"1037de1b":function(e,t,i){"use strict";let n;i.d(t,"__esModule",{value:!0}),i.d(t,"View",{enumerable:!0,get:function(){return u;}});var r,s,o,l,a=i("b6be2189"),h=i("0f725314"),c=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class u extends a.Basecoat{get priority(){return 2;}get disposeContainer(){return!0;}constructor(){super(),this.cid=l.uniqueId(),u.views[this.cid]=this;}confirmUpdate(e,t){return 0;}empty(e=this.container){return a.Dom.empty(e),this;}unmount(e=this.container){return a.Dom.remove(e),this;}remove(e=this.container){return e===this.container?(this.removeEventListeners(document),this.onRemove(),delete u.views[this.cid],this.disposeContainer&&this.unmount(e)):this.unmount(e),this;}onRemove(){}setClass(e,t=this.container){t.classList.value=Array.isArray(e)?e.join(" "):e;}addClass(e,t=this.container){return a.Dom.addClass(t,Array.isArray(e)?e.join(" "):e),this;}removeClass(e,t=this.container){return a.Dom.removeClass(t,Array.isArray(e)?e.join(" "):e),this;}setStyle(e,t=this.container){return a.Dom.css(t,e),this;}setAttrs(e,t=this.container){return null!=e&&null!=t&&a.Dom.attr(t,e),this;}findAttr(e,t=this.container){let i=t;for(;i&&1===i.nodeType;){let t=i.getAttribute(e);if(null!=t)return t;if(i===this.container)break;i=i.parentNode;}return null;}find(e,t=this.container,i=this.selectors){return u.find(e,t,i).elems;}findOne(e,t=this.container,i=this.selectors){let n=this.find(e,t,i);return n.length>0?n[0]:null;}findByAttr(e,t=this.container){let i=t;for(;i&&i.getAttribute;){let t=i.getAttribute(e);if((null!=t||i===this.container)&&"false"!==t)return i;i=i.parentNode;}return null;}getSelector(e,t){let i;if(e===this.container)return"string"==typeof t&&(i=`> ${t}`),i;if(e){let n=a.Dom.index(e)+1;i=`${e.tagName.toLowerCase()}:nth-child(${n})`,t&&(i+=` > ${t}`),i=this.getSelector(e.parentNode,i);}return i;}prefixClassName(e){return h.Config.prefix(e);}delegateEvents(e,t){if(null==e)return this;t||this.undelegateEvents();let i=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach(t=>{let n=t.match(i);if(null==n)return;let r=this.getEventHandler(e[t]);"function"==typeof r&&this.delegateEvent(n[1],n[2],r);}),this;}undelegateEvents(){return a.Dom.Event.off(this.container,this.getEventNamespace()),this;}delegateDocumentEvents(e,t){return this.addEventListeners(document,e,t),this;}undelegateDocumentEvents(){return this.removeEventListeners(document),this;}delegateEvent(e,t,i){return a.Dom.Event.on(this.container,e+this.getEventNamespace(),t,i),this;}undelegateEvent(e,t,i){let n=e+this.getEventNamespace();return null==t?a.Dom.Event.off(this.container,n):"string"==typeof t?a.Dom.Event.off(this.container,n,t,i):a.Dom.Event.off(this.container,n,t),this;}addEventListeners(e,t,i){if(null==t)return this;let n=this.getEventNamespace();return Object.keys(t).forEach(r=>{let s=this.getEventHandler(t[r]);"function"==typeof s&&a.Dom.Event.on(e,r+n,i,s);}),this;}removeEventListeners(e){return null!=e&&a.Dom.Event.off(e,this.getEventNamespace()),this;}getEventNamespace(){return`.${h.Config.prefixCls}-event-${this.cid}`;}getEventHandler(e){let t;if("string"==typeof e){let i=this[e];"function"==typeof i&&(t=(...e)=>i.call(this,...e));}else t=(...t)=>e.call(this,...t);return t;}getEventTarget(e,t={}){let{target:i,type:n,clientX:r=0,clientY:s=0}=e;return t.fromPoint||"touchmove"===n||"touchend"===n?document.elementFromPoint(r,s):i;}stopPropagation(e){return this.setEventData(e,{propagationStopped:!0}),this;}isPropagationStopped(e){return!0===this.getEventData(e).propagationStopped;}getEventData(e){return this.eventData(e);}setEventData(e,t){return this.eventData(e,t);}eventData(e,t){if(null==e)throw TypeError("Event object required");let i=e.data,n=`__${this.cid}__`;return null==t?null==i?{}:i[n]||{}:(null==i&&(i=e.data={}),null==i[n]?i[n]=Object.assign({},t):i[n]=Object.assign(Object.assign({},i[n]),t),i[n]);}normalizeEvent(e){return u.normalizeEvent(e);}dispose(){this.remove();}}c([u.dispose()],u.prototype,"dispose",null),(r=u||(u={})).createElement=function(e,t){return t?a.Dom.createSvgElement(e||"g"):a.Dom.createElementNS(e||"div");},r.find=function(e,t,i){if(!e||"."===e)return{elems:[t]};if(i){let t=i[e];if(t)return{elems:Array.isArray(t)?t:[t]};}if(h.Config.useCSSSelector){let i=e.includes(">")?`:scope ${e}`:e;return{isCSSSelector:!0,elems:Array.prototype.slice.call(t.querySelectorAll(i))};}return{elems:[]};},r.normalizeEvent=function(e){let t=e,i=e.originalEvent,n=i&&i.changedTouches&&i.changedTouches[0];if(n){for(let t in e)void 0===n[t]&&(n[t]=e[t]);t=n;}return t;},(s=u||(u={})).views={},s.getView=function(e){return s.views[e]||null;},o=l||(l={}),n=0,o.uniqueId=function(){let e=`v${n}`;return n+=1,e;};},"10f1c36f":function(e,t,i){"use strict";let n;i.d(t,"__esModule",{value:!0}),i.d(t,"Edge",{enumerable:!0,get:function(){return f;}});var r,s,o,l,a=i("b6be2189"),h=i("748e16f0"),c=i("4e89343a"),u=i("62fc6309"),g=i("52023e1d"),d=i("2ad4cd03"),p=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class f extends d.Cell{get[Symbol.toStringTag](){return f.toStringTag;}constructor(e={}){super(e);}preprocess(e,t){let{source:i,sourceCell:n,sourcePort:r,sourcePoint:s,target:o,targetCell:l,targetPort:a,targetPoint:c}=e,u=p(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]);if(null!=i){if(d.Cell.isCell(i))u.source={cell:i.id};else if("string"==typeof i||"number"==typeof i)u.source={cell:i};else if(h.Point.isPoint(i))u.source=i.toJSON();else if(Array.isArray(i))u.source={x:i[0],y:i[1]};else{let e=i.cell;d.Cell.isCell(e)?u.source=Object.assign(Object.assign({},i),{cell:e.id}):u.source=i;}}if(null!=n||null!=r){let e=u.source;if(null!=n){let t="string"==typeof n||"number"==typeof n?n:n.id;e?e.cell=t:e=u.source={cell:t};}null!=r&&e&&(e.port=r);}else null!=s&&(u.source=h.Point.create(s).toJSON());if(null!=o){if(d.Cell.isCell(o))u.target={cell:o.id};else if("string"==typeof o||"number"==typeof o)u.target={cell:o};else if(h.Point.isPoint(o))u.target=o.toJSON();else if(Array.isArray(o))u.target={x:o[0],y:o[1]};else{let e=o.cell;d.Cell.isCell(e)?u.target=Object.assign(Object.assign({},o),{cell:e.id}):u.target=o;}}if(null!=l||null!=a){let e=u.target;if(null!=l){let t="string"==typeof l||"number"==typeof l?l:l.id;e?e.cell=t:e=u.target={cell:t};}null!=a&&e&&(e.port=a);}else null!=c&&(u.target=h.Point.create(c).toJSON());return super.preprocess(u,t);}setup(){super.setup(),this.on("change:labels",e=>this.onLabelsChanged(e)),this.on("change:vertices",e=>this.onVertexsChanged(e));}isEdge(){return!0;}disconnect(e={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this;}get source(){return this.getSource();}set source(e){this.setSource(e);}getSource(){return this.getTerminal("source");}getSourceCellId(){return this.source.cell;}getSourcePortId(){return this.source.port;}setSource(e,t,i={}){return this.setTerminal("source",e,t,i);}get target(){return this.getTarget();}set target(e){this.setTarget(e);}getTarget(){return this.getTerminal("target");}getTargetCellId(){return this.target.cell;}getTargetPortId(){return this.target.port;}setTarget(e,t,i={}){return this.setTerminal("target",e,t,i);}getTerminal(e){return Object.assign({},this.store.get(e));}setTerminal(e,t,i,n={}){return d.Cell.isCell(t)?this.store.set(e,a.ObjectExt.merge({},i,{cell:t.id}),n):h.Point.isPoint(t)||null!=t.x&&null!=t.y?this.store.set(e,a.ObjectExt.merge({},i,{x:t.x,y:t.y}),n):this.store.set(e,a.ObjectExt.cloneDeep(t),n),this;}getSourcePoint(){return this.getTerminalPoint("source");}getTargetPoint(){return this.getTerminalPoint("target");}getTerminalPoint(e){let t=this[e];if(h.Point.isPointLike(t))return h.Point.create(t);let i=this.getTerminalCell(e);return i?i.getConnectionPoint(this,e):new h.Point;}getSourceCell(){return this.getTerminalCell("source");}getTargetCell(){return this.getTerminalCell("target");}getTerminalCell(e){if(this.model){let t="source"===e?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t);}return null;}getSourceNode(){return this.getTerminalNode("source");}getTargetNode(){return this.getTerminalNode("target");}getTerminalNode(e){let t=this,i={};for(;t&&t.isEdge();){if(i[t.id])return null;i[t.id]=!0,t=t.getTerminalCell(e);}return t&&t.isNode()?t:null;}get router(){return this.getRouter();}set router(e){null==e?this.removeRouter():this.setRouter(e);}getRouter(){return this.store.get("router");}setRouter(e,t,i){return"object"==typeof e?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},i),this;}removeRouter(e={}){return this.store.remove("router",e),this;}get connector(){return this.getConnector();}set connector(e){null==e?this.removeConnector():this.setConnector(e);}getConnector(){return this.store.get("connector");}setConnector(e,t,i){return"object"==typeof e?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},i),this;}removeConnector(e={}){return this.store.remove("connector",e);}getDefaultLabel(){let e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return a.ObjectExt.cloneDeep(t);}get labels(){return this.getLabels();}set labels(e){this.setLabels(e);}getLabels(){return[...this.store.get("labels",[])].map(e=>this.parseLabel(e));}setLabels(e,t={}){return this.store.set("labels",Array.isArray(e)?e:[e],t),this;}insertLabel(e,t,i={}){let n=this.getLabels(),r=n.length,s=null!=t&&Number.isFinite(t)?t:r;return s<0&&(s=r+s+1),n.splice(s,0,this.parseLabel(e)),this.setLabels(n,i);}appendLabel(e,t={}){return this.insertLabel(e,-1,t);}getLabelAt(e){let t=this.getLabels();return null!=e&&Number.isFinite(e)?this.parseLabel(t[e]):null;}setLabelAt(e,t,i={}){if(null!=e&&Number.isFinite(e)){let n=this.getLabels();n[e]=this.parseLabel(t),this.setLabels(n,i);}return this;}removeLabelAt(e,t={}){let i=this.getLabels(),n=null!=e&&Number.isFinite(e)?e:-1,r=i.splice(n,1);return this.setLabels(i,t),r.length?r[0]:null;}parseLabel(e){return"string"==typeof e?this.constructor.parseStringLabel(e):e;}onLabelsChanged({previous:e,current:t}){let i=e&&t?t.filter(t=>e.find(e=>t===e||a.ObjectExt.isEqual(t,e))?null:t):t?[...t]:[],n=e&&t?e.filter(e=>t.find(t=>e===t||a.ObjectExt.isEqual(e,t))?null:e):e?[...e]:[];i.length>0&&this.notify("labels:added",{added:i,cell:this,edge:this}),n.length>0&&this.notify("labels:removed",{removed:n,cell:this,edge:this});}get vertices(){return this.getVertices();}set vertices(e){this.setVertices(e);}getVertices(){return[...this.store.get("vertices",[])];}setVertices(e,t={}){let i=Array.isArray(e)?e:[e];return this.store.set("vertices",i.map(e=>h.Point.toJSON(e)),t),this;}insertVertex(e,t,i={}){let n=this.getVertices(),r=n.length,s=null!=t&&Number.isFinite(t)?t:r;return s<0&&(s=r+s+1),n.splice(s,0,h.Point.toJSON(e)),this.setVertices(n,i);}appendVertex(e,t={}){return this.insertVertex(e,-1,t);}getVertexAt(e){return null!=e&&Number.isFinite(e)?this.getVertices()[e]:null;}setVertexAt(e,t,i={}){if(null!=e&&Number.isFinite(e)){let n=this.getVertices();n[e]=t,this.setVertices(n,i);}return this;}removeVertexAt(e,t={}){let i=this.getVertices(),n=null!=e&&Number.isFinite(e)?e:-1;return i.splice(n,1),this.setVertices(i,t);}onVertexsChanged({previous:e,current:t}){let i=e&&t?t.filter(t=>e.find(e=>h.Point.equals(t,e))?null:t):t?[...t]:[],n=e&&t?e.filter(e=>t.find(t=>h.Point.equals(e,t))?null:e):e?[...e]:[];i.length>0&&this.notify("vertexs:added",{added:i,cell:this,edge:this}),n.length>0&&this.notify("vertexs:removed",{removed:n,cell:this,edge:this});}getDefaultMarkup(){return this.store.get("defaultMarkup")||u.Markup.getEdgeMarkup();}getMarkup(){return super.getMarkup()||this.getDefaultMarkup();}translate(e,t,i={}){return i.translateBy=i.translateBy||this.id,i.tx=e,i.ty=t,this.applyToPoints(i=>({x:(i.x||0)+e,y:(i.y||0)+t}),i);}scale(e,t,i,n={}){return this.applyToPoints(n=>h.Point.create(n).scale(e,t,i).toJSON(),n);}applyToPoints(e,t={}){let i={},n=this.getSource(),r=this.getTarget();h.Point.isPointLike(n)&&(i.source=e(n)),h.Point.isPointLike(r)&&(i.target=e(r));let s=this.getVertices();return s.length>0&&(i.vertices=s.map(e)),this.store.set(i,t),this;}getBBox(){return this.getPolyline().bbox();}getConnectionPoint(){return this.getPolyline().pointAt(.5);}getPolyline(){let e=[this.getSourcePoint(),...this.getVertices().map(e=>h.Point.create(e)),this.getTargetPoint()];return new h.Polyline(e);}updateParent(e){let t=null,i=this.getSourceCell(),n=this.getTargetCell(),r=this.getParent();return i&&n&&(t=i===n||i.isDescendantOf(n)?n:n.isDescendantOf(i)?i:d.Cell.getCommonAncestor(i,n)),r&&t&&t.id!==r.id&&r.unembed(this,e),t&&(!r||r.id!==t.id)&&t.embed(this,e),t;}hasLoop(e={}){let t=this.getSource(),i=this.getTarget(),n=t.cell,r=i.cell;if(!n||!r)return!1;let s=n===r;if(!s&&e.deep&&this._model){let t=this.getSourceCell(),i=this.getTargetCell();t&&i&&(s=t.isAncestorOf(i,e)||i.isAncestorOf(t,e));}return s;}getFragmentAncestor(){let e=[this,this.getSourceNode(),this.getTargetNode()].filter(e=>null!=e);return this.getCommonAncestor(...e);}isFragmentDescendantOf(e){let t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e));}}f.defaults={},(f||(f={})).equalTerminals=function(e,t){return e.cell===t.cell&&(e.port===t.port||null==e.port&&null==t.port);},(r=f||(f={})).defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},r.parseStringLabel=function(e){return{attrs:{label:{text:e}}};},(s=f||(f={})).toStringTag=`X6.${s.name}`,s.isEdge=function(e){if(null==e)return!1;if(e instanceof s)return!0;let t=e[Symbol.toStringTag];return(null==t||t===s.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr&&"function"==typeof e.disconnect&&"function"==typeof e.getSource&&"function"==typeof e.getTarget;},(o=f||(f={})).registry=c.Registry.create({type:"edge",process(e,t){if(g.ShareRegistry.exist(e,!1))throw Error(`Edge with name '${e}' was registered by anthor Node`);if("function"==typeof t)return t.config({shape:e}),t;let i=o,{inherit:n="edge"}=t,r=p(t,["inherit"]);if("string"==typeof n){let e=this.get(n||"edge");null==e&&n?this.onNotFound(n,"inherited"):i=e;}else i=n;null==r.constructorName&&(r.constructorName=e);let s=i.define.call(i,r);return s.config({shape:e}),s;}}),g.ShareRegistry.setEdgeRegistry(o.registry),l=f||(f={}),n=0,l.define=function(e){var t;let{constructorName:i,overwrite:r}=e,s=p(e,["constructorName","overwrite"]),o=a.ObjectExt.createClass((t=i||s.shape)?a.StringExt.pascalCase(t):(n+=1,`CustomEdge${n}`),this);return o.config(s),s.shape&&l.registry.register(s.shape,o,r),o;},l.create=function(e){let t=e.shape||"edge",i=l.registry.get(t);return i?new i(e):l.registry.onNotFound(t);},function(e){let t="basic.edge";e.config({shape:t,propHooks(t){let{label:i,vertices:n}=t,r=p(t,["label","vertices"]);if(i){null==r.labels&&(r.labels=[]);let t="string"==typeof i?e.parseStringLabel(i):i;r.labels.push(t);}return n&&Array.isArray(n)&&(r.vertices=n.map(e=>h.Point.create(e).toJSON())),r;}}),e.registry.register(t,e);}(f||(f={}));},"1287fb66":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{Collection:function(){return g;},Model:function(){return p;}});var n,r,s=i("d1751d7c"),o=s._(i("2ad4cd03"),t),l=s._(i("dd2b1c2b"),t),a=s._(i("10f1c36f"),t),h=i("b6be2189"),c=i("748e16f0"),u=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class g extends h.Basecoat{constructor(e,t={}){super(),this.length=0,this.comparator=t.comparator||"zIndex",this.clean(),e&&this.reset(e,{silent:!0});}toJSON(){return this.cells.map(e=>e.toJSON());}add(e,t,i){let n,r;"number"==typeof t?(n=t,r=Object.assign({merge:!1},i)):(n=this.length,r=Object.assign({merge:!1},t)),n>this.length&&(n=this.length),n<0&&(n+=this.length+1);let s=Array.isArray(e)?e:[e],o=this.comparator&&"number"!=typeof t&&!1!==r.sort,l=this.comparator||null,a=!1,h=[],c=[];return s.forEach(e=>{let t=this.get(e);t?r.merge&&!e.isSameStore(t)&&(t.setProp(e.getProp(),i),c.push(t),o&&!a&&(a=null==l||"function"==typeof l?t.hasChanged():"string"==typeof l?t.hasChanged(l):l.some(e=>t.hasChanged(e)))):(h.push(e),this.reference(e));}),h.length&&(o&&(a=!0),this.cells.splice(n,0,...h),this.length=this.cells.length),a&&this.sort({silent:!0}),!r.silent&&(h.forEach((e,t)=>{let i={cell:e,index:n+t,options:r};this.trigger("added",i),r.dryrun||e.notify("added",Object.assign({},i));}),a&&this.trigger("sorted"),(h.length||c.length)&&this.trigger("updated",{added:h,merged:c,removed:[],options:r})),this;}remove(e,t={}){let i=Array.isArray(e)?e:[e],n=this.removeCells(i,t);return!t.silent&&n.length>0&&this.trigger("updated",{options:t,removed:n,added:[],merged:[]}),Array.isArray(e)?n:n[0];}removeCells(e,t){let i=[];for(let n=0;n<e.length;n+=1){let r=this.get(e[n]);if(null==r)continue;let s=this.cells.indexOf(r);this.cells.splice(s,1),this.length-=1,delete this.map[r.id],i.push(r),this.unreference(r),t.dryrun||r.remove(),t.silent||(this.trigger("removed",{cell:r,index:s,options:t}),t.dryrun||r.notify("removed",{cell:r,index:s,options:t}));}return i;}reset(e,t={}){let i=this.cells.slice();if(i.forEach(e=>this.unreference(e)),this.clean(),this.add(e,Object.assign({silent:!0},t)),!t.silent){let e=this.cells.slice();this.trigger("reseted",{options:t,previous:i,current:e});let n=[],r=[];e.forEach(e=>{i.some(t=>t.id===e.id)||n.push(e);}),i.forEach(t=>{e.some(e=>e.id===t.id)||r.push(t);}),this.trigger("updated",{options:t,added:n,removed:r,merged:[]});}return this;}push(e,t){return this.add(e,this.length,t);}pop(e){let t=this.at(this.length-1);return this.remove(t,e);}unshift(e,t){return this.add(e,0,t);}shift(e){let t=this.at(0);return this.remove(t,e);}get(e){if(null==e)return null;let t="string"==typeof e||"number"==typeof e?e:e.id;return this.map[t]||null;}has(e){return null!=this.get(e);}at(e){return e<0&&(e+=this.length),this.cells[e]||null;}first(){return this.at(0);}last(){return this.at(-1);}indexOf(e){return this.cells.indexOf(e);}toArray(){return this.cells.slice();}sort(e={}){return null==this.comparator||(this.cells=h.ArrayExt.sortBy(this.cells,this.comparator),e.silent||this.trigger("sorted")),this;}clone(){return new this.constructor(this.cells.slice(),{comparator:this.comparator});}reference(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this);}unreference(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id];}notifyCellEvent(e,t){let i=t.cell;this.trigger(`cell:${e}`,t),i&&(i.isNode()?this.trigger(`node:${e}`,Object.assign(Object.assign({},t),{node:i})):i.isEdge()&&this.trigger(`edge:${e}`,Object.assign(Object.assign({},t),{edge:i})));}clean(){this.length=0,this.cells=[],this.map={};}dispose(){this.reset([]);}}u([g.dispose()],g.prototype,"dispose",null);var d=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class p extends h.Basecoat{get[Symbol.toStringTag](){return p.toStringTag;}constructor(e=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new g(e),this.setup();}notify(e,t){this.trigger(e,t);let i=this.graph;return i&&("sorted"===e||"reseted"===e||"updated"===e?i.trigger(`model:${e}`,t):i.trigger(e,t)),this;}setup(){let e=this.collection;e.on("sorted",()=>this.notify("sorted",null)),e.on("updated",e=>this.notify("updated",e)),e.on("cell:change:zIndex",()=>this.sortOnChangeZ()),e.on("added",({cell:e})=>{this.onCellAdded(e);}),e.on("removed",e=>{let t=e.cell;this.onCellRemoved(t,e.options),this.notify("cell:removed",e),t.isNode()?this.notify("node:removed",Object.assign(Object.assign({},e),{node:t})):t.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},e),{edge:t}));}),e.on("reseted",e=>{this.onReset(e.current),this.notify("reseted",e);}),e.on("edge:change:source",({edge:e})=>this.onEdgeTerminalChanged(e,"source")),e.on("edge:change:target",({edge:e})=>{this.onEdgeTerminalChanged(e,"target");});}sortOnChangeZ(){this.collection.sort();}onCellAdded(e){let t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0;}onCellRemoved(e,t){let i=e.id;if(e.isEdge()){delete this.edges[i];let t=e.getSource(),n=e.getTarget();if(t&&t.cell){let e=this.outgoings[t.cell],n=e?e.indexOf(i):-1;n>=0&&(e.splice(n,1),0===e.length&&delete this.outgoings[t.cell]);}if(n&&n.cell){let e=this.incomings[n.cell],t=e?e.indexOf(i):-1;t>=0&&(e.splice(t,1),0===e.length&&delete this.incomings[n.cell]);}}else delete this.nodes[i];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null);}onReset(e){this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach(e=>this.onCellAdded(e));}onEdgeTerminalChanged(e,t){let i="source"===t?this.outgoings:this.incomings,n=e.previous(t);if(n&&n.cell){let t=o.Cell.isCell(n.cell)?n.cell.id:n.cell,r=i[t],s=r?r.indexOf(e.id):-1;s>=0&&(r.splice(s,1),0===r.length&&delete i[t]);}let r=e.getTerminal(t);if(r&&r.cell){let t=o.Cell.isCell(r.cell)?r.cell.id:r.cell,n=i[t]||[];-1===n.indexOf(e.id)&&n.push(e.id),i[t]=n;}}prepareCell(e,t){return e.model||t&&t.dryrun||(e.model=this),null==e.zIndex&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e;}resetCells(e,t={}){return e.map(e=>this.prepareCell(e,Object.assign(Object.assign({},t),{dryrun:!0}))),this.collection.reset(e,t),e.map(e=>this.prepareCell(e,{options:t})),this;}clear(e={}){let t=this.getCells();if(0===t.length)return this;let i=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",()=>{let e=t.sort((e,t)=>(e.isEdge()?1:2)-(t.isEdge()?1:2));for(;e.length>0;){let t=e.shift();t&&t.remove(i);}},i),this;}addNode(e,t={}){let i=l.Node.isNode(e)?e:this.createNode(e);return this.addCell(i,t),i;}updateNode(e,t={}){let i=this.createNode(e),n=i.getProp();return i.dispose(),this.updateCell(n,t);}createNode(e){return l.Node.create(e);}addEdge(e,t={}){let i=a.Edge.isEdge(e)?e:this.createEdge(e);return this.addCell(i,t),i;}createEdge(e){return a.Edge.create(e);}updateEdge(e,t={}){let i=this.createEdge(e),n=i.getProp();return i.dispose(),this.updateCell(n,t);}addCell(e,t={}){return Array.isArray(e)?this.addCells(e,t):(this.collection.has(e)||this.addings.has(e)||(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,t),t),e.eachChild(e=>this.addCell(e,t)),this.addings.delete(e)),this);}addCells(e,t={}){let i=e.length;if(0===i)return this;let n=Object.assign(Object.assign({},t),{position:i-1,maxPosition:i-1});return this.startBatch("add",Object.assign(Object.assign({},n),{cells:e})),e.forEach(e=>{this.addCell(e,n),n.position-=1;}),this.stopBatch("add",Object.assign(Object.assign({},n),{cells:e})),this;}updateCell(e,t={}){let i=e.id&&this.getCell(e.id);return!!i&&this.batchUpdate("update",()=>(Object.entries(e).forEach(([e,n])=>i.setProp(e,n,t)),!0),e);}removeCell(e,t={}){let i="string"==typeof e?this.getCell(e):e;return i&&this.has(i)?this.collection.remove(i,t):null;}updateCellId(e,t){if(e.id===t)return;this.startBatch("update",{id:t}),e.prop("id",t);let i=e.clone({keepId:!0});return this.addCell(i),this.getConnectedEdges(e).forEach(i=>{let n=i.getSourceCell(),r=i.getTargetCell();n===e&&i.setSource(Object.assign(Object.assign({},i.getSource()),{cell:t})),r===e&&i.setTarget(Object.assign(Object.assign({},i.getTarget()),{cell:t}));}),this.removeCell(e),this.stopBatch("update",{id:t}),i;}removeCells(e,t={}){return e.length?this.batchUpdate("remove",()=>e.map(e=>this.removeCell(e,t))):[];}removeConnectedEdges(e,t={}){let i=this.getConnectedEdges(e);return i.forEach(e=>{e.remove(t);}),i;}disconnectConnectedEdges(e,t={}){let i="string"==typeof e?e:e.id;this.getConnectedEdges(e).forEach(e=>{let n=e.getSourceCellId(),r=e.getTargetCellId();n===i&&e.setSource({x:0,y:0},t),r===i&&e.setTarget({x:0,y:0},t);});}has(e){return this.collection.has(e);}total(){return this.collection.length;}indexOf(e){return this.collection.indexOf(e);}getCell(e){return this.collection.get(e);}getCells(){return this.collection.toArray();}getFirstCell(){return this.collection.first();}getLastCell(){return this.collection.last();}getMinZIndex(){let e=this.collection.first();return e&&e.getZIndex()||0;}getMaxZIndex(){let e=this.collection.last();return e&&e.getZIndex()||0;}getCellsFromCache(e){return e?Object.keys(e).map(e=>this.getCell(e)).filter(e=>null!=e):[];}getNodes(){return this.getCellsFromCache(this.nodes);}getEdges(){return this.getCellsFromCache(this.edges);}getOutgoingEdges(e){let t="string"==typeof e?e:e.id,i=this.outgoings[t];return i?i.map(e=>this.getCell(e)).filter(e=>e&&e.isEdge()):null;}getIncomingEdges(e){let t="string"==typeof e?e:e.id,i=this.incomings[t];return i?i.map(e=>this.getCell(e)).filter(e=>e&&e.isEdge()):null;}getConnectedEdges(e,t={}){let i=[],n="string"==typeof e?this.getCell(e):e;if(null==n)return i;let r={},s=t.indirect,o=t.incoming,l=t.outgoing;null==o&&null==l&&(o=l=!0);let a=(e,t)=>{let n=t?this.getOutgoingEdges(e):this.getIncomingEdges(e);if(null!=n&&n.forEach(e=>{!r[e.id]&&(i.push(e),r[e.id]=!0,s&&(o&&a(e,!1),l&&a(e,!0)));}),s&&e.isEdge()){let n=t?e.getTargetCell():e.getSourceCell();n&&n.isEdge()&&!r[n.id]&&(i.push(n),a(n,t));}};if(l&&a(n,!0),o&&a(n,!1),t.deep){let e=n.getDescendants({deep:!0}),s={};e.forEach(e=>{e.isNode()&&(s[e.id]=!0);});let a=(e,n)=>{let o=n?this.getOutgoingEdges(e.id):this.getIncomingEdges(e.id);null!=o&&o.forEach(e=>{if(!r[e.id]){let n=e.getSourceCell(),o=e.getTargetCell();!t.enclosed&&n&&s[n.id]&&o&&s[o.id]||(i.push(e),r[e.id]=!0);}});};e.forEach(e=>{!e.isEdge()&&(l&&a(e,!0),o&&a(e,!1));});}return i;}isBoundary(e,t){let i="string"==typeof e?this.getCell(e):e,n=t?this.getIncomingEdges(i):this.getOutgoingEdges(i);return null==n||0===n.length;}getBoundaryNodes(e){let t=[];return Object.keys(this.nodes).forEach(i=>{if(this.isBoundary(i,e)){let e=this.getCell(i);e&&t.push(e);}}),t;}getRoots(){return this.getBoundaryNodes(!0);}getLeafs(){return this.getBoundaryNodes(!1);}isRoot(e){return this.isBoundary(e,!0);}isLeaf(e){return this.isBoundary(e,!1);}getNeighbors(e,t={}){let i=t.incoming,n=t.outgoing;null==i&&null==n&&(i=n=!0);let r=this.getConnectedEdges(e,t).reduce((r,s)=>{let o=s.hasLoop(t),l=s.getSourceCell(),a=s.getTargetCell();return i&&l&&l.isNode()&&!r[l.id]&&(o||l!==e&&(!t.deep||!l.isDescendantOf(e)))&&(r[l.id]=l),n&&a&&a.isNode()&&!r[a.id]&&(o||a!==e&&(!t.deep||!a.isDescendantOf(e)))&&(r[a.id]=a),r;},{});if(e.isEdge()){if(i){let t=e.getSourceCell();t&&t.isNode()&&!r[t.id]&&(r[t.id]=t);}if(n){let t=e.getTargetCell();t&&t.isNode()&&!r[t.id]&&(r[t.id]=t);}}return Object.keys(r).map(e=>r[e]);}isNeighbor(e,t,i={}){let n=i.incoming,r=i.outgoing;return null==n&&null==r&&(n=r=!0),this.getConnectedEdges(e,i).some(e=>{let i=e.getSourceCell(),s=e.getTargetCell();return!!n&&!!i&&i.id===t.id||!!r&&!!s&&s.id===t.id;});}getSuccessors(e,t={}){let i=[];return this.search(e,(n,r)=>{n!==e&&this.matchDistance(r,t.distance)&&i.push(n);},Object.assign(Object.assign({},t),{outgoing:!0})),i;}isSuccessor(e,t,i={}){let n=!1;return this.search(e,(r,s)=>{if(r===t&&r!==e&&this.matchDistance(s,i.distance))return n=!0,!1;},Object.assign(Object.assign({},i),{outgoing:!0})),n;}getPredecessors(e,t={}){let i=[];return this.search(e,(n,r)=>{n!==e&&this.matchDistance(r,t.distance)&&i.push(n);},Object.assign(Object.assign({},t),{incoming:!0})),i;}isPredecessor(e,t,i={}){let n=!1;return this.search(e,(r,s)=>{if(r===t&&r!==e&&this.matchDistance(s,i.distance))return n=!0,!1;},Object.assign(Object.assign({},i),{incoming:!0})),n;}matchDistance(e,t){return null==t||("function"==typeof t?t(e):!!(Array.isArray(t)&&t.includes(e))||e===t);}getCommonAncestor(...e){let t=[];return e.forEach(e=>{e&&(Array.isArray(e)?t.push(...e):t.push(e));}),o.Cell.getCommonAncestor(...t);}getSubGraph(e,t={}){let i=[],n={},r=[],s=[],o=e=>{!n[e.id]&&(i.push(e),n[e.id]=e,e.isEdge()&&s.push(e),e.isNode()&&r.push(e));};return e.forEach(e=>{o(e),t.deep&&e.getDescendants({deep:!0}).forEach(e=>o(e));}),s.forEach(e=>{let t=e.getSourceCell(),s=e.getTargetCell();t&&!n[t.id]&&(i.push(t),n[t.id]=t,t.isNode()&&r.push(t)),s&&!n[s.id]&&(i.push(s),n[s.id]=s,s.isNode()&&r.push(s));}),r.forEach(e=>{this.getConnectedEdges(e,t).forEach(e=>{let t=e.getSourceCell(),r=e.getTargetCell();!n[e.id]&&t&&n[t.id]&&r&&n[r.id]&&(i.push(e),n[e.id]=e);});}),i;}cloneSubGraph(e,t={}){let i=this.getSubGraph(e,t);return this.cloneCells(i);}cloneCells(e){return o.Cell.cloneCells(e);}getNodesFromPoint(e,t){let i="number"==typeof e?{x:e,y:t||0}:e;return this.getNodes().filter(e=>e.getBBox().containsPoint(i));}getNodesInArea(e,t,i,n,r){let s="number"==typeof e?new c.Rectangle(e,t,i,n):c.Rectangle.create(e),o="number"==typeof e?r:t,l=o&&o.strict;return this.getNodes().filter(e=>{let t=e.getBBox();return l?s.containsRect(t):s.isIntersectWithRect(t);});}getEdgesInArea(e,t,i,n,r){let s="number"==typeof e?new c.Rectangle(e,t,i,n):c.Rectangle.create(e),o="number"==typeof e?r:t,l=o&&o.strict;return this.getEdges().filter(e=>{let t=e.getBBox();return 0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),l?s.containsRect(t):s.isIntersectWithRect(t);});}getNodesUnderNode(e,t={}){let i=e.getBBox();return(null==t.by||"bbox"===t.by?this.getNodesInArea(i):this.getNodesFromPoint(i[t.by])).filter(t=>e.id!==t.id&&!t.isDescendantOf(e));}getAllCellsBBox(){return this.getCellsBBox(this.getCells());}getCellsBBox(e,t={}){return o.Cell.getCellsBBox(e,t);}search(e,t,i={}){i.breadthFirst?this.breadthFirstSearch(e,t,i):this.depthFirstSearch(e,t,i);}breadthFirstSearch(e,t,i={}){let n=[],r={},s={};for(n.push(e),s[e.id]=0;n.length>0;){let e=n.shift();null!=e&&!r[e.id]&&(r[e.id]=!0,!1!==h.FunctionExt.call(t,this,e,s[e.id])&&this.getNeighbors(e,i).forEach(t=>{s[t.id]=s[e.id]+1,n.push(t);}));}}depthFirstSearch(e,t,i={}){let n=[],r={},s={};for(n.push(e),s[e.id]=0;n.length>0;){let e=n.pop();if(null==e||r[e.id]||(r[e.id]=!0,!1===h.FunctionExt.call(t,this,e,s[e.id])))continue;let o=this.getNeighbors(e,i),l=n.length;o.forEach(t=>{s[t.id]=s[e.id]+1,n.splice(l,0,t);});}}getShortestPath(e,t,i={}){let n={};this.getEdges().forEach(e=>{let t=e.getSourceCellId(),r=e.getTargetCellId();t&&r&&(n[t]||(n[t]=[]),n[r]||(n[r]=[]),n[t].push(r),i.directed||n[r].push(t));});let r="string"==typeof e?e:e.id,s=h.Dijkstra.run(n,r,i.weight),o=[],l="string"==typeof t?t:t.id;for(s[l]&&o.push(l);l=s[l];)o.unshift(l);return o;}translate(e,t,i){return this.getCells().filter(e=>!e.hasParent()).forEach(n=>n.translate(e,t,i)),this;}resize(e,t,i){return this.resizeCells(e,t,this.getCells(),i);}resizeCells(e,t,i,n={}){let r=this.getCellsBBox(i);if(r){let s=Math.max(e/r.width,0),o=Math.max(t/r.height,0),l=r.getOrigin();i.forEach(e=>e.scale(s,o,l,n));}return this;}toJSON(e={}){return p.toJSON(this.getCells(),e);}parseJSON(e){return p.fromJSON(e);}fromJSON(e,t={}){let i=this.parseJSON(e);return this.resetCells(i,t),this;}startBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this;}stopBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this;}batchUpdate(e,t,i={}){this.startBatch(e,i);let n=t();return this.stopBatch(e,i),n;}hasActiveBatch(e=Object.keys(this.batches)){return(Array.isArray(e)?e:[e]).some(e=>this.batches[e]>0);}dispose(){this.collection.dispose();}}d([p.dispose()],p.prototype,"dispose",null),(n=p||(p={})).toStringTag=`X6.${n.name}`,n.isModel=function(e){if(null==e)return!1;if(e instanceof n)return!0;let t=e[Symbol.toStringTag];return(null==t||t===n.toStringTag)&&"function"==typeof e.addNode&&"function"==typeof e.addEdge&&null!=e.collection;},(r=p||(p={})).toJSON=function(e,t={}){return{cells:e.map(e=>e.toJSON(t))};},r.fromJSON=function(e){let t=[];return Array.isArray(e)?t.push(...e):(e.cells&&t.push(...e.cells),e.nodes&&e.nodes.forEach(e=>{null==e.shape&&(e.shape="rect"),t.push(e);}),e.edges&&e.edges.forEach(e=>{null==e.shape&&(e.shape="edge"),t.push(e);})),t.map(e=>{let t=e.shape;if(t){if(l.Node.registry.exist(t))return l.Node.create(e);if(a.Edge.registry.exist(t))return a.Edge.create(e);}throw Error("The `shape` should be specified when creating a node/edge instance");});};},"160b8d0d":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{CSSManager:function(){return a;}});var n=i("b6be2189"),r=i("0f725314");let s=`.x6-graph {
  position: relative;
  overflow: hidden;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;var o=i("a43747d2"),l=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class a extends o.Base{init(){r.Config.autoInsertCSS&&n.CssLoader.ensure("core",s);}dispose(){n.CssLoader.clean("core");}}l([a.dispose()],a.prototype,"dispose",null);},"18b9d6dc":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Poly",{enumerable:!0,get:function(){return l;}});var n=i("748e16f0"),r=i("b6be2189"),s=i("c540a28c"),o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class l extends s.Base{get points(){return this.getPoints();}set points(e){this.setPoints(e);}getPoints(){return this.getAttrByPath("body/refPoints");}setPoints(e,t){return null==e?this.removePoints():this.setAttrByPath("body/refPoints",l.pointsToString(e),t),this;}removePoints(){return this.removeAttrByPath("body/refPoints"),this;}}!function(e){function t(e){return"string"==typeof e?e:e.map(e=>Array.isArray(e)?e.join(","):n.Point.isPointLike(e)?`${e.x}, ${e.y}`:"").join(" ");}e.pointsToString=t,e.config({propHooks(e){let{points:i}=e,n=o(e,["points"]);if(i){let e=t(i);e&&r.ObjectExt.setByPath(n,"attrs/body/refPoints",e);}return n;}});}(l||(l={}));},"1c5398ce":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"PanningManager",{enumerable:!0,get:function(){return o;}});var n=i("b6be2189"),r=i("a43747d2"),s=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class o extends r.Base{get widgetOptions(){return this.options.panning;}get pannable(){return this.widgetOptions&&!0===this.widgetOptions.enabled;}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName();}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),n.Dom.Event.on(this.graph.container,"mousedown",this.onRightMouseDown),n.Dom.Event.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new n.Dom.MouseWheelHandle(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable();}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),n.Dom.Event.off(this.graph.container,"mousedown",this.onRightMouseDown),n.Dom.Event.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable();}allowPanning(e,t){return e.spaceKey=this.isSpaceKeyPressed,this.pannable&&n.ModifierKey.isMatch(e,this.widgetOptions.modifiers,t);}startPanning(e){let t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),n.Dom.Event.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),n.Dom.Event.on(window,"mouseup.panning",this.stopPanning.bind(this));}pan(e){let t=this.view.normalizeEvent(e),i=t.clientX-this.clientX,n=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(i,n);}stopPanning(e){this.panning=!1,this.updateClassName(),n.Dom.Event.off(document.body,".panning"),n.Dom.Event.off(window,".panning");}updateClassName(){let e=this.view.container,t=this.view.prefixClassName("graph-panning"),i=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(n.Dom.addClass(e,t),n.Dom.removeClass(e,i)):(n.Dom.removeClass(e,t),n.Dom.addClass(e,i)):(n.Dom.removeClass(e,t),n.Dom.removeClass(e,i));}onMouseDown({e}){if(!this.allowBlankMouseDown(e))return;let t=this.graph.getPlugin("selection"),i=t&&t.allowRubberband(e,!0);(this.allowPanning(e,!0)||this.allowPanning(e)&&!i)&&this.startPanning(e);}onRightMouseDown(e){let t=this.widgetOptions.eventTypes;(null==t?void 0:t.includes("rightMouseDown"))&&2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e);}onMouseWheel(e,t,i){this.graph.translateBy(-t,-i);}onSpaceKeyDown(e){32===e.which&&(this.isSpaceKeyPressed=!0);}onSpaceKeyUp(e){32===e.which&&(this.isSpaceKeyPressed=!1);}allowBlankMouseDown(e){let t=this.widgetOptions.eventTypes;return(null==t?void 0:t.includes("leftMouseDown"))&&0===e.button||(null==t?void 0:t.includes("mouseWheelDown"))&&1===e.button;}allowMouseWheel(e){var t;return this.pannable&&!e.ctrlKey&&(null===(t=this.widgetOptions.eventTypes)||void 0===t?void 0:t.includes("mouseWheel"));}autoPanning(e,t){let i=this.graph.getGraphArea(),n=0,r=0;e<=i.left+10&&(n=-10),t<=i.top+10&&(r=-10),e>=i.right-10&&(n=10),t>=i.bottom-10&&(r=10),(0!==n||0!==r)&&this.graph.translateBy(-n,-r);}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName());}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName());}dispose(){this.stopListening();}}s([r.Base.dispose()],o.prototype,"dispose",null);},"1db70876":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{closest:function(){return h;},length:function(){return r;},orth:function(){return c;},ratio:function(){return n;}});let n=function(e,t,i,n){let r=null!=n.ratio?n.ratio:.5;return r>1&&(r/=100),e.getPointAtRatio(r);},r=function(e,t,i,n){let r=null!=n.length?n.length:20;return e.getPointAtLength(r);};var s=i("748e16f0"),o=i("b6be2189"),l=i("a87448e5");let a=function(e,t,i,n){let r=e.getClosestPoint(i);return null!=r?r:new s.Point;},h=(0,l.resolve)(a),c=(0,l.resolve)(function(e,t,i,n){let r=e.getConnection(),h=e.getConnectionSubdivisions(),c=new s.Line(i.clone().translate(0,1e6),i.clone().translate(0,-1e6)),u=new s.Line(i.clone().translate(1e6,0),i.clone().translate(-1e6,0)),g=c.intersect(r,{segmentSubdivisions:h}),d=u.intersect(r,{segmentSubdivisions:h}),p=[];return(g&&p.push(...g),d&&p.push(...d),p.length>0)?i.closest(p):null!=n.fallbackAt?(0,l.getPointAtEdge)(e,n.fallbackAt):o.FunctionExt.call(a,this,e,t,i,n);});},"2ad4cd03":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{Cell:function(){return d;}});var n,r,s=i("b6be2189"),o=i("748e16f0"),l=i("534efe08"),a=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class h extends s.Basecoat{constructor(e={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(s.ObjectExt.cloneDeep(e)),this.changed={};}mutate(e,t={}){let i=!0===t.unset,n=!0===t.silent,r=[],o=this.changing;this.changing=!0,o||(this.previous=s.ObjectExt.cloneDeep(this.data),this.changed={});let l=this.data,a=this.previous,h=this.changed;if(Object.keys(e).forEach(t=>{let n=e[t];s.ObjectExt.isEqual(l[t],n)||r.push(t),s.ObjectExt.isEqual(a[t],n)?delete h[t]:h[t]=n,i?delete l[t]:l[t]=n;}),!n&&r.length>0&&(this.pending=!0,this.pendingOptions=t,r.forEach(e=>{this.emit("change:*",{key:e,options:t,store:this,current:l[e],previous:a[e]});})),o)return this;if(!n)for(;this.pending;)this.pending=!1,this.emit("changed",{current:l,previous:a,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this;}get(e,t){if(null==e)return this.data;let i=this.data[e];return null==i?t:i;}getPrevious(e){if(this.previous){let t=this.previous[e];return null==t?void 0:t;}}set(e,t,i){return null!=e&&("object"==typeof e?this.mutate(e,t):this.mutate({[e]:t},i)),this;}remove(e,t){let i;let n=void 0,r={};if("string"==typeof e)r[e]=n,i=t;else if(Array.isArray(e))e.forEach(e=>r[e]=n),i=t;else{for(let e in this.data)r[e]=n;i=e;}return this.mutate(r,Object.assign(Object.assign({},i),{unset:!0})),this;}getByPath(e){return s.ObjectExt.getByPath(this.data,e,"/");}setByPath(e,t,i={}){let n=Array.isArray(e)?[...e]:e.split("/"),r=Array.isArray(e)?e.join("/"):e,o=n[0],l=n.length;if(i.propertyPath=r,i.propertyValue=t,i.propertyPathArray=n,1===l)this.set(o,t,i);else{let r={},a=r,h=o;for(let e=1;e<l;e+=1){let t=n[e],i=Number.isFinite(Number(t));a=a[h]=i?[]:{},h=t;}s.ObjectExt.setByPath(r,n,t,"/");let c=s.ObjectExt.cloneDeep(this.data);i.rewrite&&s.ObjectExt.unsetByPath(c,e,"/");let u=s.ObjectExt.merge(c,r);this.set(o,u[o],i);}return this;}removeByPath(e,t){let i=Array.isArray(e)?e:e.split("/"),n=i[0];if(1===i.length)this.remove(n,t);else{let e=i.slice(1),r=s.ObjectExt.cloneDeep(this.get(n));r&&s.ObjectExt.unsetByPath(r,e),this.set(n,r,t);}return this;}hasChanged(e){return null==e?Object.keys(this.changed).length>0:e in this.changed;}getChanges(e){let t;if(null==e)return this.hasChanged()?s.ObjectExt.cloneDeep(this.changed):null;let i=this.changing?this.previous:this.data,n={};for(let r in e){let o=e[r];s.ObjectExt.isEqual(i[r],o)||(n[r]=o,t=!0);}return t?s.ObjectExt.cloneDeep(n):null;}toJSON(){return s.ObjectExt.cloneDeep(this.data);}clone(){return new this.constructor(this.data);}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this});}}a([s.Basecoat.dispose()],h.prototype,"dispose",null);class c{constructor(e){this.cell=e,this.ids={},this.cache={};}get(){return Object.keys(this.ids);}start(e,t,i={},n="/"){let r=this.cell.getPropByPath(e),o=s.ObjectExt.defaults(i,c.defaultOptions),l=this.getTiming(o.timing),a=this.getInterp(o.interp,r,t),h=0,u=Array.isArray(e)?e.join(n):e,g=Array.isArray(e)?e:e.split(n),d=()=>{let e=new Date().getTime();0===h&&(h=e);let t=(e-h)/o.duration;t<1?this.ids[u]=requestAnimationFrame(d):t=1;let n=a(l(t));this.cell.setPropByPath(g,n),i.progress&&i.progress(Object.assign({progress:t,currentValue:n},this.getArgs(u))),1===t&&(this.cell.notify("transition:complete",this.getArgs(u)),i.complete&&i.complete(this.getArgs(u)),this.cell.notify("transition:finish",this.getArgs(u)),i.finish&&i.finish(this.getArgs(u)),this.clean(u));};return setTimeout(()=>{this.stop(e,void 0,n),this.cache[u]={startValue:r,targetValue:t,options:o},this.ids[u]=requestAnimationFrame(d),this.cell.notify("transition:start",this.getArgs(u)),i.start&&i.start(this.getArgs(u));},i.delay),this.stop.bind(this,e,n,i);}stop(e,t={},i="/"){let n=Array.isArray(e)?e:e.split(i);return Object.keys(this.ids).filter(e=>s.ObjectExt.isEqual(n,e.split(i).slice(0,n.length))).forEach(e=>{cancelAnimationFrame(this.ids[e]);let i=this.cache[e],n=this.getArgs(e),r=Object.assign(Object.assign({},i.options),t),s=r.jumpedToEnd;s&&null!=i.targetValue&&(this.cell.setPropByPath(e,i.targetValue),this.cell.notify("transition:end",Object.assign({},n)),this.cell.notify("transition:complete",Object.assign({},n)),r.complete&&r.complete(Object.assign({},n)));let o=Object.assign({jumpedToEnd:s},n);this.cell.notify("transition:stop",Object.assign({},o)),r.stop&&r.stop(Object.assign({},o)),this.cell.notify("transition:finish",Object.assign({},n)),r.finish&&r.finish(Object.assign({},n)),this.clean(e);}),this;}clean(e){delete this.ids[e],delete this.cache[e];}getTiming(e){return"string"==typeof e?s.Timing[e]:e;}getInterp(e,t,i){return e?e(t,i):"number"==typeof i?s.Interp.number(t,i):"string"==typeof i?"#"===i[0]?s.Interp.color(t,i):s.Interp.unit(t,i):s.Interp.object(t,i);}getArgs(e){let t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell};}}(c||(c={})).defaultOptions={delay:10,duration:100,timing:"linear"};var u=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;},g=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class d extends s.Basecoat{static config(e){let{markup:t,propHooks:i,attrHooks:n}=e,r=g(e,["markup","propHooks","attrHooks"]);null!=t&&(this.markup=t),i&&(this.propHooks=this.propHooks.slice(),Array.isArray(i)?this.propHooks.push(...i):"function"==typeof i?this.propHooks.push(i):Object.values(i).forEach(e=>{"function"==typeof e&&this.propHooks.push(e);})),n&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),n)),this.defaults=s.ObjectExt.merge({},this.defaults,r);}static getMarkup(){return this.markup;}static getDefaults(e){return e?this.defaults:s.ObjectExt.cloneDeep(this.defaults);}static getAttrHooks(){return this.attrHooks;}static applyPropHooks(e,t){return this.propHooks.reduce((t,i)=>i?s.FunctionExt.call(i,e,t):t,t);}get[Symbol.toStringTag](){return d.toStringTag;}constructor(e={}){super();let t=this.constructor.getDefaults(!0),i=s.ObjectExt.merge({},this.preprocess(t),this.preprocess(e));this.id=i.id||s.StringExt.uuid(),this.store=new h(i),this.animation=new c(this),this.setup(),this.init(),this.postprocess(e);}init(){}get model(){return this._model;}set model(e){this._model!==e&&(this._model=e);}preprocess(e,t){let i=e.id,n=this.constructor.applyPropHooks(this,e);return null==i&&!0!==t&&(n.id=s.StringExt.uuid()),n;}postprocess(e){}setup(){this.store.on("change:*",e=>{let{key:t,current:i,previous:n,options:r}=e;this.notify("change:*",{key:t,options:r,current:i,previous:n,cell:this}),this.notify(`change:${t}`,{options:r,current:i,previous:n,cell:this}),("source"===t||"target"===t)&&this.notify("change:terminal",{type:t,current:i,previous:n,options:r,cell:this});}),this.store.on("changed",({options:e})=>this.notify("changed",{options:e,cell:this}));}notify(e,t){this.trigger(e,t);let i=this.model;return i&&(i.notify(`cell:${e}`,t),this.isNode()?i.notify(`node:${e}`,Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&i.notify(`edge:${e}`,Object.assign(Object.assign({},t),{edge:this}))),this;}isNode(){return!1;}isEdge(){return!1;}isSameStore(e){return this.store===e.store;}get view(){return this.store.get("view");}get shape(){return this.store.get("shape","");}getProp(e,t){return null==e?this.store.get():this.store.get(e,t);}setProp(e,t,i){if("string"==typeof e)this.store.set(e,t,i);else{let i=this.preprocess(e,!0);this.store.set(s.ObjectExt.merge({},this.getProp(),i),t),this.postprocess(e);}return this;}removeProp(e,t){return"string"==typeof e||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this;}hasChanged(e){return null==e?this.store.hasChanged():this.store.hasChanged(e);}getPropByPath(e){return this.store.getByPath(e);}setPropByPath(e,t,i={}){return this.model&&("children"===e?this._children=t?t.map(e=>this.model.getCell(e)).filter(e=>null!=e):null:"parent"===e&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,i),this;}removePropByPath(e,t={}){let i=Array.isArray(e)?e:e.split("/");return"attrs"===i[0]&&(t.dirty=!0),this.store.removeByPath(i,t),this;}prop(e,t,i){return null==e?this.getProp():"string"==typeof e||Array.isArray(e)?1==arguments.length?this.getPropByPath(e):null==t?this.removePropByPath(e,i||{}):this.setPropByPath(e,t,i||{}):this.setProp(e,t||{});}previous(e){return this.store.getPrevious(e);}get zIndex(){return this.getZIndex();}set zIndex(e){null==e?this.removeZIndex():this.setZIndex(e);}getZIndex(){return this.store.get("zIndex");}setZIndex(e,t={}){return this.store.set("zIndex",e,t),this;}removeZIndex(e={}){return this.store.remove("zIndex",e),this;}toFront(e={}){let t=this.model;if(t){let i,n=t.getMaxZIndex();e.deep?(i=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):i=[this],n=n-i.length+1;let r=t.total(),s=t.indexOf(this)!==r-i.length;s||(s=i.some((e,t)=>e.getZIndex()!==n+t)),s&&this.batchUpdate("to-front",()=>{n+=i.length,i.forEach((t,i)=>{t.setZIndex(n+i,e);});});}return this;}toBack(e={}){let t=this.model;if(t){let i,n=t.getMinZIndex();e.deep?(i=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):i=[this];let r=0!==t.indexOf(this);r||(r=i.some((e,t)=>e.getZIndex()!==n+t)),r&&this.batchUpdate("to-back",()=>{n-=i.length,i.forEach((t,i)=>{t.setZIndex(n+i,e);});});}return this;}get markup(){return this.getMarkup();}set markup(e){null==e?this.removeMarkup():this.setMarkup(e);}getMarkup(){let e=this.store.get("markup");return null==e&&(e=this.constructor.getMarkup()),e;}setMarkup(e,t={}){return this.store.set("markup",e,t),this;}removeMarkup(e={}){return this.store.remove("markup",e),this;}get attrs(){return this.getAttrs();}set attrs(e){null==e?this.removeAttrs():this.setAttrs(e);}getAttrs(){let e=this.store.get("attrs");return e?Object.assign({},e):{};}setAttrs(e,t={}){if(null==e)this.removeAttrs(t);else{let i=e=>this.store.set("attrs",e,t);if(!0===t.overwrite)i(e);else{let n=this.getAttrs();i(!1===t.deep?Object.assign(Object.assign({},n),e):s.ObjectExt.merge({},n,e));}}return this;}replaceAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}));}updateAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}));}removeAttrs(e={}){return this.store.remove("attrs",e),this;}getAttrDefinition(e){if(!e)return null;let t=this.constructor.getAttrHooks()||{},i=t[e]||l.Attr.registry.get(e);if(!i){let n=s.StringExt.camelCase(e);i=t[n]||l.Attr.registry.get(n);}return i||null;}getAttrByPath(e){return null==e||""===e?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e));}setAttrByPath(e,t,i={}){return this.setPropByPath(this.prefixAttrPath(e),t,i),this;}removeAttrByPath(e,t={}){return this.removePropByPath(this.prefixAttrPath(e),t),this;}prefixAttrPath(e){return Array.isArray(e)?["attrs"].concat(e):`attrs/${e}`;}attr(e,t,i){return null==e?this.getAttrByPath():"string"==typeof e||Array.isArray(e)?1==arguments.length?this.getAttrByPath(e):null==t?this.removeAttrByPath(e,i||{}):this.setAttrByPath(e,t,i||{}):this.setAttrs(e,t||{});}get visible(){return this.isVisible();}set visible(e){this.setVisible(e);}setVisible(e,t={}){return this.store.set("visible",e,t),this;}isVisible(){return!1!==this.store.get("visible");}show(e={}){return this.isVisible()||this.setVisible(!0,e),this;}hide(e={}){return this.isVisible()&&this.setVisible(!1,e),this;}toggleVisible(e,t={}){let i="boolean"==typeof e?e:!this.isVisible(),n="boolean"==typeof e?t:e;return i?this.show(n):this.hide(n),this;}get data(){return this.getData();}set data(e){this.setData(e);}getData(){return this.store.get("data");}setData(e,t={}){if(null==e)this.removeData(t);else{let i=e=>this.store.set("data",e,t);if(!0===t.overwrite)i(e);else{let n=this.getData();i(!1===t.deep?"object"==typeof e?Object.assign(Object.assign({},n),e):e:s.ObjectExt.merge({},n,e));}}return this;}replaceData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}));}updateData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}));}removeData(e={}){return this.store.remove("data",e),this;}get parent(){return this.getParent();}get children(){return this.getChildren();}getParentId(){return this.store.get("parent");}getParent(){let e=this.getParentId();if(e&&this.model){let t=this.model.getCell(e);return this._parent=t,t;}return null;}getChildren(){let e=this.store.get("children");if(e&&e.length&&this.model){let t=e.map(e=>{var t;return null===(t=this.model)||void 0===t?void 0:t.getCell(e);}).filter(e=>null!=e);return this._children=t,[...t];}return null;}hasParent(){return null!=this.parent;}isParentOf(e){return null!=e&&e.getParent()===this;}isChildOf(e){return null!=e&&this.getParent()===e;}eachChild(e,t){return this.children&&this.children.forEach(e,t),this;}filterChild(e,t){return this.children?this.children.filter(e,t):[];}getChildCount(){return null==this.children?0:this.children.length;}getChildIndex(e){return null==this.children?-1:this.children.indexOf(e);}getChildAt(e){return null!=this.children&&e>=0?this.children[e]:null;}getAncestors(e={}){let t=[],i=this.getParent();for(;i;)t.push(i),i=!1!==e.deep?i.getParent():null;return t;}getDescendants(e={}){if(!1!==e.deep){if(e.breadthFirst){let e=[],t=this.getChildren()||[];for(;t.length>0;){let i=t.shift(),n=i.getChildren();e.push(i),n&&t.push(...n);}return e;}{let t=this.getChildren()||[];return t.forEach(i=>{t.push(...i.getDescendants(e));}),t;}}return this.getChildren()||[];}isDescendantOf(e,t={}){if(null==e)return!1;if(!1!==t.deep){let t=this.getParent();for(;t;){if(t===e)return!0;t=t.getParent();}return!1;}return this.isChildOf(e);}isAncestorOf(e,t={}){return null!=e&&e.isDescendantOf(this,t);}contains(e){return this.isAncestorOf(e);}getCommonAncestor(...e){return d.getCommonAncestor(this,...e);}setParent(e,t={}){return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this;}setChildren(e,t={}){return this._children=e,null!=e?this.store.set("children",e.map(e=>e.id),t):this.store.remove("children",t),this;}unembed(e,t={}){let i=this.children;if(null!=i&&null!=e){let n=this.getChildIndex(e);-1!==n&&(i.splice(n,1),e.setParent(null,t),this.setChildren(i,t));}return this;}embed(e,t={}){return e.addTo(this,t),this;}addTo(e,t={}){return d.isCell(e)?e.addChild(this,t):e.addCell(this,t),this;}insertTo(e,t,i={}){return e.insertChild(this,t,i),this;}addChild(e,t={}){return this.insertChild(e,void 0,t);}insertChild(e,t,i={}){if(null!=e&&e!==this){let n=e.getParent(),r=this!==n,s=t;if(null!=s||(s=this.getChildCount(),r||(s-=1)),n){let t=n.getChildren();if(t){let r=t.indexOf(e);r>=0&&(e.setParent(null,i),t.splice(r,1),n.setChildren(t,i));}}let o=this.children;if(null==o?(o=[]).push(e):o.splice(s,0,e),e.setParent(this,i),this.setChildren(o,i),r&&this.model){let e=this.model.getIncomingEdges(this),t=this.model.getOutgoingEdges(this);e&&e.forEach(e=>e.updateParent(i)),t&&t.forEach(e=>e.updateParent(i));}this.model&&this.model.addCell(e,i);}return this;}removeFromParent(e={}){let t=this.getParent();if(null!=t){let i=t.getChildIndex(this);t.removeChildAt(i,e);}return this;}removeChild(e,t={}){let i=this.getChildIndex(e);return this.removeChildAt(i,t);}removeChildAt(e,t={}){let i=this.getChildAt(e);return null!=this.children&&null!=i&&(this.unembed(i,t),i.remove(t)),i;}remove(e={}){return this.batchUpdate("remove",()=>{let t=this.getParent();t&&t.removeChild(this,e),!1!==e.deep&&this.eachChild(t=>t.remove(e)),this.model&&this.model.removeCell(this,e);}),this;}transition(e,t,i={},n="/"){return this.animation.start(e,t,i,n);}stopTransition(e,t,i="/"){return this.animation.stop(e,t,i),this;}getTransitions(){return this.animation.get();}translate(e,t,i){return this;}scale(e,t,i,n){return this;}addTools(e,t,i){let n=Array.isArray(e)?e:[e],r="string"==typeof t?t:null,o="object"==typeof t?t:"object"==typeof i?i:{};if(o.reset)return this.setTools({name:r,items:n,local:o.local},o);let l=s.ObjectExt.cloneDeep(this.getTools());if(null==l||null==r||l.name===r)return null==l&&(l={}),l.items||(l.items=[]),l.name=r,l.items=[...l.items,...n],this.setTools(Object.assign({},l),o);}setTools(e,t={}){return null==e?this.removeTools():this.store.set("tools",d.normalizeTools(e),t),this;}getTools(){return this.store.get("tools");}removeTools(e={}){return this.store.remove("tools",e),this;}hasTools(e){let t=this.getTools();return null!=t&&(null==e||t.name===e);}hasTool(e){let t=this.getTools();return null!=t&&t.items.some(t=>"string"==typeof t?t===e:t.name===e);}removeTool(e,t={}){let i=s.ObjectExt.cloneDeep(this.getTools());if(i){let n=!1,r=i.items.slice(),s=e=>{r.splice(e,1),n=!0;};if("number"==typeof e)s(e);else for(let t=r.length-1;t>=0;t-=1){let i=r[t];("string"==typeof i?i===e:i.name===e)&&s(t);}n&&(i.items=r,this.setTools(i,t));}return this;}getBBox(e){return new o.Rectangle;}getConnectionPoint(e,t){return new o.Point;}toJSON(e={}){let t=Object.assign({},this.store.get()),i=Object.prototype.toString,n=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!t.shape){let e=this.constructor;throw Error(`Unable to serialize ${n} missing "shape" prop, check the ${n} "${e.name||i.call(e)}"`);}let r=this.constructor,o=!0===e.diff,l=t.attrs||{},a=r.getDefaults(!0),h=o?this.preprocess(a,!0):a,c=h.attrs||{},u={};Object.entries(t).forEach(([e,r])=>{if(null!=r&&!Array.isArray(r)&&"object"==typeof r&&!s.ObjectExt.isPlainObject(r))throw Error(`Can only serialize ${n} with plain-object props, but got a "${i.call(r)}" type of key "${e}" on ${n} "${this.id}"`);if("attrs"!==e&&"shape"!==e&&o){let i=h[e];s.ObjectExt.isEqual(r,i)&&delete t[e];}}),Object.keys(l).forEach(e=>{let t=l[e],i=c[e];Object.keys(t).forEach(n=>{let r=t[n],o=i?i[n]:null;null==r||"object"!=typeof r||Array.isArray(r)?null!=i&&s.ObjectExt.isEqual(o,r)||(null==u[e]&&(u[e]={}),u[e][n]=r):Object.keys(r).forEach(t=>{let l=r[t];null!=i&&null!=o&&s.ObjectExt.isObject(o)&&s.ObjectExt.isEqual(o[t],l)||(null==u[e]&&(u[e]={}),null==u[e][n]&&(u[e][n]={}),u[e][n][t]=l);});});});let g=Object.assign(Object.assign({},t),{attrs:s.ObjectExt.isEmpty(u)?void 0:u});return null==g.attrs&&delete g.attrs,0===g.angle&&delete g.angle,s.ObjectExt.cloneDeep(g);}clone(e={}){if(!e.deep){let t=Object.assign({},this.store.get());return e.keepId||delete t.id,delete t.parent,delete t.children,new this.constructor(t);}return d.deepClone(this)[this.id];}findView(e){return e.findViewByCell(this);}startBatch(e,t={},i=this.model){return this.notify("batch:start",{name:e,data:t,cell:this}),i&&i.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this;}stopBatch(e,t={},i=this.model){return i&&i.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this;}batchUpdate(e,t,i){let n=this.model;this.startBatch(e,i,n);let r=t();return this.stopBatch(e,i,n),r;}dispose(){this.removeFromParent(),this.store.dispose();}}d.defaults={},d.attrHooks={},d.propHooks=[],u([s.Basecoat.dispose()],d.prototype,"dispose",null),(d||(d={})).normalizeTools=function(e){return"string"==typeof e?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]};},(n=d||(d={})).toStringTag=`X6.${n.name}`,n.isCell=function(e){if(null==e)return!1;if(e instanceof n)return!0;let t=e[Symbol.toStringTag];return(null==t||t===n.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr;},(r=d||(d={})).getCommonAncestor=function(...e){let t=e.filter(e=>null!=e).map(e=>e.getAncestors()).sort((e,t)=>e.length-t.length);return t.shift().find(e=>t.every(t=>t.includes(e)))||null;},r.getCellsBBox=function(e,t={}){let i=null;for(let n=0,r=e.length;n<r;n+=1){let r=e[n],s=r.getBBox(t);if(s){if(r.isNode()){let e=r.getAngle();null!=e&&0!==e&&(s=s.bbox(e));}i=null==i?s:i.union(s);}}return i;},r.deepClone=function(e){let t=[e,...e.getDescendants({deep:!0})];return r.cloneCells(t);},r.cloneCells=function(e){let t=s.ArrayExt.uniq(e),i=t.reduce((e,t)=>(e[t.id]=t.clone(),e),{});return t.forEach(e=>{let t=i[e.id];if(t.isEdge()){let e=t.getSourceCellId(),n=t.getTargetCellId();e&&i[e]&&t.setSource(Object.assign(Object.assign({},t.getSource()),{cell:i[e].id})),n&&i[n]&&t.setTarget(Object.assign(Object.assign({},t.getTarget()),{cell:i[n].id}));}let n=e.getParent();n&&i[n.id]&&t.setParent(i[n.id]);let r=e.getChildren();if(r&&r.length){let e=r.reduce((e,t)=>(i[t.id]&&e.push(i[t.id]),e),[]);e.length>0&&t.setChildren(e);}}),i;},function(e){e.config({propHooks(t){var{tools:i}=t,n=g(t,["tools"]);return i&&(n.tools=e.normalizeTools(i)),n;}});}(d||(d={}));},"2b9e5a9c":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"MouseWheel",{enumerable:!0,get:function(){return o;}});var n=i("b6be2189"),r=i("a43747d2"),s=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class o extends r.Base{constructor(){super(...arguments),this.cumulatedFactor=1;}get widgetOptions(){return this.options.mousewheel;}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new n.Dom.MouseWheelHandle(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0);}get disabled(){return!0!==this.widgetOptions.enabled;}enable(e){(this.disabled||e)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable());}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable());}allowMouseWheel(e){let t=this.widgetOptions.guard;return(null==t||t(e))&&n.ModifierKey.isMatch(e,this.widgetOptions.modifiers);}onMouseWheel(e){let t=this.widgetOptions.guard;if((null==t||t(e))&&n.ModifierKey.isMatch(e,this.widgetOptions.modifiers)){let t=this.widgetOptions.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*t*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/t)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);let i=this.currentScale,r=this.graph.transform.clampScale(i*this.cumulatedFactor),s=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,o=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if((r=n.NumberExt.clamp(r,s,o))!==i){if(this.widgetOptions.zoomAtMousePosition){let e=this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(r,{absolute:!0,center:e.clone()});}else this.graph.zoom(r,{absolute:!0});}this.currentScale=null,this.cumulatedFactor=1;}}dispose(){this.disable();}}s([n.Disposable.dispose()],o.prototype,"dispose",null);},"3125c334":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Marker",{enumerable:!0,get:function(){return r;}});var n,r,s=i("852bbaa9"),o=i("4e89343a"),l=s._(i("94abb92f")),a=i("5e6ef018");(n=r||(r={})).presets=l,n.registry=o.Registry.create({type:"marker"}),n.registry.register(n.presets,!0),(r||(r={})).normalize=a.normalize;},"3141582d":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Polyline",{enumerable:!0,get:function(){return r;}});var n=i("18b9d6dc");let r=(0,i("a74a56d7").createShape)("polyline",{},{parent:n.Poly});},"379d6a39":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{anchor:function(){return u;},bbox:function(){return o;},boundary:function(){return c;},rect:function(){return a;}});var n=i("748e16f0");function r(e,t,i){let r;if("object"==typeof i){if(Number.isFinite(i.y)){let{start:r,end:s}=new n.Line(t,e).parallel(i.y);t=r,e=s;}r=i.x;}else r=i;if(null==r||!Number.isFinite(r))return e;let s=e.distance(t);return 0===r&&s>0?e:e.move(t,-Math.min(r,s-1));}function s(e){let t=e.getAttribute("stroke-width");return null===t?0:parseFloat(t)||0;}let o=function(e,t,i,n){let o=t.getBBoxOfElement(i);n.stroked&&o.inflate(s(i)/2);let l=e.intersect(o);return r(l&&l.length?e.start.closest(l):e.end,e.start,n.offset);};var l=i("b6be2189");let a=function(e,t,i,n,a){let h=t.cell,c=h.isNode()?h.getAngle():0;if(0===c)return l.FunctionExt.call(o,this,e,t,i,n,a);let u=t.getUnrotatedBBoxOfElement(i);n.stroked&&u.inflate(s(i)/2);let g=u.getCenter(),d=e.clone().rotate(c,g),p=d.setLength(1e6).intersect(u);return r(p&&p.length?d.start.closest(p).rotate(-c,g):e.end,e.start,n.offset);};var h=i("e46b1882");let c=function(e,t,i,o){let a,c,u;let g=e.end,d=o.selector;if(a="string"==typeof d?t.findOne(d):Array.isArray(d)?l.ObjectExt.getByPath(i,d):function(e){if(null==e)return null;let t=e;do{let e=t.tagName;if("string"!=typeof e)return null;if("G"===(e=e.toUpperCase()))t=t.firstElementChild;else if("TITLE"===e)t=t.nextElementSibling;else break;}while(t)return t;}(i),!l.Dom.isSVGGraphicsElement(a)){if(a===i||!l.Dom.isSVGGraphicsElement(i))return g;a=i;}let p=t.getShapeOfElement(a),f=t.getMatrixOfElement(a),m=t.getRootTranslatedMatrix(),b=t.getRootRotatedMatrix(),y=m.multiply(b).multiply(f),v=y.inverse(),x=h.Util.transformLine(e,v),w=x.start.clone(),P=t.getDataOfElement(a);if(!1===o.insideout){null==P.shapeBBox&&(P.shapeBBox=p.bbox());let e=P.shapeBBox;if(null!=e&&e.containsPoint(w))return g;}if(!0===o.extrapolate&&x.setLength(1e6),n.Path.isPath(p)){let e=o.precision||2;null==P.segmentSubdivisions&&(P.segmentSubdivisions=p.getSegmentSubdivisions({precision:e})),u={precision:e,segmentSubdivisions:P.segmentSubdivisions},c=x.intersect(p,u);}else c=x.intersect(p);c?Array.isArray(c)&&(c=w.closest(c)):!0===o.sticky&&(c=n.Rectangle.isRectangle(p)?p.getNearestPointToPoint(w):n.Ellipse.isEllipse(p)?p.intersectsWithLineFromCenterToPoint(w):p.closestPoint(w,u));let E=c?h.Util.transformPoint(c,y):g,C=o.offset||0;return!1!==o.stroked&&("object"==typeof C?(null==(C=Object.assign({},C)).x&&(C.x=0),C.x+=s(a)/2):C+=s(a)/2),r(E,e.start,C);},u=function(e,t,i,n){let{alignOffset:s,align:o}=n;return o&&function(e,t,i=0){let n,r,s,o;let{start:l,end:a}=e;switch(t){case"left":o="x",n=a,r=l,s=-1;break;case"right":o="x",n=l,r=a,s=1;break;case"top":o="y",n=a,r=l,s=-1;break;case"bottom":o="y",n=l,r=a,s=1;break;default:return;}l[o]<a[o]?n[o]=r[o]:r[o]=n[o],Number.isFinite(i)&&(n[o]+=s*i,r[o]+=s*i);}(e,o,s),r(e.end,e.start,n.offset);};},"3a2f3ab3":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"NodeView",{enumerable:!0,get:function(){return c;}});var n,r=i("b6be2189"),s=i("748e16f0"),o=i("0f725314"),l=i("2ad4cd03"),a=i("93479dcf"),h=i("62fc6309");class c extends a.CellView{constructor(){super(...arguments),this.portsCache={};}get[Symbol.toStringTag](){return c.toStringTag;}getContainerClassName(){let e=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ");}updateClassName(e){let t=e.target;if(t.hasAttribute("magnet")){let e=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?r.Dom.removeClass(t,e):r.Dom.addClass(t,e);}else{let e=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(e):this.addClass(e);}}isNodeView(){return!0;}confirmUpdate(e,t={}){let i=e;return this.hasAction(i,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","resize","translate","rotate","ports","tools"])):(i=this.handleAction(i,"resize",()=>this.resize(),"update"),i=this.handleAction(i,"update",()=>this.update(),o.Config.useCSSSelector?"ports":null),i=this.handleAction(i,"translate",()=>this.translate()),i=this.handleAction(i,"rotate",()=>this.rotate()),i=this.handleAction(i,"ports",()=>this.renderPorts()),i=this.handleAction(i,"tools",()=>{this.getFlag("tools")===e?this.renderTools():this.updateTools(t);})),i;}update(e){this.cleanCache(),o.Config.useCSSSelector&&this.removePorts();let t=this.cell,i=t.getSize(),n=t.getAttrs();this.updateAttrs(this.container,n,{attrs:e===n?null:e,rootBBox:new s.Rectangle(0,0,i.width,i.height),selectors:this.selectors}),o.Config.useCSSSelector&&this.renderPorts();}renderMarkup(){let e=this.cell.markup;if(e){if("string"==typeof e)throw TypeError("Not support string markup.");return this.renderJSONMarkup(e);}throw TypeError("Invalid node markup.");}renderJSONMarkup(e){let t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.appendChild(t.fragment);}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),o.Config.useCSSSelector||this.renderPorts(),this.renderTools(),this;}resize(){this.cell.getAngle()&&this.rotate(),this.update();}translate(){this.updateTransform();}rotate(){this.updateTransform();}getTranslationString(){let e=this.cell.getPosition();return`translate(${e.x},${e.y})`;}getRotationString(){let e=this.cell.getAngle();if(e){let t=this.cell.getSize();return`rotate(${e},${t.width/2},${t.height/2})`;}}updateTransform(){let e=this.getTranslationString(),t=this.getRotationString();t&&(e+=` ${t}`),this.container.setAttribute("transform",e);}findPortElem(e,t){let i=e?this.portsCache[e]:null;if(!i)return null;let n=i.portContentElement,r=i.portContentSelectors||{};return this.findOne(t,n,r);}cleanPortsCache(){this.portsCache={};}removePorts(){Object.values(this.portsCache).forEach(e=>{r.Dom.remove(e.portElement);});}renderPorts(){let e=this.container,t=[];e.childNodes.forEach(e=>{t.push(e);});let i=this.cell.getParsedPorts(),n=r.ArrayExt.groupBy(i,"zIndex"),s="auto";n[s]&&n[s].forEach(i=>{let n=this.getPortElement(i);e.append(n),t.push(n);}),Object.keys(n).forEach(e=>{if(e!==s){let i=parseInt(e,10);this.appendPorts(n[e],i,t);}}),this.updatePorts();}appendPorts(e,t,i){let n=e.map(e=>this.getPortElement(e));i[t]||t<0?r.Dom.before(i[Math.max(t,0)],n):r.Dom.append(this.container,n);}getPortElement(e){let t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e);}createPortElement(e){let t,i,n=h.Markup.renderMarkup(this.cell.getPortContainerMarkup()),s=n.elem;if(null==s)throw Error("Invalid port container markup.");let o=(n=h.Markup.renderMarkup(this.getPortMarkup(e))).elem,l=n.selectors;if(null==o)throw Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},o);let a="x6-port";e.group&&(a+=` x6-port-${e.group}`),r.Dom.addClass(s,a),r.Dom.addClass(s,"x6-port"),r.Dom.addClass(o,"x6-port-body"),s.appendChild(o);let c=l;if(this.existPortLabel(e)){if(t=(n=h.Markup.renderMarkup(this.getPortLabelMarkup(e.label))).elem,i=n.selectors,null==t)throw Error("Invalid port label markup.");if(l&&i){for(let e in i)if(l[e]&&e!==this.rootSelector)throw Error("Selectors within port must be unique.");c=Object.assign(Object.assign({},l),i);}r.Dom.addClass(t,"x6-port-label"),s.appendChild(t);}return this.portsCache[e.id]={portElement:s,portSelectors:c,portLabelElement:t,portLabelSelectors:i,portContentElement:o,portContentSelectors:l},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:e,node:this.cell,container:s,selectors:c,labelContainer:t,labelSelectors:i,contentContainer:o,contentSelectors:l}),s;}updatePorts(){let e=Object.keys(this.cell.getParsedGroups());0===e.length?this.updatePortGroup():e.forEach(e=>this.updatePortGroup(e));}updatePortGroup(e){let t=s.Rectangle.fromSize(this.cell.getSize()),i=this.cell.getPortsLayoutByGroup(e,t);for(let e=0,t=i.length;e<t;e+=1){let t=i[e],n=t.portId,r=this.portsCache[n]||{},o=t.portLayout;if(this.applyPortTransform(r.portElement,o),null!=t.portAttrs){let e={selectors:r.portSelectors||{}};t.portSize&&(e.rootBBox=s.Rectangle.fromSize(t.portSize)),this.updateAttrs(r.portElement,t.portAttrs,e);}let l=t.labelLayout;if(l&&r.portLabelElement&&(this.applyPortTransform(r.portLabelElement,l,-(o.angle||0)),l.attrs)){let e={selectors:r.portLabelSelectors||{}};t.labelSize&&(e.rootBBox=s.Rectangle.fromSize(t.labelSize)),this.updateAttrs(r.portLabelElement,l.attrs,e);}}}applyPortTransform(e,t,i=0){let n=t.angle,s=t.position,o=r.Dom.createSVGMatrix().rotate(i).translate(s.x||0,s.y||0).rotate(n||0);r.Dom.transform(e,o,{absolute:!0});}getPortMarkup(e){return e.markup||this.cell.portMarkup;}getPortLabelMarkup(e){return e.markup||this.cell.portLabelMarkup;}existPortLabel(e){return e.attrs&&e.attrs.text;}getEventArgs(e,t,i){let n=this.cell;return null==t||null==i?{e,view:this,node:n,cell:n}:{e,x:t,y:i,view:this,node:n,cell:n};}getPortEventArgs(e,t,i){let n=this.cell;return i?{e,x:i.x,y:i.y,view:this,node:n,cell:n,port:t}:{e,view:this,node:n,cell:n,port:t};}notifyMouseDown(e,t,i){super.onMouseDown(e,t,i),this.notify("node:mousedown",this.getEventArgs(e,t,i));}notifyMouseMove(e,t,i){super.onMouseMove(e,t,i),this.notify("node:mousemove",this.getEventArgs(e,t,i));}notifyMouseUp(e,t,i){super.onMouseUp(e,t,i),this.notify("node:mouseup",this.getEventArgs(e,t,i));}notifyPortEvent(e,t,i){let n=this.findAttr("port",t.target);if(n){let r=t.type;"node:port:mouseenter"===e?t.type="mouseenter":"node:port:mouseleave"===e&&(t.type="mouseleave"),this.notify(e,this.getPortEventArgs(t,n,i)),t.type=r;}}onClick(e,t,i){super.onClick(e,t,i),this.notify("node:click",this.getEventArgs(e,t,i)),this.notifyPortEvent("node:port:click",e,{x:t,y:i});}onDblClick(e,t,i){super.onDblClick(e,t,i),this.notify("node:dblclick",this.getEventArgs(e,t,i)),this.notifyPortEvent("node:port:dblclick",e,{x:t,y:i});}onContextMenu(e,t,i){super.onContextMenu(e,t,i),this.notify("node:contextmenu",this.getEventArgs(e,t,i)),this.notifyPortEvent("node:port:contextmenu",e,{x:t,y:i});}onMouseDown(e,t,i){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,i),this.notifyPortEvent("node:port:mousedown",e,{x:t,y:i}),this.startNodeDragging(e,t,i));}onMouseMove(e,t,i){let n=this.getEventData(e),r=n.action;if("magnet"===r)this.dragMagnet(e,t,i);else{if("move"===r){let r=n.targetView||this;r.dragNode(e,t,i),r.notify("node:moving",{e,x:t,y:i,view:r,cell:r.cell,node:r.cell});}this.notifyMouseMove(e,t,i),this.notifyPortEvent("node:port:mousemove",e,{x:t,y:i});}this.setEventData(e,n);}onMouseUp(e,t,i){let n=this.getEventData(e),r=n.action;"magnet"===r?this.stopMagnetDragging(e,t,i):(this.notifyMouseUp(e,t,i),this.notifyPortEvent("node:port:mouseup",e,{x:t,y:i}),"move"===r&&(n.targetView||this).stopNodeDragging(e,t,i));let s=n.targetMagnet;s&&this.onMagnetClick(e,s,t,i),this.checkMouseleave(e);}onMouseOver(e){super.onMouseOver(e),this.notify("node:mouseover",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseenter",e),this.notifyPortEvent("node:port:mouseover",e);}onMouseOut(e){super.onMouseOut(e),this.notify("node:mouseout",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseleave",e),this.notifyPortEvent("node:port:mouseout",e);}onMouseEnter(e){this.updateClassName(e),super.onMouseEnter(e),this.notify("node:mouseenter",this.getEventArgs(e));}onMouseLeave(e){super.onMouseLeave(e),this.notify("node:mouseleave",this.getEventArgs(e));}onMouseWheel(e,t,i,n){super.onMouseWheel(e,t,i,n),this.notify("node:mousewheel",Object.assign({delta:n},this.getEventArgs(e,t,i)));}onMagnetClick(e,t,i,n){let r=this.graph;r.view.getMouseMovedCount(e)>r.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,i,n)));}onMagnetDblClick(e,t,i,n){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,i,n)));}onMagnetContextMenu(e,t,i,n){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,i,n)));}onMagnetMouseDown(e,t,i,n){this.startMagnetDragging(e,i,n);}onCustomEvent(e,t,i,n){this.notify("node:customevent",Object.assign({name:t},this.getEventArgs(e,i,n))),super.onCustomEvent(e,t,i,n);}prepareEmbedding(e){let t=this.graph,i=this.getEventData(e).cell||this.cell,n=t.findViewByCell(i),r=t.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e,node:i,view:n,cell:i,x:r.x,y:r.y,currentParent:i.getParent()});}processEmbedding(e,t){let i=t.cell||this.cell,n=t.graph||this.graph,s=n.options.embedding,o=s.findParent,a="function"==typeof o?r.FunctionExt.call(o,n,{view:this,node:this.cell}).filter(e=>l.Cell.isCell(e)&&this.cell.id!==e.id&&!e.isDescendantOf(this.cell)):n.model.getNodesUnderNode(i,{by:o});if(s.frontOnly&&a.length>0){let e=r.ArrayExt.groupBy(a,"zIndex"),t=r.ArrayExt.max(Object.keys(e).map(e=>parseInt(e,10)));t&&(a=e[t]);}a=a.filter(e=>e.visible);let h=null,c=t.candidateEmbedView,u=s.validate;for(let e=a.length-1;e>=0;e-=1){let t=a[e];if(c&&c.cell.id===t.id){h=c;break;}{let e=t.findView(n);if(u&&r.FunctionExt.call(u,n,{child:this.cell,parent:e.cell,childView:this,parentView:e})){h=e;break;}}}this.clearEmbedding(t),h&&h.highlight(null,{type:"embedding"}),t.candidateEmbedView=h;let g=n.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e,cell:i,node:i,view:n.findViewByCell(i),x:g.x,y:g.y,currentParent:i.getParent(),candidateParent:h?h.cell:null});}clearEmbedding(e){let t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null);}finalizeEmbedding(e,t){this.graph.startBatch("embedding");let i=t.cell||this.cell,n=t.graph||this.graph,r=n.findViewByCell(i),s=i.getParent(),o=t.candidateEmbedView;if(o?(o.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,(null==s||s.id!==o.cell.id)&&o.cell.insertChild(i,void 0,{ui:!0})):s&&s.unembed(i,{ui:!0}),n.model.getConnectedEdges(i,{deep:!0}).forEach(e=>{e.updateParent({ui:!0});}),r&&o){let t=n.snapToGrid(e.clientX,e.clientY);r.notify("node:embedded",{e,cell:i,x:t.x,y:t.y,node:i,view:n.findViewByCell(i),previousParent:s,currentParent:i.getParent()});}this.graph.stopBatch("embedding");}getDelegatedView(){let e=this.cell,t=this;for(;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.findViewByCell(e);}return null;}validateMagnet(e,t,i){if("passive"!==t.getAttribute("magnet")){let n=this.graph.options.connecting.validateMagnet;return!n||r.FunctionExt.call(n,this.graph,{e:i,magnet:t,view:e,cell:e.cell});}return!1;}startMagnetDragging(e,t,i){if(!this.can("magnetConnectable"))return;e.stopPropagation();let n=e.currentTarget,r=this.graph;this.setEventData(e,{targetMagnet:n}),this.validateMagnet(this,n,e)?(r.options.magnetThreshold<=0&&this.startConnectting(e,n,t,i),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,t,i),r.view.delegateDragEvents(e,this);}startConnectting(e,t,i,n){this.graph.model.startBatch("add-edge");let r=this.createEdgeFromMagnet(t,i,n);r.setEventData(e,r.prepareArrowheadDragging("target",{x:i,y:n,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:r}),r.notifyMouseDown(e,i,n);}getDefaultEdge(e,t){let i;let n=this.graph.options.connecting.createEdge;return n&&(i=r.FunctionExt.call(n,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),i;}createEdgeFromMagnet(e,t,i){let n=this.graph,r=n.model,s=this.getDefaultEdge(this,e);return s.setSource(Object.assign(Object.assign({},s.getSource()),this.getEdgeTerminal(e,t,i,s,"source"))),s.setTarget(Object.assign(Object.assign({},s.getTarget()),{x:t,y:i})),s.addTo(r,{async:!1,ui:!0}),s.findView(n);}dragMagnet(e,t,i){let n=this.getEventData(e),r=n.edgeView;if(r)r.onMouseMove(e,t,i),this.autoScrollGraph(e.clientX,e.clientY);else{let r=this.graph,s=r.options.magnetThreshold,o=this.getEventTarget(e),l=n.targetMagnet;if("onleave"===s){if(l===o||l.contains(o))return;}else if(r.view.getMouseMovedCount(e)<=s)return;this.startConnectting(e,l,t,i);}}stopMagnetDragging(e,t,i){let n=this.eventData(e).edgeView;n&&(n.onMouseUp(e,t,i),this.graph.model.stopBatch("add-edge"));}notifyUnhandledMouseDown(e,t,i){this.notify("node:unhandled:mousedown",{e,x:t,y:i,view:this,cell:this.cell,node:this.cell});}notifyNodeMove(e,t,i,n,r){let s=[r],o=this.graph.getPlugin("selection");if(o&&o.isSelectionMovable()){let e=o.getSelectedCells();e.includes(r)&&(s=e.filter(e=>e.isNode()));}s.forEach(r=>{this.notify(e,{e:t,x:i,y:n,cell:r,node:r,view:r.findView(this.graph)});});}getRestrictArea(e){let t=this.graph.options.translating.restrict,i="function"==typeof t?r.FunctionExt.call(t,this.graph,e):t;return"number"==typeof i?this.graph.transform.getGraphArea().inflate(i):!0===i?this.graph.transform.getGraphArea():i||null;}startNodeDragging(e,t,i){let n=this.getDelegatedView();if(null==n||!n.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,i);this.setEventData(e,{targetView:n,action:"move"});let r=s.Point.create(n.cell.getPosition());n.setEventData(e,{moving:!1,offset:r.diff(t,i),restrict:this.getRestrictArea(n)});}dragNode(e,t,i){let n=this.cell,r=this.graph,o=r.getGridSize(),l=this.getEventData(e),a=l.offset,h=l.restrict;l.moving||(l.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,i,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);let c=s.GeometryUtil.snapToGrid(t+a.x,o),u=s.GeometryUtil.snapToGrid(i+a.y,o);n.setPosition(c,u,{restrict:h,deep:!0,ui:!0}),r.options.embedding.enabled&&(l.embedding||(this.prepareEmbedding(e),l.embedding=!0),this.processEmbedding(e,l));}stopNodeDragging(e,t,i){let n=this.getEventData(e);n.embedding&&this.finalizeEmbedding(e,n),n.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,i,this.cell)),n.moving=!1,n.embedding=!1;}autoScrollGraph(e,t){let i=this.graph.getPlugin("scroller");i&&i.autoScroll(e,t);}}(n=c||(c={})).toStringTag=`X6.${n.name}`,n.isNodeView=function(e){if(null==e)return!1;if(e instanceof n)return!0;let t=e[Symbol.toStringTag];return(null==t||t===n.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate&&"function"==typeof e.update&&"function"==typeof e.findPortElem&&"function"==typeof e.resize&&"function"==typeof e.rotate&&"function"==typeof e.translate;},c.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),c.registry.register("node",c,!0);},"3bc4ba1c":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0});var n=i("d1751d7c");i("f10991e6"),i("534efe08"),n._(i("1287fb66"),t),n._(i("ca3299f3"),t),n._(i("4b2061e3"),t),n._(i("e46b1882"),t),n._(i("b6be2189"),t),n._(i("748e16f0"),t);},"3e9a29ef":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"BackgroundManager",{enumerable:!0,get:function(){return a;}});var n=i("b6be2189"),r=i("748e16f0"),s=i("534efe08"),o=i("a43747d2"),l=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class a extends o.Base{get elem(){return this.view.background;}init(){this.startListening(),this.options.background&&this.draw(this.options.background);}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this);}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this);}updateBackgroundImage(e={}){let t=e.size||"auto auto",i=e.position||"center",n=this.graph.transform.getScale(),s=this.graph.translate();if("object"==typeof i){let e=s.tx+n.sx*(i.x||0),t=s.ty+n.sy*(i.y||0);i=`${e}px ${t}px`;}"object"==typeof t&&(t=r.Rectangle.fromSize(t).scale(n.sx,n.sy),t=`${t.width}px ${t.height}px`),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=i;}drawBackgroundImage(e,t={}){let i;if(!(e instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return;}let r=this.optionsCache;if(r&&r.image!==t.image)return;let o=t.opacity,l=t.size,a=t.repeat||"no-repeat",h=s.Background.registry.get(a);if("function"==typeof h){let n=t.quality||1;e.width*=n,e.height*=n;let r=h(e,t);if(!(r instanceof HTMLCanvasElement))throw Error("Background pattern must return an HTML Canvas instance");i=r.toDataURL("image/png"),a=t.repeat&&a!==t.repeat?t.repeat:"repeat","object"==typeof l?(l.width*=r.width/e.width,l.height*=r.height/e.height):void 0===l&&(t.size={width:r.width/n,height:r.height/n});}else i=e.src,void 0===l&&(t.size={width:e.width,height:e.height});null!=r&&"object"==typeof t.size&&t.image===r.image&&t.repeat===r.repeat&&t.quality===r.quality&&(r.size=n.ObjectExt.clone(t.size));let c=this.elem.style;c.backgroundImage=`url(${i})`,c.backgroundRepeat=a,c.opacity=null==o||o>=1?"":`${o}`,this.updateBackgroundImage(t);}updateBackgroundColor(e){this.elem.style.backgroundColor=e||"";}updateBackgroundOptions(e){this.graph.options.background=e;}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache);}draw(e){let t=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(t.color),t.image){this.optionsCache=n.ObjectExt.clone(t);let i=document.createElement("img");i.onload=()=>this.drawBackgroundImage(i,e),i.setAttribute("crossorigin","anonymous"),i.src=t.image;}else this.drawBackgroundImage(null),this.optionsCache=null;}clear(){this.draw();}dispose(){this.clear(),this.stopListening();}}l([o.Base.dispose()],a.prototype,"dispose",null);},"3ea7afbe":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Circle",{enumerable:!0,get:function(){return n;}});let n=(0,i("a74a56d7").createShape)("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});},"3eaf6b35":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{defaults:function(){return s;},resolve:function(){return o;},resolveOptions:function(){return l;}});var n=i("b6be2189"),r=i("748e16f0");let s={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return o(this.step,this);},directions(){let e=o(this.step,this),t=o(this.cost,this);return[{cost:t,offsetX:e,offsetY:0},{cost:t,offsetX:-e,offsetY:0},{cost:t,offsetX:0,offsetY:e},{cost:t,offsetX:0,offsetY:-e}];},penalties(){let e=o(this.step,this);return{0:0,45:e/2,90:e/2};},paddingBox(){let e=o(this.step,this);return{x:-e,y:-e,width:2*e,height:2*e};},fallbackRouter:i("f8b16900").orth,draggingRouter:null,snapToGrid:!0};function o(e,t){return"function"==typeof e?e.call(t):e;}function l(e){let t=Object.keys(e).reduce((t,i)=>("fallbackRouter"===i||"draggingRouter"===i||"fallbackRoute"===i?t[i]=e[i]:t[i]=o(e[i],e),t),{});if(t.padding){let e=n.NumberExt.normalizeSides(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom};}return t.directions.forEach(e=>{let t=new r.Point(0,0),i=new r.Point(e.offsetX,e.offsetY);e.angle=r.Angle.normalize(t.theta(i));}),t;}},"43bcb3fd":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"ToolsView",{enumerable:!0,get:function(){return h;}});var n,r=i("b6be2189"),s=i("ec3adf98"),o=i("1037de1b"),l=i("93479dcf"),a=i("62fc6309");class h extends o.View{get name(){return this.options.name;}get graph(){return this.cellView.graph;}get cell(){return this.cellView.cell;}get[Symbol.toStringTag](){return h.toStringTag;}constructor(e={}){super(),this.svgContainer=this.createContainer(!0,e),this.htmlContainer=this.createContainer(!1,e),this.config(e);}createContainer(e,t){let i=e?o.View.createElement("g",!0):o.View.createElement("div",!1);return r.Dom.addClass(i,this.prefixClassName("cell-tools")),t.className&&r.Dom.addClass(i,t.className),i;}config(e){if(this.options=Object.assign(Object.assign({},this.options),e),!l.CellView.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(r.Dom.addClass(this.svgContainer,this.prefixClassName("edge-tools")),r.Dom.addClass(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(r.Dom.addClass(this.svgContainer,this.prefixClassName("node-tools")),r.Dom.addClass(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));let t=this.options.items;if(!Array.isArray(t))return this;this.tools=[];let i=[];t.forEach(e=>{h.ToolItem.isToolItem(e)?"vertices"===e.name?i.unshift(e):i.push(e):"vertices"===("object"==typeof e?e.name:e)?i.unshift(e):i.push(e);});for(let e=0;e<i.length;e+=1){let t;let n=i[e];if(h.ToolItem.isToolItem(n))t=n;else{let e="object"==typeof n?n.name:n,i="object"==typeof n&&n.args||{};if(e){if(this.cell.isNode()){let n=s.NodeTool.registry.get(e);if(!n)return s.NodeTool.registry.onNotFound(e);t=new n(i);}else if(this.cell.isEdge()){let n=s.EdgeTool.registry.get(e);if(!n)return s.EdgeTool.registry.onNotFound(e);t=new n(i);}}}t&&(t.config(this.cellView,this),t.render(),(!1!==t.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(t.container),this.tools.push(t));}return this;}update(e={}){let t=this.tools;return t&&t.forEach(t=>{e.toolId!==t.cid&&t.isVisible()&&t.update();}),this;}focus(e){let t=this.tools;return t&&t.forEach(t=>{e===t?t.show():t.hide();}),this;}blur(e){let t=this.tools;return t&&t.forEach(t=>{t===e||t.isVisible()||(t.show(),t.update());}),this;}hide(){return this.focus(null);}show(){return this.blur(null);}remove(){let e=this.tools;return e&&(e.forEach(e=>e.remove()),this.tools=null),r.Dom.remove(this.svgContainer),r.Dom.remove(this.htmlContainer),super.remove();}mount(){let e=this.tools,t=this.cellView;if(t&&e){let i=e.some(e=>!1!==e.options.isSVGElement),n=e.some(e=>!1===e.options.isSVGElement);i&&(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer),n&&this.graph.container.appendChild(this.htmlContainer);}return this;}}(n=h||(h={})).toStringTag=`X6.${n.name}`,n.isToolsView=function(e){if(null==e)return!1;if(e instanceof n)return!0;let t=e[Symbol.toStringTag];return(null==t||t===n.toStringTag)&&null!=e.graph&&null!=e.cell&&"function"==typeof e.config&&"function"==typeof e.update&&"function"==typeof e.focus&&"function"==typeof e.blur&&"function"==typeof e.show&&"function"==typeof e.hide;},function(e){var t,i;let n;class s extends o.View{static getDefaults(){return this.defaults;}static config(e){this.defaults=this.getOptions(e);}static getOptions(e){return r.ObjectExt.merge(r.ObjectExt.cloneDeep(this.getDefaults()),e);}get graph(){return this.cellView.graph;}get cell(){return this.cellView.cell;}get name(){return this.options.name;}get[Symbol.toStringTag](){return s.toStringTag;}constructor(e={}){super(),this.visible=!0,this.options=this.getOptions(e),this.container=o.View.createElement(this.options.tagName||"g",!1!==this.options.isSVGElement),r.Dom.addClass(this.container,this.prefixClassName("cell-tool")),"string"==typeof this.options.className&&r.Dom.addClass(this.container,this.options.className),this.init();}init(){}getOptions(e){return this.constructor.getOptions(e);}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this;}config(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?r.Dom.addClass(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&r.Dom.addClass(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this;}render(){this.empty();let e=this.options.markup;if(e){let t=a.Markup.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors;}return this.onRender(),this;}onRender(){}update(){return this;}stamp(e){e&&e.setAttribute("data-cell-id",this.cellView.cell.id);}show(){return this.container.style.display="",this.visible=!0,this;}hide(){return this.container.style.display="none",this.visible=!1,this;}isVisible(){return this.visible;}focus(){let e=this.options.focusOpacity;return null!=e&&Number.isFinite(e)&&(this.container.style.opacity=`${e}`),this.parent.focus(this),this;}blur(){return this.container.style.opacity="",this.parent.blur(this),this;}guard(e){return null==this.graph||null==this.cellView||this.graph.view.guard(e,this.cellView);}}s.defaults={isSVGElement:!0,tagName:"g"},e.ToolItem=s,t=s=e.ToolItem||(e.ToolItem={}),n=0,t.define=function(e){var t;let i=r.ObjectExt.createClass((t=e.name)?r.StringExt.pascalCase(t):(n+=1,`CustomTool${n}`),this);return i.config(e),i;},(i=s=e.ToolItem||(e.ToolItem={})).toStringTag=`X6.${i.name}`,i.isToolItem=function(e){if(null==e)return!1;if(e instanceof i)return!0;let t=e[Symbol.toStringTag];return(null==t||t===i.toStringTag)&&null!=e.graph&&null!=e.cell&&"function"==typeof e.config&&"function"==typeof e.update&&"function"==typeof e.focus&&"function"==typeof e.blur&&"function"==typeof e.show&&"function"==typeof e.hide&&"function"==typeof e.isVisible;};}(h||(h={}));},"4b2061e3":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0});var n=i("d1751d7c");n._(i("ead4bd68"),t),n._(i("c549d1e0"),t),n._(i("5f22407e"),t),n._(i("3e9a29ef"),t),n._(i("bced94ad"),t);},"4cb0c19c":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Rect",{enumerable:!0,get:function(){return n;}});let n=(0,i("a74a56d7").createShape)("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});},"4e89343a":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Registry",{enumerable:!0,get:function(){return s;}});var n,r=i("b6be2189");class s{constructor(e){this.options=Object.assign({},e),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this);}get names(){return Object.keys(this.data);}register(e,t,i=!1){if("object"==typeof e){Object.entries(e).forEach(([e,i])=>{this.register(e,i,t);});return;}!this.exist(e)||i||r.Platform.isApplyingHMR()||this.onDuplicated(e);let n=this.options.process,s=n?r.FunctionExt.call(n,this,e,t):t;return this.data[e]=s,s;}unregister(e){let t=e?this.data[e]:null;return delete this.data[e],t;}get(e){return e?this.data[e]:null;}exist(e){return!!e&&null!=this.data[e];}onDuplicated(e){try{throw this.options.onConflict&&r.FunctionExt.call(this.options.onConflict,this,e),Error(`${r.StringExt.upperFirst(this.options.type)} with name '${e}' already registered.`);}catch(e){throw e;}}onNotFound(e,t){throw Error(this.getSpellingSuggestion(e,t));}getSpellingSuggestion(e,t){let i=this.getSpellingSuggestionForName(e),n=t?`${t} ${r.StringExt.lowerFirst(this.options.type)}`:this.options.type;return`${r.StringExt.upperFirst(n)} with name '${e}' does not exist.${i?` Did you mean '${i}'?`:""}`;}getSpellingSuggestionForName(e){return r.StringExt.getSpellingSuggestion(e,Object.keys(this.data),e=>e);}}(n=s||(s={})).create=function(e){return new n(e);};},"4f615564":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{bottom:function(){return o;},bottomLeft:function(){return u;},bottomRight:function(){return g;},center:function(){return r;},left:function(){return l;},midSide:function(){return y;},nodeCenter:function(){return b;},orth:function(){return m;},right:function(){return a;},top:function(){return s;},topLeft:function(){return h;},topRight:function(){return c;}});var n=i("b6be2189");let r=d("center"),s=d("topCenter"),o=d("bottomCenter"),l=d("leftMiddle"),a=d("rightMiddle"),h=d("topLeft"),c=d("topRight"),u=d("bottomLeft"),g=d("bottomRight");function d(e){return function(t,i,r,s={}){let o=s.rotate?t.getUnrotatedBBoxOfElement(i):t.getBBoxOfElement(i),l=o[e];l.x+=n.NumberExt.normalizePercentage(s.dx,o.width),l.y+=n.NumberExt.normalizePercentage(s.dy,o.height);let a=t.cell;return s.rotate?l.rotate(-a.getAngle(),a.getBBox().getCenter()):l;};}var p=i("748e16f0"),f=i("a87448e5");let m=(0,f.resolve)(function(e,t,i,n){let r=p.Angle.normalize(e.cell.getAngle()),s=e.getBBoxOfElement(t),o=s.getCenter(),l=s.getTopLeft(),a=s.getBottomRight(),h=n.padding;if(Number.isFinite(h)||(h=0),l.y+h<=i.y&&i.y<=a.y-h){let e=i.y-o.y;o.x+=0===r||180===r?0:1*e/Math.tan(p.Angle.toRad(r)),o.y+=e;}else if(l.x+h<=i.x&&i.x<=a.x-h){let e=i.x-o.x;o.y+=90===r||270===r?0:e*Math.tan(p.Angle.toRad(r)),o.x+=e;}return o;}),b=function(e,t,i,n,r){let s=e.cell.getConnectionPoint(this.cell,r);return(n.dx||n.dy)&&s.translate(n.dx||0,n.dy||0),s;},y=(0,f.resolve)(function(e,t,i,n){let r,s,o;let l=0,a=e.cell;n.rotate?(r=e.getUnrotatedBBoxOfElement(t),s=a.getBBox().getCenter(),l=a.getAngle()):r=e.getBBoxOfElement(t);let h=n.padding;null!=h&&Number.isFinite(h)&&r.inflate(h),n.rotate&&i.rotate(l,s);let c=r.getNearestSideToPoint(i);switch(c){case"left":o=r.getLeftMiddle();break;case"right":o=r.getRightMiddle();break;case"top":o=r.getTopCenter();break;case"bottom":o=r.getBottomCenter();}let u=n.direction;return"H"===u?("top"===c||"bottom"===c)&&(o=i.x<=r.x+r.width?r.getLeftMiddle():r.getRightMiddle()):"V"===u&&(o=i.y<=r.y+r.height?r.getTopCenter():r.getBottomCenter()),n.rotate?o.rotate(-l,s):o;});},"52023e1d":function(e,t,i){"use strict";var n,r;let s,o;i.d(t,"__esModule",{value:!0}),i.d(t,"ShareRegistry",{enumerable:!0,get:function(){return n;}}),(r=n||(n={})).exist=function(e,t){return t?null!=s&&s.exist(e):null!=o&&o.exist(e);},r.setEdgeRegistry=function(e){s=e;},r.setNodeRegistry=function(e){o=e;};},"534efe08":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{Background:function(){return p;},ConnectionPoint:function(){return w;},Connector:function(){return E;},EdgeAnchor:function(){return x;},Filter:function(){return f;},Grid:function(){return D;},Highlighter:function(){return m;},NodeAnchor:function(){return v;},PortLabelLayout:function(){return y;},PortLayout:function(){return b;},Router:function(){return P;}});var n,r,s,o,l,a,h,c,u,g,d,p,f,m,b,y,v,x,w,P,E,C=i("852bbaa9"),O=i("d1751d7c"),M=i("b6be2189"),A=O._(i("4e89343a"),t),S=i("e30b1e39"),T=C._(S);class D{constructor(){this.patterns={},this.root=M.Vector.create(M.Dom.createSvgDocument(),{width:"100%",height:"100%"},[M.Dom.createSvgElement("defs")]).node;}add(e,t){let i=this.root.childNodes[0];i&&i.appendChild(t),this.patterns[e]=t,M.Vector.create("rect",{width:"100%",height:"100%",fill:`url(#${e})`}).appendTo(this.root);}get(e){return this.patterns[e];}has(e){return null!=this.patterns[e];}}(n=D||(D={})).presets=T,n.registry=A.Registry.create({type:"grid"}),n.registry.register(n.presets,!0);var k=i("efbd5273"),j=C._(k);(r=p||(p={})).presets=Object.assign({},j),r.presets["flip-x"]=j.flipX,r.presets["flip-y"]=j.flipY,r.presets["flip-xy"]=j.flipXY,r.registry=A.Registry.create({type:"background pattern"}),r.registry.register(r.presets,!0);var N=i("ddc650d0"),B=C._(N);(s=f||(f={})).presets=B,s.registry=A.Registry.create({type:"filter"}),s.registry.register(s.presets,!0),O._(i("a1cb8e39"),t);var R=i("b6793ac9"),V=C._(R);(m||(m={})).check=function(e,t){if("function"!=typeof t.highlight)throw Error(`Highlighter '${e}' is missing required \`highlight()\` method`);if("function"!=typeof t.unhighlight)throw Error(`Highlighter '${e}' is missing required \`unhighlight()\` method`);},(o=m||(m={})).presets=V,o.registry=A.Registry.create({type:"highlighter"}),o.registry.register(o.presets,!0);var L=i("a1294b5b"),_=C._(L);(l=b||(b={})).presets=_,l.registry=A.Registry.create({type:"port layout"}),l.registry.register(l.presets,!0);var I=i("f77d0316"),F=C._(I);(a=y||(y={})).presets=F,a.registry=A.Registry.create({type:"port label layout"}),a.registry.register(a.presets,!0),O._(i("ec3adf98"),t),O._(i("3125c334"),t);var z=i("4f615564"),$=C._(z);(h=v||(v={})).presets=$,h.registry=A.Registry.create({type:"node endpoint"}),h.registry.register(h.presets,!0);var G=i("1db70876"),H=C._(G);(c=x||(x={})).presets=H,c.registry=A.Registry.create({type:"edge endpoint"}),c.registry.register(c.presets,!0);var U=i("379d6a39"),q=C._(U);(u=w||(w={})).presets=q,u.registry=A.Registry.create({type:"connection point"}),u.registry.register(u.presets,!0);var W=i("f0b32a9d"),J=C._(W);(g=P||(P={})).presets=J,g.registry=A.Registry.create({type:"router"}),g.registry.register(g.presets,!0);var X=i("7edd20d3"),Y=C._(X);(d=E||(E={})).presets=Y,d.registry=A.Registry.create({type:"connector"}),d.registry.register(d.presets,!0);},"5e6ef018":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"normalize",{enumerable:!0,get:function(){return r;}});var n=i("748e16f0");function r(e,t,i){let r,s;"object"==typeof t?(r=t.x,s=t.y):(r=t,s=i);let o=n.Path.parse(e),l=o.bbox();if(l){let e=-l.height/2-l.y,t=-l.width/2-l.x;"number"==typeof r&&(t-=r),"number"==typeof s&&(e-=s),o.translate(t,e);}return o.serialize();}},"5f22407e":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"TransformManager",{enumerable:!0,get:function(){return l;}});var n=i("b6be2189"),r=i("748e16f0"),s=i("a43747d2"),o=i("e46b1882");class l extends s.Base{get container(){return this.graph.view.container;}get viewport(){return this.graph.view.viewport;}get stage(){return this.graph.view.stage;}init(){this.resize();}getMatrix(){let e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),n.Dom.createSVGMatrix(this.viewportMatrix);}setMatrix(e){let t=n.Dom.createSVGMatrix(e),i=n.Dom.matrixToTransformString(t);this.viewport.setAttribute("transform",i),this.viewportMatrix=t,this.viewportTransformString=i;}resize(e,t){let i=void 0===e?this.options.width:e,n=void 0===t?this.options.height:t;this.options.width=i,this.options.height=n,"number"==typeof i&&(i=Math.round(i)),"number"==typeof n&&(n=Math.round(n)),this.container.style.width=null==i?"":`${i}px`,this.container.style.height=null==n?"":`${n}px`;let r=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},r)),this;}getComputedSize(){let e=this.options.width,t=this.options.height;return n.NumberExt.isNumber(e)||(e=this.container.clientWidth),n.NumberExt.isNumber(t)||(t=this.container.clientHeight),{width:e,height:t};}getScale(){return n.Dom.matrixToScale(this.getMatrix());}scale(e,t=e,i=0,n=0){if(e=this.clampScale(e),t=this.clampScale(t),i||n){let r=this.getTranslation(),s=r.tx-i*(e-1),o=r.ty-n*(t-1);(s!==r.tx||o!==r.ty)&&this.translate(s,o);}let r=this.getMatrix();return r.a=e,r.d=t,this.setMatrix(r),this.graph.trigger("scale",{sx:e,sy:t,ox:i,oy:n}),this;}clampScale(e){let t=this.graph.options.scaling;return n.NumberExt.clamp(e,t.min||.01,t.max||16);}getZoom(){return this.getScale().sx;}zoom(e,t){t=t||{};let i=e,n=e,r=this.getScale(),s=this.getComputedSize(),o=s.width/2,l=s.height/2;if(t.absolute||(i+=r.sx,n+=r.sy),t.scaleGrid&&(i=Math.round(i/t.scaleGrid)*t.scaleGrid,n=Math.round(n/t.scaleGrid)*t.scaleGrid),t.maxScale&&(i=Math.min(t.maxScale,i),n=Math.min(t.maxScale,n)),t.minScale&&(i=Math.max(t.minScale,i),n=Math.max(t.minScale,n)),t.center&&(o=t.center.x,l=t.center.y),i=this.clampScale(i),n=this.clampScale(n),o||l){let e=this.getTranslation(),t=o-(o-e.tx)*(i/r.sx),s=l-(l-e.ty)*(n/r.sy);(t!==e.tx||s!==e.ty)&&this.translate(t,s);}return this.scale(i,n),this;}getRotation(){return n.Dom.matrixToRotation(this.getMatrix());}rotate(e,t,i){if(null==t||null==i){let e=o.Util.getBBox(this.stage);t=e.width/2,i=e.height/2;}let n=this.getMatrix().translate(t,i).rotate(e).translate(-t,-i);return this.setMatrix(n),this;}getTranslation(){return n.Dom.matrixToTranslation(this.getMatrix());}translate(e,t){let i=this.getMatrix();i.e=e||0,i.f=t||0,this.setMatrix(i);let n=this.getTranslation();return this.options.x=n.tx,this.options.y=n.ty,this.graph.trigger("translate",Object.assign({},n)),this;}setOrigin(e,t){return this.translate(e||0,t||0);}fitToContent(e,t,i,s){if("object"==typeof e){let n=e;e=n.gridWidth||1,t=n.gridHeight||1,i=n.padding||0,s=n;}else e=e||1,t=t||1,i=i||0,null==s&&(s={});let o=n.NumberExt.normalizeSides(i),l=s.border||0,a=s.contentArea?r.Rectangle.create(s.contentArea):this.getContentArea(s);l>0&&a.inflate(l);let h=this.getScale(),c=this.getTranslation(),u=h.sx,g=h.sy;a.x*=u,a.y*=g,a.width*=u,a.height*=g;let d=Math.max(Math.ceil((a.width+a.x)/e),1)*e,p=Math.max(Math.ceil((a.height+a.y)/t),1)*t,f=0,m=0;("negative"===s.allowNewOrigin&&a.x<0||"positive"===s.allowNewOrigin&&a.x>=0||"any"===s.allowNewOrigin)&&(d+=f=Math.ceil(-a.x/e)*e+o.left),("negative"===s.allowNewOrigin&&a.y<0||"positive"===s.allowNewOrigin&&a.y>=0||"any"===s.allowNewOrigin)&&(p+=m=Math.ceil(-a.y/t)*t+o.top),d+=o.right,p+=o.bottom,d=Math.max(d,s.minWidth||0),p=Math.max(p,s.minHeight||0),d=Math.min(d,s.maxWidth||Number.MAX_SAFE_INTEGER),p=Math.min(p,s.maxHeight||Number.MAX_SAFE_INTEGER);let b=this.getComputedSize(),y=d!==b.width||p!==b.height;return(f!==c.tx||m!==c.ty)&&this.translate(f,m),y&&this.resize(d,p),new r.Rectangle(-f/u,-m/g,d/u,p/g);}scaleContentToFit(e={}){this.scaleContentToFitImpl(e);}scaleContentToFitImpl(e={},t=!0){let i,s,o;if(e.contentArea){let t=e.contentArea;i=this.graph.localToGraph(t),s=r.Point.create(t);}else i=this.getContentBBox(e),s=this.graph.graphToLocal(i);if(!i.width||!i.height)return;let l=n.NumberExt.normalizeSides(e.padding),a=e.minScale||0,h=e.maxScale||Number.MAX_SAFE_INTEGER,c=e.minScaleX||a,u=e.maxScaleX||h,g=e.minScaleY||a,d=e.maxScaleY||h;if(e.viewportArea)o=e.viewportArea;else{let e=this.getComputedSize(),t=this.getTranslation();o={x:t.tx,y:t.ty,width:e.width,height:e.height};}o=r.Rectangle.create(o).moveAndExpand({x:l.left,y:l.top,width:-l.left-l.right,height:-l.top-l.bottom});let p=this.getScale(),f=o.width/i.width*p.sx,m=o.height/i.height*p.sy;!1!==e.preserveAspectRatio&&(f=m=Math.min(f,m));let b=e.scaleGrid;if(b&&(f=b*Math.floor(f/b),m=b*Math.floor(m/b)),f=n.NumberExt.clamp(f,c,u),m=n.NumberExt.clamp(m,g,d),this.scale(f,m),t){let e=this.options,t=o.x-s.x*f-e.x,i=o.y-s.y*m-e.y;this.translate(t,i);}}getContentArea(e={}){return!1!==e.useCellGeometry?this.model.getAllCellsBBox()||new r.Rectangle:o.Util.getBBox(this.stage);}getContentBBox(e={}){return this.graph.localToGraph(this.getContentArea(e));}getGraphArea(){let e=r.Rectangle.fromSize(this.getComputedSize());return this.graph.graphToLocal(e);}zoomToRect(e,t={}){let i=r.Rectangle.create(e),n=this.graph;t.contentArea=i,null==t.viewportArea&&(t.viewportArea={x:n.options.x,y:n.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);let s=i.getCenter();return this.centerPoint(s.x,s.y),this;}zoomToFit(e={}){return this.zoomToRect(this.getContentArea(e),e);}centerPoint(e,t){let i=this.getComputedSize(),n=this.getScale(),r=this.getTranslation(),s=i.width/2,o=i.height/2;e="number"==typeof e?e:s,t="number"==typeof t?t:o,e=s-e*n.sx,t=o-t*n.sy,(r.tx!==e||r.ty!==t)&&this.translate(e,t);}centerContent(e){let t=this.graph.getContentArea(e).getCenter();this.centerPoint(t.x,t.y);}centerCell(e){return this.positionCell(e,"center");}positionPoint(e,t,i){let r=this.getComputedSize();(t=n.NumberExt.normalizePercentage(t,Math.max(0,r.width)))<0&&(t=r.width+t),(i=n.NumberExt.normalizePercentage(i,Math.max(0,r.height)))<0&&(i=r.height+i);let s=this.getTranslation(),o=this.getScale(),l=t-e.x*o.sx,a=i-e.y*o.sy;(s.tx!==l||s.ty!==a)&&this.translate(l,a);}positionRect(e,t){let i=r.Rectangle.create(e);switch(t){case"center":return this.positionPoint(i.getCenter(),"50%","50%");case"top":return this.positionPoint(i.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(i.getTopRight(),"100%",0);case"right":return this.positionPoint(i.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(i.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(i.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(i.getBottomLeft(),0,"100%");case"left":return this.positionPoint(i.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(i.getTopLeft(),0,0);default:return this;}}positionCell(e,t){let i=e.getBBox();return this.positionRect(i,t);}positionContent(e,t){let i=this.graph.getContentArea(t);return this.positionRect(i,e);}}},"610a5823":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Edge",{enumerable:!0,get:function(){return n;}});let n=i("10f1c36f").Edge.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});},61636497:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Vertices",{enumerable:!0,get:function(){return a;}});var n=i("748e16f0"),r=i("b6be2189"),s=i("0f725314"),o=i("1037de1b"),l=i("43bcb3fd");class a extends l.ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[];}get vertices(){return this.cellView.cell.getVertices();}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this;}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this;}resetHandles(){let e=this.handles;this.handles=[],e&&e.forEach(e=>{this.stopHandleListening(e),e.remove();});}renderHandles(){let e=this.vertices;for(let t=0,i=e.length;t<i;t+=1){let i=e[t],n=this.options.createHandle,r=this.options.processHandle,s=n({index:t,graph:this.graph,guard:e=>this.guard(e),attrs:this.options.attrs||{}});r&&r(s),s.updatePosition(i.x,i.y),this.stamp(s.container),this.container.appendChild(s.container),this.handles.push(s),this.startHandleListening(s);}}updateHandles(){let e=this.vertices;for(let t=0,i=e.length;t<i;t+=1){let i=e[t],n=this.handles[t];n&&n.updatePosition(i.x,i.y);}}updatePath(){let e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData());}startHandleListening(e){let t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this);}stopHandleListening(e){let t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this);}getNeighborPoints(e){let t=this.cellView,i=this.vertices,r=e>0?i[e-1]:t.sourceAnchor,s=e<i.length-1?i[e+1]:t.targetAnchor;return{prev:n.Point.create(r),next:n.Point.create(s)};}getMouseEventArgs(e){let t=this.normalizeEvent(e),{x:i,y:n}=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:i,y:n};}onHandleChange({e}){this.focus();let t=this.cellView;if(t.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){let{e:i,x:n,y:r}=this.getMouseEventArgs(e);this.eventData(i,{start:{x:n,y:r}}),t.notifyMouseDown(i,n,r);}}onHandleChanging({handle:e,e:t}){let i=this.cellView,n=e.options.index,{e:r,x:s,y:o}=this.getMouseEventArgs(t),l={x:s,y:o};this.snapVertex(l,n),i.cell.setVertexAt(n,l,{ui:!0,toolId:this.cid}),e.updatePosition(l.x,l.y),this.options.stopPropagation||i.notifyMouseMove(r,s,o);}stopBatch(e){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),e&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid});}onHandleChanged({e}){let t=this.options,i=this.cellView;if(t.addable&&this.updatePath(),!t.removeRedundancies){this.stopBatch(this.eventData(e).vertexAdded);return;}i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(e).vertexAdded);let{e:n,x:r,y:s}=this.getMouseEventArgs(e);if(!this.options.stopPropagation){i.notifyMouseUp(n,r,s);let{start:e}=this.eventData(n);if(e){let{x:t,y:o}=e;t===r&&o===s&&i.onClick(n,r,s);}}i.checkMouseleave(n),t.onChanged&&t.onChanged({edge:i.cell,edgeView:i});}snapVertex(e,t){let i=this.options.snapRadius||0;if(i>0){let n=this.getNeighborPoints(t),r=n.prev,s=n.next;Math.abs(e.x-r.x)<i?e.x=r.x:Math.abs(e.x-s.x)<i&&(e.x=s.x),Math.abs(e.y-r.y)<i?e.y=n.prev.y:Math.abs(e.y-s.y)<i&&(e.y=s.y);}}onHandleRemove({handle:e,e:t}){if(this.options.removable){let i=e.options.index,n=this.cellView;n.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),n.checkMouseleave(this.normalizeEvent(t));}}allowAddVertex(e){let t=this.guard(e),i=this.options.addable&&this.cellView.can("vertexAddable"),n=!this.options.modifiers||r.ModifierKey.isMatch(e,this.options.modifiers);return!t&&i&&n;}onPathMouseDown(e){let t=this.cellView;if(!this.allowAddVertex(e))return;e.stopPropagation(),e.preventDefault();let i=this.normalizeEvent(e),n=this.graph.snapToGrid(i.clientX,i.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});let r=t.getVertexIndex(n.x,n.y);this.snapVertex(n,r),t.cell.insertVertex(n,r,{ui:!0,toolId:this.cid}),this.render();let s=this.handles[r];this.eventData(i,{vertexAdded:!0}),s.onMouseDown(i);}onRemove(){this.resetHandles();}}!function(e){class t extends o.View{get graph(){return this.options.graph;}constructor(e){super(),this.options=e,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"});}render(){this.container=o.View.createElement("circle",!0);let t=this.options.attrs;if("function"==typeof t){let i=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},i.attrs),t(this)));}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-vertex"));}updatePosition(e,t){this.setAttrs({cx:e,cy:t});}onMouseDown(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e:e,handle:this}));}onMouseMove(e){this.emit("changing",{e:e,handle:this});}onMouseUp(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();}onDoubleClick(e){this.emit("remove",{e:e,handle:this});}}e.Handle=t;}(a||(a={})),function(e){let t=s.Config.prefix("edge-tool-vertex-path");e.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:t=>new e.Handle(t),markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${t}`]:"onPathMouseDown",[`touchstart .${t}`]:"onPathMouseDown"}});}(a||(a={}));},"62fc6309":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Markup",{enumerable:!0,get:function(){return r;}});var n,r,s=i("b6be2189");!function(e){function t(e){return null!=e&&"string"==typeof e;}function i(e,t={ns:s.Dom.ns.svg}){let n=document.createDocumentFragment(),r={},o={},l=[{markup:Array.isArray(e)?e:[e],parent:n,ns:t.ns}];for(;l.length>0;){let e=l.pop(),t=e.ns||s.Dom.ns.svg,i=e.markup,n=e.parent;i.forEach(e=>{let i=e.tagName;if(!i)throw TypeError("Invalid tagName");e.ns&&(t=e.ns);let a=t?s.Dom.createElementNS(i,t):s.Dom.createElement(i),h=e.attrs;h&&s.Dom.attr(a,s.Dom.kebablizeAttrs(h));let c=e.style;c&&s.Dom.css(a,c);let u=e.className;null!=u&&a.setAttribute("class",Array.isArray(u)?u.join(" "):u),e.textContent&&(a.textContent=e.textContent);let g=e.selector;if(null!=g){if(o[g])throw TypeError("Selector must be unique");o[g]=a;}if(e.groupSelector){let t=e.groupSelector;Array.isArray(t)||(t=[t]),t.forEach(e=>{r[e]||(r[e]=[]),r[e].push(a);});}n.appendChild(a);let d=e.children;Array.isArray(d)&&l.push({ns:t,markup:d,parent:a});});}return Object.keys(r).forEach(e=>{if(o[e])throw Error("Ambiguous group selector");o[e]=r[e];}),{fragment:n,selectors:o,groups:r};}function n(e){return e instanceof SVGElement?s.Dom.createSvgElement("g"):s.Dom.createElement("div");}e.isJSONMarkup=function(e){return null!=e&&!t(e);},e.isStringMarkup=t,e.clone=function(e){return null==e||t(e)?e:s.ObjectExt.cloneDeep(e);},e.sanitize=function(e){return`${e}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><");},e.parseJSONMarkup=i,e.renderMarkup=function(e){if(t(e)){let t=s.Vector.createVectors(e),i=t.length;if(1===i)return{elem:t[0].node};if(i>1){let e=n(t[0].node);return t.forEach(t=>{e.appendChild(t.node);}),{elem:e};}return{};}let r=i(e),o=r.fragment,l=null;return o.childNodes.length>1?(l=n(o.firstChild)).appendChild(o):l=o.firstChild,{elem:l,selectors:r.selectors};},e.parseLabelStringMarkup=function(e){let t=s.Vector.createVectors(e),i=document.createDocumentFragment();for(let e=0,n=t.length;e<n;e+=1){let n=t[e].node;i.appendChild(n);}return{fragment:i,selectors:{}};};}(r||(r={})),(r||(r={})).getSelector=function e(t,i,n){if(null!=t){let r;let o=t.tagName.toLowerCase();if(t===i)return"string"==typeof n?`> ${o} > ${n}`:`> ${o}`;let l=t.parentNode;if(l&&l.childNodes.length>1){let e=s.Dom.index(t)+1;r=`${o}:nth-child(${e})`;}else r=o;return n&&(r+=` > ${n}`),e(t.parentNode,i,r);}return n;},(n=r||(r={})).getPortContainerMarkup=function(){return"g";},n.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}};},n.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}};},(r||(r={})).getEdgeMarkup=function(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}];},(r||(r={})).getForeignObjectMarkup=function(e=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:s.Dom.ns.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:s.Dom.ns.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]};};},"698eb945":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{Renderer:function(){return y;}});var n,r,s,o,l,a=i("748e16f0"),h=i("a43747d2"),c=i("1287fb66"),u=i("b6be2189"),g=i("ca3299f3");class d{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now();}queueJob(e){if(e.priority&l.PRIOR)e.cb();else{let t=this.findInsertionIndex(e);t>=0&&this.queue.splice(t,0,e);}}queueFlush(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob());}queueFlushSync(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync());}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob();}flushJobs(){let e;this.isFlushPending=!1,this.isFlushing=!0;let t=this.getCurrentTime();for(;(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush();}flushJobsSync(){let e;for(this.isFlushPending=!1,this.isFlushing=!0;e=this.queue.shift();)try{e.cb();}catch(e){console.log(e);}this.isFlushing=!1;}findInsertionIndex(e){let t=0,i=this.queue.length,n=i-1,r=e.priority;for(;t<=n;){let e=(n-t>>1)+t;r<=this.queue[e].priority?t=e+1:(i=e,n=e-1);}return i;}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)));}cancelScheduleJob(){"cancelIdleCallback"in window?this.scheduleId&&window.cancelIdleCallback(this.scheduleId):this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0;}getCurrentTime(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime;}}(n=l||(l={}))[n.Update=2]="Update",n[n.RenderEdge=4]="RenderEdge",n[n.RenderNode=8]="RenderNode",n[n.PRIOR=1048576]="PRIOR";var p=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class f extends u.Disposable{get model(){return this.graph.model;}get container(){return this.graph.view.stage;}constructor(e){super(),this.views={},this.willRemoveViews={},this.queue=new d,this.graph=e,this.init();}init(){this.startListening(),this.renderViews(this.model.getCells());}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this);}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this);}onModelReseted({options:e}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();let t=this.model.getCells();this.renderViews(t,Object.assign(Object.assign({},e),{queue:t.map(e=>e.id)}));}onCellAdded({cell:e,options:t}){this.renderViews([e],t);}onCellRemoved({cell:e}){this.removeViews([e]);}onCellZIndexChanged({cell:e,options:t}){let i=this.views[e.id];i&&this.requestViewUpdate(i.view,f.FLAG_INSERT,t,l.Update,!0);}onCellVisibleChanged({cell:e,current:t}){this.toggleVisible(e,!!t);}requestViewUpdate(e,t,i={},n=l.Update,r=!0){let s=e.cell.id,o=this.views[s];o&&(o.flag=t,o.options=i,(e.hasAction(t,["translate","resize","rotate"])||!1===i.async)&&(n=l.PRIOR,r=!1),this.queue.queueJob({id:s,priority:n,cb:()=>{this.renderViewInArea(e,t,i);let n=i.queue;if(n){let t=n.indexOf(e.cell.id);t>=0&&n.splice(t,1),0===n.length&&this.graph.trigger("render:done");}}}),this.getEffectedEdges(e).forEach(e=>{this.requestViewUpdate(e.view,e.flag,i,n,!1);}),r&&this.flush());}setRenderArea(e){this.renderArea=e,this.flushWaitingViews();}isViewMounted(e){if(null==e)return!1;let t=this.views[e.cell.id];return!!t&&t.state===f.ViewState.MOUNTED;}renderViews(e,t={}){e.sort((e,t)=>e.isNode()&&t.isEdge()?-1:0),e.forEach(e=>{let i=e.id,n=this.views,r=0,s=n[i];if(s)r=f.FLAG_INSERT;else{let n=this.createCellView(e);n&&(n.graph=this.graph,r=f.FLAG_INSERT|n.getBootstrapFlag(),s={view:n,flag:r,options:t,state:f.ViewState.CREATED},this.views[i]=s);}s&&this.requestViewUpdate(s.view,r,t,this.getRenderPriority(s.view),!1);}),this.flush();}renderViewInArea(e,t,i={}){let n=e.cell,r=n.id,s=this.views[r];if(!s)return;let o=0;this.isUpdatable(e)?(o=this.updateView(e,t,i),s.flag=o):s.state===f.ViewState.MOUNTED?(o=this.updateView(e,t,i),s.flag=o):s.state=f.ViewState.WAITING,o&&n.isEdge()&&(o&e.getFlag(["source","target"]))==0&&this.queue.queueJob({id:r,priority:l.RenderEdge,cb:()=>{this.updateView(e,t,i);}});}removeViews(e){e.forEach(e=>{let t=e.id,i=this.views[t];i&&(this.willRemoveViews[t]=i,delete this.views[t],this.queue.queueJob({id:t,priority:this.getRenderPriority(i.view),cb:()=>{this.removeView(i.view);}}));}),this.flush();}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync();}flushWaitingViews(){Object.values(this.views).forEach(e=>{if(e&&e.state===f.ViewState.WAITING){let{view:t,flag:i,options:n}=e;this.requestViewUpdate(t,i,n,this.getRenderPriority(t),!1);}}),this.flush();}updateView(e,t,i={}){if(null==e)return 0;if(g.CellView.isCellView(e)){if(t&f.FLAG_REMOVE)return this.removeView(e.cell),0;t&f.FLAG_INSERT&&(this.insertView(e),t^=f.FLAG_INSERT);}return t?e.confirmUpdate(t,i):0;}insertView(e){let t=this.views[e.cell.id];if(t){let i=e.cell.getZIndex(),n=this.addZPivot(i);this.container.insertBefore(e.container,n),e.cell.isVisible()||this.toggleVisible(e.cell,!1),t.state=f.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:e});}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach(e=>{e&&this.removeView(e.view);}),this.views={},this.willRemoveViews={};}removeView(e){let t=e.cell,i=this.willRemoveViews[t.id];i&&e&&(i.view.remove(),delete this.willRemoveViews[t.id],this.graph.trigger("view:unmounted",{view:e}));}toggleVisible(e,t){let i=this.model.getConnectedEdges(e);for(let e=0,n=i.length;e<n;e+=1){let n=i[e];if(t){let e=n.getSourceCell(),t=n.getTargetCell();if(e&&!e.isVisible()||t&&!t.isVisible())continue;this.toggleVisible(n,!0);}else this.toggleVisible(n,!1);}let n=this.views[e.id];n&&u.Dom.css(n.view.container,{display:t?"unset":"none"});}addZPivot(e=0){null==this.zPivots&&(this.zPivots={});let t=this.zPivots,i=t[e];if(i)return i;i=t[e]=document.createComment(`z-index:${e+1}`);let n=-1/0;for(let i in t){let t=+i;if(t<e&&t>n&&(n=t)===e-1)continue;}let r=this.container;if(n!==-1/0){let e=t[n];r.insertBefore(i,e.nextSibling);}else r.insertBefore(i,r.firstChild);return i;}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach(e=>{e&&e.parentNode&&e.parentNode.removeChild(e);}),this.zPivots={};}createCellView(e){let t={graph:this.graph},i=this.graph.options.createCellView;if(i){let n=u.FunctionExt.call(i,this.graph,e);if(n)return new n(e,t);if(null===n)return null;}let n=e.view;if(null!=n&&"string"==typeof n){let i=g.CellView.registry.get(n);return i?new i(e,t):g.CellView.registry.onNotFound(n);}return e.isNode()?new g.NodeView(e,t):e.isEdge()?new g.EdgeView(e,t):null;}getEffectedEdges(e){let t=[],i=e.cell,n=this.model.getConnectedEdges(i);for(let e=0,r=n.length;e<r;e+=1){let r=n[e],s=this.views[r.id];if(!s)continue;let o=s.view;if(!this.isViewMounted(o))continue;let l=["update"];r.getTargetCell()===i&&l.push("target"),r.getSourceCell()===i&&l.push("source"),t.push({id:r.id,view:o,flag:o.getFlag(l)});}return t;}isUpdatable(e){if(e.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(e.cell.getBBox());if(e.isEdgeView()){let t=e.cell,i=t.getSourceCell(),n=t.getTargetCell();if(this.renderArea&&i&&n)return this.renderArea.isIntersectWithRect(i.getBBox())||this.renderArea.isIntersectWithRect(n.getBBox());}return!0;}getRenderPriority(e){return e.cell.isNode()?l.RenderNode:l.RenderEdge;}dispose(){this.stopListening(),Object.keys(this.views).forEach(e=>{this.views[e].view.dispose();}),this.views={};}}p([u.Disposable.dispose()],f.prototype,"dispose",null),(r=f||(f={})).FLAG_INSERT=1073741824,r.FLAG_REMOVE=536870912,r.FLAG_RENDER=67108863,(o=(s=f||(f={})).ViewState||(s.ViewState={}))[o.CREATED=0]="CREATED",o[o.MOUNTED=1]="MOUNTED",o[o.WAITING=2]="WAITING";var m=i("e46b1882"),b=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class y extends h.Base{constructor(){super(...arguments),this.schedule=new f(this.graph);}requestViewUpdate(e,t,i={}){this.schedule.requestViewUpdate(e,t,i);}isViewMounted(e){return this.schedule.isViewMounted(e);}setRenderArea(e){this.schedule.setRenderArea(e);}findViewByElem(e){if(null==e)return null;let t=this.options.container,i="string"==typeof e?t.querySelector(e):e instanceof Element?e:e[0];if(i){let e=this.graph.view.findAttr("data-cell-id",i);if(e){let t=this.schedule.views;if(t[e])return t[e].view;}}return null;}findViewByCell(e){if(null==e)return null;let t=c.Cell.isCell(e)?e.id:e,i=this.schedule.views;return i[t]?i[t].view:null;}findViewsFromPoint(e){let t={x:e.x,y:e.y};return this.model.getCells().map(e=>this.findViewByCell(e)).filter(e=>null!=e&&m.Util.getBBox(e.container,{target:this.view.stage}).containsPoint(t));}findEdgeViewsFromPoint(e,t=5){return this.model.getEdges().map(e=>this.findViewByCell(e)).filter(i=>{if(null!=i){let n=i.getClosestPoint(e);if(n)return n.distance(e)<=t;}return!1;});}findViewsInArea(e,t={}){let i=a.Rectangle.create(e);return this.model.getCells().map(e=>this.findViewByCell(e)).filter(e=>{if(e){if(t.nodeOnly&&!e.isNodeView())return!1;let n=m.Util.getBBox(e.container,{target:this.view.stage});return 0===n.width?n.inflate(1,0):0===n.height&&n.inflate(0,1),t.strict?i.containsRect(n):i.isIntersectWithRect(n);}return!1;});}dispose(){this.schedule.dispose();}}b([h.Base.dispose()],y.prototype,"dispose",null);},"6a2f45ae":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{SourceArrowhead:function(){return a;},TargetArrowhead:function(){return h;}});var n=i("b6be2189"),r=i("748e16f0"),s=i("43bcb3fd"),o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class l extends s.ToolsView.ToolItem{get type(){return this.options.type;}get ratio(){return this.options.ratio;}init(){if(this.options.attrs){let e=this.options.attrs,{class:t}=e,i=o(e,["class"]);this.setAttrs(i,this.container),t&&n.Dom.addClass(this.container,t);}}onRender(){n.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update();}update(){let e=this.ratio,t=this.cellView,i=t.getTangentAtRatio(e),s=i?i.start:t.getPointAtRatio(e),o=i&&i.vector().vectorAngle(new r.Point(1,0))||0;if(!s)return this;let l=n.Dom.createSVGMatrix().translate(s.x,s.y).rotate(o);return n.Dom.transform(this.container,l,{absolute:!0}),this;}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();let t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});let i=this.graph.snapToGrid(e.clientX,e.clientY),n=t.prepareArrowheadDragging(this.type,{x:i.x,y:i.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(e,n),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none";}this.focus();}onMouseMove(e){let t=this.normalizeEvent(e),i=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,i.x,i.y),this.update();}onMouseUp(e){this.undelegateDocumentEvents();let t=this.normalizeEvent(e),i=this.cellView,n=this.graph.snapToGrid(t.clientX,t.clientY);i.onMouseUp(t,n.x,n.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",i.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid});}}!function(e){e.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}});}(l||(l={}));let a=l.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),h=l.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});},"6b556b57":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"VirtualRenderManager",{enumerable:!0,get:function(){return o;}});var n=i("b6be2189"),r=i("a43747d2"),s=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class o extends r.Base{init(){this.resetRenderArea=n.FunctionExt.throttle(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening();}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this);}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this);}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea();}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0);}resetRenderArea(){if(this.options.virtual){let e=this.graph.getGraphArea();this.graph.renderer.setRenderArea(e);}}dispose(){this.stopListening();}}s([r.Base.dispose()],o.prototype,"dispose",null);},"6c62d3ee":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{noop:function(){return n;},pinAbsolute:function(){return a;},pinRelative:function(){return l;}});let n=e=>e;var r=i("748e16f0");function s(e,t){return 0===t?"0%":`${Math.round(e/t*100)}%`;}function o(e){return(t,i,n,o)=>i.isEdgeElement(n)?function(e,t,i,n,r){let s=i.getConnection();if(!s)return t;let o=s.closestPointLength(r);if(e){let e=s.length();t.anchor={name:"ratio",args:{ratio:o/e}};}else t.anchor={name:"length",args:{length:o}};return t;}(e,t,i,0,o):function(e,t,i,n,o){let l=i.cell,a=l.getAngle(),h=i.getUnrotatedBBoxOfElement(n),c=l.getBBox().getCenter(),u=r.Point.create(o).rotate(a,c),g=u.x-h.x,d=u.y-h.y;return e&&(g=s(g,h.width),d=s(d,h.height)),t.anchor={name:"topLeft",args:{dx:g,dy:d,rotate:!0}},t;}(e,t,i,n,o);}let l=o(!0),a=o(!1);},"6dc15b47":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Segments",{enumerable:!0,get:function(){return h;}});var n=i("852bbaa9"),r=i("b6be2189"),s=i("748e16f0"),o=i("1037de1b"),l=i("43bcb3fd"),a=n._(i("c0026991"));class h extends l.ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[];}get vertices(){return this.cellView.cell.getVertices();}update(){return this.render(),this;}onRender(){r.Dom.addClass(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();let e=this.cellView,t=[...this.vertices];t.unshift(e.sourcePoint),t.push(e.targetPoint);for(let e=0,i=t.length;e<i-1;e+=1){let i=t[e],n=t[e+1],r=this.renderHandle(i,n,e);this.stamp(r.container),this.handles.push(r);}return this;}renderHandle(e,t,i){let n=this.options.createHandle({index:i,graph:this.graph,guard:e=>this.guard(e),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(n),this.updateHandle(n,e,t),this.container.appendChild(n.container),this.startHandleListening(n),n;}startHandleListening(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this);}stopHandleListening(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this);}resetHandles(){let e=this.handles;this.handles=[],e&&e.forEach(e=>{this.stopHandleListening(e),e.remove();});}shiftHandleIndexes(e){let t=this.handles;for(let i=0,n=t.length;i<n;i+=1)t[i].options.index+=e;}resetAnchor(e,t){let i=this.cellView.cell,n={ui:!0,toolId:this.cid};t?i.prop([e,"anchor"],t,n):i.removeProp([e,"anchor"],n);}snapHandle(e,t,i){let n=e.options.axis,r=e.options.index,s=this.cellView.cell.getVertices(),o=s[r-2]||i.sourceAnchor,l=s[r+1]||i.targetAnchor,a=this.options.snapRadius;return Math.abs(t[n]-o[n])<a?t[n]=o[n]:Math.abs(t[n]-l[n])<a&&(t[n]=l[n]),t;}onHandleChanging({handle:e,e:t}){let i=this.graph,n=this.options,o=this.cellView,l=n.anchor,a=e.options.axis,h=e.options.index-1,c=this.getEventData(t),u=this.normalizeEvent(t),g=i.snapToGrid(u.clientX,u.clientY),d=this.snapHandle(e,g.clone(),c),p=r.ObjectExt.cloneDeep(this.vertices),f=p[h],m=p[h+1],b=o.sourceView,y=o.sourceBBox,v=!1,x=!1;if(f?0===h?y.containsPoint(f)?(p.shift(),this.shiftHandleIndexes(-1),v=!0):(f[a]=d[a],x=!0):f[a]=d[a]:((f=o.sourceAnchor.toJSON())[a]=d[a],y.containsPoint(f)?v=!0:(p.unshift(f),this.shiftHandleIndexes(1),x=!0)),"function"==typeof l&&b){if(v){let e=c.sourceAnchor.clone();e[a]=d[a];let t=r.FunctionExt.call(l,o,e,b,o.sourceMagnet||b.container,"source",o,this);this.resetAnchor("source",t);}x&&this.resetAnchor("source",c.sourceAnchorDef);}let w=o.targetView,P=o.targetBBox,E=!1,C=!1;if(m?h===p.length-2?P.containsPoint(m)?(p.pop(),E=!0):(m[a]=d[a],C=!0):m[a]=d[a]:((m=o.targetAnchor.toJSON())[a]=d[a],P.containsPoint(m)?E=!0:(p.push(m),C=!0)),"function"==typeof l&&w){if(E){let e=c.targetAnchor.clone();e[a]=d[a];let t=r.FunctionExt.call(l,o,e,w,o.targetMagnet||w.container,"target",o,this);this.resetAnchor("target",t);}C&&this.resetAnchor("target",c.targetAnchorDef);}s.Point.equalPoints(p,this.vertices)||this.cellView.cell.setVertices(p,{ui:!0,toolId:this.cid}),this.updateHandle(e,f,m,0),n.stopPropagation||o.notifyMouseMove(u,g.x,g.y);}onHandleChange({handle:e,e:t}){let i=this.options,n=this.handles,s=this.cellView,o=e.options.index;if(Array.isArray(n)){for(let e=0,t=n.length;e<t;e+=1)e!==o&&n[e].hide();if(this.focus(),this.setEventData(t,{sourceAnchor:s.sourceAnchor.clone(),targetAnchor:s.targetAnchor.clone(),sourceAnchorDef:r.ObjectExt.cloneDeep(this.cell.prop(["source","anchor"])),targetAnchorDef:r.ObjectExt.cloneDeep(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!i.stopPropagation){let e=this.normalizeEvent(t),i=this.graph.snapToGrid(e.clientX,e.clientY);s.notifyMouseDown(e,i.x,i.y);}}}onHandleChanged({e}){let t=this.options,i=this.cellView;t.removeRedundancies&&i.removeRedundantLinearVertices({ui:!0,toolId:this.cid});let n=this.normalizeEvent(e),r=this.graph.snapToGrid(n.clientX,n.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),t.stopPropagation||i.notifyMouseUp(n,r.x,r.y),i.checkMouseleave(n),t.onChanged&&t.onChanged({edge:i.cell,edgeView:i});}updateHandle(e,t,i,n=0){let r=this.options.precision||0,o=Math.abs(t.x-i.x)<r,l=Math.abs(t.y-i.y)<r;if(o||l){let r=new s.Line(t,i);if(r.length()<this.options.threshold)e.hide();else{let t=r.getCenter(),i=o?"x":"y";t[i]+=n||0;let l=r.vector().vectorAngle(new s.Point(1,0));e.updatePosition(t.x,t.y,l,this.cellView),e.show(),e.options.axis=i;}}else e.hide();}onRemove(){this.resetHandles();}}!function(e){class t extends o.View{constructor(e){super(),this.options=e,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"});}render(){this.container=o.View.createElement("rect",!0);let t=this.options.attrs;if("function"==typeof t){let i=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},i.attrs),t(this)));}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-segment"));}updatePosition(e,t,i,n){let o=n.getClosestPoint(new s.Point(e,t))||new s.Point(e,t),l=r.Dom.createSVGMatrix().translate(o.x,o.y);if(o.equals({x:e,y:t}))l=l.rotate(i);else{let i=new s.Line(e,t,o.x,o.y).vector().vectorAngle(new s.Point(1,0));0!==i&&(i+=90),l=l.rotate(i);}this.setAttrs({transform:r.Dom.matrixToTransformString(l),cursor:i%180==0?"row-resize":"col-resize"});}onMouseDown(e){this.options.guard(e)||(this.trigger("change",{e:e,handle:this}),e.stopPropagation(),e.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data));}onMouseMove(e){this.emit("changing",{e:e,handle:this});}onMouseUp(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents();}show(){this.container.style.display="";}hide(){this.container.style.display="none";}}e.Handle=t;}(h||(h={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new e.Handle(t),anchor:a.getAnchor});}(h||(h={}));},"6f5a7fd3":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"CellEditor",{enumerable:!0,get:function(){return a;}});var n,r=i("748e16f0"),s=i("b6be2189"),o=i("43bcb3fd"),l=i("e46b1882");class a extends o.ToolsView.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this);}onRender(){let e=this.cellView;e&&e.on("cell:dblclick",this.dblClick);}createElement(){let e=[this.prefixClassName(`${this.cell.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=o.ToolsView.createElement("div",!1),this.addClass(e,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor);}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null);}updateEditor(){let{cell:e,editor:t}=this;if(!t)return;let{style:i}=t;e.isNode()?this.updateNodeEditorTransform():e.isEdge()&&this.updateEdgeEditorTransform();let{attrs:n}=this.options;i.fontSize=`${n.fontSize}px`,i.fontFamily=n.fontFamily,i.color=n.color,i.backgroundColor=n.backgroundColor;let r=this.getCellText()||"";return t.innerText=r,this.setCellText(""),this;}updateNodeEditorTransform(){let{graph:e,cell:t,editor:i}=this;if(!i)return;let n=r.Point.create(),o=20,l="",{x:a,y:h}=this.options,{width:c,height:u}=this.options;if(void 0!==a&&void 0!==h){let e=t.getBBox();a=s.NumberExt.normalizePercentage(a,e.width),h=s.NumberExt.normalizePercentage(h,e.height),n=e.topLeft.translate(a,h),o=e.width-2*a;}else{let e=t.getBBox();n=e.center,o=e.width-4,l="translate(-50%, -50%)";}let g=e.scale(),{style:d}=i;n=e.localToGraph(n),d.left=`${n.x}px`,d.top=`${n.y}px`,d.transform=`scale(${g.sx}, ${g.sy}) ${l}`,d.minWidth=`${o}px`,"number"==typeof c&&(d.width=`${c}px`),"number"==typeof u&&(d.height=`${u}px`);}updateEdgeEditorTransform(){if(!this.event)return;let{graph:e,editor:t}=this;if(!t)return;let i=r.Point.create(),n=20,{style:o}=t,a=this.event.target,h=a.parentElement;if(h&&s.Dom.hasClass(h,this.prefixClassName("edge-label"))){let e=h.getAttribute("data-index")||"0";this.labelIndex=parseInt(e,10);let t=h.getAttribute("transform"),{translation:o}=s.Dom.parseTransformString(t);i=new r.Point(o.tx,o.ty),n=l.Util.getBBox(a).width;}else{if(!this.options.labelAddable)return this;i=e.clientToLocal(r.Point.create(this.event.clientX,this.event.clientY));let t=this.cellView.path.closestPointLength(i);this.distance=t,this.labelIndex=-1;}i=e.localToGraph(i);let c=e.scale();o.left=`${i.x}px`,o.top=`${i.y}px`,o.minWidth=`${n}px`,o.transform=`scale(${c.sx}, ${c.sy}) translate(-50%, -50%)`;}onDocumentMouseUp(e){if(this.editor&&e.target!==this.editor){let e=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(""!==e?e:null),this.removeElement();}}onCellDblClick({e}){this.editor||(e.stopPropagation(),this.removeElement(),this.event=e,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents));}onMouseDown(e){e.stopPropagation();}autoFocus(){setTimeout(()=>{this.editor&&(this.editor.focus(),this.selectText());});}selectText(){if(window.getSelection&&this.editor){let e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e);}}getCellText(){let{getText:e}=this.options;if("function"==typeof e)return s.FunctionExt.call(e,this.cellView,{cell:this.cell,index:this.labelIndex});if("string"==typeof e){if(this.cell.isNode())return this.cell.attr(e);if(this.cell.isEdge()&&-1!==this.labelIndex)return this.cell.prop(`labels/${this.labelIndex}/attrs/${e}`);}}setCellText(e){let t=this.options.setText;if("function"==typeof t){s.FunctionExt.call(t,this.cellView,{cell:this.cell,value:e,index:this.labelIndex,distance:this.distance});return;}if("string"==typeof t){if(this.cell.isNode()){null!==e&&this.cell.attr(t,e);return;}if(this.cell.isEdge()){let i=this.cell;if(-1===this.labelIndex){if(e){let n={position:{distance:this.distance},attrs:{}};s.ObjectExt.setByPath(n,`attrs/${t}`,e),i.appendLabel(n);}}else null!==e?i.prop(`labels/${this.labelIndex}/attrs/${t}`,e):"number"==typeof this.labelIndex&&i.removeLabelAt(this.labelIndex);}}}onRemove(){let e=this.cellView;e&&e.off("cell:dblclick",this.dblClick),this.removeElement();}}!function(e){e.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}});}(a||(a={})),(n=a||(a={})).NodeEditor=n.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),n.EdgeEditor=n.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"});},"6fea0596":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"HTML",{enumerable:!0,get:function(){return g;}});var n,r,s=i("b6be2189"),o=i("ca3299f3"),l=i("dd2b1c2b"),a=i("3a2f3ab3"),h=i("ead4bd68"),c=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;},u=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class g extends l.Node{}!function(e){var t;class i extends a.NodeView{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this);}onCellChangeAny({key:t}){let i=e.shapeMaps[this.cell.shape];if(i){let{effect:e}=i;(!e||e.includes(t))&&this.renderHTMLComponent();}}confirmUpdate(e){let t=super.confirmUpdate(e);return this.handleAction(t,i.action,()=>this.renderHTMLComponent());}renderHTMLComponent(){let t=this.selectors&&this.selectors.foContent;if(t){s.Dom.empty(t);let i=e.shapeMaps[this.cell.shape];if(!i)return;let{html:n}=i;"function"==typeof n&&(n=n(this.cell)),n&&("string"==typeof n?t.innerHTML=n:s.Dom.append(t,n));}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this);}}c([i.dispose()],i.prototype,"dispose",null),e.View=i,(t=i=e.View||(e.View={})).action="html",t.config({bootstrap:[t.action],actions:{html:t.action}}),a.NodeView.registry.register("html-view",t,!0);}(g||(g={})),(n=g||(g={})).config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},o.Markup.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),l.Node.registry.register("html",n,!0),(r=g||(g={})).shapeMaps={},r.register=function(e){let{shape:t,html:i,effect:n,inherit:s}=e,o=u(e,["shape","html","effect","inherit"]);if(!t)throw Error("should specify shape in config");r.shapeMaps[t]={html:i,effect:n},h.Graph.registerNode(t,Object.assign({inherit:s||"html"},o),!0);};},"77e92f7e":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Image",{enumerable:!0,get:function(){return r;}});var n=i("a74a56d7");let r=(0,n.createShape)("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:(0,n.getImageUrlHook)()},{selector:"image"});},"7edd20d3":function(e,t,i){let n,r;i.d(t,"__esModule",{value:!0}),i.e(t,{jumpover:function(){return f;},loop:function(){return l;},normal:function(){return o;},rounded:function(){return a;},smooth:function(){return h;}});var s=i("748e16f0");let o=function(e,t,i,n={}){let r=[e,...i,t],o=new s.Polyline(r),l=new s.Path(o);return n.raw?l:l.serialize();},l=function(e,t,i,n={}){let r=3===i.length?0:1,o=s.Point.create(i[0+r]),l=s.Point.create(i[2+r]),a=s.Point.create(i[1+r]);if(!s.Point.equals(e,t)){let i=new s.Point((e.x+t.x)/2,(e.y+t.y)/2),n=i.angleBetween(s.Point.create(e).rotate(90,i),a);n>1&&(o.rotate(180-n,i),l.rotate(180-n,i),a.rotate(180-n,i));}let h=`
     M ${e.x} ${e.y}
     Q ${o.x} ${o.y} ${a.x} ${a.y}
     Q ${l.x} ${l.y} ${t.x} ${t.y}
  `;return n.raw?s.Path.parse(h):h;},a=function(e,t,i,n={}){let r,o;let l=new s.Path;l.appendSegment(s.Path.createSegment("M",e));let a=1/3,h=2/3,c=n.radius||10;for(let n=0,u=i.length;n<u;n+=1){let u=s.Point.create(i[n]),g=i[n-1]||e,d=i[n+1]||t;r=o||u.distance(g)/2,o=u.distance(d)/2;let p=-Math.min(c,r),f=-Math.min(c,o),m=u.clone().move(g,p).round(),b=u.clone().move(d,f).round(),y=new s.Point(a*m.x+h*u.x,h*u.y+a*m.y),v=new s.Point(a*b.x+h*u.x,h*u.y+a*b.y);l.appendSegment(s.Path.createSegment("L",m)),l.appendSegment(s.Path.createSegment("C",y,v,b));}return l.appendSegment(s.Path.createSegment("L",t)),n.raw?l:l.serialize();},h=function(e,t,i,n={}){let r;let o=n.direction;if(i&&0!==i.length){let n=[e,...i,t],o=s.Curve.throughPoints(n);r=new s.Path(o);}else if((r=new s.Path).appendSegment(s.Path.createSegment("M",e)),o||(o=Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)?"H":"V"),"H"===o){let i=(e.x+t.x)/2;r.appendSegment(s.Path.createSegment("C",i,e.y,i,t.y,t.x,t.y));}else{let i=(e.y+t.y)/2;r.appendSegment(s.Path.createSegment("C",e.x,i,t.x,i,t.x,t.y));}return n.raw?r:r.serialize();},c=1/3,u=2/3;function g(e,t,i=[]){let n=[e,...i,t],r=[];return n.forEach((e,t)=>{let i=n[t+1];null!=i&&r.push(new s.Line(e,i));}),r;}function d(e,t){return new s.Line(e,t).squaredLength();}function p(e,t,i,r){let o;let l=new s.Path;return o=s.Path.createSegment("M",e[0].start),l.appendSegment(o),e.forEach((a,h)=>{if(n.includes(a)){let e,n,r,h;if("arc"===i){let t;e=-90,((n=a.start.diff(a.end)).x<0||0===n.x&&n.y<0)&&(e+=180);let i=a.getCenter(),c=new s.Line(i,a.end).rotate(e,i);r=(t=new s.Line(a.start,i)).pointAt(2/3).rotate(e,a.start),h=c.pointAt(1/3).rotate(-e,c.end),o=s.Path.createSegment("C",r,h,c.end),l.appendSegment(o),t=new s.Line(i,a.end),r=c.pointAt(1/3).rotate(e,c.end),h=t.pointAt(1/3).rotate(-e,a.end),o=s.Path.createSegment("C",r,h,a.end),l.appendSegment(o);}else if("gap"===i)o=s.Path.createSegment("M",a.end),l.appendSegment(o);else if("cubic"===i){e=a.start.theta(a.end);let i=.6*t,c=1.35*t;((n=a.start.diff(a.end)).x<0||0===n.x&&n.y<0)&&(c*=-1),r=new s.Point(a.start.x+i,a.start.y+c).rotate(e,a.start),h=new s.Point(a.end.x-i,a.end.y+c).rotate(e,a.end),o=s.Path.createSegment("C",r,h,a.end),l.appendSegment(o);}}else{let t=e[h+1];0===r||!t||n.includes(t)?(o=s.Path.createSegment("L",a.end),l.appendSegment(o)):function(e,t,i,n,r){let o;let l=i.distance(n)/2,a=i.distance(r)/2,h=-Math.min(e,l),g=-Math.min(e,a),d=i.clone().move(n,h).round(),p=i.clone().move(r,g).round(),f=new s.Point(c*d.x+u*i.x,u*i.y+c*d.y),m=new s.Point(c*p.x+u*i.x,u*i.y+c*p.y);o=s.Path.createSegment("L",d),t.appendSegment(o),o=s.Path.createSegment("C",f,m,p),t.appendSegment(o);}(r,l,a.end,a.start,t.end);}}),l;}let f=function(e,t,i,o={}){n=[],r=[],function(e){let t=e.graph._jumpOverUpdateList;if(null==t&&(t=e.graph._jumpOverUpdateList=[],e.graph.on("cell:mouseup",()=>{let t=e.graph._jumpOverUpdateList;setTimeout(()=>{for(let e=0;e<t.length;e+=1)t[e].update();});}),e.graph.on("model:reseted",()=>{t=e.graph._jumpOverUpdateList=[];})),0>t.indexOf(e)){t.push(e);let i=()=>t.splice(t.indexOf(e),1);e.cell.once("change:connector",i),e.cell.once("removed",i);}}(this);let l=o.size||5,a=o.type||"arc",h=o.radius||0,c=o.ignoreConnectors||["smooth"],u=this.graph,f=u.model.getEdges();if(1===f.length)return p(g(e,t,i),l,a,h);let m=this.cell,b=f.indexOf(m),y=u.options.connecting.connector||{},v=f.filter((e,t)=>{let i=e.getConnector()||y;return!c.includes(i.name)&&(!(t>b)||"jumpover"!==i.name);}),x=v.map(e=>u.findViewByCell(e)),w=g(e,t,i),P=x.map(e=>null==e?[]:e===this?w:g(e.sourcePoint,e.targetPoint,e.routePoints)),E=[];w.forEach(e=>{let t=v.reduce((t,i,n)=>{if(i!==m){let i=function(e,t){let i=[];return t.forEach(t=>{let n=e.intersectsWithLine(t);n&&i.push(n);}),i;}(e,P[n]);t.push(...i);}return t;},[]).sort((t,i)=>d(e.start,t)-d(e.start,i));t.length>0?E.push(...t.reduce((i,o,a)=>{if(r.includes(o))return i;let h=i.pop()||e,c=s.Point.create(o).move(h.start,-l),u=s.Point.create(o).move(h.start,+l),g=t[a+1];if(null!=g){let e=u.distance(g);e<=l&&(u=g.move(h.start,e),r.push(g));}else if(c.distance(h.end)<2*l+1)return i.push(h),i;if(u.distance(h.start)<2*l+1)return i.push(h),i;let d=new s.Line(c,u);return n.push(d),i.push(new s.Line(h.start,c),d,new s.Line(u,h.end)),i;},[])):E.push(e);});let C=p(E,l,a,h);return n=[],r=[],o.raw?C:C.serialize();};},"8c2901fb":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"AttrManager",{enumerable:!0,get:function(){return a;}});var n=i("b6be2189"),r=i("748e16f0"),s=i("a1cb8e39"),o=i("1037de1b"),l=i("e46b1882");class a{constructor(e){this.view=e;}get cell(){return this.view.cell;}getDefinition(e){return this.cell.getAttrDefinition(e);}processAttrs(e,t){let i,r,o,l;let a=[];return Object.keys(t).forEach(r=>{let o=t[r],l=this.getDefinition(r),h=n.FunctionExt.call(s.Attr.isValidDefinition,this.view,l,o,{elem:e,attrs:t,cell:this.cell,view:this.view});l&&h?"string"==typeof l?(null==i&&(i={}),i[l]=o):null!==o&&a.push({name:r,definition:l}):(null==i&&(i={}),i[n.Dom.CASE_SENSITIVE_ATTR.includes(r)?r:n.StringExt.kebabCase(r)]=o);}),a.forEach(({name:e,definition:i})=>{let n=t[e];"function"==typeof i.set&&(null==r&&(r={}),r[e]=n),"function"==typeof i.offset&&(null==o&&(o={}),o[e]=n),"function"==typeof i.position&&(null==l&&(l={}),l[e]=n);}),{raw:t,normal:i,set:r,offset:o,position:l};}mergeProcessedAttrs(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);let i=e.normal&&e.normal.transform;null!=i&&t.normal&&(t.normal.transform=i),e.normal=t.normal;}findAttrs(e,t,i,r){let s=[],l=new n.Dictionary;return Object.keys(e).forEach(a=>{let h=e[a];if(!n.ObjectExt.isPlainObject(h))return;let{isCSSSelector:c,elems:u}=o.View.find(a,t,r);i[a]=u;for(let e=0,t=u.length;e<t;e+=1){let i=u[e],o=r&&r[a]===i,g=l.get(i);if(g){g.array||(s.push(i),g.array=!0,g.attrs=[g.attrs],g.priority=[g.priority]);let e=g.attrs,r=g.priority;if(o)e.unshift(h),r.unshift(-1);else{let i=n.ArrayExt.sortedIndex(r,c?-1:t);e.splice(i,0,h),r.splice(i,0,t);}}else l.set(i,{elem:i,attrs:h,priority:o?-1:t,array:!1});}}),s.forEach(e=>{let t=l.get(e),i=t.attrs;t.attrs=i.reduceRight((e,t)=>n.ObjectExt.merge(e,t),{});}),l;}updateRelativeAttrs(e,t,i){let s=t.raw||{},o=t.normal||{},a=t.set,h=t.position,c=t.offset,u=()=>({elem:e,cell:this.cell,view:this.view,attrs:s,refBBox:i.clone()});if(null!=a&&Object.keys(a).forEach(e=>{let t=a[e],i=this.getDefinition(e);if(null!=i){let r=n.FunctionExt.call(i.set,this.view,t,u());"object"==typeof r?o=Object.assign(Object.assign({},o),r):null!=r&&(o[e]=r);}}),e instanceof HTMLElement){this.view.setAttrs(o,e);return;}let g=o.transform,d=g?`${g}`:null,p=n.Dom.transformStringToMatrix(d),f=new r.Point(p.e,p.f);g&&(delete o.transform,p.e=0,p.f=0);let m=!1;null!=h&&Object.keys(h).forEach(e=>{let t=h[e],i=this.getDefinition(e);if(null!=i){let e=n.FunctionExt.call(i.position,this.view,t,u());null!=e&&(m=!0,f.translate(r.Point.create(e)));}}),this.view.setAttrs(o,e);let b=!1;if(null!=c){let t=this.view.getBoundingRectOfElement(e);if(t.width>0&&t.height>0){let i=l.Util.transformRectangle(t,p);Object.keys(c).forEach(t=>{let o=c[t],l=this.getDefinition(t);if(null!=l){let t=n.FunctionExt.call(l.offset,this.view,o,{elem:e,cell:this.cell,view:this.view,attrs:s,refBBox:i});null!=t&&(b=!0,f.translate(r.Point.create(t)));}});}}(null!=g||m||b)&&(f.round(1),p.e=f.x,p.f=f.y,e.setAttribute("transform",n.Dom.matrixToTransformString(p)));}update(e,t,i){let r;let s={},o=this.findAttrs(i.attrs||t,e,s,i.selectors),a=i.attrs?this.findAttrs(t,e,s,i.selectors):o,h=[];o.each(t=>{let n=t.elem,r=t.attrs,o=this.processAttrs(n,r);if(null==o.set&&null==o.position&&null==o.offset)this.view.setAttrs(o.normal,n);else{let t;let l=a.get(n),c=l?l.attrs:null,u=c&&null==r.ref?c.ref:r.ref;if(u){if(!(t=(s[u]||this.view.find(u,e,i.selectors))[0]))throw Error(`"${u}" reference does not exist.`);}else t=null;let g={node:n,refNode:t,attributes:c,processedAttributes:o},d=h.findIndex(e=>e.refNode===n);d>-1?h.splice(d,0,g):h.push(g);}});let c=new n.Dictionary;h.forEach(t=>{let s,o;let a=t.node,h=t.refNode,u=null!=h&&null!=i.rotatableNode&&n.Dom.contains(i.rotatableNode,h);if(h&&(s=c.get(h)),!s){let t=u?i.rotatableNode:e;s=h?l.Util.getBBox(h,{target:t}):i.rootBBox,h&&c.set(h,s);}i.attrs&&t.attributes?(o=this.processAttrs(a,t.attributes),this.mergeProcessedAttrs(o,t.processedAttributes)):o=t.processedAttributes;let g=s;u&&null!=i.rotatableNode&&!i.rotatableNode.contains(a)&&(r||(r=n.Dom.transformStringToMatrix(n.Dom.attr(i.rotatableNode,"transform"))),g=l.Util.transformRectangle(s,r)),this.updateRelativeAttrs(a,o,g);});}}},"8f1bdb3e":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"SizeManager",{enumerable:!0,get:function(){return o;}});var n=i("b6be2189"),r=i("a43747d2"),s=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class o extends r.Base{getScroller(){let e=this.graph.getPlugin("scroller");return e&&e.options.enabled?e:null;}getContainer(){let e=this.getScroller();return e?e.container.parentElement:this.graph.container.parentElement;}getSensorTarget(){let e=this.options.autoResize;if(e)return"boolean"==typeof e?this.getContainer():e;}init(){if(this.options.autoResize){let e=this.getSensorTarget();e&&n.SizeSensor.bind(e,()=>{let t=e.offsetWidth,i=e.offsetHeight;this.resize(t,i);});}}resize(e,t){let i=this.getScroller();i?i.resize(e,t):this.graph.transform.resize(e,t);}dispose(){n.SizeSensor.clear(this.graph.container);}}s([r.Base.dispose()],o.prototype,"dispose",null);},"93479dcf":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"CellView",{enumerable:!0,get:function(){return y;}});var n,r,s,o=i("748e16f0"),l=i("b6be2189"),a=i("4e89343a"),h=i("1037de1b"),c=i("c78728bd"),u=i("62fc6309"),g=i("43bcb3fd"),d=i("8c2901fb"),p=i("cdd29704"),f=i("e46b1882"),m=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;},b=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class y extends h.View{static getDefaults(){return this.defaults;}static config(e){this.defaults=this.getOptions(e);}static getOptions(e){let t=(e,t)=>null!=t?l.ArrayExt.uniq([...Array.isArray(e)?e:[e],...Array.isArray(t)?t:[t]]):Array.isArray(e)?[...e]:[e],i=l.ObjectExt.cloneDeep(this.getDefaults()),{bootstrap:n,actions:r,events:s,documentEvents:o}=e,a=b(e,["bootstrap","actions","events","documentEvents"]);return n&&(i.bootstrap=t(i.bootstrap,n)),r&&Object.entries(r).forEach(([e,n])=>{let r=i.actions[e];n&&r?i.actions[e]=t(r,n):n&&(i.actions[e]=t(n));}),s&&(i.events=Object.assign(Object.assign({},i.events),s)),e.documentEvents&&(i.documentEvents=Object.assign(Object.assign({},i.documentEvents),o)),l.ObjectExt.merge(i,a);}get[Symbol.toStringTag](){return y.toStringTag;}constructor(e,t={}){super(),this.cell=e,this.options=this.ensureOptions(t),this.graph=this.options.graph,this.attr=new d.AttrManager(this),this.flag=new p.FlagManager(this,this.options.actions,this.options.bootstrap),this.cache=new c.Cache(this),this.setContainer(this.ensureContainer()),this.setup(),this.init();}init(){}onRemove(){this.removeTools();}get priority(){return this.options.priority;}get rootSelector(){return this.options.rootSelector;}getConstructor(){return this.constructor;}ensureOptions(e){return this.getConstructor().getOptions(e);}getContainerTagName(){return this.options.isSvgElement?"g":"div";}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape};}getContainerClassName(){return this.prefixClassName("cell");}ensureContainer(){return h.View.createElement(this.getContainerTagName(),this.options.isSvgElement);}setContainer(e){if(this.container!==e){this.undelegateEvents(),this.container=e,null!=this.options.events&&this.delegateEvents(this.options.events);let t=this.getContainerAttrs();null!=t&&this.setAttrs(t,e);let i=this.getContainerStyle();null!=i&&this.setStyle(i,e);let n=this.getContainerClassName();null!=n&&this.addClass(n,e);}return this;}isNodeView(){return!1;}isEdgeView(){return!1;}render(){return this;}confirmUpdate(e,t={}){return 0;}getBootstrapFlag(){return this.flag.getBootstrapFlag();}getFlag(e){return this.flag.getFlag(e);}hasAction(e,t){return this.flag.hasAction(e,t);}removeAction(e,t){return this.flag.removeAction(e,t);}handleAction(e,t,i,n){if(this.hasAction(e,t)){i();let r=[t];return n&&("string"==typeof n?r.push(n):r.push(...n)),this.removeAction(e,r);}return e;}setup(){this.cell.on("changed",this.onCellChanged,this);}onCellChanged({options:e}){this.onAttrsChange(e);}onAttrsChange(e){let t=this.flag.getChangedFlag();!e.updated&&t&&(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,t,e));}parseJSONMarkup(e,t){let i=u.Markup.parseJSONMarkup(e),n=i.selectors,r=this.rootSelector;if(t&&r){if(n[r])throw Error("Invalid root selector");n[r]=t;}return i;}can(e){let t=this.graph.options.interacting;if("function"==typeof t&&(t=l.FunctionExt.call(t,this.graph,this)),"object"==typeof t){let i=t[e];return"function"==typeof i&&(i=l.FunctionExt.call(i,this.graph,this)),!1!==i;}return"boolean"==typeof t&&t;}cleanCache(){return this.cache.clean(),this;}getCache(e){return this.cache.get(e);}getDataOfElement(e){return this.cache.getData(e);}getMatrixOfElement(e){return this.cache.getMatrix(e);}getShapeOfElement(e){return this.cache.getShape(e);}getBoundingRectOfElement(e){return this.cache.getBoundingRect(e);}getBBoxOfElement(e){let t=this.getBoundingRectOfElement(e),i=this.getMatrixOfElement(e),n=this.getRootRotatedMatrix(),r=this.getRootTranslatedMatrix();return f.Util.transformRectangle(t,r.multiply(n).multiply(i));}getUnrotatedBBoxOfElement(e){let t=this.getBoundingRectOfElement(e),i=this.getMatrixOfElement(e),n=this.getRootTranslatedMatrix();return f.Util.transformRectangle(t,n.multiply(i));}getBBox(e={}){let t;if(e.useCellGeometry){let e=this.cell,i=e.isNode()?e.getAngle():0;t=e.getBBox().bbox(i);}else t=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(t);}getRootTranslatedMatrix(){let e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return l.Dom.createSVGMatrix().translate(t.x,t.y);}getRootRotatedMatrix(){let e=l.Dom.createSVGMatrix(),t=this.cell,i=t.isNode()?t.getAngle():0;if(i){let n=t.getBBox(),r=n.width/2,s=n.height/2;e=e.translate(r,s).rotate(i).translate(-r,-s);}return e;}findMagnet(e=this.container){return this.findByAttr("magnet",e);}updateAttrs(e,t,i={}){null==i.rootBBox&&(i.rootBBox=new o.Rectangle),null==i.selectors&&(i.selectors=this.selectors),this.attr.update(e,t,i);}isEdgeElement(e){return this.cell.isEdge()&&(null==e||e===this.container);}prepareHighlight(e,t={}){let i=e||this.container;return t.partial=i===this.container,i;}highlight(e,t={}){let i=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:i,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:i,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:i,options:t,view:this,node:this.cell,cell:this.cell}),this;}unhighlight(e,t={}){let i=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:i,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:i,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:i,options:t,view:this,edge:this.cell,cell:this.cell}),this;}notifyUnhighlight(e,t){}getEdgeTerminal(e,t,i,n,r){let s=this.cell,o=this.findAttr("port",e),l=e.getAttribute("data-selector"),a={cell:s.id};return null!=l&&(a.magnet=l),null!=o?(a.port=o,s.isNode()&&!s.hasPort(o)&&null==l&&(a.selector=this.getSelector(e))):null==l&&this.container!==e&&(a.selector=this.getSelector(e)),a;}getMagnetFromEdgeTerminal(e){let t;let i=this.cell,n=this.container,r=e.port,s=e.magnet;return null!=r&&i.isNode()&&i.hasPort(r)?t=this.findPortElem(r,s)||n:(s||(s=e.selector),s||null==r||(s=`[port="${r}"]`),t=this.findOne(s,n,this.selectors)),t;}hasTools(e){let t=this.tools;return null!=t&&(null==e||t.name===e);}addTools(e){if(this.removeTools(),e){if(!this.can("toolsAddable"))return this;let t=g.ToolsView.isToolsView(e)?e:new g.ToolsView(e);this.tools=t,t.config({view:this}),t.mount();}return this;}updateTools(e={}){return this.tools&&this.tools.update(e),this;}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this;}hideTools(){return this.tools&&this.tools.hide(),this;}showTools(){return this.tools&&this.tools.show(),this;}renderTools(){let e=this.cell.getTools();return this.addTools(e),this;}notify(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this;}getEventArgs(e,t,i){let n=this.cell;return null==t||null==i?{e,view:this,cell:n}:{e,x:t,y:i,view:this,cell:n};}onClick(e,t,i){this.notify("cell:click",this.getEventArgs(e,t,i));}onDblClick(e,t,i){this.notify("cell:dblclick",this.getEventArgs(e,t,i));}onContextMenu(e,t,i){this.notify("cell:contextmenu",this.getEventArgs(e,t,i));}onMouseDown(e,t,i){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,i));}onMouseUp(e,t,i){this.notify("cell:mouseup",this.getEventArgs(e,t,i)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null);}onMouseMove(e,t,i){this.notify("cell:mousemove",this.getEventArgs(e,t,i));}onMouseOver(e){this.notify("cell:mouseover",this.getEventArgs(e));}onMouseOut(e){this.notify("cell:mouseout",this.getEventArgs(e));}onMouseEnter(e){this.notify("cell:mouseenter",this.getEventArgs(e));}onMouseLeave(e){this.notify("cell:mouseleave",this.getEventArgs(e));}onMouseWheel(e,t,i,n){this.notify("cell:mousewheel",Object.assign({delta:n},this.getEventArgs(e,t,i)));}onCustomEvent(e,t,i,n){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,i,n))),this.notify(t,Object.assign({},this.getEventArgs(e,i,n)));}onMagnetMouseDown(e,t,i,n){}onMagnetDblClick(e,t,i,n){}onMagnetContextMenu(e,t,i,n){}onLabelMouseDown(e,t,i){}checkMouseleave(e){let t=this.getEventTarget(e,{fromPoint:!0}),i=this.graph.findViewByElem(t);i!==this&&(this.onMouseLeave(e),i&&i.onMouseEnter(e));}dispose(){this.cell.off("changed",this.onCellChanged,this);}}y.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},m([y.dispose()],y.prototype,"dispose",null),(n=y||(y={})).Flag=p.FlagManager,n.Attr=d.AttrManager,(r=y||(y={})).toStringTag=`X6.${r.name}`,r.isCellView=function(e){if(null==e)return!1;if(e instanceof r)return!0;let t=e[Symbol.toStringTag];return(null==t||t===r.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate;},(s=y||(y={})).priority=function(e){return function(t){t.config({priority:e});};},s.bootstrap=function(e){return function(t){t.config({bootstrap:e});};},(y||(y={})).registry=a.Registry.create({type:"view"});},"94abb92f":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{async:function(){return b;},block:function(){return l;},circle:function(){return v;},circlePlus:function(){return x;},classic:function(){return a;},cross:function(){return f;},diamond:function(){return u;},ellipse:function(){return P;},path:function(){return d;}});var n=i("748e16f0"),r=i("b6be2189"),s=i("5e6ef018"),o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let l=e=>{var{size:t,width:i,height:n,offset:r,open:s}=e;return h({size:t,width:i,height:n,offset:r},!0===s,!0,void 0,o(e,["size","width","height","offset","open"]));},a=e=>{var{size:t,width:i,height:n,offset:r,factor:s}=e;return h({size:t,width:i,height:n,offset:r},!1,!1,s,o(e,["size","width","height","offset","factor"]));};function h(e,t,i,o=3/4,l={}){let a=e.size||10,c=e.width||a,u=e.height||a,g=new n.Path,d={};if(t)g.moveTo(c,0).lineTo(0,u/2).lineTo(c,u),d.fill="none";else{if(g.moveTo(0,u/2),g.lineTo(c,0),!i){let e=r.NumberExt.clamp(o,0,1);g.lineTo(c*e,u/2);}g.lineTo(c,u),g.close();}return Object.assign(Object.assign(Object.assign({},d),l),{tagName:"path",d:(0,s.normalize)(g.serialize(),{x:null!=e.offset?e.offset:-c/2})});}var c=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let u=e=>{var{size:t,width:i,height:r,offset:o}=e,l=c(e,["size","width","height","offset"]);let a=t||10,h=i||a,u=r||a,g=new n.Path;return g.moveTo(0,u/2).lineTo(h/2,0).lineTo(h,u/2).lineTo(h/2,u).close(),Object.assign(Object.assign({},l),{tagName:"path",d:(0,s.normalize)(g.serialize(),null==o?-h/2:o)});};var g=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let d=e=>{var{d:t,offsetX:i,offsetY:n}=e;return Object.assign(Object.assign({},g(e,["d","offsetX","offsetY"])),{tagName:"path",d:(0,s.normalize)(t,i,n)});};var p=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let f=e=>{var{size:t,width:i,height:r,offset:o}=e,l=p(e,["size","width","height","offset"]);let a=t||10,h=i||a,c=r||a,u=new n.Path;return u.moveTo(0,0).lineTo(h,c).moveTo(0,c).lineTo(h,0),Object.assign(Object.assign({},l),{tagName:"path",fill:"none",d:(0,s.normalize)(u.serialize(),o||-h/2)});};var m=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let b=e=>{var{width:t,height:i,offset:r,open:o,flip:l}=e,a=m(e,["width","height","offset","open","flip"]);let h=i||6,c=t||10,u=Object.assign(Object.assign({},a),{tagName:"path"});!0===l&&(h=-h);let g=new n.Path;return g.moveTo(0,h).lineTo(c,0),!0===o?u.fill="none":(g.lineTo(c,h),g.close()),u.d=(0,s.normalize)(g.serialize(),{x:r||-c/2,y:h/2}),u;};var y=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let v=e=>{var{r:t}=e,i=y(e,["r"]);let n=t||5;return Object.assign(Object.assign({cx:n},i),{tagName:"circle",r:n});},x=e=>{var{r:t}=e,i=y(e,["r"]);let r=t||5,o=new n.Path;return o.moveTo(r,0).lineTo(r,2*r),o.moveTo(0,r).lineTo(2*r,r),{children:[Object.assign(Object.assign({},v({r:r})),{fill:"none"}),Object.assign(Object.assign({},i),{tagName:"path",d:(0,s.normalize)(o.serialize(),-r)})]};};var w=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let P=e=>{var{rx:t,ry:i}=e,n=w(e,["rx","ry"]);let r=t||5;return Object.assign(Object.assign({cx:r},n),{tagName:"ellipse",rx:r,ry:i||5});};},"9d7d5df2":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"GridManager",{enumerable:!0,get:function(){return h;}});var n=i("852bbaa9"),r=i("b6be2189"),s=n._(i("534efe08")),o=i("a43747d2"),l=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;},a=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class h extends o.Base{get elem(){return this.view.grid;}get grid(){return this.options.grid;}init(){this.startListening(),this.draw(this.grid);}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this);}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this);}setVisible(e){this.grid.visible!==e&&(this.grid.visible=e,this.update());}getGridSize(){return this.grid.size;}setGridSize(e){this.grid.size=Math.max(e,1),this.update();}show(){this.setVisible(!0),this.update();}hide(){this.setVisible(!1),this.update();}clear(){this.elem.style.backgroundImage="";}draw(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update();}update(e={}){let t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();let i=this.graph.matrix(),n=this.getInstance(),s=Array.isArray(e)?e:[e];this.patterns.forEach((e,o)=>{let l=`pattern_${o}`,h=i.a||1,c=i.d||1,{update:u,markup:g}=e,d=Object.assign(Object.assign(Object.assign({},a(e,["update","markup"])),s[o]),{sx:h,sy:c,ox:i.e||0,oy:i.f||0,width:t*h,height:t*c});n.has(l)||n.add(l,r.Vector.create("pattern",{id:l,patternUnits:"userSpaceOnUse"},r.Vector.createVectors(g)).node);let p=n.get(l);"function"==typeof u&&u(p.childNodes[0],d);let f=d.ox%d.width;f<0&&(f+=d.width);let m=d.oy%d.height;m<0&&(m+=d.height),r.Dom.attr(p,{x:f,y:m,width:d.width,height:d.height});});let o=new XMLSerializer().serializeToString(n.root),l=`url(data:image/svg+xml;base64,${btoa(o)})`;this.elem.style.backgroundImage=l;}getInstance(){return this.instance||(this.instance=new s.Grid),this.instance;}resolveGrid(e){if(!e)return[];let t=e.type;if(null==t)return[Object.assign(Object.assign({},s.Grid.presets.dot),e.args)];let i=s.Grid.registry.get(t);if(i){let t=e.args||[];return Array.isArray(t)||(t=[t]),Array.isArray(i)?i.map((e,i)=>Object.assign(Object.assign({},e),t[i])):[Object.assign(Object.assign({},i),t[0])];}return s.Grid.registry.onNotFound(t);}dispose(){this.stopListening(),this.clear();}}l([o.Base.dispose()],h.prototype,"dispose",null);},"9e4e650a":function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{annotations:function(){return $;},atConnectionLength:function(){return ed;},atConnectionLengthIgnoreGradient:function(){return ec;},atConnectionLengthKeepGradient:function(){return eh;},atConnectionRatio:function(){return ep;},atConnectionRatioIgnoreGradient:function(){return eg;},atConnectionRatioKeepGradient:function(){return eu;},connection:function(){return ea;},displayEmpty:function(){return H;},eol:function(){return G;},fill:function(){return B;},filter:function(){return K;},html:function(){return Z;},lineHeight:function(){return I;},port:function(){return Q;},ref:function(){return s;},refCx:function(){return m;},refCy:function(){return b;},refD:function(){return E;},refDKeepOffset:function(){return v;},refDResetOffset:function(){return y;},refDx:function(){return a;},refDy:function(){return h;},refHeight:function(){return u;},refHeight2:function(){return S;},refPoints:function(){return C;},refPointsKeepOffset:function(){return w;},refPointsResetOffset:function(){return x;},refR:function(){return P;},refRCircumscribed:function(){return f;},refRInscribed:function(){return p;},refRx:function(){return g;},refRy:function(){return d;},refWidth:function(){return c;},refWidth2:function(){return A;},refX:function(){return o;},refX2:function(){return O;},refY:function(){return l;},refY2:function(){return M;},resetOffset:function(){return J;},sourceMarker:function(){return en;},stroke:function(){return R;},style:function(){return Y;},targetMarker:function(){return er;},text:function(){return V;},textPath:function(){return z;},textVerticalAnchor:function(){return F;},textWrap:function(){return L;},title:function(){return U;},vertexMarker:function(){return es;},xAlign:function(){return q;},yAlign:function(){return W;}});var n=i("748e16f0"),r=i("b6be2189");let s={},o={position:T("x","width","origin")},l={position:T("y","height","origin")},a={position:T("x","width","corner")},h={position:T("y","height","corner")},c={set:D("width","width")},u={set:D("height","height")},g={set:D("rx","width")},d={set:D("ry","height")},p={set:(e=>{let t=D(e,"width"),i=D(e,"height");return function(e,n){let s=n.refBBox,o=s.height>s.width?t:i;return r.FunctionExt.call(o,this,e,n);};})("r")},f={set(e,{refBBox:t}){let i,n=parseFloat(e),s=r.NumberExt.isPercentage(e);s&&(n/=100);let o=Math.sqrt(t.height*t.height+t.width*t.width);return Number.isFinite(n)&&(i=s||n>=0&&n<=1?n*o:Math.max(n+o,0)),{r:i};}},m={set:D("cx","width")},b={set:D("cy","height")},y={set:j({resetOffset:!0})},v={set:j({resetOffset:!1})},x={set:N({resetOffset:!0})},w={set:N({resetOffset:!1})},P=p,E=y,C=x,O=o,M=l,A=c,S=u;function T(e,t,i){return(s,{refBBox:o})=>{let l;if(null==s)return null;let a=parseFloat(s),h=r.NumberExt.isPercentage(s);if(h&&(a/=100),Number.isFinite(a)){let n=o[i];l=h||a>0&&a<1?n[e]+o[t]*a:n[e]+a;}let c=new n.Point;return c[e]=l||0,c;};}function D(e,t){return function(i,{refBBox:n}){let s=parseFloat(i),o=r.NumberExt.isPercentage(i);o&&(s/=100);let l={};if(Number.isFinite(s)){let i=o||s>=0&&s<=1?s*n[t]:Math.max(s+n[t],0);l[e]=i;}return l;};}function k(e,t){let i="x6-shape",n=t&&t.resetOffset;return function(t,{elem:s,refBBox:o}){let l=r.Dom.data(s,i);if(!l||l.value!==t){let n=e(t);l={value:t,shape:n,shapeBBox:n.bbox()},r.Dom.data(s,i,l);}let a=l.shape.clone(),h=l.shapeBBox.clone(),c=h.getOrigin(),u=o.getOrigin();h.x=u.x,h.y=u.y;let g=o.getMaxScaleToFit(h,u),d=0===h.width||0===o.width?1:g.sx,p=0===h.height||0===o.height?1:g.sy;return a.scale(d,p,c),n&&a.translate(-c.x,-c.y),a;};}function j(e){let t=k(function(e){return n.Path.parse(e);},e);return(e,i)=>({d:t(e,i).serialize()});}function N(e){let t=k(e=>new n.Polyline(e),e);return(e,i)=>({points:t(e,i).serialize()});}let B={qualify:r.ObjectExt.isPlainObject,set:(e,{view:t})=>`url(#${t.graph.defineGradient(e)})`},R={qualify:r.ObjectExt.isPlainObject,set(e,{view:t}){let i=t.cell,n=Object.assign({},e);if(i.isEdge()&&"linearGradient"===n.type){let e=t.sourcePoint,r=t.targetPoint;n.id=`gradient-${n.type}-${i.id}`,n.attrs=Object.assign(Object.assign({},n.attrs),{x1:e.x,y1:e.y,x2:r.x,y2:r.y,gradientUnits:"userSpaceOnUse"}),t.graph.defs.remove(n.id);}return`url(#${t.graph.defineGradient(n)})`;}},V={qualify:(e,{attrs:t})=>null==t.textWrap||!r.ObjectExt.isPlainObject(t.textWrap),set(e,{view:t,elem:i,attrs:n}){let s="x6-text",o=r.Dom.data(i,s),l=e=>{try{return JSON.parse(e);}catch(t){return e;}},a={x:n.x,eol:n.eol,annotations:l(n.annotations),textPath:l(n["text-path"]||n.textPath),textVerticalAnchor:n["text-vertical-anchor"]||n.textVerticalAnchor,displayEmpty:"true"===(n["display-empty"]||n.displayEmpty),lineHeight:n["line-height"]||n.lineHeight},h=n["font-size"]||n.fontSize,c=JSON.stringify([e,a]);if(h&&i.setAttribute("font-size",h),null==o||o!==c){let n=a.textPath;if(null!=n&&"object"==typeof n){let e=n.selector;if("string"==typeof e){let i=t.find(e)[0];i instanceof SVGPathElement&&(r.Dom.ensureId(i),a.textPath=Object.assign({"xlink:href":`#${i.id}`},n));}}r.Dom.text(i,`${e}`,a),r.Dom.data(i,s,c);}}},L={qualify:r.ObjectExt.isPlainObject,set(e,{view:t,elem:i,attrs:n,refBBox:s}){let o;let l=e.width||0;r.NumberExt.isPercentage(l)?s.width*=parseFloat(l)/100:l<=0?s.width+=l:s.width=l;let a=e.height||0;r.NumberExt.isPercentage(a)?s.height*=parseFloat(a)/100:a<=0?s.height+=a:s.height=a;let h=e.text;null==h&&(h=n.text||(null==i?void 0:i.textContent)),o=null!=h?r.Dom.breakText(`${h}`,s,{"font-weight":n["font-weight"]||n.fontWeight,"font-size":n["font-size"]||n.fontSize,"font-family":n["font-family"]||n.fontFamily,lineHeight:n.lineHeight},{ellipsis:e.ellipsis}):"",r.FunctionExt.call(V.set,this,o,{view:t,elem:i,attrs:n,refBBox:s,cell:t.cell});}},_=(e,{attrs:t})=>void 0!==t.text,I={qualify:_},F={qualify:_},z={qualify:_},$={qualify:_},G={qualify:_},H={qualify:_},U={qualify:(e,{elem:t})=>t instanceof SVGElement,set(e,{elem:t}){let i="x6-title",n=`${e}`,s=r.Dom.data(t,i);if(null==s||s!==n){r.Dom.data(t,i,n);let e=t.firstChild;if(e&&"TITLE"===e.tagName.toUpperCase())e.textContent=n;else{let i=document.createElementNS(t.namespaceURI,"title");i.textContent=n,t.insertBefore(i,e);}}}},q={offset:X("x","width","right")},W={offset:X("y","height","bottom")},J={offset:(e,{refBBox:t})=>e?{x:-t.x,y:-t.y}:{x:0,y:0}};function X(e,t,i){return(s,{refBBox:o})=>{let l;let a=new n.Point;return l="middle"===s?o[t]/2:s===i?o[t]:"number"==typeof s&&Number.isFinite(s)?s>-1&&s<1?-o[t]*s:-s:r.NumberExt.isPercentage(s)?o[t]*parseFloat(s)/100:0,a[e]=-(o[e]+l),a;};}let Y={qualify:r.ObjectExt.isPlainObject,set(e,{elem:t}){r.Dom.css(t,e);}},Z={set(e,{elem:t}){t.innerHTML=`${e}`;}},K={qualify:r.ObjectExt.isPlainObject,set:(e,{view:t})=>`url(#${t.graph.defineFilter(e)})`},Q={set:e=>null!=e&&"object"==typeof e&&e.id?e.id:e};var ee=i("3125c334"),et=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};function ei(e){return"string"==typeof e||r.ObjectExt.isPlainObject(e);}let en={qualify:ei,set:(e,{view:t,attrs:i})=>eo("marker-start",e,t,i)},er={qualify:ei,set:(e,{view:t,attrs:i})=>eo("marker-end",e,t,i,{transform:"rotate(180)"})},es={qualify:ei,set:(e,{view:t,attrs:i})=>eo("marker-mid",e,t,i)};function eo(e,t,i,n,r={}){let s="string"==typeof t?{name:t}:t,{name:o,args:l}=s,a=et(s,["name","args"]),h=a;if(o&&"string"==typeof o){let e=ee.Marker.registry.get(o);if(!e)return ee.Marker.registry.onNotFound(o);h=e(Object.assign(Object.assign({},a),l));}let c=Object.assign(Object.assign(Object.assign({},function(e,t){let i={},n=e.stroke;"string"==typeof n&&(i.stroke=n,i.fill=n);let r=e.strokeOpacity;if(null==r&&(r=e["stroke-opacity"]),null==r&&(r=e.opacity),null!=r&&(i["stroke-opacity"]=r,i["fill-opacity"]=r),"marker-mid"!==t){let n=parseFloat(e.strokeWidth||e["stroke-width"]);if(Number.isFinite(n)&&n>1){let e=Math.ceil(n/2);i.refX="marker-start"===t?e:-e;}}return i;}(n,e)),r),h);return{[e]:`url(#${i.graph.defineMarker(c)})`};}let el=(e,{view:t})=>t.cell.isEdge(),ea={qualify:el,set(e,t){var i,n,r,s;let o;let l=t.view,a=e.reverse||!1,h=e.stubs||0;if(Number.isFinite(h)&&0!==h){if(a){let e,t;let a=l.getConnectionLength()||0;h<0?(e=(a+h)/2,t=-h):(e=h,t=a-2*h);let c=l.getConnection();o=null===(s=null===(r=null===(n=null===(i=null==c?void 0:c.divideAtLength(e))||void 0===i?void 0:i[1])||void 0===n?void 0:n.divideAtLength(t))||void 0===r?void 0:r[0])||void 0===s?void 0:s.serialize();}else{let e;e=h<0?((l.getConnectionLength()||0)+h)/2:h;let t=l.getConnection();if(t){let i=t.divideAtLength(e),n=t.divideAtLength(-e);i&&n&&(o=`${i[0].serialize()} ${n[1].serialize()}`);}}}return{d:o||l.getConnectionPathData()};}},eh={qualify:el,set:ef("getTangentAtLength",{rotate:!0})},ec={qualify:el,set:ef("getTangentAtLength",{rotate:!1})},eu={qualify:el,set:ef("getTangentAtRatio",{rotate:!0})},eg={qualify:el,set:ef("getTangentAtRatio",{rotate:!1})},ed=eh,ep=eu;function ef(e,t){let i={x:1,y:0};return(n,r)=>{let s,o;let l=r.view,a=l[e](Number(n));return(a?(o=t.rotate?a.vector().vectorAngle(i):0,s=a.start):(s=l.path.start,o=0),0===o)?{transform:`translate(${s.x},${s.y}')`}:{transform:`translate(${s.x},${s.y}') rotate(${o})`};};}},a1294b5b:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{absolute:function(){return l;},bottom:function(){return m;},ellipse:function(){return a;},ellipseSpread:function(){return h;},left:function(){return d;},line:function(){return g;},right:function(){return p;},top:function(){return f;}});var n=i("b6be2189"),r=i("748e16f0");function s(e,t={}){return new r.Point(n.NumberExt.normalizePercentage(t.x,e.width),n.NumberExt.normalizePercentage(t.y,e.height));}function o(e,t,i){return Object.assign({angle:t,position:e.toJSON()},i);}let l=(e,t)=>e.map(({x:e,y:i,angle:n})=>o(s(t,{x:e,y:i}),n||0)),a=(e,t,i)=>{let n=i.start||0,r=i.step||20;return c(e,t,n,(e,t)=>(e+.5-t/2)*r);},h=(e,t,i)=>{let n=i.start||0,r=i.step||360/e.length;return c(e,t,n,e=>e*r);};function c(e,t,i,n){let s=t.getCenter(),l=t.getTopCenter(),a=t.width/t.height,h=r.Ellipse.fromRect(t),c=e.length;return e.map((e,t)=>{let r=i+n(t,c),u=l.clone().rotate(-r,s).scale(a,1,s),g=e.compensateRotate?-h.tangentTheta(u):0;return(e.dx||e.dy)&&u.translate(e.dx||0,e.dy||0),e.dr&&u.move(s,e.dr),o(u.round(),g,e);});}var u=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let g=(e,t,i)=>b(e,s(t,i.start||t.getOrigin()),s(t,i.end||t.getCorner()),i),d=(e,t,i)=>b(e,t.getTopLeft(),t.getBottomLeft(),i),p=(e,t,i)=>b(e,t.getTopRight(),t.getBottomRight(),i),f=(e,t,i)=>b(e,t.getTopLeft(),t.getTopRight(),i),m=(e,t,i)=>b(e,t.getBottomLeft(),t.getBottomRight(),i);function b(e,t,i,n){let s=new r.Line(t,i),l=e.length;return e.map((e,t)=>{var{strict:i}=e,r=u(e,["strict"]);let a=i||n.strict?(t+1)/(l+1):(t+.5)/l,h=s.pointAt(a);return(r.dx||r.dy)&&h.translate(r.dx||0,r.dy||0),o(h.round(),0,r);});}},a1cb8e39:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{Attr:function(){return r;}});var n,r,s=i("852bbaa9"),o=i("b6be2189"),l=i("4e89343a"),a=i("9e4e650a"),h=s._(a);(r||(r={})).isValidDefinition=function(e,t,i){return!!(null!=e&&("string"==typeof e||"function"!=typeof e.qualify||o.FunctionExt.call(e.qualify,this,t,i)));},(n=r||(r={})).presets=Object.assign(Object.assign({},{xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"}),h),n.registry=l.Registry.create({type:"attribute definition"}),n.registry.register(n.presets,!0);},a43747d2:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Base",{enumerable:!0,get:function(){return r;}});var n=i("b6be2189");class r extends n.Disposable{get options(){return this.graph.options;}get model(){return this.graph.model;}get view(){return this.graph.view;}constructor(e){super(),this.graph=e,this.init();}init(){}}},a74a56d7:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{createShape:function(){return a;},getImageUrlHook:function(){return l;},getMarkup:function(){return o;}});var n=i("b6be2189"),r=i("c540a28c"),s=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};function o(e,t="body"){return[{tagName:e,selector:t},{tagName:"text",selector:"label"}];}function l(e="xlink:href"){return t=>{let{imageUrl:i,imageWidth:n,imageHeight:r}=t,o=s(t,["imageUrl","imageWidth","imageHeight"]);return(null!=i||null!=n||null!=r)&&(o.attrs?null==o.attrs.image&&(o.attrs.image={}):o.attrs={image:{}},(()=>{if(o.attrs){let t=o.attrs.image;null!=i&&(t[e]=i),null!=n&&(t.width=n),null!=r&&(t.height=r),o.attrs.image=t;}})()),o;};}function a(e,t,i={}){let s={constructorName:e,markup:o(e,i.selector),attrs:{[e]:Object.assign({},r.Base.bodyAttr)}};return(i.parent||r.Base).define(n.ObjectExt.merge(s,t,{shape:e}));}},a87448e5:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{getPointAtEdge:function(){return o;},resolve:function(){return s;}});var n=i("b6be2189"),r=i("748e16f0");function s(e){return function(t,i,n,s){if(n instanceof Element){let l;let a=this.graph.findViewByElem(n);return l=a?a.isEdgeElement(n)?o(a,null!=s.fixedAt?s.fixedAt:"50%"):a.getBBoxOfElement(n).getCenter():new r.Point,e.call(this,t,i,l,s);}return e.apply(this,arguments);};}function o(e,t){let i=n.NumberExt.isPercentage(t),r="string"==typeof t?parseFloat(t):t;return i?e.getPointAtRatio(r/100):e.getPointAtLength(r);}},ae7bd6cb:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Button",{enumerable:!0,get:function(){return h;}});var n,r=i("852bbaa9"),s=i("748e16f0"),o=i("b6be2189"),l=i("43bcb3fd"),a=r._(i("c0026991"));class h extends l.ToolsView.ToolItem{onRender(){o.Dom.addClass(this.container,this.prefixClassName("cell-tool-button")),this.update();}update(){return this.updatePosition(),this;}updatePosition(){let e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();o.Dom.transform(this.container,e,{absolute:!0});}getNodeMatrix(){let e=this.cellView,t=this.options,{x:i=0,y:n=0}=t,{offset:r,useCellGeometry:s,rotate:l}=t,h=a.getViewBBox(e,s),c=e.cell.getAngle();l||(h=h.bbox(c));let u=0,g=0;"number"==typeof r?(u=r,g=r):"object"==typeof r&&(u=r.x,g=r.y),i=o.NumberExt.normalizePercentage(i,h.width),n=o.NumberExt.normalizePercentage(n,h.height);let d=o.Dom.createSVGMatrix().translate(h.x+h.width/2,h.y+h.height/2);return l&&(d=d.rotate(c)),d=d.translate(i+u-h.width/2,n+g-h.height/2);}getEdgeMatrix(){let e,t,i;let n=this.cellView,{offset:r=0,distance:l=0,rotate:a}=this.options,h=o.NumberExt.normalizePercentage(l,1);(e=h>=0&&h<=1?n.getTangentAtRatio(h):n.getTangentAtLength(h))?(t=e.start,i=e.vector().vectorAngle(new s.Point(1,0))||0):(t=n.getConnection().start,i=0);let c=o.Dom.createSVGMatrix().translate(t.x,t.y).rotate(i);return c="object"==typeof r?c.translate(r.x||0,r.y||0):c.translate(0,r),a||(c=c.rotate(-i)),c;}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();let t=this.options.onClick;"function"==typeof t&&o.FunctionExt.call(t,this.cellView,{e,view:this.cellView,cell:this.cellView.cell,btn:this});}}!function(e){e.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}});}(h||(h={})),(n=h||(h={})).Remove=n.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:e,btn:t}){t.parent.remove(),e.cell.remove({ui:!0,toolId:t.cid});}});},b6793ac9:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{className:function(){return l;},opacity:function(){return h;},stroke:function(){return g;}});var n,r=i("b6be2189"),s=i("0f725314");let o=s.Config.prefix("highlighted"),l={highlight(e,t,i){let n=i&&i.className||o;r.Dom.addClass(t,n);},unhighlight(e,t,i){let n=i&&i.className||o;r.Dom.removeClass(t,n);}},a=s.Config.prefix("highlight-opacity"),h={highlight(e,t){r.Dom.addClass(t,a);},unhighlight(e,t){r.Dom.removeClass(t,a);}};var c=i("e46b1882");let u={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},g={highlight(e,t,i){let o,l;let a=n.getHighlighterId(t,i);if(n.hasCache(a))return;i=r.ObjectExt.defaultsDeep({},i,u);let h=r.Vector.create(t);try{o=h.toPathData();}catch(e){l=c.Util.bbox(h.node,!0),o=r.Dom.rectToPathData(Object.assign(Object.assign({},i),l));}let g=r.Dom.createSvgElement("path");if(r.Dom.attr(g,Object.assign({d:o,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},i.attrs?r.Dom.kebablizeAttrs(i.attrs):null)),e.isEdgeElement(t))r.Dom.attr(g,"d",e.getConnectionPathData());else{let t=h.getTransformToElement(e.container),n=i.padding;if(n){null==l&&(l=c.Util.bbox(h.node,!0));let e=l.x+l.width/2,i=l.y+l.height/2,s=Math.max((l=c.Util.transformRectangle(l,t)).width,1),o=Math.max(l.height,1),a=(s+n)/s,u=(o+n)/o,g=r.Dom.createSVGMatrix({a:a,b:0,c:0,d:u,e:e-a*e,f:i-u*i});t=t.multiply(g);}r.Dom.transform(g,t);}r.Dom.addClass(g,s.Config.prefix("highlight-stroke"));let d=e.cell,p=()=>n.removeHighlighter(a);d.on("removed",p),d.model&&d.model.on("reseted",p),e.container.appendChild(g),n.setCache(a,g);},unhighlight(e,t,i){n.removeHighlighter(n.getHighlighterId(t,i));}};!function(e){e.getHighlighterId=function(e,t){return r.Dom.ensureId(e),e.id+JSON.stringify(t);};let t={};e.setCache=function(e,i){t[e]=i;},e.hasCache=function(e){return null!=t[e];},e.removeHighlighter=function(e){let i=t[e];i&&(r.Dom.remove(i),delete t[e]);};}(n||(n={}));},bb114469:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Boundary",{enumerable:!0,get:function(){return a;}});var n=i("852bbaa9"),r=i("b6be2189"),s=i("43bcb3fd"),o=n._(i("c0026991")),l=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class a extends s.ToolsView.ToolItem{onRender(){if(r.Dom.addClass(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){let e=this.options.attrs,{class:t}=e,i=l(e,["class"]);r.Dom.attr(this.container,r.Dom.kebablizeAttrs(i)),t&&r.Dom.addClass(this.container,t);}this.update();}update(){let e=this.cellView,t=this.options,{useCellGeometry:i,rotate:n}=t,s=r.NumberExt.normalizeSides(t.padding),l=o.getViewBBox(e,i).moveAndExpand({x:-s.left,y:-s.top,width:s.left+s.right,height:s.top+s.bottom}),a=e.cell;if(a.isNode()){let e=a.getAngle();if(e){if(n){let t=a.getBBox().getCenter();r.Dom.rotate(this.container,e,t.x,t.y,{absolute:!0});}else l=l.bbox(e);}}return r.Dom.attr(this.container,l.toJSON()),this;}}!function(e){e.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}});}(a||(a={}));},bced94ad:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Options",{enumerable:!0,get:function(){return r;}});var n,r,s=i("b6be2189"),o=i("0f725314"),l=i("f10991e6"),a=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};(n=r||(r={})).get=function(e){let{grid:t,panning:i,mousewheel:r,embedding:o}=e,l=a(e,["grid","panning","mousewheel","embedding"]),h=e.container;if(null!=h)null==l.width&&(l.width=h.clientWidth),null==l.height&&(l.height=h.clientHeight);else throw Error("Ensure the container of the graph is specified and valid");let c=s.ObjectExt.merge({},n.defaults,l),u={size:10,visible:!1};return"number"==typeof t?c.grid={size:t,visible:!1}:"boolean"==typeof t?c.grid=Object.assign(Object.assign({},u),{visible:t}):c.grid=Object.assign(Object.assign({},u),t),["panning","mousewheel","embedding"].forEach(t=>{let i=e[t];"boolean"==typeof i?c[t].enabled=i:c[t]=Object.assign(Object.assign({},c[t]),i);}),c;},(r||(r={})).defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:o.Config.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:o.Config.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection:({type:e,sourceView:t,targetView:i})=>null!=("target"===e?i:t),createEdge:()=>new l.Edge},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1};},c0026991:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{getAnchor:function(){return c;},getViewBBox:function(){return u;}});var n,r,s=i("852bbaa9"),o=i("b6be2189"),l=i("4e89343a"),a=i("6c62d3ee"),h=s._(a);function c(e,t,i,n){return o.FunctionExt.call(r.presets.pinRelative,this.graph,{},t,i,e,this.cell,n,{}).anchor;}function u(e,t){return t?e.cell.getBBox():e.cell.isEdge()?e.getConnection().bbox():e.getUnrotatedBBoxOfElement(e.container);}(n=r||(r={})).presets=h,n.registry=l.Registry.create({type:"connection strategy"}),n.registry.register(n.presets,!0);},c540a28c:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Base",{enumerable:!0,get:function(){return l;}});var n,r=i("b6be2189"),s=i("1287fb66"),o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class l extends s.Node{get label(){return this.getLabel();}set label(e){this.setLabel(e);}getLabel(){return this.getAttrByPath("text/text");}setLabel(e,t){return null==e?this.removeLabel():this.setAttrByPath("text/text",e,t),this;}removeLabel(){return this.removeAttrByPath("text/text"),this;}}(n=l||(l={})).bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},n.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},n.config({attrs:{text:Object.assign({},n.labelAttr)},propHooks(e){let{label:t}=e,i=o(e,["label"]);return t&&r.ObjectExt.setByPath(i,"attrs/text/text",t),i;},visible:!0});},c549d1e0:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"GraphView",{enumerable:!0,get:function(){return a;}});var n=i("b6be2189"),r=i("1287fb66"),s=i("0f725314"),o=i("ca3299f3"),l=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class a extends o.View{get disposeContainer(){return!1;}get options(){return this.graph.options;}constructor(e){super(),this.graph=e;let{selectors:t,fragment:i}=o.Markup.parseJSONMarkup(a.markup);this.background=t.background,this.grid=t.grid,this.svg=t.svg,this.defs=t.defs,this.viewport=t.viewport,this.primer=t.primer,this.stage=t.stage,this.decorator=t.decorator,this.overlay=t.overlay,this.container=this.options.container,this.restore=a.snapshoot(this.container),n.Dom.addClass(this.container,this.prefixClassName("graph")),n.Dom.append(this.container,i),this.delegateEvents();}delegateEvents(){let e=this.constructor;return super.delegateEvents(e.events),this;}guard(e,t){return!!("mousedown"===e.type&&2===e.button||this.options.guard&&this.options.guard(e,t))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(t&&t.cell&&r.Cell.isCell(t.cell)||this.svg===e.target||this.container===e.target||this.svg.contains(e.target)));}findView(e){return this.graph.findViewByElem(e);}onDblClick(e){this.options.preventDefaultDblClick&&e.preventDefault();let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;let n=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onDblClick(t,n.x,n.y):this.graph.trigger("blank:dblclick",{e:t,x:n.x,y:n.y});}onClick(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;let n=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onClick(t,n.x,n.y):this.graph.trigger("blank:click",{e:t,x:n.x,y:n.y});}}isPreventDefaultContextMenu(e){let t=this.options.preventDefaultContextMenu;return"function"==typeof t&&(t=n.FunctionExt.call(t,this.graph,{view:e})),t;}onContextMenu(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.isPreventDefaultContextMenu(i)&&e.preventDefault(),this.guard(t,i))return;let n=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onContextMenu(t,n.x,n.y):this.graph.trigger("blank:contextmenu",{e:t,x:n.x,y:n.y});}delegateDragEvents(e,t){null==e.data&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});let i=this.constructor;this.delegateDocumentEvents(i.documentEvents,e.data),this.undelegateEvents();}getMouseMovedCount(e){return this.getEventData(e).mouseMovedCount||0;}onMouseDown(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;this.options.preventDefaultMouseDown&&e.preventDefault();let n=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onMouseDown(t,n.x,n.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(t.type)&&e.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:n.x,y:n.y})),this.delegateDragEvents(t,i);}onMouseMove(e){let t=this.getEventData(e),i=t.startPosition;if(i&&i.x===e.clientX&&i.y===e.clientY||(null==t.mouseMovedCount&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,t.mouseMovedCount<=this.options.moveThreshold))return;let n=this.normalizeEvent(e),r=this.graph.snapToGrid(n.clientX,n.clientY),s=t.currentView;s?s.onMouseMove(n,r.x,r.y):this.graph.trigger("blank:mousemove",{e:n,x:r.x,y:r.y}),this.setEventData(n,t);}onMouseUp(e){this.undelegateDocumentEvents();let t=this.normalizeEvent(e),i=this.graph.snapToGrid(t.clientX,t.clientY),r=this.getEventData(e).currentView;if(r?r.onMouseUp(t,i.x,i.y):this.graph.trigger("blank:mouseup",{e:t,x:i.x,y:i.y}),!e.isPropagationStopped()){let t=new n.Dom.EventObject(e,{type:"click",data:e.data});this.onClick(t);}e.stopImmediatePropagation(),this.delegateEvents();}onMouseOver(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(!this.guard(t,i)){if(i)i.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t});}}}onMouseOut(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(!this.guard(t,i)){if(i)i.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t});}}}onMouseEnter(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;let n=this.graph.findViewByElem(t.relatedTarget);if(i){if(n===i)return;i.onMouseEnter(t);}else{if(n)return;this.graph.trigger("graph:mouseenter",{e:t});}}onMouseLeave(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;let n=this.graph.findViewByElem(t.relatedTarget);if(i){if(n===i)return;i.onMouseLeave(t);}else{if(n)return;this.graph.trigger("graph:mouseleave",{e:t});}}onMouseWheel(e){let t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;let n=t.originalEvent,r=this.graph.snapToGrid(n.clientX,n.clientY),s=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail));i?i.onMouseWheel(t,r.x,r.y,s):this.graph.trigger("blank:mousewheel",{e:t,delta:s,x:r.x,y:r.y});}onCustomEvent(e){let t=e.currentTarget,i=t.getAttribute("event")||t.getAttribute("data-event");if(i){let n=this.findView(t);if(n){let t=this.normalizeEvent(e);if(this.guard(t,n))return;let r=this.graph.snapToGrid(t.clientX,t.clientY);n.onCustomEvent(t,i,r.x,r.y);}}}handleMagnetEvent(e,t){let i=e.currentTarget,r=i.getAttribute("magnet");if(r&&"false"!==r.toLowerCase()){let r=this.findView(i);if(r){let s=this.normalizeEvent(e);if(this.guard(s,r))return;let o=this.graph.snapToGrid(s.clientX,s.clientY);n.FunctionExt.call(t,this.graph,r,s,i,o.x,o.y);}}}onMagnetMouseDown(e){this.handleMagnetEvent(e,(e,t,i,n,r)=>{e.onMagnetMouseDown(t,i,n,r);});}onMagnetDblClick(e){this.handleMagnetEvent(e,(e,t,i,n,r)=>{e.onMagnetDblClick(t,i,n,r);});}onMagnetContextMenu(e){let t=this.findView(e.target);this.isPreventDefaultContextMenu(t)&&e.preventDefault(),this.handleMagnetEvent(e,(e,t,i,n,r)=>{e.onMagnetContextMenu(t,i,n,r);});}onLabelMouseDown(e){let t=e.currentTarget,i=this.findView(t);if(i){let t=this.normalizeEvent(e);if(this.guard(t,i))return;let n=this.graph.snapToGrid(t.clientX,t.clientY);i.onLabelMouseDown(t,n.x,n.y);}}onImageDragStart(){return!1;}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{};}}l([o.View.dispose()],a.prototype,"dispose",null),function(e){let t=`${s.Config.prefixCls}-graph`;e.markup=[{ns:n.Dom.ns.xhtml,tagName:"div",selector:"background",className:`${t}-background`},{ns:n.Dom.ns.xhtml,tagName:"div",selector:"grid",className:`${t}-grid`},{ns:n.Dom.ns.svg,tagName:"svg",selector:"svg",className:`${t}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":n.Dom.ns.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${t}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${t}-svg-primer`},{tagName:"g",selector:"stage",className:`${t}-svg-stage`},{tagName:"g",selector:"decorator",className:`${t}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${t}-svg-overlay`}]}]}],e.snapshoot=function(e){let t=e.cloneNode();return e.childNodes.forEach(e=>t.appendChild(e)),()=>{for(n.Dom.empty(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(let i=0,n=t.attributes.length;i<n;i+=1){let n=t.attributes[i];e.setAttribute(n.name,n.value);}t.childNodes.forEach(t=>e.appendChild(t));};};}(a||(a={})),function(e){let t=s.Config.prefixCls;e.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${t}-cell`]:"onMouseEnter",[`mouseleave  .${t}-cell`]:"onMouseLeave",[`mouseenter  .${t}-cell-tools`]:"onMouseEnter",[`mouseleave  .${t}-cell-tools`]:"onMouseLeave",[`mousedown   .${t}-cell [event]`]:"onCustomEvent",[`touchstart  .${t}-cell [event]`]:"onCustomEvent",[`mousedown   .${t}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${t}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${t}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${t}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${t}-cell image`]:"onImageDragStart",[`mousedown   .${t}-edge .${t}-edge-label`]:"onLabelMouseDown",[`touchstart  .${t}-edge .${t}-edge-label`]:"onLabelMouseDown"},e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"};}(a||(a={}));},c558652a:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Ellipse",{enumerable:!0,get:function(){return n;}});let n=(0,i("a74a56d7").createShape)("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});},c78728bd:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Cache",{enumerable:!0,get:function(){return s;}});var n=i("b6be2189"),r=i("e46b1882");class s{constructor(e){this.view=e,this.clean();}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new n.Dictionary,this.pathCache={};}get(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e);}getData(e){let t=this.get(e);return t.data||(t.data={}),t.data;}getMatrix(e){let t=this.get(e);if(null==t.matrix){let i=this.view.container;t.matrix=n.Dom.getTransformToParentElement(e,i);}return n.Dom.createSVGMatrix(t.matrix);}getShape(e){let t=this.get(e);return null==t.shape&&(t.shape=r.Util.toGeometryShape(e)),t.shape.clone();}getBoundingRect(e){let t=this.get(e);return null==t.boundingRect&&(t.boundingRect=r.Util.getBBoxV2(e)),t.boundingRect.clone();}}},ca3299f3:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{EdgeView:function(){return g;}});var n,r=i("d1751d7c");r._(i("62fc6309"),t),r._(i("1037de1b"),t);var s=r._(i("93479dcf"),t),o=i("748e16f0"),l=i("b6be2189"),a=i("534efe08"),h=i("10f1c36f"),c=r._(i("3a2f3ab3"),t),u=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class g extends s.CellView{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={};}get[Symbol.toStringTag](){return g.toStringTag;}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ");}get sourceBBox(){let e=this.sourceView;if(!e){let e=this.cell.getSource();return new o.Rectangle(e.x,e.y);}let t=this.sourceMagnet;return e.isEdgeElement(t)?new o.Rectangle(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container);}get targetBBox(){let e=this.targetView;if(!e){let e=this.cell.getTarget();return new o.Rectangle(e.x,e.y);}let t=this.targetMagnet;return e.isEdgeElement(t)?new o.Rectangle(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container);}isEdgeView(){return!0;}confirmUpdate(e,t={}){let i=e;if(this.hasAction(i,"source")){if(!this.updateTerminalProperties("source"))return i;i=this.removeAction(i,"source");}if(this.hasAction(i,"target")){if(!this.updateTerminalProperties("target"))return i;i=this.removeAction(i,"target");}return this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","labels","tools"])):(i=this.handleAction(i,"update",()=>this.update(t)),i=this.handleAction(i,"labels",()=>this.onLabelsChange(t)),i=this.handleAction(i,"tools",()=>this.renderTools()));}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this;}renderMarkup(){let e=this.cell.markup;if(e){if("string"==typeof e)throw TypeError("Not support string markup.");return this.renderJSONMarkup(e);}throw TypeError("Invalid edge markup.");}renderJSONMarkup(e){let t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment);}customizeLabels(){if(this.labelContainer){let e=this.cell,t=e.labels;for(let i=0,n=t.length;i<n;i+=1){let n=t[i],r=this.labelCache[i],s=this.labelSelectors[i],o=this.graph.options.onEdgeLabelRendered;if(o){let t=o({edge:e,label:n,container:r,selectors:s});t&&(this.labelDestroyFn[i]=t);}}}}destroyCustomizeLabels(){let e=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let t=0,i=e.length;t<i;t+=1){let i=this.labelDestroyFn[t],n=this.labelCache[t],r=this.labelSelectors[t];i&&n&&r&&i({edge:this.cell,label:e[t],container:n,selectors:r});}this.labelDestroyFn={};}renderLabels(){let e=this.cell,t=e.getLabels(),i=t.length,n=this.labelContainer;if(this.labelCache={},this.labelSelectors={},i<=0)return n&&n.parentNode&&n.parentNode.removeChild(n),this;n?this.empty(n):(n=l.Dom.createSvgElement("g"),this.addClass(this.prefixClassName("edge-labels"),n),this.labelContainer=n);for(let i=0,r=t.length;i<r;i+=1){let r,s;let o=t[i],l=this.normalizeLabelMarkup(this.parseLabelMarkup(o.markup));if(l)r=l.node,s=l.selectors;else{let t=e.getDefaultLabel(),i=this.normalizeLabelMarkup(this.parseLabelMarkup(t.markup));r=i.node,s=i.selectors;}r.setAttribute("data-index",`${i}`),n.appendChild(r);let a=this.rootSelector;if(s[a])throw Error("Ambiguous label root selector.");s[a]=r,this.labelCache[i]=r,this.labelSelectors[i]=s;}return null==n.parentNode&&this.container.appendChild(n),this.updateLabels(),this.customizeLabels(),this;}onLabelsChange(e={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions();}shouldRerenderLabels(e={}){let t=this.cell.previous("labels");if(null==t)return!0;if("propertyPathArray"in e&&"propertyValue"in e){let i=e.propertyPathArray||[],n=i.length;if(n>1&&t[i[1]]){if(2===n)return"object"==typeof e.propertyValue&&l.ObjectExt.has(e.propertyValue,"markup");if("markup"!==i[2])return!1;}}return!0;}parseLabelMarkup(e){return e?"string"==typeof e?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null;}parseLabelStringMarkup(e){let t=l.Vector.createVectors(e),i=document.createDocumentFragment();for(let e=0,n=t.length;e<n;e+=1){let n=t[e].node;i.appendChild(n);}return{fragment:i,selectors:{}};}normalizeLabelMarkup(e){let t;if(null==e)return;let i=e.fragment;if(!(i instanceof DocumentFragment)||!i.hasChildNodes())throw Error("Invalid label markup.");let n=i.childNodes;return(t=n.length>1||"G"!==n[0].nodeName.toUpperCase()?l.Vector.create("g").append(i):l.Vector.create(n[0])).addClass(this.prefixClassName("edge-label")),{node:t.node,selectors:e.selectors};}updateLabels(){if(this.labelContainer){let e=this.cell,t=e.labels,i=this.can("edgeLabelMovable"),n=e.getDefaultLabel();for(let e=0,r=t.length;e<r;e+=1){let r=this.labelCache[e],s=this.labelSelectors[e];r.setAttribute("cursor",i?"move":"default");let a=t[e],h=l.ObjectExt.merge({},n.attrs,a.attrs);this.updateAttrs(r,h,{selectors:s,rootBBox:a.size?o.Rectangle.fromSize(a.size):void 0});}}}renderTools(){let e=this.cell.getTools();return this.addTools(e),this;}update(e={}){this.cleanCache(),this.updateConnection(e);let t=this.cell.getAttrs(),{text:i}=t,n=u(t,["text"]);return null!=n&&this.updateAttrs(this.container,n,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(e),this;}removeRedundantLinearVertices(e={}){let t=this.cell,i=t.getVertices(),n=[this.sourceAnchor,...i,this.targetAnchor],r=n.length,s=new o.Polyline(n);s.simplify({threshold:.01});let l=s.points.map(e=>e.toJSON()),a=l.length;return r===a?0:(t.setVertices(l.slice(1,a-1),e),r-a);}getTerminalView(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw Error(`Unknown terminal type '${e}'`);}}getTerminalAnchor(e){switch(e){case"source":return o.Point.create(this.sourceAnchor);case"target":return o.Point.create(this.targetAnchor);default:throw Error(`Unknown terminal type '${e}'`);}}getTerminalConnectionPoint(e){switch(e){case"source":return o.Point.create(this.sourcePoint);case"target":return o.Point.create(this.targetPoint);default:throw Error(`Unknown terminal type '${e}'`);}}getTerminalMagnet(e,t={}){switch(e){case"source":{if(t.raw)return this.sourceMagnet;let e=this.sourceView;if(!e)return null;return this.sourceMagnet||e.container;}case"target":{if(t.raw)return this.targetMagnet;let e=this.targetView;if(!e)return null;return this.targetMagnet||e.container;}default:throw Error(`Unknown terminal type '${e}'`);}}updateConnection(e={}){let t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){let t=e.tx||0,i=e.ty||0;this.routePoints=new o.Polyline(this.routePoints).translate(t,i).points,this.translateConnectionPoints(t,i),this.path.translate(t,i);}else{let e=t.getVertices(),i=this.findAnchors(e);this.sourceAnchor=i.source,this.targetAnchor=i.target,this.routePoints=this.findRoutePoints(e);let n=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=n.source,this.targetPoint=n.target;let r=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,r.source||this.sourcePoint,r.target||this.targetPoint);}this.cleanCache();}findAnchors(e){let t=this.cell,i=t.source,n=t.target,r=e[0],s=e[e.length-1];return n.priority&&!i.priority?this.findAnchorsOrdered("target",s,"source",r):this.findAnchorsOrdered("source",r,"target",s);}findAnchorsOrdered(e,t,i,n){let r,s;let l=this.cell,a=l[e],h=l[i],c=this.getTerminalView(e),u=this.getTerminalView(i),g=this.getTerminalMagnet(e),d=this.getTerminalMagnet(i);if(c){let i;i=t?o.Point.create(t):u?d:o.Point.create(h),r=this.getAnchor(a.anchor,c,g,i,e);}else r=o.Point.create(a);if(u){let e=o.Point.create(n||r);s=this.getAnchor(h.anchor,u,d,e,i);}else s=o.Point.isPointLike(h)?o.Point.create(h):new o.Point;return{[e]:r,[i]:s};}getAnchor(e,t,i,n,r){let s;let h=t.isEdgeElement(i),c=this.graph.options.connecting,u="string"==typeof e?{name:e}:e;if(!u){let e=h?("source"===r?c.sourceEdgeAnchor:c.targetEdgeAnchor)||c.edgeAnchor:("source"===r?c.sourceAnchor:c.targetAnchor)||c.anchor;u="string"==typeof e?{name:e}:e;}if(!u)throw Error("Anchor should be specified.");let g=u.name;if(h){let e=a.EdgeAnchor.registry.get(g);if("function"!=typeof e)return a.EdgeAnchor.registry.onNotFound(g);s=l.FunctionExt.call(e,this,t,i,n,u.args||{},r);}else{let e=a.NodeAnchor.registry.get(g);if("function"!=typeof e)return a.NodeAnchor.registry.onNotFound(g);s=l.FunctionExt.call(e,this,t,i,n,u.args||{},r);}return s?s.round(this.POINT_ROUNDING):new o.Point;}findRoutePoints(e=[]){let t;let i=this.graph.options.connecting.router||a.Router.presets.normal,n=this.cell.getRouter()||i;if("function"==typeof n)t=l.FunctionExt.call(n,this,e,{},this);else{let i="string"==typeof n?n:n.name,r="string"==typeof n?{}:n.args||{},s=i?a.Router.registry.get(i):a.Router.presets.normal;if("function"!=typeof s)return a.Router.registry.onNotFound(i);t=l.FunctionExt.call(s,this,e,r,this);}return null==t?e.map(e=>o.Point.create(e)):t.map(e=>o.Point.create(e));}findConnectionPoints(e,t,i){let n,r;let s=this.cell,l=this.graph.options.connecting,a=s.getSource(),h=s.getTarget(),c=this.sourceView,u=this.targetView,g=e[0],d=e[e.length-1];if(c&&!c.isEdgeElement(this.sourceMagnet)){let e=this.sourceMagnet||c.container,r=new o.Line(g||i,t),s=a.connectionPoint||l.sourceConnectionPoint||l.connectionPoint;n=this.getConnectionPoint(s,c,e,r,"source");}else n=t;if(u&&!u.isEdgeElement(this.targetMagnet)){let e=this.targetMagnet||u.container,n=h.connectionPoint||l.targetConnectionPoint||l.connectionPoint,s=new o.Line(d||t,i);r=this.getConnectionPoint(n,u,e,s,"target");}else r=i;return{source:n,target:r};}getConnectionPoint(e,t,i,n,r){let s=n.end;if(null==e)return s;let o="string"==typeof e?e:e.name,h="string"==typeof e?{}:e.args,c=a.ConnectionPoint.registry.get(o);if("function"!=typeof c)return a.ConnectionPoint.registry.onNotFound(o);let u=l.FunctionExt.call(c,this,n,t,i,h||{},r);return u?u.round(this.POINT_ROUNDING):s;}findMarkerPoints(e,t,i){let n,r;let s=e=>{let t=this.cell.getAttrs(),i=Object.keys(t);for(let n=0,r=i.length;n<r;n+=1){let r=t[i[n]];if(r[`${e}Marker`]||r[`${e}-marker`]){let e=r.strokeWidth||r["stroke-width"];if(e)return parseFloat(e);break;}}return null;},o=e[0],l=e[e.length-1],a=s("source");a&&(n=t.clone().move(o||i,-a));let h=s("target");return h&&(r=i.clone().move(l||t,-h)),this.sourceMarkerPoint=n||t.clone(),this.targetMarkerPoint=r||i.clone(),{source:n,target:r};}findPath(e,t,i){let n,r,s;let h=this.cell.getConnector()||this.graph.options.connecting.connector;if("string"==typeof h?n=h:(n=h.name,r=h.args),n){let e=a.Connector.registry.get(n);if("function"!=typeof e)return a.Connector.registry.onNotFound(n);s=e;}else s=a.Connector.presets.normal;let c=l.FunctionExt.call(s,this,t,i,e,Object.assign(Object.assign({},r),{raw:!0}),this);return"string"==typeof c?o.Path.parse(c):c;}translateConnectionPoints(e,t){this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t),this.sourceMarkerPoint.translate(e,t),this.targetMarkerPoint.translate(e,t);}updateLabelPositions(){if(null==this.labelContainer||!this.path)return this;let e=this.cell,t=e.getLabels();if(0===t.length)return this;let i=e.getDefaultLabel(),n=this.normalizeLabelPosition(i.position);for(let e=0,i=t.length;e<i;e+=1){let i=t[e],r=this.labelCache[e];if(!r)continue;let s=this.normalizeLabelPosition(i.position),o=l.ObjectExt.merge({},n,s),a=this.getLabelTransformationMatrix(o);r.setAttribute("transform",l.Dom.matrixToTransformString(a));}return this;}updateTerminalProperties(e){let t=this.cell,i=this.graph,n=t[e],r=n&&n.cell,s=`${e}View`;if(!r)return this[s]=null,this.updateTerminalMagnet(e),!0;let o=i.getCellById(r);if(!o)throw Error(`Edge's ${e} node with id "${r}" not exists`);let l=o.findView(i);return!!l&&(this[s]=l,this.updateTerminalMagnet(e),!0);}updateTerminalMagnet(e){let t=`${e}Magnet`,i=this.getTerminalView(e);if(i){let n=i.getMagnetFromEdgeTerminal(this.cell[e]);n===i.container&&(n=null),this[t]=n;}else this[t]=null;}getLabelPositionAngle(e){let t=this.cell.getLabelAt(e);return t&&t.position&&"object"==typeof t.position&&t.position.angle||0;}getLabelPositionArgs(e){let t=this.cell.getLabelAt(e);if(t&&t.position&&"object"==typeof t.position)return t.position.options;}getDefaultLabelPositionArgs(){let e=this.cell.getDefaultLabel();if(e&&e.position&&"object"==typeof e.position)return e.position.options;}mergeLabelPositionArgs(e,t){return null===e?null:void 0===e?null===t?null:t:l.ObjectExt.merge({},t,e);}getConnection(){return null!=this.path?this.path.clone():null;}getConnectionPathData(){if(null==this.path)return"";let e=this.cache.pathCache;return l.ObjectExt.has(e,"data")||(e.data=this.path.serialize()),e.data||"";}getConnectionSubdivisions(){if(null==this.path)return null;let e=this.cache.pathCache;return l.ObjectExt.has(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions;}getConnectionLength(){if(null==this.path)return 0;let e=this.cache.pathCache;return l.ObjectExt.has(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length;}getPointAtLength(e){return null==this.path?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getPointAtRatio(e){return null==this.path?null:(l.NumberExt.isPercentage(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}));}getTangentAtLength(e){return null==this.path?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getTangentAtRatio(e){return null==this.path?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getClosestPoint(e){return null==this.path?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getClosestPointLength(e){return null==this.path?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getClosestPointRatio(e){return null==this.path?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()});}getLabelPosition(e,t,i,n){let r,s,l;let a={distance:0},h=0;"number"==typeof i?(h=i,r=n):r=i,null!=r&&(a.options=r);let c=r&&r.absoluteOffset,u=!(r&&r.absoluteDistance),g=r&&r.absoluteDistance&&r.reverseDistance,d=this.path,p={segmentSubdivisions:this.getConnectionSubdivisions()},f=new o.Point(e,t),m=d.closestPointT(f,p),b=this.getConnectionLength()||0,y=d.lengthAtT(m,p);if(u&&(y=b>0?y/b:0),g&&(y=-1*(b-y)||1),a.distance=y,c||(s=d.tangentAtT(m)),s)l=s.pointOffset(f);else{let e=d.pointAtT(m),t=f.diff(e);l={x:t.x,y:t.y};}return a.offset=l,a.angle=h,a;}normalizeLabelPosition(e){return"number"==typeof e?{distance:e}:e;}getLabelTransformationMatrix(e){let t;let i=this.normalizeLabelPosition(e),n=i.options||{},r=i.angle||0,s=i.distance,a=0,h={x:0,y:0},c=i.offset;c&&("number"==typeof c?a=c:(null!=c.x&&(h.x=c.x),null!=c.y&&(h.y=c.y)));let u=0!==h.x||0!==h.y||0===a,g=n.keepGradient,d=n.ensureLegibility,p=this.path,f={segmentSubdivisions:this.getConnectionSubdivisions()},m=s>0&&s<=1?s*this.getConnectionLength():s,b=p.tangentAtLength(m,f),y=r;if(b){if(u)(t=b.start).translate(h);else{let e=b.clone();e.rotate(-90,b.start),e.setLength(a),t=e.end;}g&&(y=b.angle()+r,d&&(y=o.Angle.normalize((y+90)%180-90)));}else t=p.start,u&&t.translate(h);return l.Dom.createSVGMatrix().translate(t.x,t.y).rotate(y);}getVertexIndex(e,t){let i=this.cell.getVertices(),n=this.getClosestPointLength(new o.Point(e,t)),r=0;if(null!=n)for(let e=i.length;r<e;r+=1){let e=i[r],t=this.getClosestPointLength(e);if(null!=t&&n<t)break;}return r;}getEventArgs(e,t,i){let n=this.cell;return null==t||null==i?{e,view:this,edge:n,cell:n}:{e,x:t,y:i,view:this,edge:n,cell:n};}notifyUnhandledMouseDown(e,t,i){this.notify("edge:unhandled:mousedown",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell});}notifyMouseDown(e,t,i){super.onMouseDown(e,t,i),this.notify("edge:mousedown",this.getEventArgs(e,t,i));}notifyMouseMove(e,t,i){super.onMouseMove(e,t,i),this.notify("edge:mousemove",this.getEventArgs(e,t,i));}notifyMouseUp(e,t,i){super.onMouseUp(e,t,i),this.notify("edge:mouseup",this.getEventArgs(e,t,i));}onClick(e,t,i){super.onClick(e,t,i),this.notify("edge:click",this.getEventArgs(e,t,i));}onDblClick(e,t,i){super.onDblClick(e,t,i),this.notify("edge:dblclick",this.getEventArgs(e,t,i));}onContextMenu(e,t,i){super.onContextMenu(e,t,i),this.notify("edge:contextmenu",this.getEventArgs(e,t,i));}onMouseDown(e,t,i){this.notifyMouseDown(e,t,i),this.startEdgeDragging(e,t,i);}onMouseMove(e,t,i){let n=this.getEventData(e);switch(n.action){case"drag-label":this.dragLabel(e,t,i);break;case"drag-arrowhead":this.dragArrowhead(e,t,i);break;case"drag-edge":this.dragEdge(e,t,i);}return this.notifyMouseMove(e,t,i),n;}onMouseUp(e,t,i){let n=this.getEventData(e);switch(n.action){case"drag-label":this.stopLabelDragging(e,t,i);break;case"drag-arrowhead":this.stopArrowheadDragging(e,t,i);break;case"drag-edge":this.stopEdgeDragging(e,t,i);}return this.notifyMouseUp(e,t,i),this.checkMouseleave(e),n;}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e));}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e));}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e));}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e));}onMouseWheel(e,t,i,n){super.onMouseWheel(e,t,i,n),this.notify("edge:mousewheel",Object.assign({delta:n},this.getEventArgs(e,t,i)));}onCustomEvent(e,t,i,n){if(l.Dom.findParentByClass(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===t){this.cell.remove({ui:!0});return;}this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,i,n)));}this.notifyMouseDown(e,i,n);}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,i,n))),super.onCustomEvent(e,t,i,n);}onLabelMouseDown(e,t,i){this.notifyMouseDown(e,t,i),this.startLabelDragging(e,t,i),this.getEventData(e).stopPropagation&&e.stopPropagation();}startEdgeDragging(e,t,i){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(e,t,i);return;}this.setEventData(e,{x:t,y:i,moving:!1,action:"drag-edge"});}dragEdge(e,t,i){let n=this.getEventData(e);n.moving||(n.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-n.x,i-n.y,{ui:!0}),this.setEventData(e,{x:t,y:i}),this.notify("edge:moving",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell});}stopEdgeDragging(e,t,i){let n=this.getEventData(e);n.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})),n.moving=!1;}prepareArrowheadDragging(e,t){let i=this.getTerminalMagnet(e),n={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:!0===t.isNewEdge,terminalType:e,initialMagnet:i,initialTerminal:l.ObjectExt.clone(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(n),n;}createValidateConnectionArgs(e){let t;let i=[];i[4]=e,i[5]=this;let n=0,r=0;"source"===e?(n=2,t="target"):(r=2,t="source");let s=this.cell[t],o=s.cell;if(o){let e;let t=i[n]=this.graph.findViewByCell(o);t&&(e=t.getMagnetFromEdgeTerminal(s))===t.container&&(e=void 0),i[n+1]=e;}return(e,t)=>(i[r]=e,i[r+1]=e.container===t?void 0:t,i);}beforeArrowheadDragging(e){e.zIndex=this.cell.zIndex,this.cell.toFront();let t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e);}afterArrowheadDragging(e){null!=e.zIndex&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null),this.container.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e);}validateConnection(e,t,i,n,r,s,o){let a=this.graph.options.connecting,h=a.allowLoop,u=a.allowNode,d=a.allowEdge,p=a.allowPort,f=a.allowMulti,m=a.validateConnection,b=s?s.cell:null,y="target"===r?i:e,v="target"===r?n:t,x=!0,w=a=>{let h="source"===r?o?o.port:null:b?b.getSourcePortId():null,c="target"===r?o?o.port:null:b?b.getTargetPortId():null;return l.FunctionExt.call(a,this.graph,{edge:b,edgeView:s,sourceView:e,targetView:i,sourcePort:h,targetPort:c,sourceMagnet:t,targetMagnet:n,sourceCell:e?e.cell:null,targetCell:i?i.cell:null,type:r});};if(null==h||("boolean"==typeof h?h||e!==i||(x=!1):x=w(h)),x&&null!=p&&("boolean"==typeof p?!p&&v&&(x=!1):x=w(p)),x&&null!=d&&("boolean"==typeof d?!d&&g.isEdgeView(y)&&(x=!1):x=w(d)),x&&null!=u&&null==v&&("boolean"==typeof u?!u&&c.NodeView.isNodeView(y)&&(x=!1):x=w(u)),x&&null!=f&&s){let e=s.cell,t="source"===r?o:e.getSource(),i="target"===r?o:e.getTarget(),n=o?this.graph.getCellById(o.cell):null;if(t&&i&&t.cell&&i.cell&&n){if("function"==typeof f)x=w(f);else{let e=this.graph.model.getConnectedEdges(n,{outgoing:"source"===r,incoming:"target"===r});e.length&&("withPort"===f?e.some(e=>{let n=e.getSource(),r=e.getTarget();return n&&r&&n.cell===t.cell&&r.cell===i.cell&&null!=n.port&&n.port===t.port&&null!=r.port&&r.port===i.port;})&&(x=!1):!f&&e.some(e=>{let n=e.getSource(),r=e.getTarget();return n&&r&&n.cell===t.cell&&r.cell===i.cell;})&&(x=!1));}}}return x&&null!=m&&(x=w(m)),x;}allowConnectToBlank(e){let t=this.graph,i=t.options.connecting.allowBlank;if("function"!=typeof i)return!!i;let n=t.findViewByCell(e),r=e.getSourceCell(),s=e.getTargetCell(),o=t.findViewByCell(r),a=t.findViewByCell(s);return l.FunctionExt.call(i,t,{edge:e,edgeView:n,sourceCell:r,targetCell:s,sourceView:o,targetView:a,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:n.sourceMagnet,targetMagnet:n.targetMagnet});}validateEdge(e,t,i){let n=this.graph;if(!this.allowConnectToBlank(e)){let t=e.getSourceCellId(),i=e.getTargetCellId();if(!(t&&i))return!1;}let r=n.options.connecting.validateEdge;return!r||l.FunctionExt.call(r,n,{edge:e,type:t,previous:i});}arrowheadDragging(e,t,i,n){n.x=t,n.y=i,n.currentTarget!==e&&(n.currentMagnet&&n.currentView&&n.currentView.unhighlight(n.currentMagnet,{type:"magnetAdsorbed"}),n.currentView=this.graph.findViewByElem(e),n.currentView?(n.currentMagnet=n.currentView.findMagnet(e),n.currentMagnet&&this.validateConnection(...n.getValidateConnectionArgs(n.currentView,n.currentMagnet),n.currentView.getEdgeTerminal(n.currentMagnet,t,i,this.cell,n.terminalType))?n.currentView.highlight(n.currentMagnet,{type:"magnetAdsorbed"}):n.currentMagnet=null):n.currentMagnet=null),n.currentTarget=e,this.cell.prop(n.terminalType,{x:t,y:i},Object.assign(Object.assign({},n.options),{ui:!0}));}arrowheadDragged(e,t,i){let n=e.currentView,r=e.currentMagnet;if(!r||!n)return;n.unhighlight(r,{type:"magnetAdsorbed"});let s=e.terminalType,o=n.getEdgeTerminal(r,t,i,this.cell,s);this.cell.setTerminal(s,o,{ui:!0});}snapArrowhead(e,t,i){let n,r;let s=this.graph,{snap:l,allowEdge:a}=s.options.connecting,h="object"==typeof l&&l.radius||50,c="object"==typeof l&&l.anchor||"center",u=s.renderer.findViewsInArea({x:e-h,y:t-h,width:2*h,height:2*h},{nodeOnly:!0});if(a){let i=s.renderer.findEdgeViewsFromPoint({x:e,y:t},h).filter(e=>e!==this);u.push(...i);}let g=i.closestView||null,d=i.closestMagnet||null;i.closestView=null,i.closestMagnet=null;let p=Number.MAX_SAFE_INTEGER,f=new o.Point(e,t);u.forEach(r=>{if("false"!==r.container.getAttribute("magnet")){if(r.isNodeView())n="center"===c?r.cell.getBBox().getCenter().distance(f):r.cell.getBBox().getNearestPointToPoint(f).distance(f);else if(r.isEdgeView()){let e=r.getClosestPoint(f);n=e?e.distance(f):Number.MAX_SAFE_INTEGER;}n<h&&n<p&&(d===r.container||this.validateConnection(...i.getValidateConnectionArgs(r,null),r.getEdgeTerminal(r.container,e,t,this.cell,i.terminalType)))&&(p=n,i.closestView=r,i.closestMagnet=r.container);}r.container.querySelectorAll("[magnet]").forEach(s=>{if("false"!==s.getAttribute("magnet")){let o=r.getBBoxOfElement(s);(n=f.distance(o.getCenter()))<h&&n<p&&(d===s||this.validateConnection(...i.getValidateConnectionArgs(r,s),r.getEdgeTerminal(s,e,t,this.cell,i.terminalType)))&&(p=n,i.closestView=r,i.closestMagnet=s);}});});let m=i.terminalType,b=i.closestView,y=i.closestMagnet,v=d!==y;if(g&&v&&g.unhighlight(d,{type:"magnetAdsorbed"}),b){if(!v)return;b.highlight(y,{type:"magnetAdsorbed"}),r=b.getEdgeTerminal(y,e,t,this.cell,m);}else r={x:e,y:t};this.cell.setTerminal(m,r,{},Object.assign(Object.assign({},i.options),{ui:!0}));}snapArrowheadEnd(e){let t=e.closestView,i=e.closestMagnet;t&&i&&(t.unhighlight(i,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(i)),e.closestView=null,e.closestMagnet=null;}finishEmbedding(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null);}fallbackConnection(e){"remove"===e.fallbackAction?this.cell.remove({ui:!0}):this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0});}notifyConnectionEvent(e,t){let i=e.terminalType,n=e.initialTerminal,r=this.cell[i];if(r&&!h.Edge.equalTerminals(n,r)){let s=this.graph,l=n.cell?s.getCellById(n.cell):null,a=n.port,h=l?s.findViewByCell(l):null,c=l||e.isNewEdge?null:o.Point.create(n).toJSON(),u=r.cell?s.getCellById(r.cell):null,g=r.port,d=u?s.findViewByCell(u):null,p=u?null:o.Point.create(r).toJSON();this.notify("edge:connected",{e:t,previousCell:l,previousPort:a,previousView:h,previousPoint:c,currentCell:u,currentView:d,currentPort:g,currentPoint:p,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:i,isNew:e.isNewEdge});}}highlightAvailableMagnets(e){let t=this.graph,i=t.model.getCells();e.marked={};for(let n=0,r=i.length;n<r;n+=1){let r=t.findViewByCell(i[n]);if(!r||r.cell.id===this.cell.id)continue;let s=Array.prototype.slice.call(r.container.querySelectorAll("[magnet]"));"false"!==r.container.getAttribute("magnet")&&s.push(r.container);let o=s.filter(t=>this.validateConnection(...e.getValidateConnectionArgs(r,t),r.getEdgeTerminal(t,e.x,e.y,this.cell,e.terminalType)));if(o.length>0){for(let e=0,t=o.length;e<t;e+=1)r.highlight(o[e],{type:"magnetAvailable"});r.highlight(null,{type:"nodeAvailable"}),e.marked[r.cell.id]=o;}}}unhighlightAvailableMagnets(e){let t=e.marked||{};Object.keys(t).forEach(e=>{let i=this.graph.findViewByCell(e);i&&(t[e].forEach(e=>{i.unhighlight(e,{type:"magnetAvailable"});}),i.unhighlight(null,{type:"nodeAvailable"}));}),e.marked=null;}startArrowheadDragging(e,t,i){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(e,t,i);return;}let n=e.target.getAttribute("data-terminal"),r=this.prepareArrowheadDragging(n,{x:t,y:i});this.setEventData(e,r);}dragArrowhead(e,t,i){let n=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,i,n):this.arrowheadDragging(this.getEventTarget(e),t,i,n);}stopArrowheadDragging(e,t,i){let n=this.graph,r=this.getEventData(e);n.options.connecting.snap?this.snapArrowheadEnd(r):this.arrowheadDragged(r,t,i),this.validateEdge(this.cell,r.terminalType,r.initialTerminal)?(this.finishEmbedding(r),this.notifyConnectionEvent(r,e)):this.fallbackConnection(r),this.afterArrowheadDragging(r);}startLabelDragging(e,t,i){if(this.can("edgeLabelMovable")){let t=parseInt(e.currentTarget.getAttribute("data-index"),10),i=this.getLabelPositionAngle(t),n=this.getLabelPositionArgs(t),r=this.getDefaultLabelPositionArgs(),s=this.mergeLabelPositionArgs(n,r);this.setEventData(e,{index:t,positionAngle:i,positionArgs:s,stopPropagation:!0,action:"drag-label"});}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this);}dragLabel(e,t,i){let n=this.getEventData(e),r=this.cell.getLabelAt(n.index),s=l.ObjectExt.merge({},r,{position:this.getLabelPosition(t,i,n.positionAngle,n.positionArgs)});this.cell.setLabelAt(n.index,s);}stopLabelDragging(e,t,i){}}(n=g||(g={})).toStringTag=`X6.${n.name}`,n.isEdgeView=function(e){if(null==e)return!1;if(e instanceof n)return!0;let t=e[Symbol.toStringTag];return(null==t||t===n.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate&&"function"==typeof e.update&&"function"==typeof e.getConnection;},g.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),g.registry.register("edge",g,!0),r._(i("43bcb3fd"),t);},cdd29704:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"FlagManager",{enumerable:!0,get:function(){return n;}});class n{get cell(){return this.view.cell;}constructor(e,t,i=[]){this.view=e;let n={},r={},s=0;Object.keys(t).forEach(e=>{let i=t[e];Array.isArray(i)||(i=[i]),i.forEach(t=>{let i=n[t];i||(s+=1,i=n[t]=1<<s),r[e]|=i;});});let o=i;if(Array.isArray(o)||(o=[o]),o.forEach(e=>{n[e]||(s+=1,n[e]=1<<s);}),s>25)throw Error("Maximum number of flags exceeded.");this.flags=n,this.attrs=r,this.bootstrap=i;}getFlag(e){let t=this.flags;return null==t?0:Array.isArray(e)?e.reduce((e,i)=>e|t[i],0):0|t[e];}hasAction(e,t){return e&this.getFlag(t);}removeAction(e,t){return e^e&this.getFlag(t);}getBootstrapFlag(){return this.getFlag(this.bootstrap);}getChangedFlag(){let e=0;return this.attrs&&Object.keys(this.attrs).forEach(t=>{this.cell.hasChanged(t)&&(e|=this.attrs[t]);}),e;}}},dd2b1c2b:function(e,t,i){let n;i.d(t,"__esModule",{value:!0}),i.e(t,{Node:function(){return m;}});var r,s,o,l=i("748e16f0"),a=i("b6be2189"),h=i("4e89343a"),c=i("62fc6309"),u=i("2ad4cd03"),g=i("52023e1d"),d=i("534efe08");class p{constructor(e){this.ports=[],this.groups={},this.init(a.ObjectExt.cloneDeep(e));}getPorts(){return this.ports;}getGroup(e){return null!=e?this.groups[e]:null;}getPortsByGroup(e){return this.ports.filter(t=>t.group===e||null==t.group&&null==e);}getPortsLayoutByGroup(e,t){let i;let n=this.getPortsByGroup(e),r=e?this.getGroup(e):null,s=r?r.position:null,o=s?s.name:null;if(null!=o){let e=d.PortLayout.registry.get(o);if(null==e)return d.PortLayout.registry.onNotFound(o);i=e;}else i=d.PortLayout.presets.left;return i(n.map(e=>e&&e.position&&e.position.args||{}),t,s&&s.args||{}).map((e,i)=>{let r=n[i];return{portLayout:e,portId:r.id,portSize:r.size,portAttrs:r.attrs,labelSize:r.label.size,labelLayout:this.getPortLabelLayout(r,l.Point.create(e.position),t)};});}init(e){let{groups:t,items:i}=e;null!=t&&Object.keys(t).forEach(e=>{this.groups[e]=this.parseGroup(t[e]);}),Array.isArray(i)&&i.forEach(e=>{this.ports.push(this.parsePort(e));});}parseGroup(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)});}parsePort(e){let t=Object.assign({},e),i=this.getGroup(e.group)||{};return t.markup=t.markup||i.markup,t.attrs=a.ObjectExt.merge({},i.attrs,t.attrs),t.position=this.createPosition(i,t),t.label=a.ObjectExt.merge({},i.label,this.getLabel(t)),t.zIndex=this.getZIndex(i,t),t.size=Object.assign(Object.assign({},i.size),t.size),t;}getZIndex(e,t){return"number"==typeof t.zIndex?t.zIndex:"number"==typeof e.zIndex||"auto"===e.zIndex?e.zIndex:"auto";}createPosition(e,t){return a.ObjectExt.merge({name:"left",args:{}},e.position,{args:t.args});}getPortPosition(e,t=!1){if(null==e){if(t)return{name:"left",args:{}};}else{if("string"==typeof e)return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if("object"==typeof e)return e;}return{args:{}};}getPortLabelPosition(e,t=!1){if(null==e){if(t)return{name:"left",args:{}};}else{if("string"==typeof e)return{name:e,args:{}};if("object"==typeof e)return e;}return{args:{}};}getLabel(e,t=!1){let i=e.label||{};return i.position=this.getPortLabelPosition(i.position,t),i;}getPortLabelLayout(e,t,i){let n=e.label.position.name||"left",r=e.label.position.args||{},s=d.PortLabelLayout.registry.get(n)||d.PortLabelLayout.presets.left;return s?s(t,i,r):null;}}var f=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};class m extends u.Cell{get[Symbol.toStringTag](){return m.toStringTag;}constructor(e={}){super(e),this.initPorts();}preprocess(e,t){let{x:i,y:n,width:r,height:s}=e,o=f(e,["x","y","width","height"]);if(null!=i||null!=n){let e=o.position;o.position=Object.assign(Object.assign({},e),{x:null!=i?i:e?e.x:0,y:null!=n?n:e?e.y:0});}if(null!=r||null!=s){let e=o.size;o.size=Object.assign(Object.assign({},e),{width:null!=r?r:e?e.width:0,height:null!=s?s:e?e.height:0});}return super.preprocess(o,t);}isNode(){return!0;}size(e,t,i){return void 0===e?this.getSize():"number"==typeof e?this.setSize(e,t,i):this.setSize(e,t);}getSize(){let e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1};}setSize(e,t,i){return"object"==typeof e?this.resize(e.width,e.height,t):this.resize(e,t,i),this;}resize(e,t,i={}){this.startBatch("resize",i);let n=i.direction;if(n){let r=this.getSize();switch(n){case"left":case"right":t=r.height;break;case"top":case"bottom":e=r.width;}let s={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[n],o=l.Angle.normalize(this.getAngle()||0);i.absolute&&(s+=Math.floor((o+45)/90),s%=4);let a=this.getBBox(),h=(0===s?a.getBottomLeft():1===s?a.getCorner():2===s?a.getTopRight():a.getOrigin()).clone().rotate(-o,a.getCenter()),c=Math.sqrt(e*e+t*t)/2,u=s*Math.PI/2;u+=Math.atan(s%2==0?t/e:e/t),u-=l.Angle.toRad(o);let g=l.Point.fromPolar(c,u,h).clone().translate(-(e/2),-(t/2));this.store.set("size",{width:e,height:t},i),this.setPosition(g.x,g.y,i);}else this.store.set("size",{width:e,height:t},i);return this.stopBatch("resize",i),this;}scale(e,t,i,n={}){let r=this.getBBox().scale(e,t,null==i?void 0:i);return this.startBatch("scale",n),this.setPosition(r.x,r.y,n),this.resize(r.width,r.height,n),this.stopBatch("scale"),this;}position(e,t,i){return"number"==typeof e?this.setPosition(e,t,i):this.getPosition(e);}getPosition(e={}){if(e.relative){let e=this.getParent();if(null!=e&&e.isNode()){let t=this.getPosition(),i=e.getPosition();return{x:t.x-i.x,y:t.y-i.y};}}let t=this.store.get("position");return t?Object.assign({},t):{x:0,y:0};}setPosition(e,t,i={}){let n,r,s;if("object"==typeof e?(n=e.x,r=e.y,s=t||{}):(n=e,r=t,s=i||{}),s.relative){let e=this.getParent();if(null!=e&&e.isNode()){let t=e.getPosition();n+=t.x,r+=t.y;}}if(s.deep){let e=this.getPosition();this.translate(n-e.x,r-e.y,s);}else this.store.set("position",{x:n,y:r},s);return this;}translate(e=0,t=0,i={}){if(0===e&&0===t)return this;i.translateBy=i.translateBy||this.id;let n=this.getPosition();if(null!=i.restrict&&i.translateBy===this.id){let r=this.getBBox({deep:!0}),s=i.restrict,o=n.x-r.x,l=n.y-r.y,a=Math.max(s.x+o,Math.min(s.x+s.width+o-r.width,n.x+e)),h=Math.max(s.y+l,Math.min(s.y+s.height+l-r.height,n.y+t));e=a-n.x,t=h-n.y;}let r={x:n.x+e,y:n.y+t};return i.tx=e,i.ty=t,i.transition?("object"!=typeof i.transition&&(i.transition={}),this.transition("position",r,Object.assign(Object.assign({},i.transition),{interp:a.Interp.object})),this.eachChild(n=>{var r;(null===(r=i.exclude)||void 0===r?void 0:r.includes(n))||n.translate(e,t,i);})):(this.startBatch("translate",i),this.store.set("position",r,i),this.eachChild(n=>{var r;(null===(r=i.exclude)||void 0===r?void 0:r.includes(n))||n.translate(e,t,i);}),this.stopBatch("translate",i)),this;}angle(e,t){return null==e?this.getAngle():this.rotate(e,t);}getAngle(){return this.store.get("angle",0);}rotate(e,t={}){let i=this.getAngle();if(t.center){let n=this.getSize(),r=this.getPosition(),s=this.getBBox().getCenter();s.rotate(i-e,t.center);let o=s.x-n.width/2-r.x,l=s.y-n.height/2-r.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(r.x+o,r.y+l,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate");}else this.store.set("angle",t.absolute?e:(i+e)%360,t);return this;}getBBox(e={}){if(e.deep){let e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),u.Cell.getCellsBBox(e);}return l.Rectangle.fromPositionAndSize(this.getPosition(),this.getSize());}getConnectionPoint(e,t){let i=this.getBBox(),n=i.getCenter(),r=e.getTerminal(t);if(null==r)return n;let s=r.port;if(!s||!this.hasPort(s))return n;let o=this.getPort(s);if(!o||!o.group)return n;let a=this.getPortsPosition(o.group)[s].position,h=l.Point.create(a).translate(i.getOrigin()),c=this.getAngle();return c&&h.rotate(-c,n),h;}fit(e={}){let t=(this.getChildren()||[]).filter(e=>e.isNode());if(0===t.length)return this;this.startBatch("fit-embeds",e),e.deep&&t.forEach(t=>t.fit(e));let{x:i,y:n,width:r,height:s}=u.Cell.getCellsBBox(t),o=a.NumberExt.normalizeSides(e.padding);return i-=o.left,n-=o.top,r+=o.left+o.right,s+=o.bottom+o.top,this.store.set({position:{x:i,y:n},size:{width:r,height:s}},e),this.stopBatch("fit-embeds"),this;}get portContainerMarkup(){return this.getPortContainerMarkup();}set portContainerMarkup(e){this.setPortContainerMarkup(e);}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||c.Markup.getPortContainerMarkup();}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup();}setPortContainerMarkup(e,t={}){return this.store.set("portContainerMarkup",c.Markup.clone(e),t),this;}get portMarkup(){return this.getPortMarkup();}set portMarkup(e){this.setPortMarkup(e);}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||c.Markup.getPortMarkup();}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup();}setPortMarkup(e,t={}){return this.store.set("portMarkup",c.Markup.clone(e),t),this;}get portLabelMarkup(){return this.getPortLabelMarkup();}set portLabelMarkup(e){this.setPortLabelMarkup(e);}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||c.Markup.getPortLabelMarkup();}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup();}setPortLabelMarkup(e,t={}){return this.store.set("portLabelMarkup",c.Markup.clone(e),t),this;}get ports(){let e=this.store.get("ports",{items:[]});return null==e.items&&(e.items=[]),e;}getPorts(){return a.ObjectExt.cloneDeep(this.ports.items);}getPortsByGroup(e){return this.getPorts().filter(t=>t.group===e);}getPort(e){return a.ObjectExt.cloneDeep(this.ports.items.find(t=>t.id&&t.id===e));}getPortAt(e){return this.ports.items[e]||null;}hasPorts(){return this.ports.items.length>0;}hasPort(e){return -1!==this.getPortIndex(e);}getPortIndex(e){let t="string"==typeof e?e:e.id;return null!=t?this.ports.items.findIndex(e=>e.id===t):-1;}getPortsPosition(e){let t=this.getSize();return this.port.getPortsLayoutByGroup(e,new l.Rectangle(0,0,t.width,t.height)).reduce((e,t)=>{let i=t.portLayout;return e[t.portId]={position:Object.assign({},i.position),angle:i.angle||0},e;},{});}getPortProp(e,t){return this.getPropByPath(this.prefixPortPath(e,t));}setPortProp(e,t,i,n){if("string"==typeof t||Array.isArray(t)){let r=this.prefixPortPath(e,t);return this.setPropByPath(r,i,n);}let r=this.prefixPortPath(e);return this.setPropByPath(r,t,i);}removePortProp(e,t,i){return"string"==typeof t||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),i):this.removePropByPath(this.prefixPortPath(e),t);}portProp(e,t,i,n){return null==t?this.getPortProp(e):"string"==typeof t||Array.isArray(t)?2==arguments.length?this.getPortProp(e,t):null==i?this.removePortProp(e,t,n):this.setPortProp(e,t,i,n):this.setPortProp(e,t,i);}prefixPortPath(e,t){let i=this.getPortIndex(e);if(-1===i)throw Error(`Unable to find port with id: "${e}"`);return null==t||""===t?["ports","items",`${i}`]:Array.isArray(t)?["ports","items",`${i}`,...t]:`ports/items/${i}/${t}`;}addPort(e,t){let i=[...this.ports.items];return i.push(e),this.setPropByPath("ports/items",i,t),this;}addPorts(e,t){return this.setPropByPath("ports/items",[...this.ports.items,...e],t),this;}insertPort(e,t,i){let n=[...this.ports.items];return n.splice(e,0,t),this.setPropByPath("ports/items",n,i),this;}removePort(e,t={}){return this.removePortAt(this.getPortIndex(e),t);}removePortAt(e,t={}){if(e>=0){let i=[...this.ports.items];i.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",i,t);}return this;}removePorts(e,t){let i;if(Array.isArray(e)){if(i=t||{},e.length){i.rewrite=!0;let t=[...this.ports.items].filter(t=>!e.some(e=>{let i="string"==typeof e?e:e.id;return t.id===i;}));this.setPropByPath("ports/items",t,i);}}else(i=e||{}).rewrite=!0,this.setPropByPath("ports/items",[],i);return this;}getParsedPorts(){return this.port.getPorts();}getParsedGroups(){return this.port.groups;}getPortsLayoutByGroup(e,t){return this.port.getPortsLayoutByGroup(e,t);}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData();});}processRemovedPort(){let e=this.ports,t={};e.items.forEach(e=>{e.id&&(t[e.id]=!0);});let i={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(e=>{e.id&&!t[e.id]&&(i[e.id]=!0);});let n=this.model;n&&!a.ObjectExt.isEmpty(i)&&(n.getConnectedEdges(this,{incoming:!0}).forEach(e=>{let t=e.getTargetPortId();t&&i[t]&&e.remove();}),n.getConnectedEdges(this,{outgoing:!0}).forEach(e=>{let t=e.getSourcePortId();t&&i[t]&&e.remove();}));}validatePorts(){let e={},t=[];return this.ports.items.forEach(i=>{"object"!=typeof i&&t.push(`Invalid port ${i}.`),null==i.id&&(i.id=this.generatePortId()),e[i.id]&&t.push("Duplicitied port id."),e[i.id]=!0;}),t;}generatePortId(){return a.StringExt.uuid();}updatePortData(){let e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),Error(e.join(" "));let t=this.port?this.port.getPorts():null;this.port=new p(this.ports);let i=this.port.getPorts(),n=t?i.filter(e=>t.find(t=>t.id===e.id)?null:e):[...i],r=t?t.filter(e=>i.find(t=>t.id===e.id)?null:e):[];n.length>0&&this.notify("ports:added",{added:n,cell:this,node:this}),r.length>0&&this.notify("ports:removed",{removed:r,cell:this,node:this});}}m.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},(r=m||(m={})).toStringTag=`X6.${r.name}`,r.isNode=function(e){if(null==e)return!1;if(e instanceof r)return!0;let t=e[Symbol.toStringTag];return(null==t||t===r.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr&&"function"==typeof e.size&&"function"==typeof e.position;},function(e){e.config({propHooks(e){var{ports:t}=e,i=f(e,["ports"]);return t&&(i.ports=Array.isArray(t)?{items:t}:t),i;}});}(m||(m={})),(s=m||(m={})).registry=h.Registry.create({type:"node",process(e,t){if(g.ShareRegistry.exist(e,!0))throw Error(`Node with name '${e}' was registered by anthor Edge`);if("function"==typeof t)return t.config({shape:e}),t;let i=s,{inherit:n}=t,r=f(t,["inherit"]);if(n){if("string"==typeof n){let e=this.get(n);null==e?this.onNotFound(n,"inherited"):i=e;}else i=n;}null==r.constructorName&&(r.constructorName=e);let o=i.define.call(i,r);return o.config({shape:e}),o;}}),g.ShareRegistry.setNodeRegistry(s.registry),o=m||(m={}),n=0,o.define=function(e){var t;let{constructorName:i,overwrite:r}=e,s=f(e,["constructorName","overwrite"]),l=a.ObjectExt.createClass((t=i||s.shape)?a.StringExt.pascalCase(t):(n+=1,`CustomNode${n}`),this);return l.config(s),s.shape&&o.registry.register(s.shape,l,r),l;},o.create=function(e){let t=e.shape||"rect",i=o.registry.get(t);return i?new i(e):o.registry.onNotFound(t);};},ddc650d0:function(e,t,i){function n(e,t){return null!=e?e:t;}function r(e,t){return null!=e&&Number.isFinite(e)?e:t;}function s(e={}){let t=n(e.color,"blue"),i=r(e.width,1),o=r(e.margin,2),l=r(e.opacity,1);return`
    <filter>
      <feFlood flood-color="${t}" flood-opacity="${l}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${o+i}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${o}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim();}function o(e={}){let t=n(e.color,"red"),i=r(e.blur,0),s=r(e.width,1),l=r(e.opacity,1);return`
      <filter>
        <feFlood flood-color="${t}" flood-opacity="${l}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${s}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${i}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim();}function l(e={}){let t=r(e.x,2),i=null!=e.y&&Number.isFinite(e.y)?[t,e.y]:t;return`
    <filter>
      <feGaussianBlur stdDeviation="${i}"/>
    </filter>
  `.trim();}function a(e={}){let t=r(e.dx,0),i=r(e.dy,0),s=n(e.color,"black"),o=r(e.blur,4),l=r(e.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${o}" dx="${t}" dy="${i}" flood-color="${s}" flood-opacity="${l}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${o}" />
         <feOffset dx="${t}" dy="${i}" result="offsetblur" />
         <feFlood flood-color="${s}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${l}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim();}function h(e={}){let t=r(e.amount,1),i=.7152-.7152*(1-t);return`
    <filter>
      <feColorMatrix type="matrix" values="${.2126+.7874*(1-t)} ${i} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${.7152+.2848*(1-t)} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${i} ${.0722+.9278*(1-t)} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim();}function c(e={}){let t=r(e.amount,1);return`
      <filter>
        <feColorMatrix type="matrix" values="${.393+.607*(1-t)} ${.769-.769*(1-t)} ${.189-.189*(1-t)} 0 0 ${.349-.349*(1-t)} ${.686+.314*(1-t)} ${.168-.168*(1-t)} 0 0 ${.272-.272*(1-t)} ${.534-.534*(1-t)} ${.131+.869*(1-t)} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim();}function u(e={}){let t=r(e.amount,1);return`
      <filter>
        <feColorMatrix type="saturate" values="${1-t}"/>
      </filter>
    `.trim();}function g(e={}){let t=r(e.angle,0);return`
      <filter>
        <feColorMatrix type="hueRotate" values="${t}"/>
      </filter>
    `.trim();}function d(e={}){let t=r(e.amount,1),i=1-t;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${t} ${i}"/>
          <feFuncG type="table" tableValues="${t} ${i}"/>
          <feFuncB type="table" tableValues="${t} ${i}"/>
        </feComponentTransfer>
      </filter>
    `.trim();}function p(e={}){let t=r(e.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${t}"/>
        <feFuncG type="linear" slope="${t}"/>
        <feFuncB type="linear" slope="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim();}function f(e={}){let t=r(e.amount,1),i=.5-t/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${t}" intercept="${i}"/>
        <feFuncG type="linear" slope="${t}" intercept="${i}"/>
        <feFuncB type="linear" slope="${t}" intercept="${i}"/>
      </feComponentTransfer>
    </filter>
  `.trim();}i.d(t,"__esModule",{value:!0}),i.e(t,{blur:function(){return l;},brightness:function(){return p;},contrast:function(){return f;},dropShadow:function(){return a;},grayScale:function(){return h;},highlight:function(){return o;},hueRotate:function(){return g;},invert:function(){return d;},outline:function(){return s;},saturate:function(){return u;},sepia:function(){return c;}});},e30b1e39:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{dot:function(){return r;},doubleMesh:function(){return l;},fixedDot:function(){return s;},mesh:function(){return o;}});var n=i("b6be2189");let r={color:"#aaaaaa",thickness:1,markup:"rect",update(e,t){let i=t.thickness*t.sx,r=t.thickness*t.sy;n.Dom.attr(e,{width:i,height:r,rx:i,ry:r,fill:t.color});}},s={color:"#aaaaaa",thickness:1,markup:"rect",update(e,t){let i=t.sx<=1?t.thickness*t.sx:t.thickness;n.Dom.attr(e,{width:i,height:i,rx:i,ry:i,fill:t.color});}},o={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(e,t){let i;let r=t.width,s=t.height,o=t.thickness;i=r-o>=0&&s-o>=0?["M",r,0,"H0 M0 0 V0",s].join(" "):"M 0 0 0 0",n.Dom.attr(e,{d:i,stroke:t.color,"stroke-width":t.thickness});}},l=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(e,t){let i;let r=t.width,s=t.height,o=t.thickness;i=r-o>=0&&s-o>=0?["M",r,0,"H0 M0 0 V0",s].join(" "):"M 0 0 0 0",n.Dom.attr(e,{d:i,stroke:t.color,"stroke-width":t.thickness});}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(e,t){let i;let r=t.factor||1,s=t.width*r,o=t.height*r,l=t.thickness;i=s-l>=0&&o-l>=0?["M",s,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",t.width=s,t.height=o,n.Dom.attr(e,{d:i,stroke:t.color,"stroke-width":t.thickness});}}];},e46b1882:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Util",{enumerable:!0,get:function(){return n;}});var n,r=i("748e16f0"),s=i("b6be2189"),o=i("5e6ef018");!function(e){function t(e,t){let i=s.Dom.createSVGPoint(e.x,e.y).matrixTransform(t);return new r.Point(i.x,i.y);}function i(e,t){let i=s.Dom.createSvgElement("svg").createSVGPoint();i.x=e.x,i.y=e.y;let n=i.matrixTransform(t);i.x=e.x+e.width,i.y=e.y;let o=i.matrixTransform(t);i.x=e.x+e.width,i.y=e.y+e.height;let l=i.matrixTransform(t);i.x=e.x,i.y=e.y+e.height;let a=i.matrixTransform(t),h=Math.min(n.x,o.x,l.x,a.x),c=Math.max(n.x,o.x,l.x,a.x),u=Math.min(n.y,o.y,l.y,a.y),g=Math.max(n.y,o.y,l.y,a.y);return new r.Rectangle(h,u,c-h,g-u);}function n(e,t={}){let o;if(!e.ownerSVGElement||!s.Dom.isSVGGraphicsElement(e)){if(s.Dom.isHTMLElement(e)){let{left:t,top:i,width:n,height:s}=l(e);return new r.Rectangle(t,i,n,s);}return new r.Rectangle(0,0,0,0);}let a=t.target;if(!t.recursive){try{o=e.getBBox();}catch(t){o={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight};}return a?i(o,s.Dom.getTransformToElement(e,a)):r.Rectangle.create(o);}{let t=e.childNodes,i=t.length;if(0===i)return n(e,{target:a});a||(a=e);for(let e=0;e<i;e+=1){let i;let r=t[e];i=0===r.childNodes.length?n(r,{target:a}):n(r,{target:a,recursive:!0}),o=o?o.union(i):i;}return o;}}function l(e){let t=0,i=0,n=0,r=0;if(e){let o=e;for(;o;)t+=o.offsetLeft,i+=o.offsetTop,(o=o.offsetParent)&&(t+=parseInt(s.Dom.getComputedStyle(o,"borderLeft"),10),i+=parseInt(s.Dom.getComputedStyle(o,"borderTop"),10));n=e.offsetWidth,r=e.offsetHeight;}return{left:t,top:i,width:n,height:r};}function a(e){let t=t=>{let i=e.getAttribute(t),n=i?parseFloat(i):0;return Number.isNaN(n)?0:n;};switch(e instanceof SVGElement&&e.nodeName.toLowerCase()){case"rect":return new r.Rectangle(t("x"),t("y"),t("width"),t("height"));case"circle":return new r.Ellipse(t("cx"),t("cy"),t("r"),t("r"));case"ellipse":return new r.Ellipse(t("cx"),t("cy"),t("rx"),t("ry"));case"polyline":{let t=s.Dom.getPointsFromSvgElement(e);return new r.Polyline(t);}case"polygon":{let t=s.Dom.getPointsFromSvgElement(e);return t.length>1&&t.push(t[0]),new r.Polyline(t);}case"path":{let t=e.getAttribute("d");return r.Path.isValid(t)||(t=r.Path.normalize(t)),r.Path.parse(t);}case"line":return new r.Line(t("x1"),t("y1"),t("x2"),t("y2"));}return n(e);}function h(e){if(null==e)return null;let t=e;do{let e=t.tagName;if("string"!=typeof e)return null;if(e=e.toUpperCase(),s.Dom.hasClass(t,"x6-port"))t=t.nextElementSibling;else if("G"===e)t=t.firstElementChild;else if("TITLE"===e)t=t.nextElementSibling;else break;}while(t)return t;}e.normalizeMarker=o.normalize,e.transformPoint=t,e.transformLine=function(e,i){return new r.Line(t(e.start,i),t(e.end,i));},e.transformPolyline=function(e,i){let n=e instanceof r.Polyline?e.points:e;return Array.isArray(n)||(n=[]),new r.Polyline(n.map(e=>t(e,i)));},e.transformRectangle=i,e.bbox=function(e,t,n){let o;let l=e.ownerSVGElement;if(!l)return new r.Rectangle(0,0,0,0);try{o=e.getBBox();}catch(t){o={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight};}return t?r.Rectangle.create(o):i(o,s.Dom.getTransformToElement(e,n||l));},e.getBBox=n,e.getBoundingOffsetRect=l,e.toGeometryShape=a,e.translateAndAutoOrient=function(e,t,i,o){let l=r.Point.create(t),a=r.Point.create(i);o||(o=e instanceof SVGSVGElement?e:e.ownerSVGElement);let h=s.Dom.scale(e);e.setAttribute("transform","");let c=n(e,{target:o}).scale(h.sx,h.sy),u=s.Dom.createSVGTransform();u.setTranslate(-c.x-c.width/2,-c.y-c.height/2);let g=s.Dom.createSVGTransform(),d=l.angleBetween(a,l.clone().translate(1,0));d&&g.setRotate(d,0,0);let p=s.Dom.createSVGTransform(),f=l.clone().move(a,c.width/2);p.setTranslate(2*l.x-f.x,2*l.y-f.y);let m=s.Dom.getTransformToElement(e,o),b=s.Dom.createSVGTransform();b.setMatrix(p.matrix.multiply(g.matrix.multiply(u.matrix.multiply(m.scale(h.sx,h.sy))))),e.setAttribute("transform",s.Dom.matrixToTransformString(b.matrix));},e.findShapeNode=h,e.getBBoxV2=function(e){let t=h(e);if(!s.Dom.isSVGGraphicsElement(t)){if(s.Dom.isHTMLElement(e)){let{left:t,top:i,width:n,height:s}=l(e);return new r.Rectangle(t,i,n,s);}return new r.Rectangle(0,0,0,0);}return a(t).bbox()||r.Rectangle.create();};}(n||(n={}));},ead4bd68:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Graph",{enumerable:!0,get:function(){return T;}});var n,r,s,o,l,a=i("852bbaa9"),h=i("b6be2189"),c=i("748e16f0"),u=i("1287fb66"),g=i("ca3299f3"),d=a._(i("534efe08")),p=i("c549d1e0"),f=i("160b8d0d"),m=i("bced94ad"),b=i("9d7d5df2"),y=i("5f22407e"),v=i("3e9a29ef"),x=i("1c5398ce"),w=i("2b9e5a9c"),P=i("6b556b57"),E=i("698eb945"),C=i("09cd1629"),O=i("f2896f16"),M=i("eb5c11e2"),A=i("8f1bdb3e"),S=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class T extends h.Basecoat{get container(){return this.options.container;}get[Symbol.toStringTag](){return T.toStringTag;}constructor(e){super(),this.installedPlugins=new Set,this.options=m.Options.get(e),this.css=new f.CSSManager(this),this.view=new p.GraphView(this),this.defs=new C.DefsManager(this),this.coord=new O.CoordManager(this),this.transform=new y.TransformManager(this),this.highlight=new M.HighlightManager(this),this.grid=new b.GridManager(this),this.background=new v.BackgroundManager(this),this.options.model?this.model=this.options.model:(this.model=new u.Model,this.model.graph=this),this.renderer=new E.Renderer(this),this.panning=new x.PanningManager(this),this.mousewheel=new w.MouseWheel(this),this.virtualRender=new P.VirtualRenderManager(this),this.size=new A.SizeManager(this);}isNode(e){return e.isNode();}isEdge(e){return e.isEdge();}resetCells(e,t={}){return this.model.resetCells(e,t),this;}clearCells(e={}){return this.model.clear(e),this;}toJSON(e={}){return this.model.toJSON(e);}parseJSON(e){return this.model.parseJSON(e);}fromJSON(e,t={}){return this.model.fromJSON(e,t),this;}getCellById(e){return this.model.getCell(e);}addNode(e,t={}){return this.model.addNode(e,t);}addNodes(e,t={}){return this.addCell(e.map(e=>u.Node.isNode(e)?e:this.createNode(e)),t);}createNode(e){return this.model.createNode(e);}removeNode(e,t={}){return this.model.removeCell(e,t);}addEdge(e,t={}){return this.model.addEdge(e,t);}addEdges(e,t={}){return this.addCell(e.map(e=>u.Edge.isEdge(e)?e:this.createEdge(e)),t);}removeEdge(e,t={}){return this.model.removeCell(e,t);}createEdge(e){return this.model.createEdge(e);}addCell(e,t={}){return this.model.addCell(e,t),this;}removeCell(e,t={}){return this.model.removeCell(e,t);}removeCells(e,t={}){return this.model.removeCells(e,t);}removeConnectedEdges(e,t={}){return this.model.removeConnectedEdges(e,t);}disconnectConnectedEdges(e,t={}){return this.model.disconnectConnectedEdges(e,t),this;}hasCell(e){return this.model.has(e);}getCells(){return this.model.getCells();}getCellCount(){return this.model.total();}getNodes(){return this.model.getNodes();}getEdges(){return this.model.getEdges();}getOutgoingEdges(e){return this.model.getOutgoingEdges(e);}getIncomingEdges(e){return this.model.getIncomingEdges(e);}getConnectedEdges(e,t={}){return this.model.getConnectedEdges(e,t);}getRootNodes(){return this.model.getRoots();}getLeafNodes(){return this.model.getLeafs();}isRootNode(e){return this.model.isRoot(e);}isLeafNode(e){return this.model.isLeaf(e);}getNeighbors(e,t={}){return this.model.getNeighbors(e,t);}isNeighbor(e,t,i={}){return this.model.isNeighbor(e,t,i);}getSuccessors(e,t={}){return this.model.getSuccessors(e,t);}isSuccessor(e,t,i={}){return this.model.isSuccessor(e,t,i);}getPredecessors(e,t={}){return this.model.getPredecessors(e,t);}isPredecessor(e,t,i={}){return this.model.isPredecessor(e,t,i);}getCommonAncestor(...e){return this.model.getCommonAncestor(...e);}getSubGraph(e,t={}){return this.model.getSubGraph(e,t);}cloneSubGraph(e,t={}){return this.model.cloneSubGraph(e,t);}cloneCells(e){return this.model.cloneCells(e);}getNodesFromPoint(e,t){return this.model.getNodesFromPoint(e,t);}getNodesInArea(e,t,i,n,r){return this.model.getNodesInArea(e,t,i,n,r);}getNodesUnderNode(e,t={}){return this.model.getNodesUnderNode(e,t);}searchCell(e,t,i={}){return this.model.search(e,t,i),this;}getShortestPath(e,t,i={}){return this.model.getShortestPath(e,t,i);}getAllCellsBBox(){return this.model.getAllCellsBBox();}getCellsBBox(e,t={}){return this.model.getCellsBBox(e,t);}startBatch(e,t={}){this.model.startBatch(e,t);}stopBatch(e,t={}){this.model.stopBatch(e,t);}batchUpdate(e,t,i){let n="string"==typeof e?e:"update",r="string"==typeof e?t:e,s="function"==typeof t?i:t;this.startBatch(n,s);let o=r();return this.stopBatch(n,s),o;}updateCellId(e,t){return this.model.updateCellId(e,t);}findView(e){return u.Cell.isCell(e)?this.findViewByCell(e):this.findViewByElem(e);}findViews(e){return c.Rectangle.isRectangleLike(e)?this.findViewsInArea(e):c.Point.isPointLike(e)?this.findViewsFromPoint(e):[];}findViewByCell(e){return this.renderer.findViewByCell(e);}findViewByElem(e){return this.renderer.findViewByElem(e);}findViewsFromPoint(e,t){return this.renderer.findViewsFromPoint("number"==typeof e?{x:e,y:t}:e);}findViewsInArea(e,t,i,n,r){let s="number"==typeof e?{x:e,y:t,width:i,height:n}:e,o="number"==typeof e?r:t;return this.renderer.findViewsInArea(s,o);}matrix(e){return void 0===e?this.transform.getMatrix():(this.transform.setMatrix(e),this);}resize(e,t){let i=this.getPlugin("scroller");return i?i.resize(e,t):this.transform.resize(e,t),this;}scale(e,t=e,i=0,n=0){return void 0===e?this.transform.getScale():(this.transform.scale(e,t,i,n),this);}zoom(e,t){let i=this.getPlugin("scroller");if(i){if(void 0===e)return i.zoom();i.zoom(e,t);}else{if(void 0===e)return this.transform.getZoom();this.transform.zoom(e,t);}return this;}zoomTo(e,t={}){let i=this.getPlugin("scroller");return i?i.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this;}zoomToRect(e,t={}){let i=this.getPlugin("scroller");return i?i.zoomToRect(e,t):this.transform.zoomToRect(e,t),this;}zoomToFit(e={}){let t=this.getPlugin("scroller");return t?t.zoomToFit(e):this.transform.zoomToFit(e),this;}rotate(e,t,i){return void 0===e?this.transform.getRotation():(this.transform.rotate(e,t,i),this);}translate(e,t){return void 0===e?this.transform.getTranslation():(this.transform.translate(e,t),this);}translateBy(e,t){let i=this.translate(),n=i.tx+e,r=i.ty+t;return this.translate(n,r);}getGraphArea(){return this.transform.getGraphArea();}getContentArea(e={}){return this.transform.getContentArea(e);}getContentBBox(e={}){return this.transform.getContentBBox(e);}fitToContent(e,t,i,n){return this.transform.fitToContent(e,t,i,n);}scaleContentToFit(e={}){return this.transform.scaleContentToFit(e),this;}center(e){return this.centerPoint(e);}centerPoint(e,t,i){let n=this.getPlugin("scroller");return n?n.centerPoint(e,t,i):this.transform.centerPoint(e,t),this;}centerContent(e){let t=this.getPlugin("scroller");return t?t.centerContent(e):this.transform.centerContent(e),this;}centerCell(e,t){let i=this.getPlugin("scroller");return i?i.centerCell(e,t):this.transform.centerCell(e),this;}positionPoint(e,t,i,n={}){let r=this.getPlugin("scroller");return r?r.positionPoint(e,t,i,n):this.transform.positionPoint(e,t,i),this;}positionRect(e,t,i){let n=this.getPlugin("scroller");return n?n.positionRect(e,t,i):this.transform.positionRect(e,t),this;}positionCell(e,t,i){let n=this.getPlugin("scroller");return n?n.positionCell(e,t,i):this.transform.positionCell(e,t),this;}positionContent(e,t){let i=this.getPlugin("scroller");return i?i.positionContent(e,t):this.transform.positionContent(e,t),this;}snapToGrid(e,t){return this.coord.snapToGrid(e,t);}pageToLocal(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.pageToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.pageToLocalRect(e,t,i,n):this.coord.pageToLocalPoint(e,t);}localToPage(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.localToPageRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.localToPageRect(e,t,i,n):this.coord.localToPagePoint(e,t);}clientToLocal(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.clientToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.clientToLocalRect(e,t,i,n):this.coord.clientToLocalPoint(e,t);}localToClient(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.localToClientRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.localToClientRect(e,t,i,n):this.coord.localToClientPoint(e,t);}localToGraph(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.localToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.localToGraphRect(e,t,i,n):this.coord.localToGraphPoint(e,t);}graphToLocal(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.graphToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.graphToLocalRect(e,t,i,n):this.coord.graphToLocalPoint(e,t);}clientToGraph(e,t,i,n){return c.Rectangle.isRectangleLike(e)?this.coord.clientToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof i&&"number"==typeof n?this.coord.clientToGraphRect(e,t,i,n):this.coord.clientToGraphPoint(e,t);}defineFilter(e){return this.defs.filter(e);}defineGradient(e){return this.defs.gradient(e);}defineMarker(e){return this.defs.marker(e);}getGridSize(){return this.grid.getGridSize();}setGridSize(e){return this.grid.setGridSize(e),this;}showGrid(){return this.grid.show(),this;}hideGrid(){return this.grid.hide(),this;}clearGrid(){return this.grid.clear(),this;}drawGrid(e){return this.grid.draw(e),this;}updateBackground(){return this.background.update(),this;}drawBackground(e,t){let i=this.getPlugin("scroller");return null==i||null!=this.options.background&&t?this.background.draw(e):i.drawBackground(e,t),this;}clearBackground(e){let t=this.getPlugin("scroller");return null==t||null!=this.options.background&&e?this.background.clear():t.clearBackground(e),this;}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this;}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this;}isMouseWheelEnabled(){return!this.mousewheel.disabled;}enableMouseWheel(){return this.mousewheel.enable(),this;}disableMouseWheel(){return this.mousewheel.disable(),this;}toggleMouseWheel(e){return null==e?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this;}isPannable(){let e=this.getPlugin("scroller");return e?e.isPannable():this.panning.pannable;}enablePanning(){let e=this.getPlugin("scroller");return e?e.enablePanning():this.panning.enablePanning(),this;}disablePanning(){let e=this.getPlugin("scroller");return e?e.disablePanning():this.panning.disablePanning(),this;}togglePanning(e){return null==e?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this;}use(e,...t){return this.installedPlugins.has(e)||(this.installedPlugins.add(e),e.init(this,...t)),this;}getPlugin(e){return Array.from(this.installedPlugins).find(t=>t.name===e);}getPlugins(e){return Array.from(this.installedPlugins).filter(t=>e.includes(t.name));}enablePlugins(e){let t=e;Array.isArray(t)||(t=[t]);let i=this.getPlugins(t);return null==i||i.forEach(e=>{var t;null===(t=null==e?void 0:e.enable)||void 0===t||t.call(e);}),this;}disablePlugins(e){let t=e;Array.isArray(t)||(t=[t]);let i=this.getPlugins(t);return null==i||i.forEach(e=>{var t;null===(t=null==e?void 0:e.disable)||void 0===t||t.call(e);}),this;}isPluginEnabled(e){var t;let i=this.getPlugin(e);return null===(t=null==i?void 0:i.isEnabled)||void 0===t?void 0:t.call(i);}disposePlugins(e){let t=e;Array.isArray(t)||(t=[t]);let i=this.getPlugins(t);return null==i||i.forEach(e=>{e.dispose(),this.installedPlugins.delete(e);}),this;}dispose(e=!0){e&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach(e=>{e.dispose();});}}S([h.Basecoat.dispose()],T.prototype,"dispose",null),(n=T||(T={})).View=p.GraphView,n.Renderer=E.Renderer,n.MouseWheel=w.MouseWheel,n.DefsManager=C.DefsManager,n.GridManager=b.GridManager,n.CoordManager=O.CoordManager,n.TransformManager=y.TransformManager,n.HighlightManager=M.HighlightManager,n.BackgroundManager=v.BackgroundManager,n.PanningManager=x.PanningManager,(r=T||(T={})).toStringTag=`X6.${r.name}`,r.isGraph=function(e){if(null==e)return!1;if(e instanceof r)return!0;let t=e[Symbol.toStringTag];return null==t||t===r.toStringTag;},(s=T||(T={})).render=function(e,t){let i=e instanceof HTMLElement?new s({container:e}):new s(e);return null!=t&&i.fromJSON(t),i;},(o=T||(T={})).registerNode=u.Node.registry.register,o.registerEdge=u.Edge.registry.register,o.registerView=g.CellView.registry.register,o.registerAttr=d.Attr.registry.register,o.registerGrid=d.Grid.registry.register,o.registerFilter=d.Filter.registry.register,o.registerNodeTool=d.NodeTool.registry.register,o.registerEdgeTool=d.EdgeTool.registry.register,o.registerBackground=d.Background.registry.register,o.registerHighlighter=d.Highlighter.registry.register,o.registerPortLayout=d.PortLayout.registry.register,o.registerPortLabelLayout=d.PortLabelLayout.registry.register,o.registerMarker=d.Marker.registry.register,o.registerRouter=d.Router.registry.register,o.registerConnector=d.Connector.registry.register,o.registerAnchor=d.NodeAnchor.registry.register,o.registerEdgeAnchor=d.EdgeAnchor.registry.register,o.registerConnectionPoint=d.ConnectionPoint.registry.register,(l=T||(T={})).unregisterNode=u.Node.registry.unregister,l.unregisterEdge=u.Edge.registry.unregister,l.unregisterView=g.CellView.registry.unregister,l.unregisterAttr=d.Attr.registry.unregister,l.unregisterGrid=d.Grid.registry.unregister,l.unregisterFilter=d.Filter.registry.unregister,l.unregisterNodeTool=d.NodeTool.registry.unregister,l.unregisterEdgeTool=d.EdgeTool.registry.unregister,l.unregisterBackground=d.Background.registry.unregister,l.unregisterHighlighter=d.Highlighter.registry.unregister,l.unregisterPortLayout=d.PortLayout.registry.unregister,l.unregisterPortLabelLayout=d.PortLabelLayout.registry.unregister,l.unregisterMarker=d.Marker.registry.unregister,l.unregisterRouter=d.Router.registry.unregister,l.unregisterConnector=d.Connector.registry.unregister,l.unregisterAnchor=d.NodeAnchor.registry.unregister,l.unregisterEdgeAnchor=d.EdgeAnchor.registry.unregister,l.unregisterConnectionPoint=d.ConnectionPoint.registry.unregister;},eb5c11e2:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"HighlightManager",{enumerable:!0,get:function(){return l;}});var n=i("b6be2189"),r=i("534efe08"),s=i("a43747d2"),o=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o;};class l extends s.Base{constructor(){super(...arguments),this.highlights={};}init(){this.startListening();}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this);}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this);}onCellHighlight({view:e,magnet:t,options:i={}}){let n=this.resolveHighlighter(i);if(!n)return;let r=this.getHighlighterId(t,n);if(!this.highlights[r]){let i=n.highlighter;i.highlight(e,t,Object.assign({},n.args)),this.highlights[r]={cellView:e,magnet:t,highlighter:i,args:n.args};}}onCellUnhighlight({magnet:e,options:t={}}){let i=this.resolveHighlighter(t);if(!i)return;let n=this.getHighlighterId(e,i);this.unhighlight(n);}resolveHighlighter(e){let t=this.options,i=e.highlighter;if(null==i){let n=e.type;i=n&&t.highlighting[n]||t.highlighting.default;}if(null==i)return null;let n="string"==typeof i?{name:i}:i,s=n.name,o=r.Highlighter.registry.get(s);return null==o?r.Highlighter.registry.onNotFound(s):(r.Highlighter.check(s,o),{name:s,highlighter:o,args:n.args||{}});}getHighlighterId(e,t){return n.Dom.ensureId(e),t.name+e.id+JSON.stringify(t.args);}unhighlight(e){let t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e]);}dispose(){Object.keys(this.highlights).forEach(e=>this.unhighlight(e)),this.stopListening();}}o([l.dispose()],l.prototype,"dispose",null);},ec3adf98:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{EdgeTool:function(){return o;},NodeTool:function(){return s;}});var n,r,s,o,l=i("4e89343a"),a=i("43bcb3fd"),h=i("ae7bd6cb"),c=i("bb114469"),u=i("61636497"),g=i("6dc15b47"),d=i("09a35859"),p=i("6a2f45ae"),f=i("6f5a7fd3"),m=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};(n=s||(s={})).presets={boundary:c.Boundary,button:h.Button,"button-remove":h.Button.Remove,"node-editor":f.CellEditor.NodeEditor},n.registry=l.Registry.create({type:"node tool",process(e,t){if("function"==typeof t)return t;let i=a.ToolsView.ToolItem,{inherit:n}=t,r=m(t,["inherit"]);if(n){let e=this.get(n);null==e?this.onNotFound(n,"inherited"):i=e;}return null==r.name&&(r.name=e),i.define.call(i,r);}}),n.registry.register(n.presets,!0),(r=o||(o={})).presets={boundary:c.Boundary,vertices:u.Vertices,segments:g.Segments,button:h.Button,"button-remove":h.Button.Remove,"source-anchor":d.SourceAnchor,"target-anchor":d.TargetAnchor,"source-arrowhead":p.SourceArrowhead,"target-arrowhead":p.TargetArrowhead,"edge-editor":f.CellEditor.EdgeEditor},r.registry=l.Registry.create({type:"edge tool",process(e,t){if("function"==typeof t)return t;let i=a.ToolsView.ToolItem,{inherit:n}=t,r=m(t,["inherit"]);if(n){let e=this.get(n);null==e?this.onNotFound(n,"inherited"):i=e;}return null==r.name&&(r.name=e),i.define.call(i,r);}}),r.registry.register(r.presets,!0);},ecba20b9:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"Polygon",{enumerable:!0,get:function(){return r;}});var n=i("18b9d6dc");let r=(0,i("a74a56d7").createShape)("polygon",{},{parent:n.Poly});},efbd5273:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{flipX:function(){return n;},flipXY:function(){return s;},flipY:function(){return r;},watermark:function(){return l;}});let n=function(e){let t=document.createElement("canvas"),i=e.width,n=e.height;t.width=2*i,t.height=n;let r=t.getContext("2d");return r.drawImage(e,0,0,i,n),r.translate(2*i,0),r.scale(-1,1),r.drawImage(e,0,0,i,n),t;},r=function(e){let t=document.createElement("canvas"),i=e.width,n=e.height;t.width=i,t.height=2*n;let r=t.getContext("2d");return r.drawImage(e,0,0,i,n),r.translate(0,2*n),r.scale(1,-1),r.drawImage(e,0,0,i,n),t;},s=function(e){let t=document.createElement("canvas"),i=e.width,n=e.height;t.width=2*i,t.height=2*n;let r=t.getContext("2d");return r.drawImage(e,0,0,i,n),r.setTransform(-1,0,0,-1,t.width,t.height),r.drawImage(e,0,0,i,n),r.setTransform(-1,0,0,1,t.width,0),r.drawImage(e,0,0,i,n),r.setTransform(1,0,0,-1,0,t.height),r.drawImage(e,0,0,i,n),t;};var o=i("748e16f0");let l=function(e,t){let i=e.width,n=e.height,r=document.createElement("canvas");r.width=3*i,r.height=3*n;let s=r.getContext("2d"),l=null!=t.angle?-t.angle:-20,a=o.Angle.toRad(l),h=r.width/4,c=r.height/4;for(let t=0;t<4;t+=1)for(let r=0;r<4;r+=1)(t+r)%2>0&&(s.setTransform(1,0,0,1,(2*t-1)*h,(2*r-1)*c),s.rotate(a),s.drawImage(e,-i/2,-n/2,i,n));return r;};},f0b32a9d:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{er:function(){return j;},loop:function(){return B;},manhattan:function(){return T;},metro:function(){return k;},normal:function(){return r;},oneSide:function(){return o;}});var n=i("d1751d7c");let r=function(e){return[...e];};var s=i("b6be2189");let o=function(e,t,i){let n,r,o;let l=t.side||"bottom",a=s.NumberExt.normalizeSides(t.padding||40),h=i.sourceBBox,c=i.targetBBox,u=h.getCenter(),g=c.getCenter();switch(l){case"top":o=-1,n="y",r="height";break;case"left":o=-1,n="x",r="width";break;case"right":o=1,n="x",r="width";break;default:o=1,n="y",r="height";}return u[n]+=o*(h[r]/2+a[l]),g[n]+=o*(c[r]/2+a[l]),o*(u[n]-g[n])>0?g[n]=u[n]:u[n]=g[n],[u.toJSON(),...e,g.toJSON()];};n._(i("f8b16900"),t);var l=i("748e16f0"),a=i("3eaf6b35");class h{constructor(){this.items=[],this.hash={},this.values={};}add(e,t){this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=1,this.values[e]=t;let i=s.ArrayExt.sortedIndexBy(this.items,e,e=>this.values[e]);this.items.splice(i,0,e);}pop(){let e=this.items.shift();return e&&(this.hash[e]=2),e;}isOpen(e){return 1===this.hash[e];}isClose(e){return 2===this.hash[e];}isEmpty(){return 0===this.items.length;}}class c{constructor(e){this.options=e,this.mapGridSize=100,this.map={};}build(e,t){let i=this.options,n=i.excludeTerminals.reduce((i,n)=>{let r=t[n];if(r){let t=e.getCell(r.cell);t&&i.push(t);}return i;},[]),r=[],o=e.getCell(t.getSourceCellId());o&&(r=s.ArrayExt.union(r,o.getAncestors().map(e=>e.id)));let a=e.getCell(t.getTargetCellId());a&&(r=s.ArrayExt.union(r,a.getAncestors().map(e=>e.id)));let h=this.mapGridSize;return e.getNodes().reduce((e,t)=>{let s=n.some(e=>e.id===t.id),o=!!t.shape&&i.excludeShapes.includes(t.shape),a=i.excludeNodes.some(e=>"string"==typeof e?t.id===e:e===t),c=r.includes(t.id);if(t.isVisible()&&!(o||s||a||c)){let n=t.getBBox().moveAndExpand(i.paddingBox),r=n.getOrigin().snapToGrid(h),s=n.getCorner().snapToGrid(h);for(let t=r.x;t<=s.x;t+=h)for(let i=r.y;i<=s.y;i+=h){let r=new l.Point(t,i).toString();null==e[r]&&(e[r]=[]),e[r].push(n);}}return e;},this.map),this;}isAccessible(e){let t=e.clone().snapToGrid(this.mapGridSize).toString(),i=this.map[t];return!i||i.every(t=>!t.containsPoint(e));}}function u(e,t){let i=e.sourceBBox.clone();return t&&t.paddingBox?i.moveAndExpand(t.paddingBox):i;}function g(e,t){let i=e.targetBBox.clone();return t&&t.paddingBox?i.moveAndExpand(t.paddingBox):i;}function d(e,t){return e.sourceAnchor?e.sourceAnchor:u(e,t).getCenter();}function p(e,t){return e.targetAnchor?e.targetAnchor:g(e,t).getCenter();}function f(e,t,i,n,r){let s=360/i,o=e.theta(function(e,t,i,n){let r=n.step,s=t.x-e.x,o=t.y-e.y,a=s/i.x,h=o/i.y;return new l.Point(e.x+a*r,e.y+h*r);}(e,t,n,r)),a=l.Angle.normalize(o+s/2);return s*Math.floor(a/s);}function m(e,t){let i=Math.abs(e-t);return i>180?360-i:i;}function b(e,t){let i=t.step;return t.directions.forEach(t=>{t.gridOffsetX=t.offsetX/i*e.x,t.gridOffsetY=t.offsetY/i*e.y;}),t.directions;}function y(e,t,i){return{source:t.clone(),x:v(i.x-t.x,e),y:v(i.y-t.y,e)};}function v(e,t){if(!e)return t;let i=Math.abs(e),n=Math.round(i/t);return n?t+(i-n*t)/n:i;}function x(e,t){return e.round(t);}function w(e,t,i){return x(function(e,t){let i=t.source,n=l.GeometryUtil.snapToGrid(e.x-i.x,t.x)+i.x,r=l.GeometryUtil.snapToGrid(e.y-i.y,t.y)+i.y;return new l.Point(n,r);}(e.clone(),t),i);}function P(e){return e.toString();}function E(e){return new l.Point(0===e.x?0:Math.abs(e.x)/e.x,0===e.y?0:Math.abs(e.y)/e.y);}function C(e,t){let i=1/0;for(let n=0,r=t.length;n<r;n+=1){let r=e.manhattanDistance(t[n]);r<i&&(i=r);}return i;}function O(e,t,i,n,r){let s=r.precision,o=r.directionMap,a=e.diff(t.getCenter()),h=Object.keys(o).reduce((r,h)=>{if(i.includes(h)){let i;let c=o[h],u=new l.Point(e.x+c.x*(Math.abs(a.x)+t.width),e.y+c.y*(Math.abs(a.y)+t.height)),g=new l.Line(e,u).intersect(t)||[],d=null;for(let t=0;t<g.length;t+=1){let n=g[t],r=e.squaredDistance(n);(null==i||r>i)&&(i=r,d=n);}if(d){let e=w(d,n,s);t.containsPoint(e)&&(e=w(e.translate(c.x*n.x,c.y*n.y),n,s)),r.push(e);}}return r;},[]);return t.containsPoint(e)||h.push(w(e,n,s)),h;}function M(e,t,i,n,r){let s;let o=[],l=E(r.diff(i)),a=P(i),h=e[a];for(;h;){let i=E((s=t[a]).diff(h));i.equals(l)||(o.unshift(s),l=i),h=e[a=P(h)];}let c=t[a];return E(c.diff(n)).equals(l)||o.unshift(c),o;}var A={};i.e(A,{align:function(){return w;},getCost:function(){return C;},getDirectionAngle:function(){return f;},getDirectionChange:function(){return m;},getGrid:function(){return y;},getGridOffsets:function(){return b;},getKey:function(){return P;},getRectPoints:function(){return O;},getSourceBBox:function(){return u;},getSourceEndpoint:function(){return d;},getTargetBBox:function(){return g;},getTargetEndpoint:function(){return p;},normalizePoint:function(){return E;},reconstructRoute:function(){return M;},round:function(){return x;}});let S=function(e,t,i){let n,r;let o=(0,a.resolveOptions)(t),u=A.getSourceBBox(i,o),g=A.getTargetBBox(i,o),d=A.getSourceEndpoint(i,o),p=new c(o).build(i.graph.model,i.cell),f=e.map(e=>l.Point.create(e)),m=[],b=d;for(let t=0,a=f.length;t<=a;t+=1){let a=null;if(n=r||u,null==(r=f[t])){r=g;let e=i.cell;if((null==e.getSourceCellId()||null==e.getTargetCellId())&&"function"==typeof o.draggingRouter){let e=n===u?d:n,t=r.getOrigin();a=s.FunctionExt.call(o.draggingRouter,i,e,t,o);}}if(null==a&&(a=function(e,t,i,n,r){let o,a,c,u;let g=r.precision;o=l.Rectangle.isRectangle(t)?A.round(A.getSourceEndpoint(e,r).clone(),g):A.round(t.clone(),g),a=l.Rectangle.isRectangle(i)?A.round(A.getTargetEndpoint(e,r).clone(),g):A.round(i.clone(),g);let d=A.getGrid(r.step,o,a);if(c=l.Rectangle.isRectangle(t)?A.getRectPoints(o,t,r.startDirections,d,r):[o],u=l.Rectangle.isRectangle(i)?A.getRectPoints(a,i,r.endDirections,d,r):[a],c=c.filter(e=>n.isAccessible(e)),u=u.filter(e=>n.isAccessible(e)),c.length>0&&u.length>0){let e,t;let i=new h,s={},p={},f={};for(let e=0,t=c.length;e<t;e+=1){let t=c[e],n=A.getKey(t);i.add(n,A.getCost(t,u)),s[n]=t,f[n]=0;}let m=r.previousDirectionAngle,b=void 0===m,y=A.getGridOffsets(d,r),v=y.length,x=u.reduce((e,t)=>{let i=A.getKey(t);return e.push(i),e;},[]),w=l.Point.equalPoints(c,u),P=r.maxLoopCount;for(;!i.isEmpty()&&P>0;){let l;let h=i.pop(),c=s[h],E=p[h],C=f[h],O=c.equals(o),M=null==E;if(l=M?b?O?null:A.getDirectionAngle(o,c,v,d,r):m:A.getDirectionAngle(E,c,v,d,r),!(M&&w)&&x.indexOf(h)>=0)return r.previousDirectionAngle=l,A.reconstructRoute(p,s,c,o,a);for(let o=0;o<v;o+=1){let h=(e=y[o]).angle;if(t=A.getDirectionChange(l,h),!(b&&O)&&t>r.maxDirectionChange)continue;let m=A.align(c.clone().translate(e.gridOffsetX||0,e.gridOffsetY||0),d,g),w=A.getKey(m);if(i.isClose(w)||!n.isAccessible(m))continue;if(x.indexOf(w)>=0&&!m.equals(a)){let e=A.getDirectionAngle(m,a,v,d,r);if(A.getDirectionChange(h,e)>r.maxDirectionChange)continue;}let P=C+e.cost+(O?0:r.penalties[t]);(!i.isOpen(w)||P<f[w])&&(s[w]=m,p[w]=c,f[w]=P,i.add(w,P+A.getCost(m,u)));}P-=1;}}return r.fallbackRoute?s.FunctionExt.call(r.fallbackRoute,this,o,a,r):null;}(i,n,r,p,o)),null===a)return console.warn("Unable to execute manhattan algorithm, use orth instead"),s.FunctionExt.call(o.fallbackRouter,this,e,o,i);let c=a[0];c&&c.equals(b)&&a.shift(),b=a[a.length-1]||b,m.push(...a);}return o.snapToGrid?function(e,t=10){if(e.length<=1)return e;for(let i=0,n=e.length;i<n-1;i+=1){let n=e[i],r=e[i+1];if(n.x===r.x){let e=t*Math.round(n.x/t);n.x!==e&&(n.x=e,r.x=e);}else if(n.y===r.y){let e=t*Math.round(n.y/t);n.y!==e&&(n.y=e,r.y=e);}}return e;}(m,i.graph.grid.getGridSize()):m;},T=function(e,t,i){return s.FunctionExt.call(S,this,e,Object.assign(Object.assign({},a.defaults),t),i);},D={maxDirectionChange:45,directions(){let e=(0,a.resolve)(this.step,this),t=(0,a.resolve)(this.cost,this),i=Math.ceil(Math.sqrt(e*e<<1));return[{cost:t,offsetX:e,offsetY:0},{cost:i,offsetX:e,offsetY:e},{cost:t,offsetX:0,offsetY:e},{cost:i,offsetX:-e,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:i,offsetX:-e,offsetY:-e},{cost:t,offsetX:0,offsetY:-e},{cost:i,offsetX:e,offsetY:-e}];},fallbackRoute(e,t,i){let n=e.theta(t),r=[],s={x:t.x,y:e.y},o={x:e.x,y:t.y};if(n%180>90){let e=s;s=o,o=e;}let a=n%90<45?s:o,h=new l.Line(e,a),c=90*Math.ceil(n/90),u=l.Point.fromPolar(h.squaredLength(),l.Angle.toRad(c+135),a),g=new l.Line(t,u),d=h.intersectsWithLine(g),p=d||t,f=d?p:e,m=360/i.directions.length,b=f.theta(t),y=l.Angle.normalize(b+m/2),v=m*Math.floor(y/m);return i.previousDirectionAngle=v,p&&r.push(p.round()),r.push(t),r;}},k=function(e,t,i){return s.FunctionExt.call(T,this,e,Object.assign(Object.assign({},D),t),i);},j=function(e,t,i){let n,r,s;let o=t.offset||32,l=null==t.min?16:t.min,a=0,h=t.direction,c=i.sourceBBox,u=i.targetBBox,g=c.getCenter(),d=u.getCenter();if("number"==typeof o&&(a=o),null==h){let e=u.left-c.right,t=u.top-c.bottom;e>=0&&t>=0?h=e>=t?"L":"T":e<=0&&t>=0?h=(e=c.left-u.right)>=0&&e>=t?"R":"T":e>=0&&t<=0?h=(t=c.top-u.bottom)>=0?e>=t?"L":"B":"L":(e=c.left-u.right,t=c.top-u.bottom,h=e>=0&&t>=0?e>=t?"R":"B":e<=0&&t>=0?"B":e>=0&&t<=0?"R":Math.abs(e)>Math.abs(t)?"R":"B");}"H"===h?h=d.x-g.x>=0?"L":"R":"V"===h&&(h=d.y-g.y>=0?"T":"B"),"center"===o&&("L"===h?a=(u.left-c.right)/2:"R"===h?a=(c.left-u.right)/2:"T"===h?a=(u.top-c.bottom)/2:"B"===h&&(a=(c.top-u.bottom)/2));let p="L"===h||"R"===h;if(p){if(d.y===g.y)return[...e];s="L"===h?1:-1,n="x",r="width";}else{if(d.x===g.x)return[...e];s="T"===h?1:-1,n="y",r="height";}let f=g.clone(),m=d.clone();if(f[n]+=s*(c[r]/2+a),m[n]-=s*(u[r]/2+a),p){let e=f.x,t=m.x,i=c.width/2+l,n=u.width/2+l;d.x>g.x?t<=e&&(f.x=Math.max(t,g.x+i),m.x=Math.min(e,d.x-n)):t>=e&&(f.x=Math.min(t,g.x-i),m.x=Math.max(e,d.x+n));}else{let e=f.y,t=m.y,i=c.height/2+l,n=u.height/2+l;d.y>g.y?t<=e&&(f.y=Math.max(t,g.y+i),m.y=Math.min(e,d.y-n)):t>=e&&(f.y=Math.min(t,g.y-i),m.y=Math.max(e,d.y+n));}return[f.toJSON(),...e,m.toJSON()];};function N(e,t){if(null!=t&&!1!==t){let i="boolean"==typeof t?0:t;if(i>0){let t=l.Point.create(e[1]).move(e[2],i),n=l.Point.create(e[1]).move(e[0],i);return[t.toJSON(),...e,n.toJSON()];}{let t=e[1];return[Object.assign({},t),...e,Object.assign({},t)];}}return e;}let B=function(e,t,i){let n=t.width||50,r=(t.height||80)/2,s=t.angle||"auto",o=i.sourceAnchor,a=i.targetAnchor,h=i.sourceBBox,c=i.targetBBox;if(o.equals(a)){let e=e=>{let t=l.Angle.toRad(e),i=Math.sin(t),s=Math.cos(t),a=new l.Point(o.x+s*n,o.y+i*n),h=new l.Point(a.x-s*r,a.y-i*r),c=h.clone().rotate(-90,a),u=h.clone().rotate(90,a);return[c.toJSON(),a.toJSON(),u.toJSON()];},i=e=>{let t=o.clone().move(e,-1),i=new l.Line(t,e);return!h.containsPoint(e)&&!h.intersectsWithLine(i);},a=[0,90,180,270,45,135,225,315];if("number"==typeof s)return N(e(s),t.merge);let c=h.getCenter();if(c.equals(o))return N(e(0),t.merge);let u=c.angleBetween(o,c.clone().translate(1,0)),g=e(u);if(i(g[1]))return N(g,t.merge);for(let t=1,n=a.length;t<n&&!i((g=e(u+a[t]))[1]);t+=1);return N(g,t.merge);}{let e=new l.Line(o,a),s=e.parallel(-n),u=s.getCenter(),g=s.start.clone().move(s.end,r),d=s.end.clone().move(s.start,r),p=e.parallel(-1),f=new l.Line(p.start,u),m=new l.Line(p.end,u);if((h.containsPoint(u)||c.containsPoint(u)||h.intersectsWithLine(f)||h.intersectsWithLine(m)||c.intersectsWithLine(f)||c.intersectsWithLine(m))&&(u=(s=e.parallel(n)).getCenter(),g=s.start.clone().move(s.end,r),d=s.end.clone().move(s.start,r)),t.merge){let e=new l.Line(o,a),t=new l.Line(u,e.center).setLength(Number.MAX_SAFE_INTEGER),n=h.intersectsWithLine(t),r=c.intersectsWithLine(t),s=n?Array.isArray(n)?n:[n]:[];r&&(Array.isArray(r)?s.push(...r):s.push(r));let g=e.center.closest(s);g?(i.sourceAnchor=g.clone(),i.targetAnchor=g.clone()):(i.sourceAnchor=e.center.clone(),i.targetAnchor=e.center.clone());}return N([g.toJSON(),u.toJSON(),d.toJSON()],t.merge);}};},f10991e6:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0});var n=i("d1751d7c");n._(i("4cb0c19c"),t),n._(i("610a5823"),t),n._(i("c558652a"),t),n._(i("ecba20b9"),t),n._(i("3141582d"),t),n._(i("070d527f"),t),n._(i("f25a416b"),t),n._(i("77e92f7e"),t),n._(i("3ea7afbe"),t),n._(i("6fea0596"),t);},f25a416b:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"TextBlock",{enumerable:!0,get:function(){return l;}});var n=i("b6be2189"),r=i("534efe08"),s=i("c540a28c"),o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i;};let l=s.Base.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},n.Platform.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:n.Dom.ns.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},s.Base.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(e){let{text:t}=e,i=o(e,["text"]);return t&&n.ObjectExt.setByPath(i,"attrs/label/text",t),i;},attrHooks:{text:{set(e,{cell:t,view:i,refBBox:s,elem:o,attrs:l}){if(o instanceof HTMLElement)o.textContent=e;else{let a=l.style||{},h=Object.assign({textVerticalAnchor:"middle"},a),c=r.Attr.presets.textWrap;return n.FunctionExt.call(c.set,this,{text:e,width:-5,height:"100%"},{cell:t,view:i,elem:o,refBBox:s,attrs:h}),{fill:a.color||null};}},position(e,{refBBox:t,elem:i}){if(i instanceof SVGElement)return t.getCenter();}}}});},f2896f16:function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.d(t,"CoordManager",{enumerable:!0,get:function(){return l;}});var n=i("b6be2189"),r=i("748e16f0"),s=i("a43747d2"),o=i("e46b1882");class l extends s.Base{getClientMatrix(){return n.Dom.createSVGMatrix(this.view.stage.getScreenCTM());}getClientOffset(){let e=this.view.svg.getBoundingClientRect();return new r.Point(e.left,e.top);}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY);}snapToGrid(e,t){return("number"==typeof e?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize());}localToGraphPoint(e,t){let i=r.Point.create(e,t);return o.Util.transformPoint(i,this.graph.matrix());}localToClientPoint(e,t){let i=r.Point.create(e,t);return o.Util.transformPoint(i,this.getClientMatrix());}localToPagePoint(e,t){return("number"==typeof e?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset());}localToGraphRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n);return o.Util.transformRectangle(s,this.graph.matrix());}localToClientRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n);return o.Util.transformRectangle(s,this.getClientMatrix());}localToPageRect(e,t,i,n){return("number"==typeof e?this.localToGraphRect(e,t,i,n):this.localToGraphRect(e)).translate(this.getPageOffset());}graphToLocalPoint(e,t){let i=r.Point.create(e,t);return o.Util.transformPoint(i,this.graph.matrix().inverse());}clientToLocalPoint(e,t){let i=r.Point.create(e,t);return o.Util.transformPoint(i,this.getClientMatrix().inverse());}clientToGraphPoint(e,t){let i=r.Point.create(e,t);return o.Util.transformPoint(i,this.graph.matrix().multiply(this.getClientMatrix().inverse()));}pageToLocalPoint(e,t){let i=r.Point.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(i);}graphToLocalRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n);return o.Util.transformRectangle(s,this.graph.matrix().inverse());}clientToLocalRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n);return o.Util.transformRectangle(s,this.getClientMatrix().inverse());}clientToGraphRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n);return o.Util.transformRectangle(s,this.graph.matrix().multiply(this.getClientMatrix().inverse()));}pageToLocalRect(e,t,i,n){let s=r.Rectangle.create(e,t,i,n),o=this.getPageOffset();return s.x-=o.x,s.y-=o.y,this.graphToLocalRect(s);}}},f77d0316:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{bottom:function(){return c;},inside:function(){return d;},insideOriented:function(){return p;},left:function(){return l;},manual:function(){return o;},outside:function(){return u;},outsideOriented:function(){return g;},radial:function(){return v;},radialOriented:function(){return x;},right:function(){return a;},top:function(){return h;}});var n=i("b6be2189");let r={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function s(e,t){let{x:i,y:s,angle:o,attrs:l}=t||{};return n.ObjectExt.defaultsDeep({},{angle:o,attrs:l,position:{x:i,y:s}},e,r);}let o=(e,t,i)=>s({position:t.getTopLeft()},i),l=(e,t,i)=>s({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},i),a=(e,t,i)=>s({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},i),h=(e,t,i)=>s({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},i),c=(e,t,i)=>s({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},i),u=(e,t,i)=>f(e,t,!1,i),g=(e,t,i)=>f(e,t,!0,i),d=(e,t,i)=>m(e,t,!1,i),p=(e,t,i)=>m(e,t,!0,i);function f(e,t,i,n){let r,o,l,a;let h=null!=n.offset?n.offset:15,c=t.getCenter().theta(e),u=b(t),g=0;return c<u[1]||c>u[2]?(r=".3em",o=h,l=0,a="start"):c<u[0]?(r="0",o=0,l=-h,i?(g=-90,a="start"):a="middle"):c<u[3]?(r=".3em",o=-h,l=0,a="end"):(r=".6em",o=0,l=h,i?(g=90,a="start"):a="middle"),s({position:{x:Math.round(o),y:Math.round(l)},angle:g,attrs:{".":{y:r,"text-anchor":a}}},n);}function m(e,t,i,n){let r,o,l,a;let h=null!=n.offset?n.offset:15,c=t.getCenter().theta(e),u=b(t),g=0;return c<u[1]||c>u[2]?(r=".3em",o=-h,l=0,a="end"):c<u[0]?(r=".6em",o=0,l=h,i?(g=90,a="start"):a="middle"):c<u[3]?(r=".3em",o=h,l=0,a="start"):(r="0em",o=0,l=-h,i?(g=-90,a="start"):a="middle"),s({position:{x:Math.round(o),y:Math.round(l)},angle:g,attrs:{".":{y:r,"text-anchor":a}}},n);}function b(e){let t=e.getCenter(),i=t.theta(e.getTopLeft()),n=t.theta(e.getBottomLeft()),r=t.theta(e.getBottomRight());return[i,t.theta(e.getTopRight()),r,n];}var y=i("748e16f0");let v=(e,t,i)=>w(e.diff(t.getCenter()),!1,i),x=(e,t,i)=>w(e.diff(t.getCenter()),!0,i);function w(e,t,i){let n;let r=null!=i.offset?i.offset:20,o=new y.Point(0,0),l=-e.theta(o),a=e.clone().move(o,r).diff(e).round(),h=".3em",c=l;return(l+90)%180==0?(n=t?"end":"middle",t||-270!==l||(h="0em")):l>-270&&l<-90?(n="start",c=l-180):n="end",s({position:a.round().toJSON(),angle:t?c:0,attrs:{".":{y:h,"text-anchor":n}}},i);}},f8b16900:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{orth:function(){return d;}});var n,r=i("b6be2189"),s=i("748e16f0");function o(e){return new s.Rectangle(e.x,e.y,0,0);}function l(e={}){let t=r.NumberExt.normalizeSides(e.padding||20);return{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom};}function a(e,t={}){return e.sourceBBox.clone().moveAndExpand(l(t));}function h(e,t={}){return e.targetBBox.clone().moveAndExpand(l(t));}function c(e,t={}){return e.sourceAnchor?e.sourceAnchor:a(e,t).getCenter();}function u(e,t={}){return e.targetAnchor?e.targetAnchor:h(e,t).getCenter();}var g={};i.e(g,{getPaddingBox:function(){return l;},getPointBBox:function(){return o;},getSourceAnchor:function(){return c;},getSourceBBox:function(){return a;},getTargetAnchor:function(){return u;},getTargetBBox:function(){return h;}});let d=function(e,t,i){let r=g.getSourceBBox(i,t),o=g.getTargetBBox(i,t),l=g.getSourceAnchor(i,t),a=g.getTargetAnchor(i,t);r=r.union(g.getPointBBox(l)),o=o.union(g.getPointBBox(a));let h=e.map(e=>s.Point.create(e));h.unshift(l),h.push(a);let c=null,u=[];for(let e=0,i=h.length-1;e<i;e+=1){let s=null,l=h[e],a=h[e+1],d=null!=n.getBearing(l,a);if(0===e)e+1===i?r.intersectsWithRect(o.clone().inflate(1))?s=n.insideNode(l,a,r,o):d||(s=n.nodeToNode(l,a,r,o)):r.containsPoint(a)?s=n.insideNode(l,a,r,g.getPointBBox(a).moveAndExpand(g.getPaddingBox(t))):d||(s=n.nodeToVertex(l,a,r));else if(e+1===i){let e=d&&n.getBearing(a,l)===c;o.containsPoint(l)||e?s=n.insideNode(l,a,g.getPointBBox(l).moveAndExpand(g.getPaddingBox(t)),o,c):d||(s=n.vertexToNode(l,a,o,c));}else d||(s=n.vertexToVertex(l,a,c));s?(u.push(...s.points),c=s.direction):c=n.getBearing(l,a),e+1<i&&u.push(a);}return u;};!function(e){let t={N:"S",S:"N",E:"W",W:"E"},i={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function n(e,t,i){let n=new s.Point(e.x,t.y);return i.containsPoint(n)&&(n=new s.Point(t.x,e.y)),n;}function o(e,t){return e["W"===t||"E"===t?"width":"height"];}function l(e,t){return e.x===t.x?e.y>t.y?"N":"S":e.y===t.y?e.x>t.x?"W":"E":null;}function a(e,i,n){let r=new s.Point(e.x,i.y),o=new s.Point(i.x,e.y),a=l(e,r),h=l(e,o),c=n?t[n]:null,u=a===n||a!==c&&(h===c||h!==n)?r:o;return{points:[u],direction:l(u,i)};}function h(e,t,i){let r=n(e,t,i);return{points:[r],direction:l(r,t)};}e.getBBoxSize=o,e.getBearing=l,e.vertexToVertex=a,e.nodeToVertex=h,e.vertexToNode=function(e,t,i,a){let h;let c=[new s.Point(e.x,t.y),new s.Point(t.x,e.y)],u=c.filter(e=>!i.containsPoint(e)),g=u.filter(t=>l(t,e)!==a);if(g.length>0)return{points:[h=(h=g.filter(t=>l(e,t)===a).pop())||g[0]],direction:l(h,t)};{h=r.ArrayExt.difference(c,u)[0];let g=s.Point.create(t).move(h,-o(i,a)/2);return{points:[n(g,e,i),g],direction:l(g,t)};}},e.nodeToNode=function(e,t,i,n){let r=h(t,e,n),c=r.points[0];if(i.containsPoint(c)){let u=(r=h(e,t,i)).points[0];if(n.containsPoint(u)){let g=s.Point.create(e).move(u,-o(i,l(e,u))/2),d=s.Point.create(t).move(c,-o(n,l(t,c))/2),p=new s.Line(g,d).getCenter(),f=h(e,p,i),m=a(p,t,f.direction);r.points=[f.points[0],m.points[0]],r.direction=m.direction;}}return r;},e.insideNode=function(e,t,r,o,a){let h,c,u,g;let d=r.union(o).inflate(1),p=d.getCenter(),f=p.distance(t)>p.distance(e),m=f?t:e,b=f?e:t;return a?(h=s.Point.fromPolar(d.width+d.height,i[a],m),h=d.getNearestPointToPoint(h).move(h,-1)):h=d.getNearestPointToPoint(m).move(m,1),c=n(h,b,d),h.round().equals(c.round())?(c=s.Point.fromPolar(d.width+d.height,s.Angle.toRad(h.theta(m))+Math.PI/2,b),u=n(h,c=d.getNearestPointToPoint(c).move(b,1).round(),d),g=f?[c,u,h]:[h,u,c]):g=f?[c,h]:[h,c],{points:g,direction:f?l(h,t):l(c,t)};};}(n||(n={}));}}]);
