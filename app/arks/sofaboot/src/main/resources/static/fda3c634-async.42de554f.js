(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["fda3c634"],{fda3c634:function(e,t,r){"use strict";var s=r("852bbaa9")._;r.d(t,"__esModule",{value:!0}),r.e(t,{SimpleWorkerClient:function(){return y;},SimpleWorkerServer:function(){return b;},create:function(){return q;},logOnceWebWorkerWarning:function(){return _;}});var n=r("852bbaa9"),i=r("0d0a6cfe"),o=r("e793196d"),a=r("77b755a9"),l=r("b1fc2372"),h=r("c83e5ca5"),d=n._(r("246b9c8c"));let c="default",u="$initialize",g=!1;function _(e){h.isWeb&&(g||(g=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(e.message));}class f{constructor(e,t,r,s,n){this.vsWorker=e,this.req=t,this.channel=r,this.method=s,this.args=n,this.type=0;}}class p{constructor(e,t,r,s){this.vsWorker=e,this.seq=t,this.res=r,this.err=s,this.type=1;}}class m{constructor(e,t,r,s,n){this.vsWorker=e,this.req=t,this.channel=r,this.eventName=s,this.arg=n,this.type=2;}}class w{constructor(e,t,r){this.vsWorker=e,this.req=t,this.event=r,this.type=3;}}class v{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4;}}class M{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map;}setWorkerId(e){this._workerId=e;}sendMessage(e,t,r){let s=String(++this._lastSentReq);return new Promise((n,i)=>{this._pendingReplies[s]={resolve:n,reject:i},this._send(new f(this._workerId,s,e,t,r));});}listen(e,t,r){let s=null,n=new o.Emitter({onWillAddFirstListener:()=>{s=String(++this._lastSentReq),this._pendingEmitters.set(s,n),this._send(new m(this._workerId,s,e,t,r));},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(s),this._send(new v(this._workerId,s)),s=null;}});return n.event;}handleMessage(e){e&&e.vsWorker&&(-1===this._workerId||e.vsWorker===this._workerId)&&this._handleMessage(e);}createProxyToRemoteChannel(e,t){return new Proxy(Object.create(null),{get:(r,s)=>("string"!=typeof s||r[s]||(k(s)?r[s]=t=>this.listen(e,s,t):E(s)?r[s]=this.listen(e,s,void 0):36!==s.charCodeAt(0)||(r[s]=async(...r)=>(await (null==t?void 0:t()),this.sendMessage(e,s,r)))),r[s])});}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e);}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return;}let t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let r=e.err;e.err.$isError&&((r=Error()).name=e.err.name,r.message=e.err.message,r.stack=e.err.stack),t.reject(r);return;}t.resolve(e.res);}_handleRequestMessage(e){let t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(e=>{this._send(new p(this._workerId,t,e,void 0));},e=>{e.detail instanceof Error&&(e.detail=(0,i.transformErrorForSerialization)(e.detail)),this._send(new p(this._workerId,t,void 0,(0,i.transformErrorForSerialization)(e)));});}_handleSubscribeEventMessage(e){let t=e.req,r=this._handler.handleEvent(e.channel,e.eventName,e.arg)(e=>{this._send(new w(this._workerId,t,e));});this._pendingEvents.set(t,r);}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return;}this._pendingEmitters.get(e.req).fire(e.event);}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return;}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req);}_send(e){let t=[];if(0===e.type)for(let r=0;r<e.args.length;r++)e.args[r]instanceof ArrayBuffer&&t.push(e.args[r]);else 1===e.type&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t);}}class y extends a.Disposable{constructor(e,t){super(),this._localChannels=new Map,this._worker=this._register(e.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:t.esmModuleLocation,label:t.label},e=>{this._protocol.handleMessage(e);},e=>{(0,i.onUnexpectedError)(e);})),this._protocol=new M({sendMessage:(e,t)=>{this._worker.postMessage(e,t);},handleMessage:(e,t,r)=>this._handleMessage(e,t,r),handleEvent:(e,t,r)=>this._handleEvent(e,t,r)}),this._protocol.setWorkerId(this._worker.getId());let r=null,s=globalThis.require;void 0!==s&&"function"==typeof s.getConfig?r=s.getConfig():void 0!==globalThis.requirejs&&(r=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(c,u,[this._worker.getId(),JSON.parse(JSON.stringify(r)),t.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(c,async()=>{await this._onModuleLoaded;}),this._onModuleLoaded.catch(e=>{this._onError("Worker failed to load "+t.amdModuleId,e);});}_handleMessage(e,t,r){let s=this._localChannels.get(e);if(!s)return Promise.reject(Error(`Missing channel ${e} on main thread`));if("function"!=typeof s[t])return Promise.reject(Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(s[t].apply(s,r));}catch(e){return Promise.reject(e);}}_handleEvent(e,t,r){let s=this._localChannels.get(e);if(!s)throw Error(`Missing channel ${e} on main thread`);if(k(t)){let n=s[t].call(s,r);if("function"!=typeof n)throw Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return n;}if(E(t)){let r=s[t];if("function"!=typeof r)throw Error(`Missing event ${t} on main thread channel ${e}.`);return r;}throw Error(`Malformed event name ${t}`);}setChannel(e,t){this._localChannels.set(e,t);}_onError(e,t){console.error(e),console.info(t);}}function E(e){return"o"===e[0]&&"n"===e[1]&&d.isUpperAsciiLetter(e.charCodeAt(2));}function k(e){return/^onDynamic/.test(e)&&d.isUpperAsciiLetter(e.charCodeAt(9));}class b{constructor(e,t){this._localChannels=new Map,this._remoteChannels=new Map,this._requestHandlerFactory=t,this._requestHandler=null,this._protocol=new M({sendMessage:(t,r)=>{e(t,r);},handleMessage:(e,t,r)=>this._handleMessage(e,t,r),handleEvent:(e,t,r)=>this._handleEvent(e,t,r)});}onmessage(e){this._protocol.handleMessage(e);}_handleMessage(e,t,r){if(e===c&&t===u)return this.initialize(r[0],r[1],r[2]);let s=e===c?this._requestHandler:this._localChannels.get(e);if(!s)return Promise.reject(Error(`Missing channel ${e} on worker thread`));if("function"!=typeof s[t])return Promise.reject(Error(`Missing method ${t} on worker thread channel ${e}`));try{return Promise.resolve(s[t].apply(s,r));}catch(e){return Promise.reject(e);}}_handleEvent(e,t,r){let s=e===c?this._requestHandler:this._localChannels.get(e);if(!s)throw Error(`Missing channel ${e} on worker thread`);if(k(t)){let e=s[t].call(s,r);if("function"!=typeof e)throw Error(`Missing dynamic event ${t} on request handler.`);return e;}if(E(t)){let e=s[t];if("function"!=typeof e)throw Error(`Missing event ${t} on request handler.`);return e;}throw Error(`Malformed event name ${t}`);}getChannel(e){if(!this._remoteChannels.has(e)){let t=this._protocol.createProxyToRemoteChannel(e);this._remoteChannels.set(e,t);}return this._remoteChannels.get(e);}async initialize(e,t,n){if(this._protocol.setWorkerId(e),this._requestHandlerFactory){this._requestHandler=this._requestHandlerFactory(this);return;}t&&(void 0!==t.baseUrl&&delete t.baseUrl,void 0!==t.paths&&void 0!==t.paths.vs&&delete t.paths.vs,void 0!==t.trustedTypesPolicy&&delete t.trustedTypesPolicy,t.catchError=!0,globalThis.require.config(t));{let e=l.FileAccess.asBrowserUri(`${n}.js`).toString(!0);return Promise.all([r.ensure("605fd315")]).then(r.dr(s,r.bind(r,"605fd315"))).then(t=>t.default(`./${e}`)).then(e=>{if(this._requestHandler=e.create(this),!this._requestHandler)throw Error("No RequestHandler!");});}}}function q(e){return new b(e,null);}}}]);
