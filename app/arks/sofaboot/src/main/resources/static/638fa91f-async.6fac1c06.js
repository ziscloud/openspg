(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["638fa91f"],{"638fa91f":function(e,t,i){"use strict";i.d(t,"__esModule",{value:!0}),i.e(t,{ILanguageFeatureDebounceService:function(){return _;},LanguageFeatureDebounceService:function(){return m;}});var a,r=i("96875aa5"),n=i("c6bdbcd6"),s=i("0841d709"),l=i("d27182b7"),o=i("ad8563a1"),u=i("2aa5bed3"),c=i("9bfcb0cf"),h=i("b1fc2372"),d=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s;},f=this&&this.__param||function(e,t){return function(i,a){t(i,a,e);};};let _=(0,u.createDecorator)("ILanguageFeatureDebounceService");!function(e){let t=new WeakMap,i=0;e.of=function(e){let a=t.get(e);return void 0===a&&(a=++i,t.set(e,a)),a;};}(a||(a={}));class g{constructor(e){this._default=e;}get(e){return this._default;}update(e,t){return this._default;}default(){return this._default;}}class v{constructor(e,t,i,a,r,s){this._logService=e,this._name=t,this._registry=i,this._default=a,this._min=r,this._max=s,this._cache=new n.LRUCache(50,.7);}_key(e){return e.id+this._registry.all(e).reduce((e,t)=>(0,r.doHash)(a.of(t),e),0);}get(e){let t=this._key(e),i=this._cache.get(t);return i?(0,s.clamp)(i.value,this._min,this._max):this.default();}update(e,t){let i=this._key(e),a=this._cache.get(i);a||(a=new s.SlidingWindowAverage(6),this._cache.set(i,a));let r=(0,s.clamp)(a.update(t),this._min,this._max);return(0,h.matchesScheme)(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r;}_overall(){let e=new s.MovingAverage;for(let[,t]of this._cache)e.update(t.value);return e.value;}default(){let e=0|this._overall()||this._default;return(0,s.clamp)(e,this._min,this._max);}}let m=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt;}for(e,t,i){let r=(null==i?void 0:i.min)??50,n=(null==i?void 0:i.max)??r**2,s=(null==i?void 0:i.key)??void 0,l=`${a.of(e)},${r}${s?","+s:""}`,o=this._data.get(l);return o||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),o=new g(1.5*r)):o=new v(this._logService,t,e,0|this._overallAverage()||1.5*r,r,n),this._data.set(l,o)),o;}_overallAverage(){let e=new s.MovingAverage;for(let t of this._data.values())e.update(t.default());return e.value;}};m=d([f(0,c.ILogService),f(1,l.IEnvironmentService)],m),(0,o.registerSingleton)(_,m,1);}}]);
