(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["196d2f45"],{"196d2f45":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"SemanticTokensStylingService",{enumerable:!0,get:function(){return _;}});var i=n("77b755a9"),r=n("4dc1b036"),s=n("dd8f73a0"),a=n("9bfcb0cf"),h=n("c6f02569"),o=n("2188434e"),l=n("ad8563a1"),u=this&&this.__decorate||function(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var h=e.length-1;h>=0;h--)(r=e[h])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a;},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e);};};let _=class extends i.Disposable{constructor(e,t,n){super(),this._themeService=e,this._logService=t,this._languageService=n,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap;}));}getStyling(e){return this._caches.has(e)||this._caches.set(e,new h.SemanticTokensProviderStyling(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e);}};_=u([c(0,s.IThemeService),c(1,a.ILogService),c(2,r.ILanguageService)],_),(0,l.registerSingleton)(o.ISemanticTokensStylingService,_,1);},"2188434e":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"ISemanticTokensStylingService",{enumerable:!0,get:function(){return i;}});let i=(0,n("2aa5bed3").createDecorator)("semanticTokensStylingService");},c6f02569:function(e,t,n){n.d(t,"__esModule",{value:!0}),n.e(t,{SemanticTokensProviderStyling:function(){return g;},toMultilineTokens2:function(){return f;}}),n("0cba99d7");var i=n("dd8f73a0"),r=n("9bfcb0cf"),s=n("47118010"),a=n("e7e5ddb3"),h=n("17014ea9");class o{static create(e,t){return new o(e,new l(t));}get startLineNumber(){return this._startLineNumber;}get endLineNumber(){return this._endLineNumber;}constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine();}toString(){return this._tokens.toString(this._startLineNumber);}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine();}isEmpty(){return this._tokens.isEmpty();}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null;}getRange(){let e=this._tokens.getRange();return e?new a.Range(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn):e;}removeTokens(e){let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,n,e.endColumn-1),this._updateEndLineNumber();}split(e){let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber,[i,r,s]=this._tokens.split(t,e.startColumn-1,n,e.endColumn-1);return[new o(this._startLineNumber,i),new o(this._startLineNumber+s,r)];}applyEdit(e,t){let[n,i,r]=(0,h.countEOL)(t);this.acceptEdit(e,n,i,r,t.length>0?t.charCodeAt(0):0);}acceptEdit(e,t,n,i,r){this._acceptDeleteRange(e),this._acceptInsertText(new s.Position(e.startLineNumber,e.startColumn),t,n,i,r),this._updateEndLineNumber();}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let e=n-t;this._startLineNumber-=e;return;}let i=this._tokens.getMaxDeltaLine();if(!(t>=i+1)){if(t<0&&n>=i+1){this._startLineNumber=0,this._tokens.clear();return;}if(t<0){let i=-t;this._startLineNumber-=i,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,n,e.endColumn-1);}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,n,e.endColumn-1);}}_acceptInsertText(e,t,n,i,r){if(0===t&&0===n)return;let s=e.lineNumber-this._startLineNumber;if(s<0){this._startLineNumber+=t;return;}s>=this._tokens.getMaxDeltaLine()+1||this._tokens.acceptInsertText(s,e.column-1,t,n,i,r);}}class l{constructor(e){this._tokens=e,this._tokenCount=e.length/4;}toString(e){let t=[];for(let n=0;n<this._tokenCount;n++)t.push(`(${this._getDeltaLine(n)+e},${this._getStartCharacter(n)}-${this._getEndCharacter(n)})`);return`[${t.join(",")}]`;}getMaxDeltaLine(){let e=this._getTokenCount();return 0===e?-1:this._getDeltaLine(e-1);}getRange(){let e=this._getTokenCount();if(0===e)return null;let t=this._getStartCharacter(0),n=this._getDeltaLine(e-1),i=this._getEndCharacter(e-1);return new a.Range(0,t+1,n,i+1);}_getTokenCount(){return this._tokenCount;}_getDeltaLine(e){return this._tokens[4*e];}_getStartCharacter(e){return this._tokens[4*e+1];}_getEndCharacter(e){return this._tokens[4*e+2];}isEmpty(){return 0===this._getTokenCount();}getLineTokens(e){let t=0,n=this._getTokenCount()-1;for(;t<n;){let i=t+Math.floor((n-t)/2),r=this._getDeltaLine(i);if(r<e)t=i+1;else if(r>e)n=i-1;else{let r=i;for(;r>t&&this._getDeltaLine(r-1)===e;)r--;let s=i;for(;s<n&&this._getDeltaLine(s+1)===e;)s++;return new u(this._tokens.subarray(4*r,4*s+4));}}return this._getDeltaLine(t)===e?new u(this._tokens.subarray(4*t,4*t+4)):null;}clear(){this._tokenCount=0;}removeTokens(e,t,n,i){let r=this._tokens,s=this._tokenCount,a=0,h=!1,o=0;for(let l=0;l<s;l++){let s=4*l,u=r[s],c=r[s+1],_=r[s+2],d=r[s+3];if((u>e||u===e&&_>=t)&&(u<n||u===n&&c<=i))h=!0;else{if(0===a&&(o=u),h){let e=4*a;r[e]=u-o,r[e+1]=c,r[e+2]=_,r[e+3]=d;}a++;}}return this._tokenCount=a,o;}split(e,t,n,i){let r=this._tokens,s=this._tokenCount,a=[],h=[],o=a,u=0,c=0;for(let a=0;a<s;a++){let s=4*a,l=r[s],_=r[s+1],d=r[s+2],g=r[s+3];if(l>e||l===e&&d>=t){if(l<n||l===n&&_<=i)continue;o!==h&&(o=h,u=0,c=l);}o[u++]=l-c,o[u++]=_,o[u++]=d,o[u++]=g;}return[new l(new Uint32Array(a)),new l(new Uint32Array(h)),c];}acceptDeleteRange(e,t,n,i,r){let s=this._tokens,a=this._tokenCount,h=i-t,o=0,l=!1;for(let u=0;u<a;u++){let c=4*u,_=s[c],d=s[c+1],g=s[c+2],f=s[c+3];if(_<t||_===t&&g<=n){o++;continue;}if(_===t&&d<n)_===i&&g>r?g-=r-n:g=n;else if(_===t&&d===n){if(_===i&&g>r)g-=r-n;else{l=!0;continue;}}else if(_<i||_===i&&d<r){if(_===i&&g>r)_=t,g=(d=n)+(g-r);else{l=!0;continue;}}else if(_>i){if(0===h&&!l){o=a;break;}_-=h;}else if(_===i&&d>=r)e&&0===_&&(d+=e,g+=e),_-=h,d-=r-n,g-=r-n;else throw Error("Not possible!");let m=4*o;s[m]=_,s[m+1]=d,s[m+2]=g,s[m+3]=f,o++;}this._tokenCount=o;}acceptInsertText(e,t,n,i,r,s){let a=0===n&&1===i&&(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122),h=this._tokens,o=this._tokenCount;for(let s=0;s<o;s++){let o=4*s,l=h[o],u=h[o+1],c=h[o+2];if(!(l<e)&&(l!==e||!(c<t))){if(l===e&&c===t){if(!a)continue;c+=1;}else if(l===e&&u<t&&t<c)0===n?c+=i:c=t;else{if(l===e&&u===t&&a)continue;if(l===e){if(l+=n,0===n)u+=i,c+=i;else{let e=c-u;c=(u=r+(u-t))+e;}}else l+=n;}h[o]=l,h[o+1]=u,h[o+2]=c;}}}}class u{constructor(e){this._tokens=e;}getCount(){return this._tokens.length/4;}getStartCharacter(e){return this._tokens[4*e+1];}getEndCharacter(e){return this._tokens[4*e+2];}getMetadata(e){return this._tokens[4*e+3];}}var c=n("4dc1b036"),_=this&&this.__decorate||function(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var h=e.length-1;h>=0;h--)(r=e[h])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a;},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e);};};let g=class{constructor(e,t,n,i){this._legend=e,this._themeService=t,this._languageService=n,this._logService=i,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new k;}getMetadata(e,t,n){let i;let r=this._languageService.languageIdCodec.encodeLanguageId(n),s=this._hashTable.get(e,t,r);if(s)i=s.metadata;else{let s=this._legend.tokenTypes[e],a=[];if(s){let e=t;for(let t=0;e>0&&t<this._legend.tokenModifiers.length;t++)1&e&&a.push(this._legend.tokenModifiers[t]),e>>=1;let r=this._themeService.getColorTheme().getTokenStyleMetadata(s,a,n);void 0===r?i=2147483647:(i=0,void 0!==r.italic&&(i|=1|(r.italic?1:0)<<11),void 0!==r.bold&&(i|=2|(r.bold?2:0)<<11),void 0!==r.underline&&(i|=4|(r.underline?4:0)<<11),void 0!==r.strikethrough&&(i|=8|(r.strikethrough?8:0)<<11),r.foreground&&(i|=16|r.foreground<<15),0===i&&(i=2147483647));}else i=2147483647,s="not-in-legend";this._hashTable.add(e,t,r,i);}return i;}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`));}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`));}warnInvalidEditStart(e,t,n,i,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${n}: The provided start offset ${i} is outside the previous data (length ${r}).`));}};function f(e,t,n){let i=e.data,r=e.data.length/5|0,s=Math.max(Math.ceil(r/1024),400),a=[],h=0,l=1,u=0;for(;h<r;){let e=h,c=Math.min(e+s,r);if(c<r){let t=c;for(;t-1>e&&0===i[5*t];)t--;if(t-1===e){let e=c;for(;e+1<r&&0===i[5*e];)e++;c=e;}else c=t;}let _=new Uint32Array((c-e)*4),d=0,g=0,f=0,m=0;for(;h<c;){let e=5*h,r=i[e],s=i[e+1],a=l+r|0,o=0===r?u+s|0:s,c=o+i[e+2]|0,k=i[e+3],L=i[e+4];if(c<=o)t.warnInvalidLengthSemanticTokens(a,o+1);else if(f===a&&m>o)t.warnOverlappingSemanticTokens(a,o+1);else{let e=t.getMetadata(k,L,n);2147483647!==e&&(0===g&&(g=a),_[d]=a-g,_[d+1]=o,_[d+2]=c,_[d+3]=e,d+=4,f=a,m=c);}l=a,u=o,h++;}d!==_.length&&(_=_.subarray(0,d));let k=o.create(g,_);a.push(k);}return a;}g=_([d(1,i.IThemeService),d(2,c.ILanguageService),d(3,r.ILogService)],g);class m{constructor(e,t,n,i){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=n,this.metadata=i,this.next=null;}}class k{static #e=this._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=k._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<k._SIZES.length?2/3*this._currentLength:0),this._elements=[],k._nullOutEntries(this._elements,this._currentLength);}static _nullOutEntries(e,t){for(let n=0;n<t;n++)e[n]=null;}_hash2(e,t){return(e<<5)-e+t|0;}_hashFunc(e,t,n){return this._hash2(this._hash2(e,t),n)%this._currentLength;}get(e,t,n){let i=this._hashFunc(e,t,n),r=this._elements[i];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===n)return r;r=r.next;}return null;}add(e,t,n,i){if(this._elementsCount++,0!==this._growCount&&this._elementsCount>=this._growCount){let e=this._elements;for(let t of(this._currentLengthIndex++,this._currentLength=k._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<k._SIZES.length?2/3*this._currentLength:0),this._elements=[],k._nullOutEntries(this._elements,this._currentLength),e)){let e=t;for(;e;){let t=e.next;e.next=null,this._add(e),e=t;}}}this._add(new m(e,t,n,i));}_add(e){let t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e;}}}}]);
