(self.webpackChunkcognik_web_app=self.webpackChunkcognik_web_app||[]).push([[4005],{60359:function(Xn,dt,_){"use strict";var W=_(55443),M=_(75271),V=_(49385),X=_(58720),Y=function(I,L){return M.createElement(X.Z,(0,W.Z)((0,W.Z)({},I),{},{ref:L,icon:V.Z}))},j=M.forwardRef(Y);dt.Z=j},71417:function(Xn,dt,_){"use strict";_.d(dt,{Z:function(){return I}});var W=_(55443),M=_(75271),V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},X=V,Y=_(58720),j=function(T,C){return M.createElement(Y.Z,(0,W.Z)((0,W.Z)({},T),{},{ref:C,icon:X}))},k=M.forwardRef(j),I=k},24390:function(Xn,dt,_){"use strict";var W=_(55443),M=_(75271),V=_(85928),X=_(58720),Y=function(I,L){return M.createElement(X.Z,(0,W.Z)((0,W.Z)({},I),{},{ref:L,icon:V.Z}))},j=M.forwardRef(Y);dt.Z=j},87146:function(Xn,dt,_){"use strict";_.d(dt,{kJ:function(){return Br}});var W={};_.r(W),_.d(W,{circle:function(){return mf},diamond:function(){return bf},rect:function(){return xf},simple:function(){return Of},triangle:function(){return Ic},triangleRect:function(){return Sf},vee:function(){return Ef}});var M=_(1478),V=_(70373),X=_(54663),Y=_(87314),j=_(48758);const k={duration:500},I={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"},L={CHANGE:"change"};var T;(function(i){i.NodeAdded="NodeAdded",i.NodeUpdated="NodeUpdated",i.NodeRemoved="NodeRemoved",i.EdgeAdded="EdgeAdded",i.EdgeUpdated="EdgeUpdated",i.EdgeRemoved="EdgeRemoved",i.ComboAdded="ComboAdded",i.ComboUpdated="ComboUpdated",i.ComboRemoved="ComboRemoved"})(T||(T={}));var C;(function(i){i.DRAW="draw",i.COLLAPSE="collapse",i.EXPAND="expand",i.TRANSFORM="transform"})(C||(C={}));var R;(function(i){i.CLICK="canvas:click",i.DBLCLICK="canvas:dblclick",i.POINTER_OVER="canvas:pointerover",i.POINTER_LEAVE="canvas:pointerleave",i.POINTER_ENTER="canvas:pointerenter",i.POINTER_MOVE="canvas:pointermove",i.POINTER_OUT="canvas:pointerout",i.POINTER_DOWN="canvas:pointerdown",i.POINTER_UP="canvas:pointerup",i.CONTEXT_MENU="canvas:contextmenu",i.DRAG_START="canvas:dragstart",i.DRAG="canvas:drag",i.DRAG_END="canvas:dragend",i.DRAG_ENTER="canvas:dragenter",i.DRAG_OVER="canvas:dragover",i.DRAG_LEAVE="canvas:dragleave",i.DROP="canvas:drop",i.WHEEL="canvas:wheel"})(R||(R={}));var Z;(function(i){i.CLICK="combo:click",i.DBLCLICK="combo:dblclick",i.POINTER_OVER="combo:pointerover",i.POINTER_LEAVE="combo:pointerleave",i.POINTER_ENTER="combo:pointerenter",i.POINTER_MOVE="combo:pointermove",i.POINTER_OUT="combo:pointerout",i.POINTER_DOWN="combo:pointerdown",i.POINTER_UP="combo:pointerup",i.CONTEXT_MENU="combo:contextmenu",i.DRAG_START="combo:dragstart",i.DRAG="combo:drag",i.DRAG_END="combo:dragend",i.DRAG_ENTER="combo:dragenter",i.DRAG_OVER="combo:dragover",i.DRAG_LEAVE="combo:dragleave",i.DROP="combo:drop"})(Z||(Z={}));var x;(function(i){i.CLICK="click",i.DBLCLICK="dblclick",i.POINTER_OVER="pointerover",i.POINTER_LEAVE="pointerleave",i.POINTER_ENTER="pointerenter",i.POINTER_MOVE="pointermove",i.POINTER_OUT="pointerout",i.POINTER_DOWN="pointerdown",i.POINTER_UP="pointerup",i.CONTEXT_MENU="contextmenu",i.DRAG_START="dragstart",i.DRAG="drag",i.DRAG_END="dragend",i.DRAG_ENTER="dragenter",i.DRAG_OVER="dragover",i.DRAG_LEAVE="dragleave",i.DROP="drop",i.KEY_DOWN="keydown",i.KEY_UP="keyup",i.WHEEL="wheel",i.PINCH="pinch"})(x||(x={}));var rt;(function(i){i.KEY_DOWN="keydown",i.KEY_UP="keyup"})(rt||(rt={}));var wt;(function(i){i.CLICK="edge:click",i.DBLCLICK="edge:dblclick",i.POINTER_OVER="edge:pointerover",i.POINTER_LEAVE="edge:pointerleave",i.POINTER_ENTER="edge:pointerenter",i.POINTER_MOVE="edge:pointermove",i.POINTER_OUT="edge:pointerout",i.POINTER_DOWN="edge:pointerdown",i.POINTER_UP="edge:pointerup",i.CONTEXT_MENU="edge:contextmenu",i.DRAG_ENTER="edge:dragenter",i.DRAG_OVER="edge:dragover",i.DRAG_LEAVE="edge:dragleave",i.DROP="edge:drop"})(wt||(wt={}));var P;(function(i){i.BEFORE_CANVAS_INIT="beforecanvasinit",i.AFTER_CANVAS_INIT="aftercanvasinit",i.BEFORE_SIZE_CHANGE="beforesizechange",i.AFTER_SIZE_CHANGE="aftersizechange",i.BEFORE_ELEMENT_CREATE="beforeelementcreate",i.AFTER_ELEMENT_CREATE="afterelementcreate",i.BEFORE_ELEMENT_UPDATE="beforeelementupdate",i.AFTER_ELEMENT_UPDATE="afterelementupdate",i.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",i.AFTER_ELEMENT_DESTROY="afterelementdestroy",i.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",i.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",i.BEFORE_DRAW="beforedraw",i.AFTER_DRAW="afterdraw",i.BEFORE_RENDER="beforerender",i.AFTER_RENDER="afterrender",i.BEFORE_ANIMATE="beforeanimate",i.AFTER_ANIMATE="afteranimate",i.BEFORE_LAYOUT="beforelayout",i.AFTER_LAYOUT="afterlayout",i.BEFORE_STAGE_LAYOUT="beforestagelayout",i.AFTER_STAGE_LAYOUT="afterstagelayout",i.BEFORE_TRANSFORM="beforetransform",i.AFTER_TRANSFORM="aftertransform",i.BATCH_START="batchstart",i.BATCH_END="batchend",i.BEFORE_DESTROY="beforedestroy",i.AFTER_DESTROY="afterdestroy",i.BEFORE_RENDERER_CHANGE="beforerendererchange",i.AFTER_RENDERER_CHANGE="afterrendererchange"})(P||(P={}));var pt;(function(i){i.UNDO="undo",i.REDO="redo",i.CANCEL="cancel",i.ADD="add",i.CLEAR="clear",i.CHANGE="change"})(pt||(pt={}));var St;(function(i){i.CLICK="node:click",i.DBLCLICK="node:dblclick",i.POINTER_OVER="node:pointerover",i.POINTER_LEAVE="node:pointerleave",i.POINTER_ENTER="node:pointerenter",i.POINTER_MOVE="node:pointermove",i.POINTER_OUT="node:pointerout",i.POINTER_DOWN="node:pointerdown",i.POINTER_UP="node:pointerup",i.CONTEXT_MENU="node:contextmenu",i.DRAG_START="node:dragstart",i.DRAG="node:drag",i.DRAG_END="node:dragend",i.DRAG_ENTER="node:dragenter",i.DRAG_OVER="node:dragover",i.DRAG_LEAVE="node:dragleave",i.DROP="node:drop"})(St||(St={}));const ot="combo",jt="tree";var Le;(function(i){i.NODE="node",i.EDGE="edge",i.COMBO="combo",i.THEME="theme",i.PALETTE="palette",i.LAYOUT="layout",i.BEHAVIOR="behavior",i.PLUGIN="plugin",i.ANIMATION="animation",i.TRANSFORM="transform",i.SHAPE="shape"})(Le||(Le={}));const Oe={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function te(i,t){var e;const n=(e=Oe[i])===null||e===void 0?void 0:e[t];if(n)return n}function B(i){return EXTENSION_REGISTRY[i]}const st="5.0.45",lt="G6";function D(i){return`[${lt} v${st}] ${i}`}const F={mute:!1,debug:i=>{!F.mute&&console.debug(D(i))},info:i=>{!F.mute&&console.info(D(i))},warn:i=>{!F.mute&&console.warn(D(i))},error:i=>{!F.mute&&console.error(D(i))}};function q(i){const{theme:t}=i;if(!t)return{};const e=te(Le.THEME,t);return e||(F.warn(`The theme of ${t} is not registered.`),{})}function K(i,t){if(Array.isArray(i)&&i.length===0)return null;const e=Array.isArray(i)?i[0]:i,n=Array.isArray(i)?i.slice(1):t||[];return new Proxy(e,{get(s,r){return typeof s[r]=="function"&&!["onframe","onfinish"].includes(r)?(...o)=>{s[r](...o),n.forEach(a=>{var c;return(c=a[r])===null||c===void 0?void 0:c.call(a,...o)})}:r==="finished"?Promise.all([e.finished,...n.map(o=>o.finished)]):Reflect.get(s,r)},set(s,r,o){return["onframe","onfinish"].includes(r)||n.forEach(a=>{a[r]=o}),Reflect.set(s,r,o)}})}function ft(i){const t=i.reduce((n,s)=>(Object.entries(s).forEach(([r,o])=>{n[r]===void 0?n[r]=[o]:n[r].push(o)}),n),{});Object.entries(t).forEach(([n,s])=>{(s.length!==i.length||s.some(r=>(0,X.Z)(r))||s.every(r=>!["sourceNode","targetNode","childrenNode"].includes(n)&&(0,Y.Z)(r,s[0])))&&delete t[n]});const e=Object.entries(t).reduce((n,[s,r])=>(r.forEach((o,a)=>{n[a]?n[a][s]=o:n[a]={[s]:o}}),n),[]);return i.length!==0&&e.length===0&&e.push({_:0},{_:0}),e}function ye(i){switch(i){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function Xe(i,t){const{animation:e}=i;if(e===!1||t===!1)return!1;const n=Object.assign({},k);return(0,j.Z)(e)&&Object.assign(n,e),(0,j.Z)(t)&&Object.assign(n,t),n}function Ke(i){if(typeof i=="string"){const t=te(Le.ANIMATION,i);return t||(F.warn(`The animation of ${i} is not registered.`),[])}return i}function Nn(i,t,e,n){var s,r;const{animation:o}=i;if(o===!1||n===!1)return[];const a=(s=i==null?void 0:i[t])===null||s===void 0?void 0:s.animation;if(a===!1)return[];const c=a==null?void 0:a[e];if(c===!1)return[];const l=(r=q(i)[t])===null||r===void 0?void 0:r.animation,d=(u=[])=>Ke(u).map(f=>Object.assign(Object.assign(Object.assign(Object.assign({},I),(0,j.Z)(o)&&o),f),(0,j.Z)(n)&&n));if(c)return d(c);if(!l)return[];const h=l[e];return h===!1?[]:d(h)}var Rt=_(22355);function qe(i,t,e,n=[]){if(!n&&i===0&&t===0&&e===0)return null;if(Array.isArray(n)){let r=-1;const o=[];for(let a=0;a<n.length;a++){const c=n[a];if(c[0]==="translate"){if(c[1]===i&&c[2]===t)return null;r=a,o.push(["translate",i,t])}else if(c[0]==="translate3d"){if(c[1]===i&&c[2]===t&&c[3]===e)return null;r=a,o.push(["translate3d",i,t,e!=null?e:0])}else o.push(c)}return r===-1&&o.splice(0,0,(0,Rt.Z)(e)?["translate3d",i,t,e!=null?e:0]:["translate",i,t]),o.length===0?null:o}const s=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return e===0?`translate(${i}, ${t})${s}`:`translate3d(${i}, ${t}, ${e})${s}`}var Xt=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};const In=(i,t,e)=>{if(!e.length)return null;const[n,s]=t,r=l=>{var d;if(l){const h=i.getShape(l);if(!h)return null;const u=`get${(0,V.Z)(l)}Style`,f=((d=i==null?void 0:i[u])===null||d===void 0?void 0:d.bind(i))||(v=>v),g=(f==null?void 0:f(n))||{},p=(f==null?void 0:f(s))||{};return{shape:h,fromStyle:g,toStyle:p}}else return{shape:i,fromStyle:n,toStyle:s}};let o;const a=e.map(l=>{var{fields:d,shape:h,states:u}=l,f=Xt(l,["fields","shape","states"]);const g=r(h);if(!g)return null;const{shape:p,fromStyle:v,toStyle:y}=g,m=[{},{}];if(d.forEach(E=>{var S,O;Object.assign(m[0],{[E]:(S=v[E])!==null&&S!==void 0?S:ye(E)}),Object.assign(m[1],{[E]:(O=y[E])!==null&&O!==void 0?O:ye(E)})}),m.some(E=>Object.keys(E).some(S=>["x","y","z"].includes(S)))){const{x:E=0,y:S=0,z:O,transform:A=""}=p.attributes||{};m.forEach(N=>{var z,U,J;N.transform=qe((z=N.x)!==null&&z!==void 0?z:E,(U=N.y)!==null&&U!==void 0?U:S,(J=N.z)!==null&&J!==void 0?J:O,A)})}const b=p.animate(ft(m),f);return h===void 0&&(o=b),b}).filter(Boolean),c=o||(a==null?void 0:a[0]);return c?K(c,a.filter(l=>l!==l)):null},on=[{fields:["opacity"]}],ke=[{fields:["x","y"]}],Kn=[{fields:["x","y"]}],Ui=Kn,yi=[{fields:["sourceNode","targetNode"]}],Vr=yi,mi=[{fields:["childrenNode","x","y"]}],Hr=mi,Kt=[{fields:["childrenNode","x","y"]}];var et=_(90079),qn=_(18814),Yr=Object.prototype.hasOwnProperty;function Ur(i,t){if(!t||!(0,qn.Z)(i))return{};for(var e={},n=(0,et.Z)(t)?t:function(a){return a[t]},s,r=0;r<i.length;r++){var o=i[r];s=n(o),Yr.call(e,s)?e[s].push(o):e[s]=[o]}return e}var Qn=Ur,Gi=_(2170),gd=_(12637);function pd(i){return"source"in i&&"target"in i}function vd(i){return i.length===2}function Rv(i){return i.length===3}function Jn(i){return i instanceof Float32Array?!0:Array.isArray(i)&&(i.length===2||i.length===3)?i.every(t=>typeof t=="number"):!1}function Qe(i,t,e){return i>=t&&i<=e}function je(i=0){if(Array.isArray(i)){const[t=0,e=t,n=t,s=e]=i;return[t,e,n,s]}return[i,i,i,i]}function yd(i=0){const t=je(i);return t[0]+t[2]}function kv(i=0){const t=je(i);return t[1]+t[3]}function Je(i){return i.max[0]-i.min[0]}function tn(i){return i.max[1]-i.min[1]}function fn(i){return[Je(i),tn(i)]}function gn(i,t){const e=Jn(i)?Gr(i):i.getShape("key").getBounds();return t?pn(e,t):e}function Gr(i){const[t,e,n=0]=i,s=new M.mN;return s.setMinMax([t,e,n],[t,e,n]),s}function pn(i,t){const[e,n,s,r]=je(t),[o,a,c]=i.min,[l,d,h]=i.max,u=new M.mN;return u.setMinMax([o-r,a-e,c],[l+n,d+s,h]),u}function bi(i){if(i.length===0)return new M.mN;if(i.length===1)return i[0];const t=new M.mN;t.setMinMax(i[0].min,i[0].max);for(let e=1;e<i.length;e++){const n=i[e];t.setMinMax([Math.min(t.min[0],n.min[0]),Math.min(t.min[1],n.min[1]),Math.min(t.min[2],n.min[2])],[Math.max(t.max[0],n.max[0]),Math.max(t.max[1],n.max[1]),Math.max(t.max[2],n.max[2])])}return t}function md(i,t){const[e,n]=i.min,[s,r]=i.max,[o,a]=t.min,[c,l]=t.max;return e>=o&&s<=c&&n>=a&&r<=l}function Be(i,t){return Qe(i[0],t.min[0],t.max[0])&&Qe(i[1],t.min[1],t.max[1])}function aa(i,t,e=!1){const{min:[n,s],max:[r,o]}=t,a=(i[1]===s||i[1]===o)&&(e||Qe(i[0],n,r)),c=(i[0]===n||i[0]===r)&&(e||Qe(i[1],s,o));return a||c}function bd(i,t){return!Be(i,t)}function Xi(i,t){const{center:e}=t;return i[0]===e[0]&&i[1]===e[1]}function Ei(i,t){const[e,n]=i,[s,r]=t.min,[o,a]=t.max,c=e-s,l=o-e,d=n-r,h=a-n,u=Math.min(c,l,d,h);return u===c?"left":u===l?"right":u===d?"top":u===h?"bottom":"left"}function Pn(i,t){const e=(0,gd.Z)(i);if(Be(i,t))switch(Ei(i,t)){case"left":e[0]=t.min[0];break;case"right":e[0]=t.max[0];break;case"top":e[1]=t.min[1];break;case"bottom":e[1]=t.max[1];break}else{const[n,s]=i,[r,o]=t.min,[a,c]=t.max;e[0]=Qe(n,r,a)?n:n<r?r:a,e[1]=Qe(s,o,c)?s:s<o?o:c}return e}function Ed(i,t){const{center:e}=i,[n,s]=fn(i),r=t==="up"||t==="down"?e[0]:t==="right"?e[0]-n/6:e[0]+n/6,o=t==="left"||t==="right"?e[1]:t==="down"?e[1]-s/6:e[1]+s/6;return[r,o]}function xd(i,t){let[e,n]=fn(i);return[e,n]=t==="up"||t==="down"?[e,n]:[n,e],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(e/2,2)+Math.pow(n,2))-e/2,2))/(2*n)}function Sd(i){const{min:[t,e],max:[n,s]}=i,r=[t,s],o=[n,s],a=[n,e],c=[t,e];return[[r,o],[o,a],[a,c],[c,r]]}var Od=function(t,e){var n=t.nodes,s=t.edges,r=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(function(a,c){o[a.id]=c;var l=[];r.push(l)}),s&&s.forEach(function(a){var c=a.source,l=a.target,d=o[c],h=o[l];!d&&d!==0||!h&&h!==0||(r[d][h]=1,e||(r[h][d]=1))}),r},Ki=Od,wd=function(t,e){return t===e},ca=function(){function i(t,e){e===void 0&&(e=null),this.value=t,this.next=e}return i.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},i}(),Cd=function(){function i(t){t===void 0&&(t=wd),this.head=null,this.tail=null,this.compare=t}return i.prototype.prepend=function(t){var e=new ca(t,this.head);return this.head=e,this.tail||(this.tail=e),this},i.prototype.append=function(t){var e=new ca(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},i.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},i.prototype.find=function(t){var e=t.value,n=e===void 0?void 0:e,s=t.callback,r=s===void 0?void 0:s;if(!this.head)return null;for(var o=this.head;o;){if(r&&r(o.value)||n!==void 0&&this.compare(o.value,n))return o;o=o.next}return null},i.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},i.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},i.prototype.fromArray=function(t){var e=this;return t.forEach(function(n){return e.append(n)}),this},i.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},i.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},i.prototype.toString=function(t){return t===void 0&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},i}(),la=Cd,Dd=function(){function i(){this.linkedList=new la}return i.prototype.isEmpty=function(){return!this.linkedList.head},i.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},i.prototype.enqueue=function(t){this.linkedList.append(t)},i.prototype.dequeue=function(){var t=this.linkedList.deleteHead();return t?t.value:null},i.prototype.toString=function(t){return this.linkedList.toString(t)},i}(),Td=Dd,Ne=function(t,e,n){e===void 0&&(e=[]);var s=e.filter(function(c){return c.source===t||c.target===t});if(n==="target"){var r=function(l){return l.source===t};return s.filter(r).map(function(c){return c.target})}if(n==="source"){var o=function(l){return l.target===t};return s.filter(o).map(function(c){return c.source})}var a=function(l){return l.source===t?l.target:l.source};return s.map(a)},Md=function(t,e){return e.filter(function(n){return n.source===t})},qi=function(t,e){return e.filter(function(n){return n.source===t||n.target===t})},da=function(t){t===void 0&&(t=0);var e="".concat(Math.random()).split(".")[1].substr(0,5),n="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(t,"-").concat(e).concat(n)};function Ad(i){i===void 0&&(i={});var t=i,e=function(){},n=function(){var s={};return function(r){var o=r.next,a=o;return s[a]?!1:(s[a]=!0,!0)}}();return t.allowTraversal=i.allowTraversal||n,t.enter=i.enter||e,t.leave=i.leave||e,t}var Ld=function(t,e,n,s){s===void 0&&(s=!0);var r=Ad(n),o=new Td,a=t.edges,c=a===void 0?[]:a;o.enqueue(e);for(var l="",d=function(){var u=o.dequeue();r.enter({current:u,previous:l}),Ne(u,c,s?"target":void 0).forEach(function(f){r.allowTraversal({previous:l,current:u,next:f})&&o.enqueue(f)}),r.leave({current:u,previous:l}),l=u};!o.isEmpty();)d()},Nd=Ld,Id=function(t){for(var e=t.nodes,n=e===void 0?[]:e,s=t.edges,r=s===void 0?[]:s,o=[],a={},c=[],l=function f(g){c.push(g),a[g.id]=!0;for(var p=Ne(g.id,r),v=function(b){var E=p[b];if(!a[E]){var S=n.filter(function(O){return O.id===E});S.length>0&&f(S[0])}},y=0;y<p.length;++y)v(y)},d=0;d<n.length;d++){var h=n[d];if(!a[h.id]){l(h);for(var u=[];c.length>0;)u.push(c.pop());o.push(u)}}return o},ha=function(t){for(var e=t.nodes,n=e===void 0?[]:e,s=t.edges,r=s===void 0?[]:s,o=[],a={},c={},l={},d=[],h=0,u=function v(y){c[y.id]=h,l[y.id]=h,h+=1,o.push(y),a[y.id]=!0;for(var m=Ne(y.id,r,"target").filter(function(A){return n.map(function(N){return N.id}).indexOf(A)>-1}),b=function(N){var z=m[N];if(!c[z]&&c[z]!==0){var U=n.filter(function(J){return J.id===z});U.length>0&&v(U[0]),l[y.id]=Math.min(l[y.id],l[z])}else a[z]&&(l[y.id]=Math.min(l[y.id],c[z]))},E=0;E<m.length;E++)b(E);if(l[y.id]===c[y.id]){for(var S=[];o.length>0;){var O=o.pop();if(a[O.id]=!1,S.push(O),O===y)break}S.length>0&&d.push(S)}},f=0,g=n;f<g.length;f++){var p=g[f];!c[p.id]&&c[p.id]!==0&&u(p)}return d};function ua(i,t){return t?ha(i):Id(i)}var xi=function(t){var e={},n=t.nodes,s=n===void 0?[]:n,r=t.edges,o=r===void 0?[]:r;return s.forEach(function(a){e[a.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(a){e[a.source].degree++,e[a.source].outDegree++,e[a.target].degree++,e[a.target].inDegree++}),e},Xr=xi,Pd=function(t,e){var n=xi(t);return n[e]?xi(t)[e].inDegree:0},_d=function(t,e){var n=xi(t);return n[e]?xi(t)[e].outDegree:0};function Rd(i){i===void 0&&(i={});var t=i,e=function(){},n=function(){var s={};return function(r){var o=r.next;return s[o]?!1:(s[o]=!0,!0)}}();return t.allowTraversal=i.allowTraversal||n,t.enter=i.enter||e,t.leave=i.leave||e,t}function fa(i,t,e,n,s){s===void 0&&(s=!0),n.enter({current:t,previous:e});var r=i.edges,o=r===void 0?[]:r;Ne(t,o,s?"target":void 0).forEach(function(a){n.allowTraversal({previous:e,current:t,next:a})&&fa(i,a,t,n,s)}),n.leave({current:t,previous:e})}function ga(i,t,e,n){n===void 0&&(n=!0),fa(i,t,"",Rd(e),n)}var kd=function(t){var e=null,n=t.nodes,s=n===void 0?[]:n,r={},o={},a={},c={};s.forEach(function(h){o[h.id]=h});for(var l={enter:function(u){var f=u.current,g=u.previous;if(a[f]){e={};for(var p=f,v=g;v!==f;)e[p]=v,p=v,v=r[v];e[p]=v}else a[f]=f,delete o[f],r[f]=g},leave:function(u){var f=u.current;c[f]=f,delete a[f]},allowTraversal:function(u){var f=u.next;return e?!1:!c[f]}};Object.keys(o).length;){var d=Object.keys(o)[0];ga(t,d,l)}return e},pa=function(t,e,n){var s,r;n===void 0&&(n=!0);for(var o=[],a=ua(t,!1),c=0,l=a;c<l.length;c++){var d=l[c];if(d.length)for(var h=d[0],u=h.id,f=[h],g=(s={},s[u]=h,s),p=(r={},r[u]=new Set,r);f.length>0;)for(var v=f.pop(),y=v.id,m=Ne(y,t.edges),b=function(O){var A,N=m[O],z=t.nodes.find(function(ut){return ut.id===N});if(N===y)o.push((A={},A[N]=v,A));else if(!(N in p))g[N]=v,f.push(z),p[N]=new Set([v]);else if(!p[y].has(z)){for(var U=!0,J=[z,v],G=g[y];p[N].size&&!p[N].has(G)&&(J.push(G),G!==g[G.id]);)G=g[G.id];if(J.push(G),e&&n?(U=!1,J.findIndex(function(ut){return e.indexOf(ut.id)>-1})>-1&&(U=!0)):e&&!n&&J.findIndex(function(ut){return e.indexOf(ut.id)>-1})>-1&&(U=!1),U){for(var vt={},ht=1;ht<J.length;ht+=1)vt[J[ht-1].id]=J[ht];J.length&&(vt[J[J.length-1].id]=J[0]),o.push(vt)}p[N].add(v)}},E=0;E<m.length;E+=1)b(E)}return o},va=function(t,e,n){n===void 0&&(n=!0);for(var s=[],r=new Set,o=[],a=[],c={},l={},d=function(G){for(var vt=[G];vt.length>0;){var ht=vt.pop();r.has(ht)&&(r.delete(ht),o[ht.id].forEach(function(ut){vt.push(ut)}),o[ht.id].clear())}},h=function J(G,vt,ht){var ut=!1;if(e&&n===!1&&e.indexOf(G.id)>-1)return ut;s.push(G),r.add(G);for(var yt=ht[G.id],bt=0;bt<yt.length;bt+=1){var Et=c[yt[bt]];if(Et===vt){for(var H={},Q=1;Q<s.length;Q+=1)H[s[Q-1].id]=s[Q];s.length&&(H[s[s.length-1].id]=s[0]),a.push(H),ut=!0}else r.has(Et)||J(Et,vt,ht)&&(ut=!0)}if(ut)d(G);else for(var bt=0;bt<yt.length;bt+=1){var Et=c[yt[bt]];o[Et.id].has(G)||o[Et.id].add(G)}return s.pop(),ut},u=t.nodes,f=u===void 0?[]:u,g=0;g<f.length;g+=1){var p=f[g],v=p.id;l[v]=g,c[g]=p}if(e&&n)for(var y=function(G){var vt=e[G];l[f[G].id]=l[vt],l[vt]=0,c[0]=f.find(function(ht){return ht.id===vt}),c[l[f[G].id]]=f[G]},g=0;g<e.length;g++)y(g);for(var m=function(G){for(var vt,ht,ut=1/0,yt=0;yt<G.length;yt+=1)for(var bt=G[yt],Et=0;Et<bt.length;Et++){var H=l[bt[Et].id];H<ut&&(ut=H,ht=yt)}for(var Q=G[ht],nt=[],yt=0;yt<Q.length;yt+=1){var ct=Q[yt];nt[ct.id]=[];for(var it=0,$t=Ne(ct.id,t.edges,"target").filter(function(Ee){return Q.map(function(fe){return fe.id}).indexOf(Ee)>-1});it<$t.length;it++){var kt=$t[it];kt===ct.id&&!(n===!1&&e.indexOf(ct.id)>-1)?a.push((vt={},vt[ct.id]=ct,vt)):nt[ct.id].push(l[kt])}}return{component:Q,adjList:nt,minIdx:ut}},b=0;b<f.length;){var E=f.filter(function(J){return l[J.id]>=b}),S=ha({nodes:E,edges:t.edges}).filter(function(J){return J.length>1});if(S.length===0)break;var O=m(S),A=O.minIdx,N=O.adjList,z=O.component;if(z.length>1){z.forEach(function(J){o[J.id]=new Set});var U=c[A];if(e&&n&&e.indexOf(U.id)===-1)return a;h(U,U,N),b=A+1}else break}return a},jd=function(t,e,n,s){return s===void 0&&(s=!0),e?va(t,n,s):pa(t,n,s)},ya=kd,$=_(15767),Bd={}.toString,zd=function(i,t){return Bd.call(i)==="[object "+t+"]"},Qi=zd,Kr=function(i){return Qi(i,"Function")},qr=function(i){return Array.isArray?Array.isArray(i):Qi(i,"Array")},Fd=function(i){var t=typeof i;return i!==null&&t==="object"||t==="function"};function $d(i,t){if(i){var e;if(qr(i))for(var n=0,s=i.length;n<s&&(e=t(i[n],n),e!==!1);n++);else if(Fd(i)){for(var r in i)if(i.hasOwnProperty(r)&&(e=t(i[r],r),e===!1))break}}}var ma=$d,jv=Object.keys?function(i){return Object.keys(i)}:function(i){var t=[];return ma(i,function(e,n){Kr(i)&&n==="prototype"||t.push(n)}),t},Bv=null;function zv(i,t){var e=keys(t),n=e.length;if(isNil(i))return!n;for(var s=0;s<n;s+=1){var r=e[s];if(t[r]!==i[r]||!(r in i))return!1}return!0}var Fv=null,$v=function(i){if(!isObjectLike(i)||!isType(i,"Object"))return!1;if(Object.getPrototypeOf(i)===null)return!0;for(var t=i;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(i)===t},Wv=null;function Zv(i,t){if(!isArray(i))return null;var e;if(isFunction(t)&&(e=t),isPlainObject(t)&&(e=function(s){return isMatch(s,t)}),e){for(var n=0;n<i.length;n+=1)if(e(i[n]))return i[n]}return null}var Vv=null,Hv=function(i,t){for(var e=null,n=0;n<i.length;n++){var s=i[n],r=s[t];if(!isNil(r)){isArray(r)?e=r[0]:e=r;break}}return e},Yv=null,Uv=function(i){if(!isArray(i))return[];for(var t=[],e=0;e<i.length;e++)t=t.concat(i[e]);return t},Gv=null,Wd=function(i,t){if(t===void 0&&(t=[]),!isArray(i))t.push(i);else for(var e=0;e<i.length;e+=1)Wd(i[e],t);return t},Xv=null,Kv=function(i){if(isArray(i))return i.reduce(function(t,e){return Math.max(t,e)},i[0])},qv=function(i){if(isArray(i))return i.reduce(function(t,e){return Math.min(t,e)},i[0])},Qv=function(i){var t=i.filter(function(o){return!isNaN(o)});if(!t.length)return{min:0,max:0};if(isArray(i[0])){for(var e=[],n=0;n<i.length;n++)e=e.concat(i[n]);t=e}var s=getMax(t),r=getMin(t);return{min:r,max:s}},Jv=null,ba=Array.prototype,Zd=ba.splice,Vd=ba.indexOf,ty=function(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n++)for(var s=t[n],r=-1;(r=Vd.call(i,s))>-1;)Zd.call(i,r,1);return i},ey=null,Hd=Array.prototype.splice,ny=function(t,e){if(!isArrayLike(t))return[];for(var n=t?e.length:0,s=n-1;n--;){var r=void 0,o=e[n];(n===s||o!==r)&&(r=o,Hd.call(t,o,1))}return t},iy=null,sy=function(i,t,e){if(!isArray(i)&&!isPlainObject(i))return i;var n=e;return each(i,function(s,r){n=t(n,s,r)}),n},ry=null,oy=function(i,t){var e=[];if(!isArrayLike(i))return e;for(var n=-1,s=[],r=i.length;++n<r;){var o=i[n];t(o,n,i)&&(e.push(o),s.push(n))}return pullAt(i,s),e},ay=null,Qr=function(i){return Qi(i,"String")};function cy(i,t){var e;if(isFunction(t))e=function(s,r){return t(s)-t(r)};else{var n=[];isString(t)?n.push(t):isArray(t)&&(n=t),e=function(s,r){for(var o=0;o<n.length;o+=1){var a=n[o];if(s[a]>r[a])return 1;if(s[a]<r[a])return-1}return 0}}return i.sort(e),i}var ly=null;function Jr(i,t){t===void 0&&(t=new Map);var e=[];if(Array.isArray(i))for(var n=0,s=i.length;n<s;n++){var r=i[n];t.has(r)||(e.push(r),t.set(r,!0))}return e}var dy=function(i,t){for(var e=[],n={},s=0;s<i.length;s++){var r=i[s],o=r[t];if(!isNil(o)){isArray(o)||(o=[o]);for(var a=0;a<o.length;a++){var c=o[a];n[c]||(e.push(c),n[c]=!0)}}}return e};function hy(i,t){return isArray(i)||isString(i)?i[0]===t:!1}var uy=null;function fy(i,t){return isArray(i)||isString(i)?i[i.length-1]===t:!1}var gy=null,Yd=Object.prototype.hasOwnProperty;function py(i,t){if(!t||!isArray(i))return{};for(var e={},n=isFunction(t)?t:function(a){return a[t]},s,r=0;r<i.length;r++){var o=i[r];s=n(o),Yd.call(e,s)?e[s].push(o):e[s]=[o]}return e}var vy=null;function yy(i,t){if(!t)return{0:i};if(!isFunction(t)){var e=isArray(t)?t:t.replace(/\s+/g,"").split("*");t=function(n){for(var s="_",r=0,o=e.length;r<o;r++)s+=n[e[r]]&&n[e[r]].toString();return s}}return groupBy(i,t)}var my=function(i,t){if(!t)return[i];var e=groupToMap(i,t),n=[];for(var s in e)n.push(e[s]);return n},Ea={};function by(i){var t=Ea[i];if(!t){for(var e=i.toString(16),n=e.length;n<6;n++)e="0"+e;t="#"+e,Ea[i]=t}return t}var Ey=null;function xy(i){var t=0,e=0,n=0,s=0;return isArray(i)?i.length===1?t=e=n=s=i[0]:i.length===2?(t=n=i[0],e=s=i[1]):i.length===3?(t=i[0],e=s=i[1],n=i[2]):(t=i[0],e=i[1],n=i[2],s=i[3]):t=e=n=s=i,{r1:t,r2:e,r3:n,r4:s}}var Sy=null,Ud=function(i){return Qi(i,"Number")},Gd=Ud,Oy=function(i){return isNumber(i)&&i%1!==0},wy=null,Cy=function(i){return isNumber(i)&&i%2===0},Dy=null,Ty=Number.isInteger?Number.isInteger:function(i){return Gd(i)&&i%1===0},My=null,Ay=function(i){return isNumber(i)&&i<0},Ly=null,Ny=function(i){return isNumber(i)&&i%2!==0},Iy=null,Py=function(i){return isNumber(i)&&i>0},_y=null,Ry=function(i,t){if(isArray(i)){for(var e,n=-1/0,s=0;s<i.length;s++){var r=i[s],o=isFunction(t)?t(r):r[t];o>n&&(e=r,n=o)}return e}},ky=function(i,t){if(isArray(i)){for(var e,n=1/0,s=0;s<i.length;s++){var r=i[s],o=isFunction(t)?t(r):r[t];o<n&&(e=r,n=o)}return e}},Xd=180/Math.PI,jy=function(i){return Xd*i},By=null,Kd=Math.PI/180,zy=function(i){return Kd*i},Fy=null,$y=null,qd=Object.values?function(i){return Object.values(i)}:function(i){var t=[];return ma(i,function(e,n){Kr(i)&&n==="prototype"||t.push(e)}),t},Qd=qd,Wy=function(i,t){return contains(values(i),t)},Jd={}.toString,Zy=function(i){return Jd.call(i).replace(/^\[object /,"").replace(/]$/,"")},Vy=null,Hy=function(i){return isType(i,"Arguments")},Yy=null,Uy=function(i){return isType(i,"Boolean")},Gy=null,Xy=function(i){return isType(i,"Date")},Ky=null,qy=function(i){return isType(i,"Error")},Qy=null;function Jy(i){return isNumber(i)&&isFinite(i)}var th=Object.prototype,tm=function(i){var t=i&&i.constructor,e=typeof t=="function"&&t.prototype||th;return i===e},em=null,nm=function(i){return isType(i,"RegExp")},im=null,sm=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];for(var e=i[0],n=1;n<i.length;n++){var s=i[n];isFunction(s)&&(s=s.prototype),mix(e.prototype,s)}},rm=null,to=function(i){if(typeof i!="object"||i===null)return i;var t;if(qr(i)){t=[];for(var e=0,n=i.length;e<n;e++)typeof i[e]=="object"&&i[e]!=null?t[e]=to(i[e]):t[e]=i[e]}else{t={};for(var s in i)typeof i[s]=="object"&&i[s]!=null?t[s]=to(i[s]):t[s]=i[s]}return t},Si=to,eh=function(i,t){if(!Kr(i))throw new TypeError("Expected a function");var e=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var r=t?t.apply(this,n):n[0],o=e.cache;if(o.has(r))return o.get(r);var a=i.apply(this,n);return o.set(r,a),a};return e.cache=new Map,e},nh=5;function xa(i,t,e,n){e=e||0,n=n||nh;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s];r!==null&&isPlainObject(r)?(isPlainObject(i[s])||(i[s]={}),e<n?xa(i[s],r,e+1,n):i[s]=t[s]):isArray(r)?(i[s]=[],i[s]=i[s].concat(r)):r!==void 0&&(i[s]=r)}}var om=function(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n+=1)xa(i,t[n]);return i},am=null,cm=function(i,t,e,n){isFunction(t)||(e=t,t=i,i=function(){});var s=Object.create?function(o,a){return Object.create(o,{constructor:{value:a}})}:function(o,a){function c(){}c.prototype=o;var l=new c;return l.constructor=a,l},r=s(t.prototype,i);return i.prototype=mix(r,i.prototype),i.superclass=s(t.prototype,t),mix(r,e),mix(i,n),i},lm=null,ih=Object.prototype.hasOwnProperty;function dm(i){if(isNil(i))return!0;if(isArrayLike(i))return!i.length;var t=getType(i);if(t==="Map"||t==="Set")return!i.size;if(isPrototype(i))return!Object.keys(i).length;for(var e in i)if(ih.call(i,e))return!1;return!0}var hm=null,sh=function(i){return typeof i=="object"&&i!==null},Sa=sh,rh=function(i){return i!==null&&typeof i!="function"&&isFinite(i.length)},Oa=rh,eo=function(i,t){if(i===t)return!0;if(!i||!t||Qr(i)||Qr(t))return!1;if(Oa(i)||Oa(t)){if(i.length!==t.length)return!1;for(var e=!0,n=0;n<i.length&&(e=eo(i[n],t[n]),!!e);n++);return e}if(Sa(i)||Sa(t)){var s=Object.keys(i),r=Object.keys(t);if(s.length!==r.length)return!1;for(var e=!0,n=0;n<s.length&&(e=eo(i[s[n]],t[s[n]]),!!e);n++);return e}return!1},oh=eo,um=function(i,t,e){return isFunction(e)?!!e(i,t):isEqual(i,t)},fm=function(i,t,e){for(var n=0,s=isString(t)?t.split("."):t;i&&n<s.length;)i=i[s[n++]];return i===void 0||n<s.length?e:i},gm=function(i,t,e){var n=i,s=isString(t)?t.split("."):t;return s.forEach(function(r,o){o<s.length-1?(isObject(n[r])||(n[r]=isNumber(s[o+1])?[]:{}),n=n[r]):n[r]=e}),i},ah=Object.prototype.hasOwnProperty,pm=function(i,t){if(i===null||!isPlainObject(i))return{};var e={};return each(t,function(n){ah.call(i,n)&&(e[n]=i[n])}),e},vm=function(i,t){return reduce(i,function(e,n,s){return t.includes(s)||(e[s]=n),e},{})},Ji={},ym=function(i){return i=i||"g",Ji[i]?Ji[i]+=1:Ji[i]=1,i+Ji[i]},ts,mm=eh(function(i,t){t===void 0&&(t={});var e=t.fontSize,n=t.fontFamily,s=t.fontWeight,r=t.fontStyle,o=t.fontVariant;return ts||(ts=document.createElement("canvas").getContext("2d")),ts.font=[r,o,s,e+"px",n].join(" "),ts.measureText(Qr(i)?i:"").width},function(i,t){return t===void 0&&(t={}),(0,$.pr)([i],Qd(t)).join("")}),bm=function(i,t,e,n){n===void 0&&(n="...");var s=16,r=measureTextWidth(n,e),o=isString(i)?i:toString(i),a=t,c=[],l,d;if(measureTextWidth(i,e)<=t)return i;for(;l=o.substr(0,s),d=measureTextWidth(l,e),!(d+r>a&&d>a);)if(c.push(l),a-=d,o=o.substr(s),!o)return c.join("");for(;l=o.substr(0,1),d=measureTextWidth(l,e),!(d+r>a);)if(c.push(l),a-=d,o=o.substr(1),!o)return c.join("");return""+c.join("")+n},Em=function(){function i(){this.map={}}return i.prototype.has=function(t){return this.map[t]!==void 0},i.prototype.get=function(t,e){var n=this.map[t];return n===void 0?e:n},i.prototype.set=function(t,e){this.map[t]=e},i.prototype.clear=function(){this.map={}},i.prototype.delete=function(t){delete this.map[t]},i.prototype.size=function(){return Object.keys(this.map).length},i}(),xm=null,ch=function(t,e,n){for(var s=1/0,r,o=0;o<e.length;o++){var a=e[o].id;!n[a]&&t[a]<=s&&(s=t[a],r=e[o])}return r},lh=function(t,e,n,s){var r=t.nodes,o=r===void 0?[]:r,a=t.edges,c=a===void 0?[]:a,l=[],d={},h={},u={};o.forEach(function(b,E){var S=b.id;l.push(S),h[S]=1/0,S===e&&(h[S]=0)});for(var f=o.length,g=function(E){var S=ch(h,o,d),O=S.id;if(d[O]=!0,h[O]===1/0)return"continue";var A=[];n?A=Md(O,c):A=qi(O,c),A.forEach(function(N){var z=N.target,U=N.source,J=z===O?U:z,G=s&&N[s]?N[s]:1;h[J]>h[S.id]+G?(h[J]=h[S.id]+G,u[J]=[S.id]):h[J]===h[S.id]+G&&u[J].push(S.id)})},p=0;p<f;p++)g(p);u[e]=[e];var v={};for(var y in h)h[y]!==1/0&&wa(e,y,u,v);var m={};for(var y in v)m[y]=v[y][0];return{length:h,path:m,allPath:v}},es=lh;function wa(i,t,e,n){if(i===t)return[i];if(n[t])return n[t];for(var s=[],r=0,o=e[t];r<o.length;r++){var a=o[r],c=wa(i,a,e,n);if(!c)return;for(var l=0,d=c;l<d.length;l++){var h=d[l];qr(h)?s.push((0,$.ev)((0,$.ev)([],h,!0),[t],!1)):s.push([h,t])}}return n[t]=s,n[t]}var no=function(t,e,n,s,r){var o=es(t,e,s,r),a=o.length,c=o.path,l=o.allPath;return{length:a[n],path:c[n],allPath:l[n]}},dh=function(t,e,n,s){var r;if(e===n)return[[e]];var o=t.edges,a=o===void 0?[]:o,c=[e],l=(r={},r[e]=!0,r),d=[],h=[],u=s?Ne(e,a,"target"):Ne(e,a);for(d.push(u);c.length>0&&d.length>0;){var f=d[d.length-1];if(f.length){var g=f.shift();g&&(c.push(g),l[g]=!0,u=s?Ne(g,a,"target"):Ne(g,a),d.push(u.filter(function(y){return!l[y]})))}else{var p=c.pop();l[p]=!1,d.pop();continue}if(c[c.length-1]===n){var v=c.map(function(m){return m});h.push(v);var p=c.pop();l[p]=!1,d.pop()}}return h},hh=function(t,e){for(var n=Ki(t,e),s=[],r=n.length,o=0;o<r;o+=1){s[o]=[];for(var a=0;a<r;a+=1)o===a?s[o][a]=0:n[o][a]===0||!n[o][a]?s[o][a]=1/0:s[o][a]=n[o][a]}for(var c=0;c<r;c+=1)for(var o=0;o<r;o+=1)for(var a=0;a<r;a+=1)s[o][a]>s[o][c]+s[c][a]&&(s[o][a]=s[o][c]+s[c][a]);return s},io=hh,uh=function(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n="weight"),s===void 0&&(s=1e3);var r=t.nodes,o=r===void 0?[]:r,a=t.edges,c=a===void 0?[]:a,l={},d={};o.forEach(function(E,S){var O=da();E.clusterId=O,l[O]={id:O,nodes:[E]},d[E.id]={node:E,idx:S}});var h=Ki(t,e),u=[],f={};h.forEach(function(E,S){var O=0,A=o[S].id;f[A]={},E.forEach(function(N,z){if(N){O+=N;var U=o[z].id;f[A][U]=N}}),u.push(O)});for(var g=0,p=function(){var S=!1;if(o.forEach(function(O){var A={};Object.keys(f[O.id]).forEach(function(ut){var yt=f[O.id][ut],bt=d[ut].node,Et=bt.clusterId;A[Et]||(A[Et]=0),A[Et]+=yt});var N=-1/0,z=[];if(Object.keys(A).forEach(function(ut){N<A[ut]?(N=A[ut],z=[ut]):N===A[ut]&&z.push(ut)}),!(z.length===1&&z[0]===O.clusterId)){var U=z.indexOf(O.clusterId);if(U>=0&&z.splice(U,1),z&&z.length){S=!0;var J=l[O.clusterId],G=J.nodes.indexOf(O);J.nodes.splice(G,1);var vt=Math.floor(Math.random()*z.length),ht=l[z[vt]];ht.nodes.push(O),O.clusterId=ht.id}}}),!S)return"break";g++};g<s;){var v=p();if(v==="break")break}Object.keys(l).forEach(function(E){var S=l[E];(!S.nodes||!S.nodes.length)&&delete l[E]});var y=[],m={};c.forEach(function(E){var S=E.source,O=E.target,A=E[n]||1,N=d[S].node.clusterId,z=d[O].node.clusterId,U="".concat(N,"---").concat(z);if(m[U])m[U].weight+=A,m[U].count++;else{var J={source:N,target:z,weight:A,count:1};m[U]=J,y.push(J)}});var b=[];return Object.keys(l).forEach(function(E){b.push(l[E])}),{clusters:b,clusterEdges:y}},fh=uh,gh=function(){function i(t){this.arr=t}return i.prototype.getArr=function(){return this.arr||[]},i.prototype.add=function(t){var e,n=t.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new i(n);if(!(n!=null&&n.length))return new i(this.arr);if(this.arr.length===n.length){var s=[];for(var r in this.arr)s[r]=this.arr[r]+n[r];return new i(s)}},i.prototype.subtract=function(t){var e,n=t.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new i(n);if(!(n!=null&&n.length))return new i(this.arr);if(this.arr.length===n.length){var s=[];for(var r in this.arr)s[r]=this.arr[r]-n[r];return new i(s)}},i.prototype.avg=function(t){var e=[];if(t!==0)for(var n in this.arr)e[n]=this.arr[n]/t;return new i(e)},i.prototype.negate=function(){var t=[];for(var e in this.arr)t[e]=-this.arr[e];return new i(t)},i.prototype.squareEuclideanDistance=function(t){var e,n=t.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(n!=null&&n.length))return 0;if(this.arr.length===n.length){var s=0;for(var r in this.arr)s+=Math.pow(this.arr[r]-t.arr[r],2);return s}},i.prototype.euclideanDistance=function(t){var e,n=t.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(n!=null&&n.length))return 0;if(this.arr.length===n.length){var s=0;for(var r in this.arr)s+=Math.pow(this.arr[r]-t.arr[r],2);return Math.sqrt(s)}else console.error("The two vectors are unequal in length.")},i.prototype.normalize=function(){var t=[],e=Si(this.arr);e.sort(function(o,a){return o-a});var n=e[e.length-1],s=e[0];for(var r in this.arr)t[r]=(this.arr[r]-s)/(n-s);return new i(t)},i.prototype.norm2=function(){var t;if(!(!((t=this.arr)===null||t===void 0)&&t.length))return 0;var e=0;for(var n in this.arr)e+=Math.pow(this.arr[n],2);return Math.sqrt(e)},i.prototype.dot=function(t){var e,n=t.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(n!=null&&n.length))return 0;if(this.arr.length===n.length){var s=0;for(var r in this.arr)s+=this.arr[r]*t.arr[r];return s}else console.error("The two vectors are unequal in length.")},i.prototype.equal=function(t){var e,n=t.arr;if(((e=this.arr)===null||e===void 0?void 0:e.length)!==(n==null?void 0:n.length))return!1;for(var s in this.arr)if(this.arr[s]!==n[s])return!1;return!0},i}(),Ie=gh,ph=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,vh=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,Ca=function(t,e){t===void 0&&(t=[]),e===void 0&&(e=100);var n={};t.forEach(function(r){r.properties&&Object.keys(r.properties).forEach(function(o){if(o==="id"||!"".concat(r.properties[o]).match(ph)&&!"".concat(r.properties[o]).match(vh)&&isNaN(Number(r.properties[o]))){n.hasOwnProperty(o)&&delete n[o];return}n.hasOwnProperty(o)?n[o]+=1:n[o]=1})});var s=Object.keys(n).sort(function(r,o){return n[o]-n[r]});return s.length<e?s:s.slice(0,e)},yh=function(t,e){return e.map(function(n){return t.hasOwnProperty(n)?t[n]:0})},mh=function(t){for(var e=Ca(t),n=[],s=0;s<t.length;s++)n[s]=yh(t[s].properties,e);return n},ns=function(t,e){e===void 0&&(e=void 0);var n=[];return t.forEach(function(s){e===void 0&&n.push(s),s[e]!==void 0&&n.push(s[e])}),n},Sm={getAllSortProperties:Ca,getPropertyWeight:mh,getAllProperties:ns},ze;(function(i){i.EuclideanDistance="euclideanDistance"})(ze||(ze={}));var Da=function(t,e,n){var s=[];e!=null&&e.length?s=e:(t.forEach(function(o){s=s.concat(Object.keys(o))}),s=Jr(s));var r={};return s.forEach(function(o){var a=[];t.forEach(function(c){c[o]!==void 0&&c[o]!==""&&a.push(c[o])}),a.length&&!(n!=null&&n.includes(o))&&(r[o]=Jr(a))}),r},is=function(t,e,n){var s=Da(t,e,n),r=[];if(!Object.keys(s).length)return r;var o=Object.values(s),a=o.every(function(c){return c.every(function(l){return typeof l=="number"})});return t.forEach(function(c,l){var d=[];Object.keys(s).forEach(function(h){var u=c[h],f=s[h],g=f.findIndex(function(y){return u===y}),p=[];if(a)p.push(u);else for(var v=0;v<f.length;v++)v===g?p.push(1):p.push(0);d=d.concat(p)}),r[l]=d}),r},so=function(t,e,n,s){n===void 0&&(n=ze.EuclideanDistance);var r=0;switch(n){case ze.EuclideanDistance:r=new Ie(t).euclideanDistance(new Ie(e));break;default:break}return r},Om={getAllKeyValueMap:Da,oneHot:is,getDistance:so},Ta=function(t,e,n,s){for(var r=e.length,o=2*s,a=0,c=0;c<r;c++)for(var l=t[c].clusterId,d=0;d<r;d++){var h=t[d].clusterId;if(l===h){var u=e[c][d]||0,f=n[c]||0,g=n[d]||0;a+=u-f*g/o}}return a*=1/o,a},ro=function(t,e){t===void 0&&(t=[]);for(var n=t.length,s=new Ie([]),r=0;r<n;r++)s=s.add(new Ie(e[r]));var o=s.avg(n);o.normalize();for(var a=0,r=0;r<n;r++){var c=new Ie(e[r]),l=c.squareEuclideanDistance(o);a+=l}var d=[];t.forEach(function(){d.push([])});for(var r=0;r<n;r++){var c=new Ie(e[r]);t[r].clusterInertial=0;for(var h=0;h<n;h++){if(r===h){d[r][h]=0;continue}var u=new Ie(e[h]);d[r][h]=c.squareEuclideanDistance(u),t[r].clusterInertial+=d[r][h]}}for(var f=0,g=2*n*a,r=0;r<n;r++)for(var p=t[r].clusterId,h=0;h<n;h++){var v=t[h].clusterId;if(!(r===h||p!==v)){var y=t[r].clusterInertial*t[h].clusterInertial/Math.pow(g,2)-d[r][h]/g;f+=y}}return Number(f.toFixed(4))},bh=function(t,e,n,s,r,o,a,c,l){e===void 0&&(e=!1),n===void 0&&(n="weight"),s===void 0&&(s=1e-4),r===void 0&&(r=!1),o===void 0&&(o=void 0),a===void 0&&(a=[]),c===void 0&&(c=["id"]),l===void 0&&(l=1);var d=t.nodes,h=d===void 0?[]:d,u=t.edges,f=u===void 0?[]:u,g=[];if(r){h.forEach(function(H,Q){H.properties=H.properties||{},H.originIndex=Q});var p=[];h.every(function(H){return H.hasOwnProperty("nodeType")})&&(p=Array.from(new Set(h.map(function(H){return H.nodeType}))),h.forEach(function(H){H.properties.nodeType=p.findIndex(function(Q){return Q===H.nodeType})}));var v=ns(h,o);g=is(v,a,c)}var y=1,m={},b={};h.forEach(function(H,Q){var nt=String(y++);H.clusterId=nt,m[nt]={id:nt,nodes:[H]},b[H.id]={node:H,idx:Q}});var E=Ki(t,e),S=[],O={},A=0;E.forEach(function(H,Q){var nt=0,ct=h[Q].id;O[ct]={},H.forEach(function(it,$t){if(it){nt+=it;var kt=h[$t].id;O[ct][kt]=it,A+=it}}),S.push(nt)}),A/=2;for(var N=1/0,z=1/0,U=0,J=[],G={};;){r&&h.every(function(H){return H.hasOwnProperty("properties")})?N=Ta(h,E,S,A)+ro(h,g)*l:N=Ta(h,E,S,A),U===0&&(z=N,J=h,G=m);var vt=N>0&&N>z&&N-z<s;if(N>z&&(J=h.map(function(H){return{node:H,clusterId:H.clusterId}}),G=Si(m),z=N),vt||U>100)break;U++,Object.keys(m).forEach(function(H){var Q=0;f.forEach(function(nt){var ct=nt.source,it=nt.target,$t=b[ct].node.clusterId,kt=b[it].node.clusterId;($t===H&&kt!==H||kt===H&&$t!==H)&&(Q=Q+(nt[n]||1))}),m[H].sumTot=Q}),h.forEach(function(H,Q){var nt=m[H.clusterId],ct=0,it,$t=S[Q]/(2*A),kt=0,be=nt.nodes;be.forEach(function(Se){var ge=b[Se.id].idx;kt+=E[Q][ge]||0});var Ee=kt-nt.sumTot*$t,fe=be.filter(function(Se){return Se.id!==H.id}),Mn=[];fe.forEach(function(Se,ge){Mn[ge]=g[Se.originIndex]});var le=ro(fe,g)*l,An=O[H.id];if(Object.keys(An).forEach(function(Se){var ge=b[Se].node,pi=ge.clusterId;if(pi!==H.clusterId){var _e=m[pi],Ue=_e.nodes;if(!(!Ue||!Ue.length)){var gt=0;Ue.forEach(function(Ot){var Dt=b[Ot.id].idx;gt+=E[Q][Dt]||0});var At=gt-_e.sumTot*$t,mt=Ue.concat([H]),Ct=[];mt.forEach(function(Ot,Dt){Ct[Dt]=g[Ot.originIndex]});var Wt=ro(mt,g)*l,tt=At-Ee;r&&(tt=At+Wt-(Ee+le)),tt>ct&&(ct=tt,it=_e)}}}),ct>0){it.nodes.push(H);var Gt=H.clusterId;H.clusterId=it.id;var Hi=nt.nodes.indexOf(H);nt.nodes.splice(Hi,1);var xe=0,Yi=0;f.forEach(function(Se){var ge=Se.source,pi=Se.target,_e=b[ge].node.clusterId,Ue=b[pi].node.clusterId;(_e===it.id&&Ue!==it.id||Ue===it.id&&_e!==it.id)&&(xe=xe+(Se[n]||1)),(_e===Gt&&Ue!==Gt||Ue===Gt&&_e!==Gt)&&(Yi=Yi+(Se[n]||1))}),it.sumTot=xe,nt.sumTot=Yi}})}var ht={},ut=0;Object.keys(G).forEach(function(H){var Q=G[H];if(!Q.nodes||!Q.nodes.length){delete G[H];return}var nt=String(ut+1);nt!==H&&(Q.id=nt,Q.nodes=Q.nodes.map(function(ct){return{id:ct.id,clusterId:nt}}),G[nt]=Q,ht[H]=nt,delete G[H],ut++)}),J.forEach(function(H){var Q=H.node,nt=H.clusterId;Q&&(Q.clusterId=nt,Q.clusterId&&ht[Q.clusterId]&&(Q.clusterId=ht[Q.clusterId]))});var yt=[],bt={};f.forEach(function(H){var Q=H.source,nt=H.target,ct=H[n]||1,it=b[Q].node.clusterId,$t=b[nt].node.clusterId;if(!(!it||!$t)){var kt="".concat(it,"---").concat($t);if(bt[kt])bt[kt].weight+=ct,bt[kt].count++;else{var be={source:it,target:$t,weight:ct,count:1};bt[kt]=be,yt.push(be)}}});var Et=[];return Object.keys(G).forEach(function(H){Et.push(G[H])}),{clusters:Et,clusterEdges:yt}},Ma=bh,Eh=function(t,e,n,s,r,o,a,c){return e===void 0&&(e=!1),n===void 0&&(n="weight"),s===void 0&&(s=1e-4),r===void 0&&(r=void 0),o===void 0&&(o=[]),a===void 0&&(a=["id"]),c===void 0&&(c=1),Ma(t,e,n,s,!0,r,o,a,c)},xh=Eh,Sh=function(t,e){var n;e===void 0&&(e=1);for(var s=Si(t),r=s.nodes,o=r===void 0?[]:r,a=s.edges,c=a===void 0?[]:a,l=function(){var u=Xr({nodes:o,edges:c}),f=Object.keys(u);f.sort(function(v,y){var m,b;return((m=u[v])===null||m===void 0?void 0:m.degree)-((b=u[y])===null||b===void 0?void 0:b.degree)});var g=f[0];if(!o.length||((n=u[g])===null||n===void 0?void 0:n.degree)>=e)return"break";var p=o.findIndex(function(v){return v.id===g});o.splice(p,1),c=c.filter(function(v){return!(v.source===g||v.target===g)})};;){var d=l();if(d==="break")break}return{nodes:o,edges:c}},Oh=Sh,Aa=function(t,e,n){var s=[];switch(t){case ze.EuclideanDistance:s=e[n];break;default:s=[];break}return s},wh=function(t,e,n,s,r,o){e===void 0&&(e=3),n===void 0&&(n=void 0),s===void 0&&(s=[]),r===void 0&&(r=["id"]),o===void 0&&(o=ze.EuclideanDistance);var a=t.nodes,c=a===void 0?[]:a,l=t.edges,d=l===void 0?[]:l,h={clusters:[{id:"0",nodes:c}],clusterEdges:[]};if(o===ze.EuclideanDistance&&!c.every(function(nt){return nt.hasOwnProperty(n)}))return h;var u=[],f=[];if(o===ze.EuclideanDistance&&(u=ns(c,n),f=is(u,s,r)),!f.length)return h;for(var g=Jr(f.map(function(nt){return nt.join("")})),p=Math.min(e,c.length,g.length),v=0;v<c.length;v++)c[v].originIndex=v;for(var y=[],m=[],b=[],v=0;v<p;v++)if(v===0){var E=Math.floor(Math.random()*c.length);switch(o){case ze.EuclideanDistance:y[v]=f[E];break;default:y[v]=[];break}m.push(E),b[v]=[c[E]],c[E].clusterId=String(v)}else{for(var S=-1/0,O=0,A=function(it){if(!m.includes(it)){for(var $t=0,kt=0;kt<y.length;kt++){var be=0;switch(o){case ze.EuclideanDistance:be=so(f[c[it].originIndex],y[kt],o);break;default:break}$t+=be}var Ee=$t/y.length;Ee>S&&!y.find(function(fe){return oh(fe,Aa(o,f,c[it].originIndex))})&&(S=Ee,O=it)}},N=0;N<c.length;N++)A(N);y[v]=Aa(o,f,O),m.push(O),b[v]=[c[O]],c[O].clusterId=String(v)}for(var z=0;;){for(var v=0;v<c.length;v++){var U=0,J=1/0;if(!(z===0&&m.includes(v))){for(var G=0;G<y.length;G++){var vt=0;switch(o){case ze.EuclideanDistance:vt=so(f[v],y[G],o);break;default:break}vt<J&&(J=vt,U=G)}if(c[v].clusterId!==void 0)for(var ht=b[Number(c[v].clusterId)].length-1;ht>=0;ht--)b[Number(c[v].clusterId)][ht].id===c[v].id&&b[Number(c[v].clusterId)].splice(ht,1);c[v].clusterId=String(U),b[U].push(c[v])}}for(var ut=!1,v=0;v<b.length;v++){for(var yt=b[v],bt=new Ie([]),G=0;G<yt.length;G++)bt=bt.add(new Ie(f[yt[G].originIndex]));var Et=bt.avg(yt.length);Et.equal(new Ie(y[v]))||(ut=!0,y[v]=Et.getArr())}if(z++,c.every(function(nt){return nt.clusterId!==void 0})&&ut||z>=1e3)break}var H=[],Q={};return d.forEach(function(nt){var ct,it,$t=nt.source,kt=nt.target,be=(ct=c.find(function(le){return le.id===$t}))===null||ct===void 0?void 0:ct.clusterId,Ee=(it=c.find(function(le){return le.id===kt}))===null||it===void 0?void 0:it.clusterId,fe="".concat(be,"---").concat(Ee);if(Q[fe])Q[fe].count++;else{var Mn={source:be,target:Ee,count:1};Q[fe]=Mn,H.push(Mn)}}),{clusters:b,clusterEdges:H}},Ch=wh,Dh=function(t,e){var n=new Ie(e),s=n.norm2(),r=new Ie(t),o=r.norm2(),a=n.dot(r),c=s*o,l=c?a/c:0;return l},La=Dh,Th=function(t,e,n,s,r){t===void 0&&(t=[]),n===void 0&&(n=void 0),s===void 0&&(s=[]),r===void 0&&(r=[]);var o=Si(t.filter(function(u){return u.id!==e.id})),a=t.findIndex(function(u){return u.id===e.id}),c=ns(t,n),l=is(c,s,r),d=l[a],h=[];return o.forEach(function(u,f){if(u.id!==e.id){var g=l[f],p=La(g,d);h.push(p),u.cosineSimilarity=p}}),o.sort(function(u,f){return f.cosineSimilarity-u.cosineSimilarity}),{allCosineSimilarity:h,similarNodes:o}},Mh=Th,Ah=function(){function i(t){this.count=t.length,this.parent={};for(var e=0,n=t;e<n.length;e++){var s=n[e];this.parent[s]=s}}return i.prototype.find=function(t){for(;this.parent[t]!==t;)t=this.parent[t];return t},i.prototype.union=function(t,e){var n=this.find(t),s=this.find(e);n!==s&&(n<s?(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]):(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]))},i.prototype.connected=function(t,e){return this.find(t)===this.find(e)},i}(),Lh=Ah,Nh=function(t,e){return t-e},Ih=function(){function i(t){t===void 0&&(t=Nh),this.compareFn=t,this.list=[]}return i.prototype.getLeft=function(t){return 2*t+1},i.prototype.getRight=function(t){return 2*t+2},i.prototype.getParent=function(t){return t===0?null:Math.floor((t-1)/2)},i.prototype.isEmpty=function(){return this.list.length<=0},i.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},i.prototype.delMin=function(){var t=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),t},i.prototype.insert=function(t){if(t!==null){this.list.push(t);var e=this.list.length-1;return this.moveUp(e),!0}return!1},i.prototype.moveUp=function(t){for(var e=this.getParent(t);t&&t>0&&this.compareFn(this.list[e],this.list[t])>0;){var n=this.list[e];this.list[e]=this.list[t],this.list[t]=n,t=e,e=this.getParent(t)}},i.prototype.moveDown=function(t){var e,n=t,s=this.getLeft(t),r=this.getRight(t),o=this.list.length;s!==null&&s<o&&this.compareFn(this.list[n],this.list[s])>0?n=s:r!==null&&r<o&&this.compareFn(this.list[n],this.list[r])>0&&(n=r),t!==n&&(e=[this.list[n],this.list[t]],this.list[t]=e[0],this.list[n]=e[1],this.moveDown(n))},i}(),Ph=Ih,_h=function(t,e){var n=[],s=t.nodes,r=s===void 0?[]:s,o=t.edges,a=o===void 0?[]:o;if(r.length===0)return n;var c=r[0],l=new Set;l.add(c);var d=function(v,y){return e?v.weight-y.weight:0},h=new Ph(d);for(qi(c.id,a).forEach(function(p){h.insert(p)});!h.isEmpty();){var u=h.delMin(),f=u.source,g=u.target;l.has(f)&&l.has(g)||(n.push(u),l.has(f)||(l.add(f),qi(f,a).forEach(function(p){h.insert(p)})),l.has(g)||(l.add(g),qi(g,a).forEach(function(p){h.insert(p)})))}return n},Na=function(t,e){var n=[],s=t.nodes,r=s===void 0?[]:s,o=t.edges,a=o===void 0?[]:o;if(r.length===0)return n;var c=a.map(function(f){return f});e&&c.sort(function(f,g){return f.weight-g.weight});for(var l=new Lh(r.map(function(f){return f.id}));c.length>0;){var d=c.shift(),h=d.source,u=d.target;l.connected(h,u)||(n.push(d),l.union(h,u))}return n},Rh=function(t,e,n){var s={prim:_h,kruskal:Na};return n?s[n](t,e):Na(t,e)},kh=Rh,jh=function(t,e,n){typeof e!="number"&&(e=1e-6),typeof n!="number"&&(n=.85);for(var s=1,r=0,o=1e3,a=t.nodes,c=a===void 0?[]:a,l=t.edges,d=l===void 0?[]:l,h=c.length,u,f={},g={},p=0;p<h;++p){var v=c[p],y=v.id;f[y]=1/h,g[y]=1/h}for(var m=Xr(t);o>0&&s>e;){r=0;for(var p=0;p<h;++p){var v=c[p],y=v.id;if(u=0,m[v.id].inDegree===0)f[y]=0;else{for(var b=Ne(y,d,"source"),E=0;E<b.length;++E){var S=b[E],O=m[S].outDegree;O>0&&(u+=g[S]/O)}f[y]=n*u,r+=f[y]}}r=(1-r)/h,s=0;for(var p=0;p<h;++p){var v=c[p],y=v.id;u=f[y]+r,s+=Math.abs(u-g[y]),g[y]=u}o-=1}return g},Ia=jh,Bh=-1,ss=-1,Pa="-1",en="-1",_a=-1,wm="-1",Ra=function(){function i(t,e,n,s){t===void 0&&(t=Bh),e===void 0&&(e=ss),n===void 0&&(n=ss),s===void 0&&(s=Pa),this.id=t,this.from=e,this.to=n,this.label=s}return i}(),zh=function(){function i(t,e){t===void 0&&(t=ss),e===void 0&&(e=en),this.id=t,this.label=e,this.edges=[],this.edgeMap={}}return i.prototype.addEdge=function(t){this.edges.push(t),this.edgeMap[t.id]=t},i}(),ka=function(){function i(t,e,n){t===void 0&&(t=ss),e===void 0&&(e=!0),n===void 0&&(n=!1),this.id=t,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return i.prototype.getNodeNum=function(){return this.nodes.length},i.prototype.addNode=function(t,e){if(!this.nodeMap[t]){var n=new zh(t,e);this.nodes.push(n),this.nodeMap[t]=n,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(t)}},i.prototype.addEdge=function(t,e,n,s){if((this.edgeIdAutoIncrease||t===void 0)&&(t=this.counter++),!(this.nodeMap[e]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[t])){var r=new Ra(t,e,n,s);if(this.edges.push(r),this.edgeMap[t]=r,this.nodeMap[e].addEdge(r),this.edgeLabelMap[s]||(this.edgeLabelMap[s]=[]),this.edgeLabelMap[s].push(r),!this.directed){var o=new Ra(t,n,e,s);this.nodeMap[n].addEdge(o),this.edgeLabelMap[s].push(o)}}},i}(),_n=function(){function i(t,e,n,s,r){this.fromNode=t,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:n||en,edgeLabel:s||Pa,nodeLabel2:r||en}}return i.prototype.equalTo=function(t){return this.fromNode===t.formNode&&this.toNode===t.toNode&&this.nodeEdgeNodeLabel===t.nodeEdgeNodeLabel},i.prototype.notEqualTo=function(t){return!this.equalTo(t)},i}(),ja=function(){function i(){this.rmpath=[],this.dfsEdgeList=[]}return i.prototype.equalTo=function(t){var e=this.dfsEdgeList.length,n=t.length;if(e!==n)return!1;for(var s=0;s<e;s++)if(this.dfsEdgeList[s]!==t[s])return!1;return!0},i.prototype.notEqualTo=function(t){return!this.equalTo(t)},i.prototype.pushBack=function(t,e,n,s,r){return this.dfsEdgeList.push(new _n(t,e,n,s,r)),this.dfsEdgeList},i.prototype.toGraph=function(t,e){t===void 0&&(t=_a),e===void 0&&(e=!1);var n=new ka(t,!0,e);return this.dfsEdgeList.forEach(function(s){var r=s.fromNode,o=s.toNode,a=s.nodeEdgeNodeLabel,c=a.nodeLabel1,l=a.edgeLabel,d=a.nodeLabel2;c!==en&&n.addNode(r,c),d!==en&&n.addNode(o,d),c!==en&&d!==c&&n.addEdge(void 0,r,o,l)}),n},i.prototype.buildRmpath=function(){this.rmpath=[];for(var t=void 0,e=this.dfsEdgeList.length,n=e-1;n>=0;n--){var s=this.dfsEdgeList[n],r=s.fromNode,o=s.toNode;r<o&&(t===void 0||o===t)&&(this.rmpath.push(n),t=r)}return this.rmpath},i.prototype.getNodeNum=function(){var t={};return this.dfsEdgeList.forEach(function(e){t[e.fromNode]||(t[e.fromNode]=!0),t[e.toNode]||(t[e.toNode]=!0)}),Object.keys(t).length},i}(),rs=function(){function i(t){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!t){for(;t;){var e=t.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,t=t.preNode}this.edges=this.edges.reverse()}}return i.prototype.hasNode=function(t){return this.nodesUsed[t.id]===1},i.prototype.hasEdge=function(t){return this.edgesUsed[t.id]===1},i}(),Fh=function(){function i(t){var e=t.graphs,n=t.minSupport,s=n===void 0?2:n,r=t.minNodeNum,o=r===void 0?1:r,a=t.maxNodeNum,c=a===void 0?4:a,l=t.top,d=l===void 0?10:l,h=t.directed,u=h===void 0?!1:h,f=t.verbose,g=f===void 0?!1:f;this.graphs=e,this.dfsCode=new ja,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=s,this.top=d,this.directed=u,this.counter=0,this.maxNodeNum=c,this.minNodeNum=o,this.verbose=g,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return i.prototype.findForwardRootEdges=function(t,e){var n=this,s=[],r=t.nodeMap;return e.edges.forEach(function(o){(n.directed||e.label<=r[o.to].label)&&s.push(o)}),s},i.prototype.findBackwardEdge=function(t,e,n,s){if(!this.directed&&e===n)return null;for(var r=t.nodeMap,o=r[n.to],a=o.edges,c=a.length,l=0;l<c;l++){var d=a[l];if(!(s.hasEdge(d)||d.to!==e.from)){if(this.directed){if(r[e.from].label<r[n.to].label||r[e.from].label===r[n.to].label&&e.label<=d.label)return d}else if(e.label<d.label||e.label===d.label&&r[e.to].label<=r[n.to].label)return d}}return null},i.prototype.findForwardPureEdges=function(t,e,n,s){for(var r=[],o=e.to,a=t.nodeMap[o].edges,c=a.length,l=0;l<c;l++){var d=a[l],h=t.nodeMap[d.to];n<=h.label&&!s.hasNode(h)&&r.push(d)}return r},i.prototype.findForwardRmpathEdges=function(t,e,n,s){for(var r=[],o=t.nodeMap,a=o[e.to].label,c=o[e.from],l=c.edges,d=l.length,h=0;h<d;h++){var u=l[h],f=o[u.to].label;e.to===u.to||n>f||s.hasNode(o[u.to])||(e.label<u.label||e.label===u.label&&a<=f)&&r.push(u)}return r},i.prototype.getSupport=function(t){var e={};return t.forEach(function(n){e[n.graphId]||(e[n.graphId]=!0)}),Object.keys(e).length},i.prototype.findMinLabel=function(t){var e=void 0;return Object.keys(t).forEach(function(n){var s=t[n],r=s.nodeLabel1,o=s.edgeLabel,a=s.nodeLabel2;if(!e){e={nodeLabel1:r,edgeLabel:o,nodeLabel2:a};return}(r<e.nodeLabel1||r===e.nodeLabel1&&o<e.edgeLabel||r===e.nodeLabel1&&o===e.edgeLabel&&a<e.nodeLabel2)&&(e={nodeLabel1:r,edgeLabel:o,nodeLabel2:a})}),e},i.prototype.isMin=function(){var t=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),e.dfsEdgeList.length===1)return!0;var n=this.directed,s=e.toGraph(_a,n),r=s.nodeMap,o=new ja,a={};s.nodes.forEach(function(h){var u=t.findForwardRootEdges(s,h);u.forEach(function(f){var g=r[f.to],p="".concat(h.label,"-").concat(f.label,"-").concat(g.label);a[p]||(a[p]={projected:[],nodeLabel1:h.label,edgeLabel:f.label,nodeLabel2:g.label});var v={graphId:s.id,edge:f,preNode:null};a[p].projected.push(v)})});var c=this.findMinLabel(a);if(c){o.dfsEdgeList.push(new _n(0,1,c.nodeLabel1,c.edgeLabel,c.nodeLabel2));var l=function h(u){for(var f=o.buildRmpath(),g=o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,p=o.dfsEdgeList[f[0]].toNode,v={},y=!1,m=0,b=n?-1:0,E=function(bt){if(y)return"break";u.forEach(function(Et){var H=new rs(Et),Q=t.findBackwardEdge(s,H.edges[f[bt]],H.edges[f[0]],H);Q&&(v[Q.label]||(v[Q.label]={projected:[],edgeLabel:Q.label}),v[Q.label].projected.push({graphId:s.id,edge:v,preNode:Et}),m=o.dfsEdgeList[f[bt]].fromNode,y=!0)})},S=f.length-1;S>b;S--){var O=E(S);if(O==="break")break}if(y){var A=t.findMinLabel(v);o.dfsEdgeList.push(new _n(p,m,en,A.edgeLabel,en));var N=o.dfsEdgeList.length-1;return t.dfsCode.dfsEdgeList[N]!==o.dfsEdgeList[N]?!1:h(v[A.edgeLabel].projected)}var z={};y=!1;var U=0;u.forEach(function(yt){var bt=new rs(yt),Et=t.findForwardPureEdges(s,bt.edges[f[0]],g,bt);Et.length>0&&(y=!0,U=p,Et.forEach(function(H){var Q="".concat(H.label,"-").concat(r[H.to].label);z[Q]||(z[Q]={projected:[],edgeLabel:H.label,nodeLabel2:r[H.to].label}),z[Q].projected.push({graphId:s.id,edge:H,preNode:yt})}))});for(var J=f.length,G=function(bt){if(y)return"break";var Et=f[bt];u.forEach(function(H){var Q=new rs(H),nt=t.findForwardRmpathEdges(s,Q.edges[Et],g,Q);nt.length>0&&(y=!0,U=o.dfsEdgeList[Et].fromNode,nt.forEach(function(ct){var it="".concat(ct.label,"-").concat(r[ct.to].label);z[it]||(z[it]={projected:[],edgeLabel:ct.label,nodeLabel2:r[ct.to].label}),z[it].projected.push({graphId:s.id,edge:ct,preNode:H})}))})},S=0;S<J;S++){var vt=G(S);if(vt==="break")break}if(!y)return!0;var ht=t.findMinLabel(z);o.dfsEdgeList.push(new _n(U,p+1,en,ht.edgeLabel,ht.nodeLabel2));var ut=o.dfsEdgeList.length-1;return e.dfsEdgeList[ut]!==o.dfsEdgeList[ut]?!1:h(z["".concat(ht.edgeLabel,"-").concat(ht.nodeLabel2)].projected)},d="".concat(c.nodeLabel1,"-").concat(c.edgeLabel,"-").concat(c.nodeLabel2);return l(a[d].projected)}},i.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var t=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(Si(t))}},i.prototype.subGraphMining=function(t){var e=this,n=this.getSupport(t);if(!(n<this.minSupport)&&this.isMin()){this.report();var s=this.dfsCode.getNodeNum(),r=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[r[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,c={},l={};t.forEach(function(d){for(var h=e.graphs[d.graphId],u=h.nodeMap,f=new rs(d),g=r.length-1;g>=0;g--){var p=e.findBackwardEdge(h,f.edges[r[g]],f.edges[r[0]],f);if(p){var v="".concat(e.dfsCode.dfsEdgeList[r[g]].fromNode,"-").concat(p.label);l[v]||(l[v]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[r[g]].fromNode,edgeLabel:p.label}),l[v].projected.push({graphId:d.graphId,edge:p,preNode:d})}}if(!(s>=e.maxNodeNum)){var y=e.findForwardPureEdges(h,f.edges[r[0]],a,f);y.forEach(function(b){var E="".concat(o,"-").concat(b.label,"-").concat(u[b.to].label);c[E]||(c[E]={projected:[],fromNodeId:o,edgeLabel:b.label,nodeLabel2:u[b.to].label}),c[E].projected.push({graphId:d.graphId,edge:b,preNode:d})});for(var m=function(E){var S=e.findForwardRmpathEdges(h,f.edges[r[E]],a,f);S.forEach(function(O){var A="".concat(e.dfsCode.dfsEdgeList[r[E]].fromNode,"-").concat(O.label,"-").concat(u[O.to].label);c[A]||(c[A]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[r[E]].fromNode,edgeLabel:O.label,nodeLabel2:u[O.to].label}),c[A].projected.push({graphId:d.graphId,edge:O,preNode:d})})},g=0;g<r.length;g++)m(g)}}),Object.keys(l).forEach(function(d){var h=l[d],u=h.toNodeId,f=h.edgeLabel;e.dfsCode.dfsEdgeList.push(new _n(o,u,"-1",f,"-1")),e.subGraphMining(l[d].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(c).forEach(function(d){var h=c[d],u=h.fromNodeId,f=h.edgeLabel,g=h.nodeLabel2;e.dfsCode.dfsEdgeList.push(new _n(u,o+1,en,f,g)),e.subGraphMining(c[d].projected),e.dfsCode.dfsEdgeList.pop()})}},i.prototype.generate1EdgeFrequentSubGraphs=function(){var t=this.graphs,e=this.directed,n=this.minSupport,s=this.frequentSize1Subgraphs,r={},o={},a={},c={};return Object.keys(t).forEach(function(l){var d=t[l],h=d.nodeMap;d.nodes.forEach(function(u,f){var g=u.label,p="".concat(l,"-").concat(g);if(!a[p]){var v=r[g]||0;v++,r[g]=v}a[p]={graphKey:l,label:g},u.edges.forEach(function(y){var m=g,b=h[y.to].label;if(!e&&m>b){var E=b;b=m,m=E}var S=y.label,O="".concat(l,"-").concat(m,"-").concat(S,"-").concat(b),A="".concat(m,"-").concat(S,"-").concat(b);if(!o[A]){var N=o[A]||0;N++,o[A]=N}c[O]={graphId:l,nodeLabel1:m,edgeLabel:S,nodeLabel2:b}})})}),Object.keys(r).forEach(function(l){var d=r[l];if(!(d<n)){var h={nodes:[],edges:[]};h.nodes.push({id:"0",label:l}),s.push(h)}}),s},i.prototype.run=function(){var t=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs,n=this.directed,s={};Object.keys(e).forEach(function(r){var o=e[r],a=o.nodeMap;o.nodes.forEach(function(c){var l=t.findForwardRootEdges(o,c);l.forEach(function(d){var h=a[d.to],u="".concat(c.label,"-").concat(d.label,"-").concat(h.label);s[u]||(s[u]={projected:[],nodeLabel1:c.label,edgeLabel:d.label,nodeLabel2:h.label});var f={graphId:r,edge:d,preNode:null};s[u].projected.push(f)})})}),Object.keys(s).forEach(function(r){var o=s[r],a=o.projected,c=o.nodeLabel1,l=o.edgeLabel,d=o.nodeLabel2;t.dfsCode.dfsEdgeList.push(new _n(0,1,c,l,d)),t.subGraphMining(a),t.dfsCode.dfsEdgeList.pop()})}},i}(),$h=function(t,e,n,s){var r={};return Object.keys(t).forEach(function(o,a){var c=t[o],l=new ka(a,!0,e),d={};c.nodes.forEach(function(h,u){l.addNode(u,h[n]),d[h.id]=u}),c.edges.forEach(function(h,u){var f=d[h.source],g=d[h.target];l.addEdge(-1,f,g,h[s])}),l&&l.getNodeNum()&&(r[l.id]=l)}),r},Wh=function(t,e,n){var s=[];return t.forEach(function(r){var o={nodes:[],edges:[]};r.nodes.forEach(function(a){var c;o.nodes.push((c={id:"".concat(a.id)},c[e]=a.label,c))}),r.edges.forEach(function(a){var c;o.edges.push((c={source:"".concat(a.from),target:"".concat(a.to)},c[n]=a.label,c))}),s.push(o)}),s},Ba="cluster",Zh=function(t){var e=t.graphs,n=t.directed,s=n===void 0?!1:n,r=t.nodeLabelProp,o=r===void 0?Ba:r,a=t.edgeLabelProp,c=a===void 0?Ba:a,l=$h(e,s,o,c),d=t.minSupport,h=t.maxNodeNum,u=t.minNodeNum,f=t.verbose,g=t.top,p={graphs:l,minSupport:d,maxNodeNum:h,minNodeNum:u,top:g,verbose:f,directed:s},v=new Fh(p);v.run();var y=Wh(v.frequentSubgraphs,o,c);return y},Vh=Zh,za=function(t,e,n,s){n===void 0&&(n="cluster"),s===void 0&&(s=2);var r=[],o=t.nodes;return e.forEach(function(a,c){r.push(Fa(o,a,c,n,s))}),r},Fa=function(t,e,n,s,r){var o=[n],a=[],c={};return e.forEach(function(l,d){if(l<=r&&n!==d){o.push(d),a.push(t[d]);var h=t[d][s];c[h]?(c[h].count++,c[h].dists.push(l)):c[h]={count:1,dists:[l]}}}),Object.keys(c).forEach(function(l){c[l].dists=c[l].dists.sort(function(d,h){return d-h})}),{nodeIdx:n,nodeId:t[n].id,nodeIdxs:o,neighbors:a,neighborNum:o.length-1,nodeLabelCountMap:c}},Hh=function(t,e,n,s,r){var o=Math.ceil(n/e),a={},c=0;return s.forEach(function(l,d){for(var h=0,u=0,f=l.nodeIdxs,g=l.neighborNum-1;h<o;){for(var p=f[1+Math.floor(Math.random()*g)],v=0;(a["".concat(d,"-").concat(p)]||a["".concat(p,"-").concat(d)])&&(p=Math.floor(Math.random()*e),v++,!(v>2*e)););if(v<2*e&&(a["".concat(d,"-").concat(p)]={start:d,end:p,distance:r[d][p]},h++,c++,c>=n))return a;if(u++,u>2*e)break}if(h<o){var y=o-h;o=(o+y)/(e-d-1)}}),a},os=function(t,e,n,s){var r=n.nodes;return s||(s={}),Object.keys(t).forEach(function(o){var a,c;if(!(s&&s[o])){s[o]={nodes:[],edges:[]};var l=t[o],d=(a=e[l.start])===null||a===void 0?void 0:a.nodeIdxs,h=(c=e[l.end])===null||c===void 0?void 0:c.nodeIdxs;if(!(!d||!h)){var u=new Set(h),f=d.filter(function(m){return u.has(m)});if(!(!f||!f.length)){for(var g={},p=f.length,v=0;v<p;v++){var y=r[f[v]];s[o].nodes.push(y),g[y.id]=!0}n.edges.forEach(function(m){g[m.source]&&g[m.target]&&s[o].edges.push(m)})}}}}),s},as=function(t,e,n,s){var r,o,a={};t.nodes.forEach(function(l){a[l.id]=l});var c=0;return!(!((r=e==null?void 0:e.edges)===null||r===void 0)&&r.length)||((o=e==null?void 0:e.nodes)===null||o===void 0?void 0:o.length)<2?0:(t.edges.forEach(function(l){var d=a[l.source][n],h=a[l.target][n],u=e==null?void 0:e.nodes[0][n],f=e==null?void 0:e.nodes[1][n],g=e==null?void 0:e.edges[0][s];l[s]===g&&(d===u&&h===f||d===f&&h===u)&&c++}),c)},Yh=function(t,e,n){for(var s=1/0,r=0,o=function(l){var d=t[l],h=Object.keys(d).sort(function(m,b){return d[m]-d[b]}),u=10,f=[];h.forEach(function(m,b){f[b%u]||(f[b%u]={graphs:[],totalCount:0,aveCount:0}),f[b%u].graphs.push(m),f[b%u].totalCount+=d[m]});var g=0,p=[];f.forEach(function(m){var b=m.totalCount/m.graphs.length;m.aveCount=b,p.push(b);var E=0,S=m.length;m.graphs.forEach(function(O,A){var N=d[O];m.graphs.forEach(function(z,U){A!==U&&(E+=Math.abs(N-d[z]))})}),E/=S*(S-1)/2,g+=E}),g/=f.length;var v=0;p.forEach(function(m,b){p.forEach(function(E,S){b!==S&&(v+=Math.abs(m-E))}),v/=p.length*(p.length-1)/2});var y=v-g;s<y&&(s=y,r=l)},a=0;a<e;a++)o(a);return{structure:n[r],structureCountMap:t[r]}},$a=function(t,e){var n={},s={};return t.forEach(function(r,o){n[r.id]={idx:o,node:r,degree:0,inDegree:0,outDegree:0};var a=r[e];s[a]||(s[a]=[]),s[a].push(r)}),{nodeMap:n,nodeLabelMap:s}},Wa=function(t,e,n){var s={},r={};return t.forEach(function(o,a){s["".concat(da)]={idx:a,edge:o};var c=o[e];r[c]||(r[c]=[]),r[c].push(o);var l=n[o.source];l&&(l.degree++,l.outDegree++);var d=n[o.target];d&&(d.degree++,d.inDegree++)}),{edgeMap:s,edgeLabelMap:r}},Za=function(t,e,n){var s=e.length,r={};return e.forEach(function(o,a){for(var c=n?0:a+1,l=t[a].id,d=c;d<s;d++)if(a!==d){var h=t[d].id,u=o[d];r["".concat(l,"-").concat(h)]=u,n||(r["".concat(h,"-").concat(l)]=u)}}),r},Uh=function(t,e,n,s,r,o,a,c,l,d,h){var u,f="".concat(e.id,"-").concat(n.id);if(d&&d[f])return d[f];var g=h?h[f]:void 0;if(!g){var p=(u={},u[f]={start:s[e.id].idx,end:s[n.id].idx,distance:r},u);h=os(p,o,t,h),g=h[f]}return as(g,a,c,l)},Va=function(t,e,n,s){var r,o,a,c=(r=t[e])===null||r===void 0?void 0:r.degree,l=(o=t[e])===null||o===void 0?void 0:o.inDegree,d=(a=t[e])===null||a===void 0?void 0:a.outDegree;return t[e]===void 0&&(c=1/0,l=1/0,d=1/0,s[e].forEach(function(h){var u=n[h.id].degree;c>u&&(c=u);var f=n[h.id].inDegree;l>f&&(l=f);var g=n[h.id].outDegree;d>g&&(d=g)}),t[e]={degree:c,inDegree:l,outDegree:d}),{minPatternNodeLabelDegree:c,minPatternNodeLabelInDegree:l,minPatternNodeLabelOutDegree:d}},Gh=function(t,e,n,s,r,o,a){var c;if(n===void 0&&(n=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),!(!t||!t.nodes)){var l=t.nodes.length;if(l){var d=io(t,n),h=io(e,n),u=Za(t.nodes,d,n),f=Za(e.nodes,h,n),g=$a(t.nodes,o),p=g.nodeMap,v=g.nodeLabelMap,y=$a(e.nodes,o),m=y.nodeMap,b=y.nodeLabelMap;Wa(t.edges,a,p);var E=Wa(e.edges,a,m).edgeLabelMap,S=[];h==null||h.forEach(function(gt){S=S.concat(gt)}),r||(r=Math.max.apply(Math,(0,$.ev)((0,$.ev)([],S,!1),[2],!1))),s||(s=r);var O=za(t,d,o,s),A=za(e,h,o,s),N=Math.min(100,l*(l-1)/2),z=Hh(s,l,N,O,d),U=os(z,O,t),J=10,G=1,vt=1,ht=4,ut={graphs:U,nodeLabelProp:o,edgeLabelProp:a,minSupport:G,minNodeNum:vt,maxNodeNum:ht,directed:n},yt=Vh(ut).slice(0,J),bt=yt.length,Et=[];yt.forEach(function(gt,At){Et[At]={},Object.keys(U).forEach(function(mt){var Ct=U[mt],Wt=as(Ct,gt,o,a);Et[At][mt]=Wt})});var H=Yh(Et,bt,yt),Q=H.structure,nt=H.structureCountMap,ct=e.nodes[0],it=[],$t=(c=e.nodes[0])===null||c===void 0?void 0:c[o],kt=-1/0;e.nodes.forEach(function(gt){var At=gt[o],mt=v[At];(mt==null?void 0:mt.length)>kt&&(kt=mt.length,it=mt,$t=At,ct=gt)});var be={},Ee={},fe={},Mn={},le={},An={};Object.keys(b).forEach(function(gt,At){le[gt]=[],n&&(An[gt]=[]);var mt=-1/0,Ct=b[gt],Wt={};Ct.forEach(function(Tt){var xt=f["".concat(ct.id,"-").concat(Tt.id)];if(xt&&le[gt].push(xt),mt<xt&&(mt=xt),Wt["".concat(ct.id,"-").concat(Tt.id)]={start:0,end:m[Tt.id].idx,distance:xt},n){var Zt=f["".concat(Tt.id,"-").concat(ct.id)];Zt&&An[gt].push(Zt)}}),le[gt]=le[gt].sort(function(Tt,xt){return Tt-xt}),n&&(An[gt]=An[gt].sort(function(Tt,xt){return Tt-xt})),Ee=os(Wt,A,e,Ee);var tt=[];if(Object.keys(Wt).forEach(function(Tt){if(fe[Tt]){tt.push(fe[Tt]);return}var xt=Ee[Tt];fe[Tt]=as(xt,Q,o,a),tt.push(fe[Tt])}),tt=tt.sort(function(Tt,xt){return xt-Tt}),Mn["".concat(ct.id,"-").concat(gt)]=tt,gt!==$t)for(var Ot=(it==null?void 0:it.length)||0,Dt=function(xt){var Zt=it[xt],Me=O[p[Zt.id].idx],Ht=Me.nodeLabelCountMap[gt],Un=b[gt].length;if(!Ht||Ht.count<Un)return it.splice(xt,1),"continue";for(var vi=!1,pe=0;pe<Un;pe++)if(Ht.dists[pe]>le[gt][pe]){vi=!0;break}if(vi)return it.splice(xt,1),"continue";var Re={};Me.neighbors.forEach(function(ve){var Ge=u["".concat(Zt.id,"-").concat(ve.id)];Re["".concat(Zt.id,"-").concat(ve.id)]={start:p[Zt.id].idx,end:p[ve.id].idx,distance:Ge}}),U=os(Re,O,t,U);var sn=[];Object.keys(Re).forEach(function(ve){if(nt[ve]){sn.push(nt[ve]);return}var Ge=U[ve];nt[ve]=as(Ge,Q,o,a),sn.push(nt[ve])}),sn=sn.sort(function(ve,Ge){return Ge-ve});for(var Ln=!1,pe=0;pe<Un;pe++)if(sn[pe]<tt[pe]){Ln=!0;break}if(Ln)return it.splice(xt,1),"continue"},se=Ot-1;se>=0;se--)Dt(se)});var Gt=[];it==null||it.forEach(function(gt){for(var At=p[gt.id].idx,mt=Fa(t.nodes,d[At],At,o,r),Ct=mt.neighbors,Wt=Ct.length,tt=!1,Ot=Wt-1;Ot>=0;Ot--){if(Ct.length+1<e.nodes.length){tt=!0;return}var Dt=Ct[Ot],se=Dt[o];if(!b[se]||!b[se].length){Ct.splice(Ot,1);continue}if(!le[se]||!le[se].length){Ct.splice(Ot,1);continue}var Tt="".concat(gt.id,"-").concat(Dt.id),xt=u[Tt],Zt=le[se].length-1,Me=le[se][Zt];if(xt>Me){Ct.splice(Ot,1);continue}if(n){var Ht="".concat(Dt.id,"-").concat(gt.id),Un=u[Ht];Zt=An[se].length-1;var vi=An[se][Zt];if(Un>vi){Ct.splice(Ot,1);continue}}var pe=nt[Tt]?nt[Tt]:Uh(t,gt,Dt,p,xt,O,Q,o,a,nt,U),Re="".concat(ct.id,"-").concat(se),sn=Mn[Re][Mn[Re].length-1];if(pe<sn){Ct.splice(Ot,1);continue}var Ln=Va(be,se,m,b),ve=Ln.minPatternNodeLabelDegree,Ge=Ln.minPatternNodeLabelInDegree,hn=Ln.minPatternNodeLabelOutDegree;if(p[Dt.id].degree<ve){Ct.splice(Ot,1);continue}}tt||Gt.push({nodes:[gt].concat(Ct)})});var Hi=es(e,ct.id,!1).length,xe={};n?(Object.keys(Hi).forEach(function(gt){var At=m[gt].node[o];xe[At]?xe[At].push(Hi[gt]):xe[At]=[Hi[gt]]}),Object.keys(xe).forEach(function(gt){xe[gt].sort(function(At,mt){return At-mt})})):xe=le;for(var Yi=Gt.length,Se=function(At){var mt=Gt[At],Ct=mt.nodes[0],Wt={},tt={};mt.nodes.forEach(function(Pt,Ae){tt[Pt.id]={idx:Ae,node:Pt,degree:0,inDegree:0,outDegree:0};var Jt=Pt[o];Wt[Jt]?Wt[Jt]++:Wt[Jt]=1});var Ot=[],Dt={};t.edges.forEach(function(Pt){tt[Pt.source]&&tt[Pt.target]&&(Ot.push(Pt),Dt[Pt[a]]?Dt[Pt[a]]++:Dt[Pt[a]]=1,tt[Pt.source].degree++,tt[Pt.target].degree++,tt[Pt.source].outDegree++,tt[Pt.target].inDegree++)});for(var se=Object.keys(E).length,Tt=!1,xt=0;xt<se;xt++){var Zt=Object.keys(E)[xt];if(!Dt[Zt]||Dt[Zt]<E[Zt].length){Tt=!0;break}}if(Tt)return Gt.splice(At,1),"continue";var Me=Ot.length;if(Me<e.edges.length)return Gt.splice(At,1),"break";for(var Ht=!1,Un=function(Ae){var Jt=Ot[Ae],rn=Jt[a],Gn=E[rn];if(!Gn||!Gn.length)return Dt[rn]--,Gn&&Dt[rn]<Gn.length?(Ht=!0,"break"):(Ot.splice(Ae,1),tt[Jt.source].degree--,tt[Jt.target].degree--,tt[Jt.source].outDegree--,tt[Jt.target].inDegree--,"continue");var ld=tt[Jt.source].node[o],dd=tt[Jt.target].node[o],oa=!1;if(Gn.forEach(function(hd){var ud=m[hd.source].node,fd=m[hd.target].node;ud[o]===ld&&fd[o]===dd&&(oa=!0),!n&&ud[o]===dd&&fd[o]===ld&&(oa=!0)}),!oa)return Dt[rn]--,Gn&&Dt[rn]<Gn.length?(Ht=!0,"break"):(Ot.splice(Ae,1),tt[Jt.source].degree--,tt[Jt.target].degree--,tt[Jt.source].outDegree--,tt[Jt.target].inDegree--,"continue")},xt=Me-1;xt>=0;xt--){var vi=Un(xt);if(vi==="break")break}if(Ht)return Gt.splice(At,1),"continue";mt.edges=Ot;var pe=es(mt,mt.nodes[0].id,!1).length;if(Object.keys(pe).reverse().forEach(function(Pt){if(!(Pt===mt.nodes[0].id||Ht)){if(pe[Pt]===1/0){var Ae=tt[Pt].node[o];if(Wt[Ae]--,Wt[Ae]<b[Ae].length){Ht=!0;return}var Jt=mt.nodes.indexOf(tt[Pt].node);mt.nodes.splice(Jt,1),tt[Pt]=void 0;return}var rn=p[Pt].node[o];if(!xe[rn]||!xe[rn].length||pe[Pt]>xe[rn][xe[rn].length-1]){var Ae=tt[Pt].node[o];if(Wt[Ae]--,Wt[Ae]<b[Ae].length){Ht=!0;return}var Jt=mt.nodes.indexOf(tt[Pt].node);mt.nodes.splice(Jt,1),tt[Pt]=void 0}}}),Ht)return Gt.splice(At,1),"continue";for(var Re=!0,sn=0;Re&&!Ht;){Re=!1;var Ln=n?tt[Ct.id].degree<m[ct.id].degree||tt[Ct.id].inDegree<m[ct.id].inDegree||tt[Ct.id].outDegree<m[ct.id].outDegree:tt[Ct.id].degree<m[ct.id].degree;if(Ln){Ht=!0;break}if(Wt[Ct[o]]<b[Ct[o]].length){Ht=!0;break}for(var ve=mt.nodes.length,Ge=ve-1;Ge>=0;Ge--){var hn=mt.nodes[Ge],ad=tt[hn.id].degree,Av=tt[hn.id].inDegree,Lv=tt[hn.id].outDegree,Nv=hn[o],ra=Va(be,Nv,m,b),cd=ra.minPatternNodeLabelDegree,Iv=ra.minPatternNodeLabelInDegree,Pv=ra.minPatternNodeLabelOutDegree,_v=n?ad<cd||Av<Iv||Lv<Pv:ad<cd;if(_v){if(Wt[hn[o]]--,Wt[hn[o]]<b[hn[o]].length){Ht=!0;break}mt.nodes.splice(Ge,1),tt[hn.id]=void 0,Re=!0}}if(Ht||!Re&&sn!==0)break;Me=Ot.length;for(var Wr=Me-1;Wr>=0;Wr--){var un=Ot[Wr];if(!tt[un.source]||!tt[un.target]){Ot.splice(Wr,1);var Zr=un[a];if(Dt[Zr]--,tt[un.source]&&(tt[un.source].degree--,tt[un.source].outDegree--),tt[un.target]&&(tt[un.target].degree--,tt[un.target].inDegree--),E[Zr]&&Dt[Zr]<E[Zr].length){Ht=!0;break}Re=!0}}sn++}if(Ht||Ht||mt.nodes.length<e.nodes.length||Ot.length<e.edges.length)return Gt.splice(At,1),"continue"},ge=Yi-1;ge>=0;ge--){var pi=Se(ge);if(pi==="break")break}for(var _e=Gt.length,Ue=function(At){var mt=Gt[At],Ct={};mt.edges.forEach(function(Ot){var Dt="".concat(Ot.source,"-").concat(Ot.target,"-").concat(Ot.label);Ct[Dt]?Ct[Dt]++:Ct[Dt]=1});for(var Wt=function(Dt){var se=Gt[Dt],Tt={};se.edges.forEach(function(Zt){var Me="".concat(Zt.source,"-").concat(Zt.target,"-").concat(Zt.label);Tt[Me]?Tt[Me]++:Tt[Me]=1});var xt=!0;Object.keys(Tt).length!==Object.keys(Ct).length?xt=!1:Object.keys(Ct).forEach(function(Zt){Tt[Zt]!==Ct[Zt]&&(xt=!1)}),xt&&Gt.splice(Dt,1)},tt=_e-1;tt>At;tt--)Wt(tt);_e=Gt.length},ge=0;ge<=_e-1;ge++)Ue(ge);return Gt}}},Xh=Gh,Kh=function(){function i(t){t===void 0&&(t=10),this.linkedList=new la,this.maxStep=t}return Object.defineProperty(i.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),i.prototype.isEmpty=function(){return!this.linkedList.head},i.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},i.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},i.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},i.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},i.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},i.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},i}(),qh=Kh,Qh=ya,Cm={getAdjMatrix:Ki,breadthFirstSearch:Nd,connectedComponent:ua,getDegree:Xr,getInDegree:Pd,getOutDegree:_d,detectCycle:ya,detectDirectedCycle:Qh,detectAllCycles:jd,detectAllDirectedCycle:va,detectAllUndirectedCycle:pa,depthFirstSearch:ga,dijkstra:es,findAllPath:dh,findShortestPath:no,floydWarshall:io,labelPropagation:fh,louvain:Ma,iLouvain:xh,kCore:Oh,kMeans:Ch,cosineSimilarity:La,nodesCosineSimilarity:Mh,minimumSpanningTree:kh,pageRank:Ia,getNeighbors:Ne,Stack:qh,GADDI:Xh};function w(i){if(i.id!==void 0)return i.id;if(i.source!==void 0&&i.target!==void 0)return`${i.source}-${i.target}`;throw new Error(D("The datum does not have available id."))}function cs(i){return i.combo}function Ha(i,t){const e={nodes:(i.nodes||[]).map(w),edges:(i.edges||[]).map(w),combos:(i.combos||[]).map(w)};return t?Object.values(e).flat():e}const Ya=(i,t,e)=>{var n;switch(e.type){case"degree":{const s=new Map;return(n=i.nodes)===null||n===void 0||n.forEach(r=>{const o=t(w(r),e.direction).length;s.set(w(r),o)}),s}case"betweenness":return Jh(i,e.directed,e.weightPropertyName);case"closeness":return tu(i,e.directed,e.weightPropertyName);case"eigenvector":return nu(i,e.directed);case"pagerank":return eu(i,e.epsilon,e.linkProb);default:return Ua(i)}},Ua=i=>{var t;const e=new Map;return(t=i.nodes)===null||t===void 0||t.forEach(n=>{e.set(w(n),0)}),e},Jh=(i,t,e)=>{const n=Ua(i),{nodes:s=[]}=i;return s.forEach(r=>{s.forEach(o=>{if(r!==o){const{allPath:a}=no(i,w(r),w(o),t,e),c=a.length;a.flat().forEach(l=>{l!==w(r)&&l!==w(o)&&n.set(l,n.get(l)+1/c)})}})}),n},tu=(i,t,e)=>{const n=new Map,{nodes:s=[]}=i;return s.forEach(r=>{const o=s.reduce((a,c)=>{if(r!==c){const{length:l}=no(i,w(r),w(c),t,e);a+=l}return a},0);n.set(w(r),1/o)}),n},eu=(i,t,e)=>{var n;const s=new Map,r=Ia(i,t,e);return(n=i.nodes)===null||n===void 0||n.forEach(o=>{s.set(w(o),r[w(o)])}),s},nu=(i,t)=>{const{nodes:e=[]}=i,n=iu(i,t),s=su(n,e.length),r=new Map;return e.forEach((o,a)=>{r.set(w(o),s[a])}),r},iu=(i,t)=>{const{nodes:e=[],edges:n=[]}=i,s=Array(e.length).fill(null).map(()=>Array(e.length).fill(0));return n.forEach(({source:r,target:o})=>{const a=e.findIndex(l=>w(l)===r),c=e.findIndex(l=>w(l)===o);t?s[a][c]=1:(s[a][c]=1,s[c][a]=1)}),s},su=(i,t,e=100,n=1e-6)=>{let s=Array(t).fill(1),r=1/0;for(let o=0;o<e&&r>n;o++){const a=Array(t).fill(0);for(let l=0;l<t;l++)for(let d=0;d<t;d++)a[l]+=i[l][d]*s[d];const c=Math.sqrt(a.reduce((l,d)=>l+d*d,0));for(let l=0;l<t;l++)a[l]/=c;r=Math.sqrt(a.reduce((l,d,h)=>l+(d-s[h])*d,0)),s=a}return s};function vn(i,t,e,n=Y.Z){const s=new Map(i.map(u=>[e(u),u])),r=new Map(t.map(u=>[e(u),u])),o=new Set(s.keys()),a=new Set(r.keys()),c=[],l=[],d=[],h=[];return a.forEach(u=>{o.has(u)?n(s.get(u),r.get(u))?h.push(r.get(u)):l.push(r.get(u)):c.push(r.get(u))}),o.forEach(u=>{a.has(u)||d.push(s.get(u))}),{enter:c,exit:d,keep:h,update:l}}function Rn(i,t,e){const n=s=>{e&&!e(s)||(s.style.visibility=t)};i.forEach(s=>{n(s)})}function ru(i,t,e){const n={},s=r=>(r in n||(n[r]=0),`${t}-${r}-${n[r]++}`);return e.map(r=>typeof r=="string"?{type:r,key:s(r)}:typeof r=="function"?r.call(i):r.key?r:Object.assign(Object.assign({},r),{key:s(r.type)}))}class oo{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=ru(this.context.graph,this.category,t),{enter:n,update:s,exit:r,keep:o}=vn(this.extensions,e,a=>a.key);this.createExtensions(n),this.updateExtensions([...s,...o]),this.destroyExtensions(r),this.extensions=e}createExtension(t){const{category:e}=this,{key:n,type:s}=t,r=te(e,s);if(!r)return F.warn(`The extension ${s} of ${e} is not registered.`);const o=new r(this.context,t);this.extensionMap[n]=o}createExtensions(t){t.forEach(e=>this.createExtension(e))}updateExtension(t){const{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach(e=>this.updateExtension(e))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:e})=>this.destroyExtension(e))}destroy(){Object.values(this.extensionMap).forEach(t=>t.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class ao{constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class we extends ao{}class ls extends we{constructor(t,e){super(t,Object.assign({},ls.defaultOptions,e)),this.isOverlapping=(n,s)=>s.some(r=>n.intersects(r)),this.occupiedBounds=[],this.detectLabelCollision=n=>{const s=this.context.viewport,r={show:[],hide:[]};return this.occupiedBounds=[],n.forEach(o=>{const a=o.getShape("label").getRenderBounds();s.isInViewport(a,!0)&&!this.isOverlapping(a,this.occupiedBounds)?(r.show.push(o),this.occupiedBounds.push(pn(a,this.options.padding))):r.hide.push(o)}),r},this.hideLabelIfExceedViewport=(n,s)=>{const{exit:r}=vn(n,s,o=>o.id);r==null||r.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(n,s)=>{const{model:r}=this.context,o=r.getData(),a=r.getRelatedEdgesData.bind(r);return n.map(l=>(this.nodeCentralities.has(l.id)||(this.nodeCentralities=Ya(o,a,s)),{node:l,centrality:this.nodeCentralities.get(l.id)})).sort((l,d)=>d.centrality-l.centrality).map(l=>l.node)},this.sortLabelElementsInView=n=>{const{sort:s,sortNode:r,sortCombo:o,sortEdge:a}=this.options,{model:c}=this.context;if((0,et.Z)(s))return n.sort((p,v)=>s(c.getElementDataById(p.id),c.getElementDataById(v.id)));const{node:l=[],edge:d=[],combo:h=[]}=Qn(n,p=>p.type),u=(0,et.Z)(o)?h.sort((p,v)=>o(...c.getComboData([p.id,v.id]))):h,f=(0,et.Z)(r)?l.sort((p,v)=>r(...c.getNodeData([p.id,v.id]))):this.sortNodesByCentrality(l,r),g=(0,et.Z)(a)?d.sort((p,v)=>a(...c.getEdgeData([p.id,v.id]))):d;return[...u,...f,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=n=>{var s;if(((s=n.data)===null||s===void 0?void 0:s.stage)==="zIndex")return;if(!this.validate(n)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const r=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,r),this.labelElementsInView=r;const o=this.sortLabelElementsInView(this.labelElementsInView),{show:a,hide:c}=this.detectLabelCollision(o);for(let l=a.length-1;l>=0;l--)this.showLabel(a[l]);c.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=n=>{const s=n.getShape("label");s&&Rn(s,"hidden"),this.hiddenElements.set(n.id,n)},this.showLabel=n=>{const s=n.getShape("label");s&&Rn(s,"visible"),n.toFront(),this.hiddenElements.delete(n.id)},this.onTransform=(0,Gi.Z)(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=n=>{this.enableToggle&&this.onToggleVisibility(n)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=n=>{this.onToggleVisibility(n),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const n in t){const s=t[n];s.isVisible()&&s.getShape("label")&&e.push(s)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){const{graph:t}=this.context;t.on(P.BEFORE_RENDER,this.onBeforeRender),t.on(P.AFTER_RENDER,this.onAfterRender),t.on(P.AFTER_DRAW,this.toggle),t.on(P.AFTER_LAYOUT,this.toggle),t.on(P.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(P.BEFORE_RENDER,this.onBeforeRender),t.off(P.AFTER_RENDER,this.onAfterRender),t.off(P.AFTER_DRAW,this.toggle),t.off(P.AFTER_LAYOUT,this.toggle),t.off(P.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}ls.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};var kn=_(11051);const Ga=[0,0,0];function at(i,t){return i.map((e,n)=>e+t[n])}function Mt(i,t){return i.map((e,n)=>e-t[n])}function Fe(i,t){return typeof t=="number"?i.map(e=>e*t):i.map((e,n)=>e*t[n])}function $e(i,t){return typeof t=="number"?i.map(e=>e/t):i.map((e,n)=>e/t[n])}function ou(i,t){return i.reduce((e,n,s)=>e+n*t[s],0)}function au(i,t){const e=Oi(i),n=Oi(t);return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function yn(i,t){return i.map(e=>e*t)}function It(i,t){return Math.sqrt(i.reduce((e,n,s)=>e+Math.pow(n-t[s]||0,2),0))}function ds(i,t){return i.reduce((e,n,s)=>e+Math.abs(n-t[s]),0)}function an(i){const t=i.reduce((e,n)=>e+Math.pow(n,2),0);return i.map(e=>e/Math.sqrt(t))}function co(i,t,e=!1){const n=i[0]*t[1]-i[1]*t[0];let s=Math.acos(Fe(i,t).reduce((r,o)=>r+o,0)/(It(i,Ga)*It(t,Ga)));return e&&n<0&&(s=2*Math.PI-s),s}function Dm(i,t){return i.every((e,n)=>e===t[n])}function hs(i,t=!0){return t?[-i[1],i[0]]:[i[1],-i[0]]}function lo(i,t){return i.map(e=>e%t)}function jn(i){return[i[0],i[1]]}function Oi(i){return vd(i)?[i[0],i[1],0]:i}function Xa(i){const[t,e]=i;return!t&&!e?0:Math.atan2(e,t)}function Ka(i,t){const[e,n]=i,[s,r]=t,o=Mt(e,n),a=Mt(s,r);return au(o,a).every(c=>c===0)}function ho(i,t,e=!1){if(Ka(i,t))return;const[n,s]=i,[r,o]=t,a=((n[0]-r[0])*(r[1]-o[1])-(n[1]-r[1])*(r[0]-o[0]))/((n[0]-s[0])*(r[1]-o[1])-(n[1]-s[1])*(r[0]-o[0])),c=o[0]-r[0]?(n[0]-r[0]+a*(s[0]-n[0]))/(o[0]-r[0]):(n[1]-r[1]+a*(s[1]-n[1]))/(o[1]-r[1]);if(!(!e&&(!Qe(a,0,1)||!Qe(c,0,1))))return[n[0]+a*(s[0]-n[0]),n[1]+a*(s[1]-n[1])]}function qa(i){if(Array.isArray(i))return Qe(i[0],0,1)&&Qe(i[1],0,1)?i:[.5,.5];const t=i.split("-"),e=t.includes("left")?0:t.includes("right")?1:.5,n=t.includes("top")?0:t.includes("bottom")?1:.5;return[e,n]}function qt(i){const{x:t=0,y:e=0,z:n=0}=i.style||{};return[+t,+e,+n]}function cu(i){const{x:t,y:e,z:n}=i.style||{};return t!==void 0||e!==void 0||n!==void 0}function Qa(i,t){const[e,n]=t,{min:s,max:r}=i;return[s[0]+e*(r[0]-s[0]),s[1]+n*(r[1]-s[1])]}function cn(i,t="center"){const e=qa(t);return Qa(i,e)}function Tm(i,t){const e=parseAnchor(t);return Qa(i,e)}const Mm=i=>{const[t,e]=i;return{left:Math.min(t[0],e[0]),right:Math.max(t[0],e[0]),top:Math.min(t[1],e[1]),bottom:Math.max(t[1],e[1])}};function re(i){var t;return[i.x,i.y,(t=i.z)!==null&&t!==void 0?t:0]}function We(i){var t;return{x:i[0],y:i[1],z:(t=i[2])!==null&&t!==void 0?t:0}}function Am(i){return i.sort((t,e)=>t[0]-e[0]||t[1]-e[1])}function Lm(i){const t=new Set;return i.filter(e=>{const n=e.join(",");return t.has(n)?!1:(t.add(n),!0)})}function wi(i,t=0){return i.map(e=>parseFloat(e.toFixed(t)))}function mn(i,t,e,n=!1){if((0,Y.Z)(i,t))return i;const s=n?Mt(i,t):Mt(t,i),r=an(s),o=[r[0]*e,r[1]*e];return at(jn(i),o)}function Ja(i,t){return i[1]===t[1]}function lu(i,t){return i[0]===t[0]}function du(i,t){return Ja(i,t)||lu(i,t)}function tc(i,t,e){return Ka([i,t],[t,e])}function ec(i,t){return[2*t[0]-i[0],2*t[1]-i[1]]}function nc(i,t,e,n=!0,s=!1){for(let r=0;r<e.length;r++){let o=e[r],a=e[(r+1)%e.length];n&&(o=at(t,o),a=at(t,a));const c=s?ec(i,t):i,l=ho([t,c],[o,a]);if(l)return{point:l,line:[o,a]}}return{point:t,line:void 0}}function hu(i,t,e,n){const s=i[0],r=i[1];let o=!1;e===void 0&&(e=0),n===void 0&&(n=t.length);const a=n-e;for(let c=0,l=a-1;c<a;l=c++){const d=t[c+e][0],h=t[c+e][1],u=t[l+e][0],f=t[l+e][1];h>r!=f>r&&s<(u-d)*(r-h)/(f-h)+d&&(o=!o)}return o}function uu(i,t,e=!1){const n=cn(t,"center"),s=[cn(t,"left-top"),cn(t,"right-top"),cn(t,"right-bottom"),cn(t,"left-bottom")];return nc(i,n,s,!1,e).point}function us(i,t,e=!1){const n=t.center,s=e?ec(i,n):i,r=Mt(s,t.center),o=Math.atan2(r[1],r[0]);if(isNaN(o))return n;const a=Je(t)/2,c=tn(t)/2,l=n[0]+a*Math.cos(o),d=n[1]+c*Math.sin(o);return[l,d]}function fu(i,t){let e=1/0,n=[i[0],t[0]];return i.forEach(s=>{t.forEach(r=>{const o=It(s,r);o<e&&(e=o,n=[s,r])})}),n}function gu(i,t){let e=1/0,n=[[0,0],[0,0]];return t.forEach(s=>{const r=pu(i,s);r<e&&(e=r,n=s)}),n}function pu(i,t){const e=ic(i,t);return It(i,e)}function ic(i,t){const[e,n]=t[0],[s,r]=t[1],[o,a]=i,c=s-e,l=r-n;if(c===0&&l===0)return[e,n];let d=((o-e)*c+(a-n)*l)/(c*c+l*l);d>1?d=1:d<0&&(d=0);const h=e+d*c,u=n+d*l;return[h,u]}function vu(i){const t=i.reduce((e,n)=>at(e,n),[0,0]);return $e(t,i.length)}function uo(i,t=!0){const e=vu(i);return i.sort(([n,s],[r,o])=>{const a=Math.atan2(s-e[1],n-e[0]),c=Math.atan2(o-e[1],r-e[0]);return t?c-a:a-c})}function sc(i,t){return[i,[i[0],t[1]],t,[t[0],i[1]]]}var ti=_(43706);class Vt{constructor(t,e,n){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,Vt.instance)return Vt.callbacks[this.phase].push(n),Vt.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),Vt.instance=this,Vt.callbacks[this.phase].push(n)}bindEvents(){const{emitter:t}=this;t.on(x.POINTER_DOWN,this.onPointerDown),t.on(x.POINTER_MOVE,this.onPointerMove),t.on(x.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,n){const s=this.pointerByTouch.findIndex(r=>r.pointerId===t);s>=0&&(this.pointerByTouch[s]={x:e,y:n,pointerId:t})}onPointerDown(t){const{x:e,y:n}=t.client||{};if(!(e===void 0||n===void 0)&&(this.pointerByTouch.push({x:e,y:n,pointerId:t.pointerId}),t.pointerType==="touch"&&this.pointerByTouch.length===2)){Vt.isPinching=!0;const s=this.pointerByTouch[0].x-this.pointerByTouch[1].x,r=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(s*s+r*r),Vt.callbacks.pinchstart.forEach(o=>o(t,{scale:0}))}}onPointerMove(t){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:e,y:n}=t.client||{};if(e===void 0||n===void 0)return;this.updatePointerPosition(t.pointerId,e,n);const s=this.pointerByTouch[0].x-this.pointerByTouch[1].x,r=this.pointerByTouch[0].y-this.pointerByTouch[1].y,a=Math.sqrt(s*s+r*r)/this.initialDistance;Vt.callbacks.pinchmove.forEach(c=>c(t,{scale:(a-1)*5}))}onPointerUp(t){var e;Vt.callbacks.pinchend.forEach(n=>n(t,{scale:0})),Vt.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(e=Vt.instance)===null||e===void 0||e.tryDestroy()}destroy(){this.emitter.off(x.POINTER_DOWN,this.onPointerDown),this.emitter.off(x.POINTER_MOVE,this.onPointerMove),this.emitter.off(x.POINTER_UP,this.onPointerUp),Vt.instance=null}off(t,e){const n=Vt.callbacks[t].indexOf(e);n>-1&&Vt.callbacks[t].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(Vt.callbacks).every(t=>t.length===0)&&this.destroy()}}Vt.isPinching=!1,Vt.instance=null,Vt.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const rc=i=>i.map(t=>(0,ti.Z)(t)?t.toLocaleLowerCase():t);class ei{constructor(t){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))},this.onKeyUp=e=>{e!=null&&e.key&&this.recordKey.delete(e.key)},this.onWheel=e=>{this.triggerExtendKey(x.WHEEL,e)},this.onDrag=e=>{this.triggerExtendKey(x.DRAG,e)},this.handlePinch=(e,n)=>{this.triggerExtendKey(x.PINCH,Object.assign(Object.assign({},e),n))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){t.length!==0&&(t.includes(x.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new Vt(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}unbind(t,e){this.map.forEach((n,s)=>{(0,Y.Z)(s,t)&&(!e||e===n)&&this.map.delete(s)})}unbindAll(){this.map.clear()}match(t){const e=rc(Array.from(this.recordKey)).sort(),n=rc(t).sort();return(0,Y.Z)(e,n)}bindEvents(){var t;const{emitter:e}=this;e.on(x.KEY_DOWN,this.onKeyDown),e.on(x.KEY_UP,this.onKeyUp),e.on(x.WHEEL,this.onWheel),e.on(x.DRAG,this.onDrag),(t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,n)=>{this.match(n)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((n,s)=>{s.includes(t)&&(0,Y.Z)(Array.from(this.recordKey),s.filter(r=>r!==t))&&n(e)})}destroy(){var t,e;this.unbindAll(),this.emitter.off(x.KEY_DOWN,this.onKeyDown),this.emitter.off(x.KEY_UP,this.onKeyUp),this.emitter.off(x.WHEEL,this.onWheel),this.emitter.off(x.DRAG,this.onDrag),(t=this.pinchHandler)===null||t===void 0||t.off("pinchmove",this.boundHandlePinch),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"blur",this.onFocus)}}class Ci extends we{constructor(t,e){super(t,(0,kn.Z)({},Ci.defaultOptions,e)),this.shortcut=new ei(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:n}=this.context,s=Object.assign({},this.options.style);this.options.style.lineWidth&&(s.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new M.UL({id:"g6-brush-select",style:s}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:n,mode:s}=this.options;this.endPoint=fs(t),(e=this.rectShape)===null||e===void 0||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&s==="default"&&this.updateElementsStates(sc(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=fs(t),this.updateElementsStates(sc(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce((n,s)=>Object.assign({},n,s.reduce((r,o)=>(r[w(o)]=[],r),{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:n,state:s,mode:r,onSelect:o}=this.options,a=this.selector(e,t,n);let c={};switch(r){case"union":a.forEach(l=>{c[l]=[...e.getElementState(l),s]});break;case"diff":a.forEach(l=>{const d=e.getElementState(l);c[l]=d.includes(s)?d.filter(h=>h!==s):[...d,s]});break;case"intersect":a.forEach(l=>{const d=e.getElementState(l);c[l]=d.includes(s)?[s]:[]});break;case"default":default:a.forEach(l=>{c[l]=[s]});break}(0,et.Z)(o)&&(c=o(c)),e.setElementState(c,this.options.animation)}selector(t,e,n){if(!n||n.length===0)return[];const s=[],r=t.getData();if(n.forEach(o=>{r[`${o}s`].forEach(a=>{const c=w(a);t.getElementVisibility(c)!=="hidden"&&hu(t.getElementPosition(c),e)&&s.push(c)})}),n.includes("edge")){const o=r.edges;o==null||o.forEach(a=>{const{source:c,target:l}=a;s.includes(c)&&s.includes(l)&&s.push(w(a))})}return s}clearBrush(){var t;(t=this.rectShape)===null||t===void 0||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(n=>n!=="drag"))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}bindEvents(){const{graph:t}=this.context;t.on(x.POINTER_DOWN,this.onPointerDown),t.on(x.POINTER_MOVE,this.onPointerMove),t.on(x.POINTER_UP,this.onPointerUp),t.on(R.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(x.POINTER_DOWN,this.onPointerDown),t.off(x.POINTER_MOVE,this.onPointerMove),t.off(x.POINTER_UP,this.onPointerUp),t.off(R.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=(0,kn.Z)(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Ci.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const fs=i=>[i.canvas.x,i.canvas.y],ln=.8,Bn=["node","edge","combo"];function ni(i,t,e,n,s=0){n==="TB"&&t(i,s);const r=e(i);if(r)for(const o of r)ni(o,t,e,n,s+1);n==="BT"&&t(i,s)}function yu(i,t,e){const n=[[i,0]];for(;n.length;){const[s,r]=n.shift();t(s,r);const o=e(s);if(o)for(const a of o)n.push([a,r+1])}}function oc(i,t,e,n,s="both"){if(t==="combo"||t==="node")return fo(i,e,n,s);const r=i.getEdgeData(e);if(!r)return[];const o=fo(i,r.source,n-1,s),a=fo(i,r.target,n-1,s);return Array.from(new Set([...o,...a,e]))}function fo(i,t,e,n="both"){const s=new Set,r=new Set,o=new Set;return yu(t,(a,c)=>{c>e||(o.add(a),i.getRelatedEdgesData(a,n).forEach(l=>{const d=w(l);!r.has(d)&&c<e&&(o.add(d),r.add(d))}))},a=>i.getRelatedEdgesData(a,n).map(c=>c.source===a?c.target:c.source).filter(c=>s.has(c)?!1:(s.add(c),!0))),Array.from(o)}function go(i){return i.states||[]}var gs=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class ps extends we{constructor(t,e){super(t,Object.assign({},ps.defaultOptions,e)),this.onClickSelect=n=>gs(this,void 0,void 0,function*(){var s,r;this.validate(n)&&(yield this.updateState(n),(r=(s=this.options).onClick)===null||r===void 0||r.call(s,n))}),this.onClickCanvas=n=>gs(this,void 0,void 0,function*(){var s,r;this.validate(n)&&(yield this.clearState(),(r=(s=this.options).onClick)===null||r===void 0||r.call(s,n))}),this.shortcut=new ei(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bn.forEach(e=>{t.on(`${e}:${x.CLICK}`,this.onClickSelect)}),t.on(R.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:n}=t,{graph:s}=this.context,{degree:r}=this.options;return oc(s,n,e.id,typeof r=="function"?r(t):r).filter(o=>o!==e.id)}updateState(t){return gs(this,void 0,void 0,function*(){const{state:e,unselectedState:n,neighborState:s,animation:r}=this.options;if(!e&&!s&&!n)return;const{target:o}=t,{graph:a}=this.context,c=a.getElementData(o.id),l=go(c).includes(e)?"unselect":"select",d={},h=this.isMultipleSelect,u=[o.id],f=this.getNeighborIds(t);if(h)if(Object.assign(d,this.getDataStates()),l==="select"){const g=(p,v)=>{p.forEach(y=>{const m=new Set(a.getElementState(y));m.add(v),m.delete(n),d[y]=Array.from(m)})};g(u,e),g(f,s),n&&Object.keys(d).forEach(p=>{const v=d[p];!v.includes(e)&&!v.includes(s)&&!v.includes(n)&&d[p].push(n)})}else{const g=d[o.id];d[o.id]=g.filter(p=>p!==e&&p!==s),g.includes(n)||d[o.id].push(n),f.forEach(p=>{d[p]=d[p].filter(v=>v!==s),d[p].includes(e)||d[p].push(n)})}else if(l==="select"){Object.assign(d,this.getClearStates(!!n));const g=(p,v)=>{p.forEach(y=>{d[y]||(d[y]=a.getElementState(y)),d[y].push(v)})};g(u,e),g(f,s),n&&Object.keys(d).forEach(p=>{!u.includes(p)&&!f.includes(p)&&d[p].push(n)})}else Object.assign(d,this.getClearStates());yield a.setElementState(d,r)})}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:n,combos:s}=t.getData(),r={};return[...e,...n,...s].forEach(o=>{r[w(o)]=go(o)}),r}getClearStates(t=!1){const{graph:e}=this.context,{state:n,unselectedState:s,neighborState:r}=this.options,o=new Set([n,s,r]),{nodes:a,edges:c,combos:l}=e.getData(),d={};return[...a,...c,...l].forEach(h=>{const u=go(h),f=u.filter(g=>!o.has(g));(t||f.length!==u.length)&&(d[w(h)]=f)}),d}clearState(){return gs(this,void 0,void 0,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bn.forEach(e=>{t.off(`${e}:${x.CLICK}`,this.onClickSelect)}),t.off(R.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}ps.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function me(i){var t;return!!(!((t=i.style)===null||t===void 0)&&t.collapsed)}var Ce=_(85695),vs=_(58871),mu=_(76109);function Di(i,t){if(!i.startsWith(t))return!1;const e=i[t.length];return e>="A"&&e<="Z"}function ac(i,t){return`${t}${(0,V.Z)(i)}`}function cc(i,t,e=!0){if(!t||!Di(i,t))return i;const n=i.slice(t.length);return e?(0,mu.Z)(n):n}function Yt(i,t){const e=Object.entries(i).reduce((n,[s,r])=>(s==="className"||s==="class"||Di(s,t)&&Object.assign(n,{[cc(s,t)]:r}),n),{});if("opacity"in i){const n=ac("opacity",t),s=i.opacity;if(n in i){const r=i[n];Object.assign(e,{opacity:s*r})}else Object.assign(e,{opacity:s})}return e}function po(i,t){const e=t.length;return Object.keys(i).reduce((n,s)=>{if(s.startsWith(t)){const r=s.slice(e);n[r]=i[s]}return n},{})}function lc(i,t){const e=typeof t=="string"?[t]:t,n={};return Object.keys(i).forEach(s=>{e.find(r=>s.startsWith(r))||(n[s]=i[s])}),n}function Nm(i,t,e){return Object.entries(i).reduce((n,[s,r])=>(Di(s,t)?n[ac(cc(s,t,!1),e)]=r:n[s]=r,n),{})}function De(i=0){if(typeof i=="number")return[i,i,i];const[t,e=t,n=t]=i;return[t,e,n]}var bu=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function dc(i,t){const{datum:e,graph:n}=t;return typeof i=="function"?i.call(n,e):Object.fromEntries(Object.entries(i).map(([s,r])=>typeof r=="function"?[s,r.call(n,e)]:[s,r]))}function ee(i,t){const e=(i==null?void 0:i.style)||{},n=(t==null?void 0:t.style)||{};for(const s in e)s in n||(n[s]=e[s]);return Object.assign({},i,t,{style:n})}function Eu(i){const{x:t,y:e,z:n,class:s,className:r,transform:o,transformOrigin:a,zIndex:c,visibility:l}=i;return bu(i,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function xu(i,t){const e=De(i);let n={};return t.text&&!t.fontSize&&(n={fontSize:Math.min(...e)*.5}),t.src&&(!t.width||!t.height)&&(n={width:e[0]*.5,height:e[1]*.5}),n}function hc(i){if(i)return typeof i=="string"||typeof i=="function"||Array.isArray(i)?{type:"group",field:t=>t.id,color:i,invert:!1}:i}function Su(i,t){if(!t)return{};const{type:e,color:n,field:s,invert:r}=t,o=c=>{const l=typeof n=="string"?te("palette",n):n;if(typeof l=="function"){const d={};return c.forEach(([h,u])=>{d[h]=l(r?1-u:u)}),d}else if(Array.isArray(l)){const d=r?[...l].reverse():l,h={};return c.forEach(([u,f])=>{h[u]=d[f%l.length]}),h}return{}},a=(c,l)=>{var d;return typeof c=="string"?(d=l.data)===null||d===void 0?void 0:d[c]:c==null?void 0:c(l)};if(e==="group"){const c=Qn(i,u=>{if(!s)return"default";const f=a(s,u);return f?String(f):"default"}),l=Object.keys(c),d=o(l.map((u,f)=>[u,f])),h={};return Object.entries(c).forEach(([u,f])=>{f.forEach(g=>{h[w(g)]=d[u]})}),h}else if(e==="value"){const[c,l]=i.reduce(([h,u],f)=>{const g=a(s,f);if(typeof g!="number")throw new Error(D(`Palette field ${s} is not a number`));return[Math.min(h,g),Math.max(u,g)]},[1/0,-1/0]),d=l-c;return o(i.map(h=>[h.id,(a(s,h)-c)/d]))}}function uc(i){const t=typeof i=="string"?te("palette",i):i;if(typeof t!="function")return t}function fc(i,t){let e=2*i;return typeof t=="string"?e=i*Number(t.replace("%",""))/100:typeof t=="number"&&(e=t),isNaN(e)&&(e=2*i),e}function gc(i,t,e=1,n=!1){const s=n?e:1,r=(i.max[0]-i.min[0])*s;return fc(r,t)}function Ou(i,t,e=1){const n=It(i[0],i[1])*e;return fc(n,t)}var pc=_(65443),wu={}.toString,Cu=function(i){return wu.call(i).replace(/^\[object /,"").replace(/]$/,"")},Du=Cu,Tu=Object.prototype,Mu=function(i){var t=i&&i.constructor,e=typeof t=="function"&&t.prototype||Tu;return i===e},Au=Mu,Lu=Object.prototype.hasOwnProperty;function Nu(i){if((0,X.Z)(i))return!0;if((0,pc.Z)(i))return!i.length;var t=Du(i);if(t==="Map"||t==="Set")return!i.size;if(Au(i))return!Object.keys(i).length;for(var e in i)if(Lu.call(i,e))return!1;return!0}var nn=Nu;class Ti extends M.b_{constructor(t){vc(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,n,s,r){var o,a,c,l,d,h,u,f;const g=this.shapeMap[t];if(n===!1){g&&((o=r==null?void 0:r.beforeDestroy)===null||o===void 0||o.call(r,g),s.removeChild(g),delete this.shapeMap[t],(a=r==null?void 0:r.afterDestroy)===null||a===void 0||a.call(r,g));return}const p=typeof e=="string"?te(Le.SHAPE,e):e;if(!p)throw new Error(D(`Shape ${e} not found`));if(!g||g.destroyed||!(g instanceof p)){g&&((c=r==null?void 0:r.beforeDestroy)===null||c===void 0||c.call(r,g),g==null||g.destroy(),(l=r==null?void 0:r.afterDestroy)===null||l===void 0||l.call(r,g)),(d=r==null?void 0:r.beforeCreate)===null||d===void 0||d.call(r);const v=new p({className:t,style:n});return s.appendChild(v),this.shapeMap[t]=v,(h=r==null?void 0:r.afterCreate)===null||h===void 0||h.call(r,v),v}return(u=r==null?void 0:r.beforeUpdate)===null||u===void 0||u.call(r,g),Lo(g,n),(f=r==null?void 0:r.afterUpdate)===null||f===void 0||f.call(r,g),g}update(t={}){const e=Object.assign({},this.attributes,t);vc(e),Zf(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return Eu(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(t.length===0)return null;const n=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:r=0,y:o=0,z:a=0}=this.attributes;t.forEach(c=>{const{x:l=r,y:d=o,z:h=a}=c;Object.assign(c,{transform:h?[["translate3d",l,d,h]]:[["translate",l,d]]})})}const s=super.animate(t,e);if(s&&(vo(this,s),n.push(s)),Array.isArray(t)&&t.length>0){const r=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(o=>!r.includes(o))){Object.entries(this.shapeMap).forEach(([a,c])=>{const l=`get${(0,V.Z)(a)}Style`,d=this[l];if((0,et.Z)(d)){const h=t.map(f=>d.call(this,Object.assign(Object.assign({},this.attributes),f))),u=c.animate(ft(h),e);u&&(vo(c,u),n.push(u))}});const o=(a,c)=>{if(!nn(a)){const l=`get${(0,V.Z)(c)}Style`,d=this[l];if((0,et.Z)(d)){const h=t.map(u=>d.call(this,Object.assign(Object.assign({},this.attributes),u)));Object.entries(h[0]).map(([u])=>{const f=h.map(p=>p[u]),g=a[u];if(g){const p=g.animate(ft(f),e);p&&(vo(g,p),n.push(p))}})}}};this.compositeShapes.forEach(([a,c])=>{const l=po(this.shapeMap,c);o(l,a)})}}return K(n)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Rn(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function vo(i,t){t==null||t.finished.then(()=>{const e=i.activeAnimations.findIndex(n=>n===t);e>-1&&i.activeAnimations.splice(e,1)})}function vc(i){if(!i)return{};if("x"in i||"y"in i||"z"in i){const{x:t=0,y:e=0,z:n,transform:s}=i,r=qe(t,e,n,s);r&&(i.transform=r)}return i}var Iu=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class bn extends Ti{constructor(t){super(ee({style:bn.defaultStyleProps},t))}isTextStyle(t){return Di(t,"label")}isBackgroundStyle(t){return Di(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t),{padding:n}=e,s=Iu(e,["padding"]);return lc(s,"background")}getBackgroundStyle(t){if(t.background===!1)return!1;const e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:s,padding:r}=e,o=Yt(e,"background"),{min:[a,c],center:[l,d],halfExtents:[h,u]}=this.shapeMap.text.getGeometryBounds(),[f,g,p,v]=je(r),y=h*2+v+g,{width:m,height:b}=o;m&&b?Object.assign(o,{x:l-Number(m)/2,y:d-Number(b)/2}):Object.assign(o,{x:a-v,y:c-f,width:n?Math.min(y,s+v+g):y,height:u*2+f+p});const{radius:E}=o;if(typeof E=="string"&&E.endsWith("%")){const S=Number(E.replace("%",""))/100;o.radius=Math.min(+o.width,+o.height)*S}return o}render(t=this.parsedAttributes,e=this){this.upsert("text",M.xv,this.getTextStyle(t),e),this.upsert("background",M.UL,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}bn.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class ii extends Ti{constructor(t){super(ee({style:ii.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",bn,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}ii.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function Pu(i,t=!0){const e=[];return i.forEach((n,s)=>{e.push([s===0?"M":"L",...n])}),t&&e.push(["Z"]),e}const yc={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function _u(i){const t=i.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),e=[];let n="",s={};for(;t.length>0;){let r=t.shift();r in yc?n=r:t.unshift(r),s={type:n},yc[n].forEach(c=>{r=t.shift(),s[c]=r}),n==="M"?n="L":n==="m"&&(n="l");const[o,...a]=Object.values(s);e.push([o,...a.map(Number)])}return e}function Ru(i){const t=[];return(typeof i=="string"?_u(i):i).forEach(n=>{const s=n[0];if(s==="Z"){t.push(t[0]);return}if(s!=="A")for(let r=1;r<n.length;r=r+2)t.push([n[r],n[r+1],0]);else{const r=n.length;t.push([n[r-2],n[r-1],0])}}),t}const mc=i=>{if(i.length<2)return[["M",0,0],["L",0,0]];const t=i[0],e=i[1],n=i[i.length-1],s=i[i.length-2];i.unshift(s,n),i.push(t,e);const r=[["M",n[0],n[1]]];for(let o=1;o<i.length-2;o+=1){const[a,c]=i[o-1],[l,d]=i[o],[h,u]=i[o+1],[f,g]=o!==i.length-2?i[o+2]:[h,u],p=l+(h-a)/6,v=d+(u-c)/6,y=h-(f-l)/6,m=u-(g-d)/6;r.push(["C",p,v,y,m,h,u])}return r};function ku(i,t,e,n,s,r,o){const[a,c]=cn(i,t),l={textAlign:t==="left"?"right":t==="right"?"left":"center",textBaseline:t==="top"?"bottom":t==="bottom"?"top":"middle",transform:[["translate",a+e,c+n]]};if(t==="center"||!s)return l;const d=Ru(r);if(!d||d.length<=3)return l;const h=d.map((g,p)=>{const v=g,y=d[(p+1)%d.length];return(0,Y.Z)(v,y)?null:[v,y]}).filter(Boolean),u=gu([a,c],h),f=ic([a,c],u);if(f&&u&&(l.transform=[["translate",f[0]+e,f[1]+n]],o)){const g=Math.atan((u[0][1]-u[1][1])/(u[0][0]-u[1][0]));l.transform.push(["rotate",g/Math.PI*180]),l.textAlign="center",(t==="right"||t==="left")&&(g>0?l.textBaseline=t==="right"?"bottom":"top":l.textBaseline=t==="right"?"top":"bottom")}return l}var ju=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class Mi extends Ti{constructor(t){super(ee({style:Mi.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||t.d.length===0)return!1;const e=Yt(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:s,offsetY:r,autoRotate:o,placement:a,closeToPath:c}=e,l=ju(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),d=this.shapeMap.key,h=d==null?void 0:d.getRenderBounds();return Object.assign(ku(h,a,s,r,c,t.d,o),{wordWrapWidth:gc(h,n)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",M.y$,this.getKeyStyle(t),e),this.upsert("label",bn,this.getLabelStyle(t),e)}}Mi.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function Bu(i){const t=[],e=n=>{n!=null&&n.children.length&&n.children.forEach(s=>{t.push(s),e(s)})};return e(i),t}function zu(i){const t=[];let e=i.parentNode;for(;e;)t.push(e),e=e.parentNode;return t}class yo extends M.Ee{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},si=this,this.isMutationObserved=!0,this.addEventListener(M.Dk.MOUNTED,this.onMounted),this.addEventListener(M.Dk.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:n=0,height:s=0}=this.attributes;if(t&&n&&s){const[r,o]=this.getBounds().min,a={x:r,y:o,radius:t,width:n,height:s};if(e)Object.assign(this.parsedStyle.clipPath.style,a);else{const c=new M.UL({style:a});this.style.clipPath=c}}else e&&(this.style.clipPath=null)}}const mo=new WeakMap;let si=null;const bo=i=>{if(si&&zu(si).includes(i)){const t=mo.get(i);t?t.includes(si)||t.push(si):mo.set(i,[si])}},Eo=i=>{const t=mo.get(i);t&&t.forEach(e=>e.handleRadius())};class bc extends Ti{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:n=0}=t,s=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},s):Object.assign({textBaseline:"middle",textAlign:"center"},s)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?yo:M.xv,this.getIconStyle(t),e)}}class Ec extends Ti{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var ys=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class Ze extends Ec{constructor(t){super(ee({style:Ze.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return De(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(lc(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=Yt(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:s,offsetX:r,offsetY:o}=e,a=ys(e,["placement","maxWidth","offsetX","offsetY"]),c=this.getShape("key").getLocalBounds();return Object.assign($c(c,n,r,o),{wordWrapWidth:gc(c,s)},a)}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),{fill:n}=e,s=ys(e,["fill"]),r=Yt(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},s),{stroke:n}),r)}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const e=Yt(this.getGraphicStyle(t),"icon");return Object.assign(xu(t.size,e),e)}getBadgesStyle(t){var e;const n=po(this.shapeMap,"badge-"),s={};if(Object.keys(n).forEach(h=>{s[h]=!1}),t.badge===!1||!(!((e=t.badges)===null||e===void 0)&&e.length))return s;const{badges:r=[],badgePalette:o,opacity:a=1}=t,c=ys(t,["badges","badgePalette","opacity"]),l=uc(o),d=Yt(this.getGraphicStyle(c),"badge");return r.forEach((h,u)=>{s[u]=Object.assign(Object.assign({backgroundFill:l?l[u%(l==null?void 0:l.length)]:void 0,opacity:a},d),this.getBadgeStyle(h))}),s}getBadgeStyle(t){const e=this.getShape("key"),{placement:n="top",offsetX:s,offsetY:r}=t,o=ys(t,["placement","offsetX","offsetY"]),a=$c(e.getLocalBounds(),n,s,r,!0);return Object.assign(Object.assign({},a),o)}getPortsStyle(t){var e;const n=this.getPorts(),s={};if(Object.keys(n).forEach(a=>{s[a]=!1}),t.port===!1||!(!((e=t.ports)===null||e===void 0)&&e.length))return s;const r=Yt(this.getGraphicStyle(t),"port"),{ports:o=[]}=t;return o.forEach((a,c)=>{const l=a.key||c,d=Object.assign(Object.assign({},r),a);if(Bc(d))s[l]=!1;else{const[h,u]=this.getPortXY(t,a);s[l]=Object.assign({transform:[["translate",h,u]]},d)}}),s}getPortXY(t,e){const{placement:n="left"}=e,s=this.getShape("key");return To(Fu(this.context,s),n)}getPorts(){return po(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return uu(t,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t),s=this.getShape("key");this.upsert("halo",s.constructor,n,e)}drawIconShape(t,e){const n=this.getIconStyle(t);this.upsert("icon",bc,n,e),bo(this)}drawBadgeShapes(t,e){const n=this.getBadgesStyle(t);Object.keys(n).forEach(s=>{const r=n[s];this.upsert(`badge-${s}`,ii,r,e)})}drawPortShapes(t,e){const n=this.getPortsStyle(t);Object.keys(n).forEach(s=>{const r=n[s],o=`port-${s}`;this.upsert(o,M.Cd,r,e)})}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",bn,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&Eo(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Ze.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function Fu(i,t){if(!i)return t.getLocalBounds();const e=i.canvas.getLayer(),n=t.cloneNode();Rn(n,"hidden"),e.appendChild(n);const s=n.getLocalBounds();return n.destroy(),s}class zn extends Ze{constructor(t){super(ee({style:zn.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",M.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,s=n*2*ln;return e?Object.assign({width:s,height:s},e):!1}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return us(t,n,e)}}zn.defaultStyleProps={size:32};class ms extends Ze{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",M.mg,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var n,s;const{points:r}=this.getShape("key").attributes,o=[+(((n=this.attributes)===null||n===void 0?void 0:n.x)||0),+(((s=this.attributes)===null||s===void 0?void 0:s.y)||0)];return nc(t,o,r,!0,e).point}}class $u extends ms{constructor(t){super(t)}getPoints(t){const[e,n]=this.getSize(t);return $f(e,n)}}var Wu=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class bs extends zn{constructor(t){super(ee({style:bs.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...De(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return(0,ti.Z)(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:n}=t;if(!(n!=null&&n.length))return;const s=n.map(h=>(0,Rt.Z)(h)?{value:h}:h),r=Yt(this.getGraphicStyle(t),"donut"),o=uc(t.donutPalette);if(!o)return;const a=s.reduce((h,u)=>{var f;return h+((f=u.value)!==null&&f!==void 0?f:0)},0),c=this.parseOuterR(),l=this.parseInnerR();let d=0;s.forEach((h,u)=>{const{value:f=0,color:g=o[u%o.length]}=h,p=Wu(h,["value","color"]),v=(a===0?1/s.length:f/a)*360;this.upsert(`round${u}`,M.y$,Object.assign(Object.assign(Object.assign({},r),{d:Hu(c,l,d,d+v),fill:g}),p),e),d+=v})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}bs.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const Es=(i,t,e,n)=>[i+Math.sin(n)*e,t-Math.cos(n)*e],Zu=(i,t,e,n)=>n<=0||e<=n?[["M",i-e,t],["A",e,e,0,1,1,i+e,t],["A",e,e,0,1,1,i-e,t],["Z"]]:[["M",i-e,t],["A",e,e,0,1,1,i+e,t],["A",e,e,0,1,1,i-e,t],["Z"],["M",i+n,t],["A",n,n,0,1,0,i-n,t],["A",n,n,0,1,0,i+n,t],["Z"]],Vu=(i,t,e,n,s,r)=>{const[o,a]=[s/360*2*Math.PI,r/360*2*Math.PI],c=[Es(i,t,n,o),Es(i,t,e,o),Es(i,t,e,a),Es(i,t,n,a)],l=a-o>Math.PI?1:0;return[["M",c[0][0],c[0][1]],["L",c[1][0],c[1][1]],["A",e,e,0,l,1,c[2][0],c[2][1]],["L",c[3][0],c[3][1]],["A",n,n,0,l,0,c[0][0],c[0][1]],["Z"]]},Hu=(i=0,t=0,e,n)=>{const[s,r]=[0,0];return Math.abs(e-n)%360<1e-6?Zu(s,r,i,t):Vu(s,r,i,t,e,n)};class xs extends Ze{constructor(t){super(ee({style:xs.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",M.Pj,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,s]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:s/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:n,ry:s}=this.getShape("key").attributes,r=Math.min(+n,+s)*2*ln;return e?Object.assign({width:r,height:r},e):!1}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return us(t,n,e)}}xs.defaultStyleProps={size:[45,35]};class Yu extends ms{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return Vf(this.getOuterR(t))}getIconStyle(t){const e=super.getIconStyle(t),n=this.getOuterR(t)*ln;return e?Object.assign({width:n,height:n},e):!1}}var Ai=_(31211),Li=_(1819),Bt=_(49025),Uu=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class Ss extends Ze{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},Ss.defaultStyleProps,t.style)})),this.rootPointerEvent=new M.nR(null),this.forwardEvents=e=>{const n=this.context.canvas,s=n.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(e,s).forEach(o=>{const a=this.bootstrapEvent(this.rootPointerEvent,o,s,e);(0,vs.Z)(n.context.eventService,"mappingTable.pointerupoutside",[]),n.context.eventService.mapEvent(a)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[x.CLICK,x.POINTER_DOWN,x.POINTER_MOVE,x.POINTER_UP,x.POINTER_OVER,x.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){const e=(0,Li.Z)(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:s=0}=e,r=Uu(e,["dx","dy"]),[o,a]=this.getSize(t);return Object.assign(Object.assign({x:n,y:s},r),{width:o,height:a})}drawKeyShape(t,e){const n=this.getKeyStyle(t),{x:s,y:r,width:o=0,height:a=0}=n,c=this.upsert("key-container",M.UL,{x:s,y:r,width:o,height:a,opacity:0},e);return this.upsert("key",M.k9,n,c)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Ai.Th))return;const n=this.getDomElement();this.events.forEach(s=>{n.addEventListener(s,this.forwardEvents)})}attributeChangedCallback(t,e,n){t==="zIndex"&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){const n=[];if(e.isTouchEvent(t))for(let s=0;s<t.changedTouches.length;s++){const r=t.changedTouches[s];(0,Bt.Z)(r.button)&&(r.button=0),(0,Bt.Z)(r.buttons)&&(r.buttons=1),(0,Bt.Z)(r.isPrimary)&&(r.isPrimary=t.touches.length===1&&t.type==="touchstart"),(0,Bt.Z)(r.width)&&(r.width=r.radiusX||1),(0,Bt.Z)(r.height)&&(r.height=r.radiusY||1),(0,Bt.Z)(r.tiltX)&&(r.tiltX=0),(0,Bt.Z)(r.tiltY)&&(r.tiltY=0),(0,Bt.Z)(r.pointerType)&&(r.pointerType="touch"),(0,Bt.Z)(r.pointerId)&&(r.pointerId=r.identifier||0),(0,Bt.Z)(r.pressure)&&(r.pressure=r.force||.5),(0,Bt.Z)(r.twist)&&(r.twist=0),(0,Bt.Z)(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){const s=t;(0,Bt.Z)(s.isPrimary)&&(s.isPrimary=!0),(0,Bt.Z)(s.width)&&(s.width=1),(0,Bt.Z)(s.height)&&(s.height=1),(0,Bt.Z)(s.tiltX)&&(s.tiltX=0),(0,Bt.Z)(s.tiltY)&&(s.tiltY=0),(0,Bt.Z)(s.pointerType)&&(s.pointerType="mouse"),(0,Bt.Z)(s.pointerId)&&(s.pointerId=1),(0,Bt.Z)(s.pressure)&&(s.pressure=.5),(0,Bt.Z)(s.twist)&&(s.twist=0),(0,Bt.Z)(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,n.push(s)}else n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,s){t.view=n,t.originalEvent=null,t.nativeEvent=s,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:r,y:o}=this.getViewportXY(e);t.viewport.x=r,t.viewport.y=o;const[a,c]=this.context.canvas.getCanvasByViewport([r,o]);return t.canvas.x=a,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=s.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let e,n;const{offsetX:s,offsetY:r,clientX:o,clientY:a}=t;if(!(0,X.Z)(s)&&!(0,X.Z)(r))e=s,n=r;else{const c=this.eventService.client2Viewport({x:o,y:a});e=c.x,n=c.y}return{x:e,y:n}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}Ss.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var xc=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class Os extends Ze{constructor(t){super(ee({style:Os.defaultStyleProps},t))}getKeyStyle(t){const[e,n]=this.getSize(t),s=super.getKeyStyle(t),{fillOpacity:r,opacity:o=r}=s,a=xc(s,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:o},a),{width:e,height:n,x:-e/2,y:-n/2})}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getShape("key").attributes,{fill:n,stroke:s}=e,r=xc(e,["fill","stroke"]),o=Yt(this.getGraphicStyle(t),"halo"),a=Number(o.lineWidth),[c,l]=at(this.getSize(t),[a,a]);return Object.assign(Object.assign({},o),{width:c,height:l,fill:"transparent",x:-c/2,y:-l/2})}getIconStyle(t){const e=super.getIconStyle(t),[n,s]=this.getSize(t);return e?Object.assign({width:n*ln,height:s*ln},e):!1}drawKeyShape(t,e){const n=this.upsert("key",yo,this.getKeyStyle(t),e);return bo(this),n}drawHaloShape(t,e){this.upsert("halo",M.UL,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&Eo(this)}}Os.defaultStyleProps={size:32};class Gu extends Ze{constructor(t){super(t)}getKeyStyle(t){const[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:n,height:s}=this.getShape("key").attributes;return e?Object.assign({width:n*ln,height:s*ln},e):!1}drawKeyShape(t,e){return this.upsert("key",M.UL,this.getKeyStyle(t),e)}}class Xu extends ms{constructor(t){super(t)}getInnerR(t){return t.innerR||this.getOuterR(t)*3/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return jf(this.getOuterR(t),this.getInnerR(t))}getIconStyle(t){const e=super.getIconStyle(t),n=this.getInnerR(t)*2*ln;return e?Object.assign({width:n,height:n},e):!1}getPortXY(t,e){const{placement:n="top"}=e,s=this.getShape("key").getLocalBounds(),r=Bf(this.getOuterR(t),this.getInnerR(t));return To(s,n,r,!1)}}class ws extends ms{constructor(t){super(ee({style:ws.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[n,s]=this.getSize(t);return zf(n,s,e)}getPortXY(t,e){const{direction:n}=t,{placement:s="top"}=e,r=this.getShape("key").getLocalBounds(),[o,a]=this.getSize(t),c=Ff(o,a,n);return To(r,s,c,!1)}getIconStyle(t){const{icon:e,iconText:n,iconSrc:s,direction:r}=t;if(e===!1||nn(n||s))return!1;const o=Yt(this.getGraphicStyle(t),"icon"),a=this.getShape("key").getLocalBounds(),[c,l]=Ed(a,r),d=xd(a,r)*2*ln;return Object.assign({x:c,y:l,width:d,height:d},o)}}ws.defaultStyleProps={size:40,direction:"up"};var Sc=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class ri extends Ze{constructor(t){super(ee({style:ri.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:n=[]}=t;return n.length===0?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:n}=t,[s,r,o,a]=je(e);return at(De(n),[a+r,s+o,0])}getCollapsedKeySize(t){return De(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[Je(e),tn(e),0]}getContentBBox(t){const{childrenNode:e=[],padding:n}=t,s=e.map(o=>this.context.element.getElement(o)).filter(Boolean);if(s.length===0){const o=new M.mN,{x:a=0,y:c=0,size:l}=t,[d,h]=De(l);return o.setMinMax([a-d/2,c-h/2,0],[a+d/2,c+h/2,0]),o}const r=bi(s.map(o=>o.getBounds()));return n?pn(r,n):r}drawCollapsedMarkerShape(t,e){const n=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",bc,n,e),bo(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=Yt(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,s=Sc(e,["type"]),r=this.getShape("key"),[o,a]=cn(r.getLocalBounds(),"center"),c=Object.assign(Object.assign({},s),{x:o,y:a});if(n){const l=this.getCollapsedMarkerText(n,t);Object.assign(c,{text:l})}return c}getCollapsedMarkerText(t,e){const{childrenData:n=[]}=e,{model:s}=this.context;return t==="descendant-count"?s.getDescendantsData(this.id).length.toString():t==="child-count"?n.length.toString():t==="node-count"?s.getDescendantsData(this.id).filter(r=>s.getElementType(w(r))==="node").length.toString():(0,et.Z)(t)?t(n):""}getComboPosition(t){const{x:e=0,y:n=0,collapsed:s,childrenData:r=[]}=t;if(r.length===0)return[+e,+n,0];if(s){const{model:o}=this.context,a=o.getDescendantsData(this.id).filter(c=>!o.isCombo(w(c)));if(a.length>0&&a.some(cu)){const c=a.reduce((l,d)=>at(l,qt(d)),[0,0,0]);return $e(c,a.length)}return[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){const[e,n]=this.getComboPosition(t);return{x:e,y:n,transform:[["translate",e,n]]}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:n,y:s}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:s}}),Eo(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(this.attributes.collapsed?t:t.map(s=>{var{x:r,y:o,z:a,transform:c}=s,l=Sc(s,["x","y","z","transform"]);return l}),e);return n&&new Proxy(n,{set:(s,r,o)=>(r==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(s,r,o))})}}ri.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class Ku extends ri{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",M.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,n=super.getKeyStyle(t),[s]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&Yt(n,"collapsed")),{r:s/2})}getCollapsedKeySize(t){const[e,n]=De(t.collapsedSize),s=Math.max(e,n)/2;return[s*2,s*2,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[n,s]=fn(e),r=Math.sqrt(Math.pow(n,2)+Math.pow(s,2))/2;return[r*2,r*2,0]}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return us(t,n,e)}}class qu extends ri{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",M.UL,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,s]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&Yt(e,"collapsed")),{width:n,height:s,x:-n/2,y:-s/2})}}var Qu=_(13639),Ju=function(i,t){return(0,pc.Z)(i)?i.indexOf(t)>-1:!1},tf=Ju,ef=function(i,t){return t===void 0&&(t=[]),(0,Qu.Z)(i,function(e){return!tf(t,e)})},nf=ef;const sf={padding:10};function Oc(i,t,e,n,s,r){const{padding:o}=Object.assign(sf,r),a=gn(e,o),c=gn(n,o),l=[i,...s,t];let d=null;const h=[];for(let u=0,f=l.length;u<f-1;u++){const g=u+1,p=l[u],v=l[g],y=du(p,v);let m=null;if(u===0)if(g===f-1)if(a.intersects(c))m=So(p,v,a,c);else if(!Xi(p,a)&&!Xi(v,c)){const b=Pn(p,a),E=Pn(v,c);m=Cc(b,E,de(b,E)),m.points.unshift(b),m.points.push(E)}else y||(m=of(p,v,a,c));else Be(v,a)?m=So(p,v,a,gn(v,o),d):y||(m=Cs(p,v,a));else g===f-1?Be(p,c)?m=So(p,v,gn(p,o),c,d):y||(m=Dc(p,v,c,d)):y||(m=Cc(p,v,d));m?(h.push(...m.points),d=m.direction):d=de(p,v),g<f-1&&h.push(v)}return h.map(jn)}const rf={N:"S",S:"N",W:"E",E:"W"},wc={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function de(i,t){const[e,n]=i,[s,r]=t;return e===s?n>r?"N":"S":n===r?e>s?"W":"E":null}function xo(i,t){return t==="N"||t==="S"?tn(i):Je(i)}function Cc(i,t,e){const n=[i[0],t[1]],s=[t[0],i[1]],r=de(i,n),o=de(i,s),a=e?rf[e]:null,c=r===e||r!==a&&o!==e?n:s;return{points:[c],direction:de(c,t)}}function Cs(i,t,e){if(Xi(i,e)){const n=Ni(i,t,e);return{points:[n],direction:de(n,t)}}else{const n=Pn(i,e),r=["left","right"].includes(Ei(i,e))?[t[0],n[1]]:[n[0],t[1]];return{points:[r],direction:de(r,t)}}}function Dc(i,t,e,n){const s=Xi(t,e)?t:Pn(t,e),r=[[s[0],i[1]],[i[0],s[1]]],o=r.filter(c=>bd(c,e)&&!aa(c,e,!0)),a=o.filter(c=>de(c,i)!==n);if(a.length>0){const c=a.find(l=>de(i,l)===n)||a[0];return{points:[c],direction:de(c,t)}}else{const c=nf(r,o)[0],l=mn(t,c,xo(e,n)/2);return{points:[Ni(l,i,e),l],direction:de(l,t)}}}function of(i,t,e,n){let s=Cs(i,t,e);const r=Oi(s.points[0]);if(Be(r,n)){s=Cs(t,i,n);const o=Oi(s.points[0]);if(Be(o,e)){const a=mn(i,r,xo(e,de(i,r))/2),c=mn(t,o,xo(n,de(t,o))/2),l=[(a[0]+c[0])/2,(a[1]+c[1])/2],d=Cs(i,l,e),h=Dc(l,t,n,d.direction);s.points=[d.points[0],h.points[0]],s.direction=h.direction}}return s}function So(i,t,e,n,s){const o=bi([e,n]),a=It(t,o.center)>It(i,o.center),[c,l]=a?[t,i]:[i,t],d=tn(o)+Je(o);let h;if(s){const g=[c[0]+d*Math.cos(wc[s]),c[1]+d*Math.sin(wc[s])];h=mn(Pn(g,o),g,.01)}else h=mn(Pn(c,o),c,-.01);let u=Ni(h,l,o),f=[wi(h,2),wi(u,2)];if((0,Y.Z)(wi(h),wi(u))){const g=co(Mt(h,c),[1,0,0])+Math.PI/2;u=[l[0]+d*Math.cos(g),l[1]+d*Math.sin(g),0],u=wi(mn(Pn(u,o),l,-.01),2);const p=Ni(h,u,o);f=[h,p,u]}return{points:a?f.reverse():f,direction:de(a?h:u,t)}}function Ni(i,t,e){let n=[i[0],t[1]];return Be(n,e)&&(n=[t[0],i[1]]),n}function Tc(i,t,e,n,s){let c=typeof t=="number"?t:.5;t==="start"&&(c=0),t==="end"&&(c=.99);const l=re(i.getPoint(c)),d=re(i.getPoint(c+.01));let h=t==="start"?"left":t==="end"?"right":"center";if(Ja(l,d)||!e){const[y,m]=Mc(i,c,n,s);return{transform:[["translate",y,m]],textAlign:h}}let u=Math.atan2(d[1]-l[1],d[0]-l[0]);d[0]<l[0]&&(h=h==="center"?h:h==="left"?"right":"left",n*=-1,u+=Math.PI);const[g,p]=Mc(i,c,n,s,u),v=[["translate",g,p],["rotate",u/Math.PI*180]];return{textAlign:h,transform:v}}function af(i,t,e,n,s){var r,o;const a=((r=i.badge)===null||r===void 0?void 0:r.getGeometryBounds().halfExtents[0])*2||0,c=((o=i.label)===null||o===void 0?void 0:o.getGeometryBounds().halfExtents[0])*2||0;return Tc(i.key,e,!0,(c?(c/2+a/2)*(t==="suffix"?1:-1):0)+n,s)}function Mc(i,t,e,n,s){const[r,o]=re(i.getPoint(t));let a=e,c=n;return s&&(a=e*Math.cos(s)-n*Math.sin(s),c=e*Math.sin(s)+n*Math.cos(s)),[r+a,o+c]}function Oo(i,t,e,n){if((0,Y.Z)(i,t))return i;const s=Mt(t,i),r=[i[0]+e*s[0],i[1]+e*s[1]],o=an(hs(s,!1));return r[0]+=n*o[0],r[1]+=n*o[1],r}function cf(i){return(0,Rt.Z)(i)?[i,-i]:i}function lf(i){return(0,Rt.Z)(i)?[i,1-i]:i}function df(i,t,e){return[["M",i[0],i[1]],["Q",e[0],e[1],t[0],t[1]]]}function Ac(i,t,e){return[["M",i[0],i[1]],["C",e[0][0],e[0][1],e[1][0],e[1][1],t[0],t[1]]]}function wo(i,t=0,e=!1){const n=i.length-1,s=i[0],r=i[n],o=i.slice(1,n),a=[["M",s[0],s[1]]];return o.forEach((c,l)=>{const d=o[l-1]||s,h=o[l+1]||r;if(!tc(d,c,h)&&t){const[u,f]=hf(d,c,h,t);a.push(["L",u[0],u[1]],["Q",c[0],c[1],f[0],f[1]],["L",f[0],f[1]])}else a.push(["L",c[0],c[1]])}),a.push(["L",r[0],r[1]]),e&&a.push(["Z"]),a}function hf(i,t,e,n){const s=ds(i,t),r=ds(e,t),o=Math.min(n,Math.min(s,r)/2),a=[t[0]-o/s*(t[0]-i[0]),t[1]-o/s*(t[1]-i[1])],c=[t[0]-o/r*(t[0]-e[0]),t[1]-o/r*(t[1]-e[1])];return[a,c]}const uf=i=>{const t=Math.PI/2,e=tn(i)/2,n=Je(i)/2,s=Math.atan2(e,n)/2,r=Math.atan2(n,e)/2;return{top:[-t-r,-t+r],"top-right":[-t+r,-s],"right-top":[-t+r,-s],right:[-s,s],"bottom-right":[s,t-r],"right-bottom":[s,t-r],bottom:[t-r,t+r],"bottom-left":[t+r,Math.PI-s],"left-bottom":[t+r,Math.PI-s],left:[Math.PI-s,Math.PI+s],"top-left":[Math.PI+s,-t-r],"left-top":[Math.PI+s,-t-r]}};function Lc(i,t,e,n,s){const r=gn(i),o=i.getCenter();let a=n&&xn(n),c=s&&xn(s);if(!a||!c){const l=uf(r),d=l[t][0],h=l[t][1],[u,f]=fn(r),g=Math.max(u,f),p=at(o,[g*Math.cos(d),g*Math.sin(d),0]),v=at(o,[g*Math.cos(h),g*Math.sin(h),0]);a=Ao(i,p),c=Ao(i,v),e||([a,c]=[c,a])}return[a,c]}function ff(i,t,e,n,s,r){const o=i.getPorts()[s||r],a=i.getPorts()[r||s];let[c,l]=Lc(i,t,e,o,a);const d=gf(i,c,l,n);return o&&(c=Pi(o,d[0])),a&&(l=Pi(a,d.at(-1))),Ac(c,l,d)}function gf(i,t,e,n){const s=i.getCenter();if((0,Y.Z)(t,e)){const r=Mt(t,s),o=[n*Math.sign(r[0])||n/2,n*Math.sign(r[1])||-n/2,0];return[at(t,o),at(e,Fe(o,[1,-1,1]))]}return[mn(s,t,It(s,t)+n),mn(s,e,It(s,e)+n)]}function pf(i,t,e,n,s,r,o){const a=Mo(i),c=a[r||o],l=a[o||r];let[d,h]=Lc(i,e,n,c,l);const u=vf(i,d,h,s);return c&&(d=Pi(c,u[0])),l&&(h=Pi(l,u.at(-1))),wo([d,...u,h],t)}function vf(i,t,e,n){const s=[],r=gn(i);if((0,Y.Z)(t,e))switch(Ei(t,r)){case"left":s.push([t[0]-n,t[1]]),s.push([t[0]-n,t[1]+n]),s.push([t[0],t[1]+n]);break;case"right":s.push([t[0]+n,t[1]]),s.push([t[0]+n,t[1]+n]),s.push([t[0],t[1]+n]);break;case"top":s.push([t[0],t[1]-n]),s.push([t[0]+n,t[1]-n]),s.push([t[0]+n,t[1]]);break;case"bottom":s.push([t[0],t[1]+n]),s.push([t[0]+n,t[1]+n]),s.push([t[0]+n,t[1]]);break}else{const o=Ei(t,r),a=Ei(e,r);if(o===a){const c=o;let l,d;switch(c){case"left":l=Math.min(t[0],e[0])-n,s.push([l,t[1]]),s.push([l,e[1]]);break;case"right":l=Math.max(t[0],e[0])+n,s.push([l,t[1]]),s.push([l,e[1]]);break;case"top":d=Math.min(t[1],e[1])-n,s.push([t[0],d]),s.push([e[0],d]);break;case"bottom":d=Math.max(t[1],e[1])+n,s.push([t[0],d]),s.push([e[0],d]);break}}else{const c=(u,f)=>({left:[f[0]-n,f[1]],right:[f[0]+n,f[1]],top:[f[0],f[1]-n],bottom:[f[0],f[1]+n]})[u],l=c(o,t),d=c(a,e),h=Ni(l,d,r);s.push(l,h,d)}}return s}function Co(i,t){const e=new Set,n=new Set,s=new Set;return i.forEach(r=>{t(r).forEach(a=>{e.add(a),i.includes(a.source)&&i.includes(a.target)?n.add(a):s.add(a)})}),{edges:Array.from(e),internal:Array.from(n),external:Array.from(s)}}function Nc(i,t){const e=[];let n=i;for(;n;){e.push(n);const s=t(w(n));if(s)n=s;else break}if(e.some(s=>{var r;return(r=s.style)===null||r===void 0?void 0:r.collapsed})){const s=e.reverse().findIndex(me);return e[s]||e.at(-1)}return i}function yf(i,t){return t||(i<4?10:i===4?12:i*2.5)}const mf=(i,t)=>{const e=Math.max(i,t)/2;return[["M",-i/2,0],["A",e,e,0,1,0,2*e-i/2,0],["A",e,e,0,1,0,-i/2,0],["Z"]]},Ic=(i,t)=>[["M",-i/2,0],["L",i/2,-t/2],["L",i/2,t/2],["Z"]],bf=(i,t)=>[["M",-i/2,0],["L",0,-t/2],["L",i/2,0],["L",0,t/2],["Z"]],Ef=(i,t)=>[["M",-i/2,0],["L",i/2,-t/2],["L",4*i/5-i/2,0],["L",i/2,t/2],["Z"]],xf=(i,t)=>[["M",-i/2,-t/2],["L",i/2,-t/2],["L",i/2,t/2],["L",-i/2,t/2],["Z"]],Sf=(i,t)=>{const e=i/2,n=i/7,s=i-n;return[["M",-e,0],["L",0,-t/2],["L",0,t/2],["Z"],["M",s-e,-t/2],["L",s+n-e,-t/2],["L",s+n-e,t/2],["L",s-e,t/2],["Z"]]},Of=(i,t)=>[["M",i/2,-t/2],["L",-i/2,0],["L",i/2,0],["L",-i/2,0],["L",i/2,t/2]];var Ds=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class En extends Ec{constructor(t){super(ee({style:En.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){const{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:n}=e,s=Ds(e,["loop"]),{sourceNode:r,targetNode:o}=this,c={d:n&&Pf(r,o)?this.getLoopPath(t):this.getKeyPath(t)};return M.y$.PARSED_STYLE_LIST.forEach(l=>{l in s&&(c[l]=s[l])}),c}getLoopPath(t){const{sourcePort:e,targetPort:n}=t,s=this.sourceNode,r=gn(s),o=Math.max(Je(r),tn(r)),{placement:a,clockwise:c,dist:l=o}=Yt(this.getGraphicStyle(t),"loop");return ff(s,a,c,l,e,n)}getEndpoints(t,e=!0,n=[]){const{sourcePort:s,targetPort:r}=t,{sourceNode:o,targetNode:a}=this,[c,l]=Rf(o,a,s,r);if(!e){const f=c?xn(c):o.getCenter(),g=l?xn(l):a.getCenter();return[f,g]}const d=typeof n=="function"?n():n,h=Fc(c||o,d[0]||l||a),u=Fc(l||a,d[d.length-1]||c||o);return[h,u]}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),n=Yt(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=Yt(this.getGraphicStyle(t),"label"),{placement:n,offsetX:s,offsetY:r,autoRotate:o,maxWidth:a}=e,c=Ds(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=Tc(this.shapeMap.key,n,o,s,r),d=this.shapeMap.key.getLocalBounds(),h=Ou([d.min,d.max],a);return Object.assign({wordWrapWidth:h},l,c)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const e=Yt(t,"badge"),{offsetX:n,offsetY:s,placement:r}=e,o=Ds(e,["offsetX","offsetY","placement"]);return Object.assign(o,af(this.shapeMap,r,t.labelPlacement,n,s))}drawArrow(t,e){var n;const s=e==="start",o=t[e==="start"?"startArrow":"endArrow"],a=this.shapeMap.key;if(o){const c=this.getArrowStyle(t,s),[l,d,h]=s?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],u=a.parsedStyle[l];if(u)u.attr(c);else{const f=c.src?M.Ee:M.y$,g=new f({style:c});a.style[l]=g}a.style[d]=t[h]||c.width/2+ +c.lineWidth}else{const c=s?"markerStart":"markerEnd";(n=a.style[c])===null||n===void 0||n.destroy(),a.style[c]=null}}getArrowStyle(t,e){const n=this.getShape("key").attributes,s=e?"startArrow":"endArrow",r=Yt(this.getGraphicStyle(t),s),{size:o,type:a}=r,c=Ds(r,["size","type"]),[l,d]=De(yf(n.lineWidth,o)),u=((0,et.Z)(a)?a:W[a]||Ic)(l,d);return Object.assign((0,Li.Z)(n,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:d},Object.assign({},u&&{d:u,fill:a==="simple"?"":n.stroke}),c)}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",bn,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);this.upsert("halo",M.y$,n,e)}drawBadgeShape(t,e){const n=this.getBadgeStyle(t);this.upsert("badge",ii,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const n=this.getKeyStyle(t);return this.upsert("key",M.y$,n,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(t,e);return n&&new Proxy(n,{set:(s,r,o)=>(r==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(s,r,o))})}}En.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class Fn extends En{constructor(t){super(ee({style:Fn.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t),{controlPoints:s,curvePosition:r,curveOffset:o}=t,a=this.getControlPoints(e,n,lf(r),cf(o),s);return Ac(e,n,a)}getControlPoints(t,e,n,s,r){return(r==null?void 0:r.length)===2?r:[Oo(t,e,n[0],s[0]),Oo(t,e,n[1],s[1])]}}Fn.defaultStyleProps={curvePosition:.5,curveOffset:20};class Ts extends Fn{constructor(t){super(ee({style:Ts.defaultStyleProps},t))}getControlPoints(t,e,n,s){const r=e[0]-t[0];return[[t[0]+r*n[0]+s[0],t[1]],[e[0]-r*n[1]+s[1],e[1]]]}}Ts.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Ms extends Fn{constructor(t){super(ee({style:Ms.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=qt(this.ref),n=this.sourceNode.getIntersectPoint(e,!0),s=this.targetNode.getIntersectPoint(e);return[n,s]}toRadialCoordinate(t){const e=qt(this.ref),n=It(t,e),s=Xa(Mt(t,e));return[n,s]}getControlPoints(t,e,n,s){const[r,o]=this.toRadialCoordinate(t),[a]=this.toRadialCoordinate(e),c=a-r;return[[t[0]+(c*n[0]+s[0])*Math.cos(o),t[1]+(c*n[0]+s[0])*Math.sin(o)],[e[0]-(c*n[1]-s[0])*Math.cos(o),e[1]-(c*n[1]-s[0])*Math.sin(o)]]}}Ms.defaultStyleProps={curvePosition:.5,curveOffset:20};class As extends Fn{constructor(t){super(ee({style:As.defaultStyleProps},t))}getControlPoints(t,e,n,s){const r=e[1]-t[1];return[[t[0],t[1]+r*n[0]+s[0]],[e[0],e[1]-r*n[1]+s[1]]]}}As.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Ls extends En{constructor(t){super(ee({style:Ls.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}}Ls.defaultStyleProps={};const wf={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:ds},dn=i=>`${Math.round(i[0])}|||${Math.round(i[1])}`;function $n(i,t){const e=n=>Math.round(n/t);return(0,Rt.Z)(i)?e(i):i.map(e)}function Cf(i,t){const e=Math.abs(i-t);return e>Math.PI?2*Math.PI-e:e}function Pc(i,t){const e=t[0]-i[0],n=t[1]-i[1];return!e&&!n?0:Math.atan2(n,e)}function _c(i,t,e,n){const s=Pc(i,t),r=e[dn(i)],a=Pc(r||n,i);return Cf(a,s)}const Df=(i,t)=>{const{offset:e,gridSize:n}=t,s={};return i.forEach(r=>{if(!r||r.destroyed||!r.isVisible())return;const o=pn(r.getRenderBounds(),e);for(let a=$n(o.min[0],n);a<=$n(o.max[0],n);a+=1)for(let c=$n(o.min[1],n);c<=$n(o.max[1],n);c+=1)s[`${a}|||${c}`]=!0}),s};function Rc(i,t,e){return Math.min(...t.map(n=>e(i,n)))}function Tf(i,t,e){let n=i[0],s=e(i[0],t);for(let r=0;r<i.length;r++){const o=i[r],a=e(o,t);a<s&&(n=o,s=a)}return n}const kc=(i,t,e,n)=>{if(!t)return[i];const{directionMap:s,offset:r}=n,o=pn(t.getRenderBounds(),r),a=Object.keys(s).reduce((c,l)=>{if(e.includes(l)){const d=s[l],[h,u]=fn(o),f=[i[0]+d.stepX*h,i[1]+d.stepY*u],g=Sd(o);for(let p=0;p<g.length;p++){const v=ho([i,f],g[p]);v&&aa(v,o)&&c.push(v)}}return c},[]);return Be(i,o)||a.push(i),a.map(c=>$n(c,n.gridSize))},Mf=(i,t,e,n,s,r,o)=>{const a=[];let c=[r[0]===n[0]?n[0]:i[0]*o,r[1]===n[1]?n[1]:i[1]*o];a.unshift(c);let l=i,d=t[dn(l)];for(;d;){const f=d,g=l;_c(f,g,t,e)&&(c=[f[0]===g[0]?c[0]:f[0]*o,f[1]===g[1]?c[1]:f[1]*o],a.unshift(c)),d=t[dn(f)],l=f}const h=s.map(f=>[f[0]*o,f[1]*o]),u=Tf(h,c,ds);return a.unshift(u),a};function Af(i,t,e,n){const s=jn(i.getCenter()),r=jn(t.getCenter()),o=Object.assign(wf,n),{gridSize:a}=o,c=o.enableObstacleAvoidance?e:[i,t],l=Df(c,o),d=$n(s,a),h=$n(r,a),u=kc(s,i,o.startDirections,o),f=kc(r,t,o.endDirections,o);u.forEach(N=>delete l[dn(N)]),f.forEach(N=>delete l[dn(N)]);const g={},p={},v={},y={},m={},b=new Lf;for(let N=0;N<u.length;N++){const z=u[N],U=dn(z);g[U]=z,y[U]=0,m[U]=Rc(z,f,o.distFunc),b.add({id:U,value:m[U]})}const E=f.map(N=>dn(N));let S=o.maximumLoops,O,A=1/0;for(const[N,z]of Object.entries(g))m[N]<=A&&(A=m[N],O=z);for(;Object.keys(g).length>0&&S>0;){const N=b.minId(!1);if(N)O=g[N];else break;const z=dn(O);if(E.includes(z))return Mf(O,v,d,r,u,h,a);delete g[z],b.remove(z),p[z]=!0;for(const U of Object.values(o.directionMap)){const J=at(O,[U.stepX,U.stepY]),G=dn(J);if(p[G])continue;const vt=_c(O,J,v,d);if(vt>o.maxAllowedDirectionChange||l[G])continue;g[G]||(g[G]=J);const ht=o.penalties[vt],ut=o.distFunc(O,J)+(isNaN(ht)?a:ht),yt=y[z]+ut,bt=y[G];bt&&yt>=bt||(v[G]=O,y[G]=yt,m[G]=yt+Rc(J,f,o.distFunc),b.add({id:G,value:m[G]}))}S-=1}return[]}class Lf{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let n=0,s=e-1;for(;s-n>1;){const r=Math.floor((n+s)/2);if(this.arr[r].value>t.value)s=r;else if(this.arr[r].value<t.value)n=r;else{this.arr.splice(r,0,t),this.map[t.id]=!0;return}}this.arr.splice(s,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class Ns extends En{constructor(t){super(ee({style:Ns.defaultStyleProps},t))}getControlPoints(t){const{router:e}=t,{sourceNode:n,targetNode:s}=this,[r,o]=this.getEndpoints(t,!1);let a=[];if(!e)a=t.controlPoints;else if(e.type==="shortest-path"){const c=this.context.element.getNodes();a=Af(n,s,c,e),a.length||(a=Oc(r,o,n,s,t.controlPoints,{padding:e.offset}))}else e.type==="orth"&&(a=Oc(r,o,n,s,t.controlPoints,e));return a}getPoints(t){const e=this.getControlPoints(t),[n,s]=this.getEndpoints(t,!0,e);return[n,...e,s]}getKeyPath(t){const e=this.getPoints(t);return wo(e,t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:n,radius:s}=t,r=this.sourceNode,o=gn(r),a=Math.max(Je(o),tn(o))/4,{placement:c,clockwise:l,dist:d=a}=Yt(this.getGraphicStyle(t),"loop");return pf(r,s,c,l,d,e,n)}}Ns.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Is extends En{constructor(t){super(ee({style:Is.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:n}=t,[s,r]=this.getEndpoints(t),o=t.controlPoint||Oo(s,r,e,n);return df(s,r,o)}}Is.defaultStyleProps={curvePosition:.5,curveOffset:30};var Nf=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function Ii(i){return i instanceof Ze&&i.type==="node"}function jc(i){return i instanceof En}function Do(i){return i instanceof ri}function If(i){return Ii(i)||jc(i)||Do(i)}function Pf(i,t){return!i||!t?!1:i===t}const _f={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function To(i,t,e=_f,n=!0){const s=[.5,.5],r=(0,ti.Z)(t)?(0,Ce.Z)(e,t.toLocaleLowerCase(),s):t;if(!n&&(0,ti.Z)(t))return r;const[o,a]=r||s;return[i.min[0]+Je(i)*o,i.min[1]+tn(i)*a]}function Mo(i){if(!i)return{};const t=i.getPorts();return(i.attributes.ports||[]).forEach((n,s)=>{var r;const{key:o,placement:a}=n;Bc(n)&&(t[r=o||s]||(t[r]=cn(i.getShape("key").getBounds(),a)))}),t}function Bc(i){const{r:t}=i;return!t||Number(t)===0}function xn(i){return Jn(i)?i:i.getPosition()}function Rf(i,t,e,n){const s=zc(i,t,e,n),r=zc(t,i,n,e);return[s,r]}function zc(i,t,e,n){const s=Mo(i);if(e)return s[e];const r=Object.values(s);if(r.length===0)return;const o=r.map(l=>xn(l)),a=kf(t,n),[c]=fu(o,a);return r.find(l=>xn(l)===c)}function kf(i,t){const e=Mo(i);if(t)return[xn(e[t])];const n=Object.values(e);return n.length>0?n.map(s=>xn(s)):[i.getCenter()]}function Fc(i,t){return Do(i)||Ii(i)?Ao(i,t):Pi(i,t)}function Pi(i,t){if(!i||!t)return[0,0,0];if(Jn(i))return i;if(i.attributes.linkToCenter)return i.getPosition();const e=Jn(t)?t:Ii(t)?t.getCenter():t.getPosition();return us(e,i.getBounds())}function Ao(i,t){if(!i||!t)return[0,0,0];const e=Jn(t)?t:Ii(t)?t.getCenter():t.getPosition();return i.getIntersectPoint(e)||i.getCenter()}function $c(i,t="bottom",e=0,n=0,s=!1){const r=t.split("-"),[o,a]=cn(i,t),[c,l]=s?["bottom","top"]:["top","bottom"],d=r.includes("top")?l:r.includes("bottom")?c:"middle",h=r.includes("left")?"right":r.includes("right")?"left":"center";return{transform:[["translate",o+e,a+n]],textBaseline:d,textAlign:h}}function jf(i,t){return[[0,-i],[t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)],[i*Math.cos(Math.PI/10),-i*Math.sin(Math.PI/10)],[t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[i*Math.cos(3*Math.PI/10),i*Math.sin(3*Math.PI/10)],[0,t],[-i*Math.cos(3*Math.PI/10),i*Math.sin(3*Math.PI/10)],[-t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[-i*Math.cos(Math.PI/10),-i*Math.sin(Math.PI/10)],[-t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)]]}function Bf(i,t){const e={};return e.top=[0,-i],e.left=[-i*Math.cos(Math.PI/10),-i*Math.sin(Math.PI/10)],e["left-bottom"]=[-i*Math.cos(3*Math.PI/10),i*Math.sin(3*Math.PI/10)],e.bottom=[0,t],e["right-bottom"]=[i*Math.cos(3*Math.PI/10),i*Math.sin(3*Math.PI/10)],e.right=e.default=[i*Math.cos(Math.PI/10),-i*Math.sin(Math.PI/10)],e}function zf(i,t,e){const n=t/2,s=i/2,r={up:[[-s,n],[s,n],[0,-n]],left:[[-s,0],[s,n],[s,-n]],right:[[-s,n],[-s,-n],[s,0]],down:[[-s,-n],[s,-n],[0,n]]};return r[e]||r.up}function Ff(i,t,e){const n=t/2,s=i/2,r={};return e==="down"?(r.bottom=r.default=[0,n],r.right=[s,-n],r.left=[-s,-n]):e==="left"?(r.top=[s,-n],r.bottom=[s,n],r.left=r.default=[-s,0]):e==="right"?(r.top=[-s,-n],r.bottom=[-s,n],r.right=r.default=[s,0]):(r.left=[-s,n],r.top=r.default=[0,-n],r.right=[s,n]),r}function Im(i,t){return[[i/2,-t/2],[i/2,t/2],[-i/2,t/2],[-i/2,-t/2]]}function $f(i,t){return[[0,-t/2],[i/2,0],[0,t/2],[-i/2,0]]}function Wf(i){return(0,Ce.Z)(i,["style","visibility"])!=="hidden"}function Zf(i,t){const{zIndex:e,transform:n,transformOrigin:s,visibility:r,cursor:o,clipPath:a,component:c}=t,l=Nf(t,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(i.attributes,l),n&&i.setAttribute("transform",n),(0,Rt.Z)(e)&&i.setAttribute("zIndex",e),s&&i.setAttribute("transformOrigin",s),r&&i.setAttribute("visibility",r),o&&i.setAttribute("cursor",o),a&&i.setAttribute("clipPath",a),c&&i.setAttribute("component",c)}function Lo(i,t){"update"in i?i.update(t):i.attr(t)}function Vf(i){return[[0,i],[i*Math.sqrt(3)/2,i/2],[i*Math.sqrt(3)/2,-i/2],[0,-i],[-i*Math.sqrt(3)/2,-i/2],[-i*Math.sqrt(3)/2,i/2]]}function Hf(i){(0,vs.Z)(i,"__to_be_destroyed__",!0)}function Ps(i){return(0,Ce.Z)(i,"__to_be_destroyed__",!1)}var Yf=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class _s extends we{constructor(t,e){super(t,Object.assign({},_s.defaultOptions,e)),this.onCollapseExpand=n=>Yf(this,void 0,void 0,function*(){if(!this.validate(n))return;const{target:s}=n;if(!If(s))return;const r=s.id,{model:o,graph:a}=this.context,c=o.getElementDataById(r);if(!c)return!1;const{onCollapse:l,onExpand:d,animation:h,align:u}=this.options;me(c)?(yield a.expandElement(r,{animation:h,align:u}),d==null||d(r)):(yield a.collapseElement(r,{animation:h,align:u}),l==null||l(r))}),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}_s.defaultOptions={enable:!0,animation:!0,trigger:x.DBLCLICK,align:!0};var Rs={},Uf=function(i){return i=i||"g",Rs[i]?Rs[i]+=1:Rs[i]=1,i+Rs[i]},ks=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};const Gf="g6-create-edge-assist-edge-id",js="g6-create-edge-assist-node-id";class Bs extends we{constructor(t,e){super(t,Object.assign({},Bs.defaultOptions,e)),this.drop=n=>ks(this,void 0,void 0,function*(){const{targetType:s}=n;["combo","node"].includes(s)&&this.source?yield this.handleCreateEdge(n):yield this.cancelEdge()}),this.handleCreateEdge=n=>ks(this,void 0,void 0,function*(){var s,r,o;if(!this.validate(n))return;const{graph:a,canvas:c,batch:l,element:d}=this.context,{style:h}=this.options;if(this.source){this.createEdge(n),yield this.cancelEdge();return}l.startBatch(),c.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([n.target.id])[0];const u=a.getElementData(this.source);a.addNodeData([{id:js,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(s=u.style)===null||s===void 0?void 0:s.x,y:(r=u.style)===null||r===void 0?void 0:r.y}}]),a.addEdgeData([{id:Gf,source:this.source,target:js,style:Object.assign({pointerEvents:"none"},h)}]),yield(o=d.draw({animation:!1}))===null||o===void 0?void 0:o.finished}),this.updateAssistEdge=n=>ks(this,void 0,void 0,function*(){var s;if(!this.source)return;const{model:r,element:o}=this.context;r.translateNodeTo(js,[n.canvas.x,n.canvas.y]),yield(s=o.draw({animation:!1,silence:!0}))===null||s===void 0?void 0:s.finished}),this.createEdge=n=>{var s,r;const{graph:o}=this.context,{style:a,onFinish:c,onCreate:l}=this.options;if(((s=n.target)===null||s===void 0?void 0:s.id)===void 0||this.source===void 0)return;const h=(r=this.getSelectedNodeIDs([n.target.id]))===null||r===void 0?void 0:r[0],u=`${this.source}-${h}-${Uf()}`,f=l({id:u,source:this.source,target:h,style:a});o.addEdgeData([f]),c(f)},this.cancelEdge=()=>ks(this,void 0,void 0,function*(){var n;if(!this.source)return;const{graph:s,element:r,batch:o}=this.context;s.removeNodeData([js]),this.source=void 0,yield(n=r.draw({animation:!1}))===null||n===void 0?void 0:n.finished,o.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),e==="click"?(t.on(St.CLICK,this.handleCreateEdge),t.on(Z.CLICK,this.handleCreateEdge),t.on(R.CLICK,this.cancelEdge),t.on(wt.CLICK,this.cancelEdge)):(t.on(St.DRAG_START,this.handleCreateEdge),t.on(Z.DRAG_START,this.handleCreateEdge),t.on(x.POINTER_UP,this.drop)),t.on(x.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;t.off(St.CLICK,this.handleCreateEdge),t.off(Z.CLICK,this.handleCreateEdge),t.off(R.CLICK,this.cancelEdge),t.off(wt.CLICK,this.cancelEdge),t.off(St.DRAG_START,this.handleCreateEdge),t.off(Z.DRAG_START,this.handleCreateEdge),t.off(x.POINTER_UP,this.drop),t.off(x.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Bs.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:i=>i,onFinish:()=>{}};var zs=_(99860),Wc=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Fs extends we{constructor(t,e){super(t,Object.assign({},Fs.defaultOptions,e)),this.isDragging=!1,this.onDragStart=n=>{this.validate(n)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=n=>{var s,r,o,a;if(!this.isDragging||Vt.isPinching)return;const c=(r=(s=n.movement)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:n.dx,l=(a=(o=n.movement)===null||o===void 0?void 0:o.y)!==null&&a!==void 0?a:n.dy;c|l&&this.translate([c,l],!1)},this.onDragEnd=()=>{var n,s;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(s=(n=this.options).onFinish)===null||s===void 0||s.call(n)},this.invokeOnFinish=(0,zs.Z)(()=>{var n,s;(s=(n=this.options).onFinish)===null||s===void 0||s.call(n)},300),this.shortcut=new ei(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if((0,j.Z)(t)){const{up:e=[],down:n=[],left:s=[],right:r=[]}=t;this.shortcut.bind(e,o=>this.onTranslate([0,1],o)),this.shortcut.bind(n,o=>this.onTranslate([0,-1],o)),this.shortcut.bind(s,o=>this.onTranslate([1,0],o)),this.shortcut.bind(r,o=>this.onTranslate([-1,0],o))}else{const{graph:e}=this.context;e.on(x.DRAG_START,this.onDragStart),e.on(x.DRAG,this.onDrag),e.on(x.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return Wc(this,void 0,void 0,function*(){if(!this.validate(e))return;const{sensitivity:n}=this.options,s=n*-1;yield this.translate(Fe(t,s),this.options.animation),this.invokeOnFinish()})}translate(t,e){return Wc(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),yield this.context.graph.translateBy(t,e)})}clampByDirection([t,e]){const{direction:n}=this.options;return n==="x"?e=0:n==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:s}=this.context,[r,o]=s.getSize(),[a,c,l,d]=je(this.options.range),h=[o*a,r*c,o*l,r*d],u=pn(Gr(n.getCanvasCenter()),h),f=Mt(n.getViewportCenter(),[t,e,0]);if(!Be(f,u)){const{min:[g,p],max:[v,y]}=u;(f[0]<g&&t>0||f[0]>v&&t<0)&&(t=0),(f[1]<p&&e>0||f[1]>y&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return typeof e=="function"?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(x.DRAG_START,this.onDragStart),t.off(x.DRAG,this.onDrag),t.off(x.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}Fs.defaultOptions={enable:i=>"targetType"in i?i.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var Zc=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class _i extends we{constructor(t,e){super(t,Object.assign({},_i.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=n=>Zc(this,void 0,void 0,function*(){var s;if(this.options.dropEffect!=="link")return;const{model:r,element:o}=this.context,a=n.target.id;this.target.forEach(c=>{const l=r.getParentData(c,ot);l&&w(l)===a&&r.refreshComboData(a),r.setParent(c,a,ot)}),yield(s=o==null?void 0:o.draw({animation:!0}))===null||s===void 0?void 0:s.finished}),this.setCursor=n=>{if(this.isDragging)return;const{type:s}=n,{canvas:r}=this.context,{cursor:o}=this.options;s===x.POINTER_ENTER?r.setCursor((o==null?void 0:o.grab)||"grab"):r.setCursor((o==null?void 0:o.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(s=>{t.on(`${s}:${x.DRAG_START}`,this.onDragStart),t.on(`${s}:${x.DRAG}`,this.onDrag),t.on(`${s}:${x.DRAG_END}`,this.onDragEnd),t.on(`${s}:${x.POINTER_ENTER}`,this.setCursor),t.on(`${s}:${x.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(Z.DROP,this.onDrop),t.on(R.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return $e([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:n,canvas:s,graph:r}=this.context;s.setCursor(((e=this.options.cursor)===null||e===void 0?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const o=t.target.id;r.getElementState(o).includes(this.options.state)?this.target=this.getSelectedNodeIDs([o]):this.target=[o],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:o=0,y:a=0}=this.shadow.attributes,[c,l]=Mt([+o,+a],this.shadowOrigin);this.moveElement(this.target,[c,l])}this.showEdges(),(e=(t=this.options).onFinish)===null||e===void 0||e.call(t,this.target);const{batch:s,canvas:r}=this.context;s.endBatch(),r.setCursor(((n=this.options.cursor)===null||n===void 0?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}moveElement(t,e){return Zc(this,void 0,void 0,function*(){const{graph:n,model:s}=this.context,{dropEffect:r}=this.options;r==="move"&&t.forEach(o=>s.refreshComboData(o)),n.translateElementBy(Object.fromEntries(t.map(o=>[o,e])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:n=0}=this.shadow.attributes,[s,r]=t;this.shadow.attr({x:+e+s,y:+n+r})}createShadow(t){const e=Yt(this.options,"shadow"),n=bi(t.map(l=>this.context.element.getElement(l).getBounds())),[s,r]=n.min;this.shadowOrigin=[s,r];const[o,a]=fn(n),c={width:o,height:a,x:s,y:r};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),c),{visibility:"visible"})):(this.shadow=new M.UL({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),c),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if(t==="none"||e)return;const{graph:n}=this.context;t==="all"?this.hiddenEdges=n.getEdgeData().map(w):this.hiddenEdges=Array.from(new Set(this.target.map(s=>n.getRelatedEdgesData(s,t).map(w)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(s=>{t.off(`${s}:${x.DRAG_START}`,this.onDragStart),t.off(`${s}:${x.DRAG}`,this.onDrag),t.off(`${s}:${x.DRAG_END}`,this.onDragEnd),t.off(`${s}:${x.POINTER_ENTER}`,this.setCursor),t.off(`${s}:${x.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${x.DROP}`,this.onDrop),t.off(`canvas:${x.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)===null||t===void 0||t.destroy(),super.destroy()}}_i.defaultOptions={animation:!0,enable:i=>["node","combo"].includes(i.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var No=_(16754);class $s{constructor(t,e){this.context=t,this.options=e||{}}}var Xf=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})},Kf=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function Pm(i){const{type:t}=i;return!!(["comboCombined","comboForce"].includes(t)||t==="antv-dagre"&&i.sortByCombo)}function qf(i){const{type:t}=i;return["compact-box","mindmap","dendrogram","indented"].includes(t)}function _m(i){return isNumber(i.x)&&isNumber(i.y)}function Qf(i){return!Array.isArray(i)&&(i==null?void 0:i.preLayout)}function Ws(i){const{nodes:t,edges:e}=i,n={nodes:[],edges:[],combos:[]};return t.forEach(s=>{const r=s.data._isCombo?n.combos:n.nodes,{x:o,y:a,z:c=0}=s.data;r==null||r.push({id:s.id,style:{x:o,y:a,z:c}})}),e.forEach(s=>{const{id:r,source:o,target:a,data:{points:c=[],controlPoints:l=c.slice(1,c.length-1)}}=s;n.edges.push({id:r,source:o,target:a,style:Object.assign({},l!=null&&l.length?{controlPoints:l.map(re)}:{})})}),n}function Jf(i,t){class e extends $s{constructor(s,r){if(super(s,r),this.instance=new i({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const o=this.instance;this.stop=o.stop.bind(o),this.tick=a=>{const c=o.tick(a);return Ws(c)}}}execute(s,r){return Xf(this,void 0,void 0,function*(){return Ws(yield this.instance.execute(this.graphData2LayoutModel(s),this.transformOptions((0,kn.Z)({},this.options,r))))})}transformOptions(s){const{onTick:r}=s;return r&&(s.onTick=o=>r(Ws(o))),s}graphData2LayoutModel(s){const{nodes:r=[],edges:o=[],combos:a=[]}=s,c=r.map(f=>{const g=w(f),{data:p,style:v,combo:y}=f,m=Kf(f,["data","style","combo"]),b={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},p),{data:p}),y?{parentId:y}:{}),{style:v}),m)};return v!=null&&v.x&&Object.assign(b.data,{x:v.x}),v!=null&&v.y&&Object.assign(b.data,{y:v.y}),v!=null&&v.z&&Object.assign(b.data,{z:v.z}),b}),l=new Map(c.map(f=>[f.id,f])),d=o.filter(f=>{const{source:g,target:p}=f;return l.has(g)&&l.has(p)}).map(f=>{const{source:g,target:p,data:v,style:y}=f;return{id:w(f),source:g,target:p,data:Object.assign({},v),style:Object.assign({},y)}}),h=a.map(f=>({id:w(f),data:Object.assign({_isCombo:!0},f.data),style:Object.assign({},f.style)})),u=new No.k({nodes:[...c,...h],edges:d});return t.model.model.hasTreeStructure(ot)&&(u.attachTreeStructure(ot),c.forEach(f=>{const g=t.model.model.getParent(f.id,ot);g&&u.hasNode(g.id)&&u.setParent(f.id,g.id,ot)})),u}}return e}function Io(i,t,...e){if(t in i)return i[t](...e);if("instance"in i){const n=i.instance;if(t in n)return n[t](...e)}return null}function Vc(i,t){if(t in i)return i[t];if("instance"in i){const e=i.instance;if(t in e)return e[t]}return null}var tg=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class eg extends _i{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(t==null?void 0:t.id))}validate(t){return this.context.layout?this.forceLayoutInstance?super.validate(t):(F.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(t,e){return tg(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((s,r)=>{const{x:o=0,y:a=0}=s.style||{};n&&Io(n,"setFixedPosition",t[r],[...at([+o,+a],e)])})})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&Vc(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(n=>{const{x:s=0,y:r=0}=n.style||{};e&&Io(e,"setFixedPosition",w(n),[+s,+r])})}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&Vc(t,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(e=>{t&&Io(t,"setFixedPosition",w(e),[null,null,null])})}}var Hc=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Zs extends we{constructor(t,e){super(t,Object.assign({},Zs.defaultOptions,e)),this.isZoomEvent=n=>!!(n.data&&"scale"in n.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=n=>Hc(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:s}=this.context,{state:r,nodeFilter:o,edgeFilter:a,comboFilter:c}=this.options,l=(r?s.getElementDataByState("node",r):s.getNodeData()).filter(o),d=(r?s.getElementDataByState("edge",r):s.getEdgeData()).filter(a),h=(r?s.getElementDataByState("combo",r):s.getComboData()).filter(c),u=this.isZoomEvent(n)?this.zoom=Math.max(.01,Math.min(n.data.scale,10)):this.zoom,f=[...l,...h];f.length>0&&f.forEach(g=>this.fixNodeLike(g,u)),this.updateRelatedEdges(),d.length>0&&d.forEach(g=>this.fixEdge(g,u))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(n,s,r)=>{var o;const a=this.cachedStyles.get(n)||[],c=((o=a.find(l=>l.shape===s))===null||o===void 0?void 0:o.style)||{};return r in c||(c[r]=s.attributes[r],this.cachedStyles.set(n,[...a.filter(l=>l.shape!==s),{shape:s,style:c}])),c[r]},this.scaleEntireElement=(n,s,r)=>{s.setLocalScale(1/r);const o=this.cachedStyles.get(n)||[];o.push({shape:s}),this.cachedStyles.set(n,o)},this.scaleSpecificShapes=(n,s,r)=>{const o=Bu(n);(Array.isArray(r)?r:[r]).forEach(c=>{const{shape:l,fields:d}=c,h=typeof l=="function"?l(o):n.getShape(l);if(h){if(!d){this.scaleEntireElement(n.id,h,s);return}d.forEach(u=>{const f=this.getOriginalFieldValue(n.id,h,u);(0,Rt.Z)(f)&&(h.style[u]=f/s)})}})},this.skipIfExceedViewport=n=>{const{viewport:s}=this.context;return!(s!=null&&s.isInViewport(n.getRenderBounds(),!1,30))},this.fixNodeLike=(n,s)=>{const r=w(n),{element:o,model:a}=this.context,c=o.getElement(r);if(!c||this.skipIfExceedViewport(c))return;a.getRelatedEdgesData(r).forEach(h=>this.relatedEdgeToUpdate.add(w(h)));const d=this.options[c.type];if(!d){this.scaleEntireElement(r,c,s);return}this.scaleSpecificShapes(c,s,d)},this.fixEdge=(n,s)=>{const r=w(n),o=this.context.element.getElement(r);if(!o||this.skipIfExceedViewport(o))return;const a=this.options.edge;if(!a){o.style.transformOrigin="center",this.scaleEntireElement(r,o,s);return}this.scaleSpecificShapes(o,s,a)},this.updateRelatedEdges=()=>{const{element:n}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(s=>{const r=n.getElement(s);r==null||r.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=n=>Hc(this,void 0,void 0,function*(){var s;!((s=n.data)===null||s===void 0)&&s.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(s=>{s.forEach(({shape:r,style:o})=>{if(nn(o))r.setLocalScale(1);else{if(this.options.state)return;Object.entries(o).forEach(([a,c])=>r.style[a]=c)}})});const{graph:t,element:e}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(s=>s&&t.getElementType(s)==="node");if(n.length>0){const s=new Set;n.forEach(r=>{t.getRelatedEdgesData(r).forEach(o=>s.add(w(o)))}),s.forEach(r=>{const o=e==null?void 0:e.getElement(r);o==null||o.update({})})}}}bindEvents(){const{graph:t}=this.context;t.on(P.AFTER_DRAW,this.resetTransform),t.on(P.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:t}=this.context;t.off(P.AFTER_DRAW,this.resetTransform),t.off(P.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Zs.defaultOptions={enable:i=>i.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var ng=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Vs extends we{constructor(t,e){super(t,Object.assign({},Vs.defaultOptions,e)),this.focus=n=>ng(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:s}=this.context;yield s.focusElement(n.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bn.forEach(e=>{t.on(`${e}:${x.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bn.forEach(e=>{t.off(`${e}:${x.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}Vs.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class Hs extends we{constructor(t,e){super(t,Object.assign({},Hs.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=n=>{this.isFrozen=n.type==="dragstart"},this.hoverElement=n=>{if(!this.validate(n))return;const s=n.type===x.POINTER_ENTER;this.updateElementsState(n,s);const{onHover:r,onHoverEnd:o}=this.options;s?r==null||r(n):o==null||o(n)},this.updateElementsState=(n,s)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:r}=this.context,{state:o,animation:a,inactiveState:c}=this.options,l=this.getActiveIds(n),d={};if(o&&Object.assign(d,this.getElementsState(l,o,s)),c){const h=Ha(r.getData(),!0).filter(u=>!l.includes(u));Object.assign(d,this.getElementsState(h,c,s))}r.setElementState(d,a)},this.getElementsState=(n,s,r)=>{const{graph:o}=this.context,a={};return n.forEach(c=>{const l=o.getElementState(c);r?a[c]=l.includes(s)?l:[...l,s]:a[c]=l.filter(d=>d!==s)}),a},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bn.forEach(n=>{t.on(`${n}:${x.POINTER_ENTER}`,this.hoverElement),t.on(`${n}:${x.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.addEventListener(`${x.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${x.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:n,direction:s}=this.options,r=t.target.id;return n?oc(e,t.targetType,r,typeof n=="function"?n(t):n,s):[r]}validate(t){if(this.destroyed||this.isFrozen||Ps(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bn.forEach(n=>{t.off(`${n}:${x.POINTER_ENTER}`,this.hoverElement),t.off(`${n}:${x.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.removeEventListener(`${x.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${x.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}Hs.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class ig extends Ci{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e}=this.context;this.pathShape=new M.y$({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[fs(t)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:n,mode:s}=this.options;this.points.push(fs(t)),(e=this.pathShape)===null||e===void 0||e.setAttribute("d",Pu(this.points)),n&&s==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)===null||t===void 0||t.remove(),this.pathShape=void 0,this.points=void 0}}class Ys extends we{constructor(t,e){super(t,Object.assign({},Ys.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(n,s,r)=>{n.filter(Boolean).forEach(o=>{s==="hidden"&&!o.isVisible()?this.hiddenShapes.push(o):s==="visible"&&this.hiddenShapes.includes(o)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(o),1):Rn(o,s,r)})},this.filterShapes=(n,s)=>{if((0,et.Z)(s))return o=>!s(n,o);const r=s==null?void 0:s[n];return o=>o.className?!(r!=null&&r.includes(o.className)):!0},this.hideShapes=n=>{if(!this.validate(n)||!this.isVisible)return;const{element:s}=this.context,{shapes:r={}}=this.options;this.setElementsVisibility(s.getNodes(),"hidden",this.filterShapes("node",r)),this.setElementsVisibility(s.getEdges(),"hidden",this.filterShapes("edge",r)),this.setElementsVisibility(s.getCombos(),"hidden",this.filterShapes("combo",r)),this.isVisible=!1},this.showShapes=(0,zs.Z)(n=>{if(!this.validate(n)||this.isVisible)return;const{element:s}=this.context;this.setElementsVisibility(s.getNodes(),"visible"),this.setElementsVisibility(s.getEdges(),"visible"),this.setElementsVisibility(s.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(P.BEFORE_TRANSFORM,this.hideShapes),t.on(P.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(P.BEFORE_TRANSFORM,this.hideShapes),t.off(P.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Ys.defaultOptions={enable:!0,debounce:200,shapes:i=>i==="node"};var Yc=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Us extends we{constructor(t,e){super(t,Object.assign({},Us.defaultOptions,e)),this.onWheel=n=>Yc(this,void 0,void 0,function*(){this.options.preventDefault&&n.preventDefault();const s=n.deltaX,r=n.deltaY;yield this.scroll([-s,-r],n)}),this.shortcut=new ei(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),(0,j.Z)(n)){(t=this.graphDom)===null||t===void 0||t.removeEventListener(x.WHEEL,this.onWheel);const{up:s=[],down:r=[],left:o=[],right:a=[]}=n;this.shortcut.bind(s,c=>this.scroll([0,-10],c)),this.shortcut.bind(r,c=>this.scroll([0,10],c)),this.shortcut.bind(o,c=>this.scroll([-10,0],c)),this.shortcut.bind(a,c=>this.scroll([10,0],c))}else(e=this.graphDom)===null||e===void 0||e.addEventListener(x.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=Fe(t,e),t=this.clampByDirection(t),t=this.clampByRange(t),t}clampByDirection([t,e]){const{direction:n}=this.options;return n==="x"?e=0:n==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:s}=this.context,[r,o]=s.getSize(),[a,c,l,d]=je(this.options.range),h=[o*a,r*c,o*l,r*d],u=pn(Gr(n.getCanvasCenter()),h),f=Mt(n.getViewportCenter(),[t,e,0]);if(!Be(f,u)){const{min:[g,p],max:[v,y]}=u;(f[0]<g&&t>0||f[0]>v&&t<0)&&(t=0),(f[1]<p&&e>0||f[1]>y&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return Yc(this,void 0,void 0,function*(){if(!this.validate(e))return;const{onFinish:n}=this.options,s=this.context.graph,r=this.formatDisplacement(t);yield s.translateBy(r,!1),n==null||n()})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)===null||t===void 0||t.removeEventListener(x.WHEEL,this.onWheel),super.destroy()}}Us.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var Ri=_(63777),Uc=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Gs extends we{constructor(t,e){super(t,Object.assign({},Gs.defaultOptions,e)),this.zoom=(n,s,r)=>Uc(this,void 0,void 0,function*(){if(!this.validate(s))return;const{graph:o}=this.context;let a;"viewport"in s&&(a=re(s.viewport));const{sensitivity:c,onFinish:l}=this.options,d=1+(0,Ri.Z)(n,-50,50)*c/100,h=o.getZoom();yield o.zoomTo(h*d,r,a),l==null||l()}),this.onReset=()=>Uc(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=n=>{this.options.preventDefault&&n.preventDefault()},this.shortcut=new ei(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t))if(t.includes(x.PINCH))this.shortcut.bind([x.PINCH],e=>{this.zoom(e.scale,e,!1)});else{const e=this.context.canvas.getContainer();e==null||e.addEventListener(x.WHEEL,this.preventDefault),this.shortcut.bind([...t,x.WHEEL],n=>{const{deltaX:s,deltaY:r}=n;this.zoom(-(r!=null?r:s),n,!1)})}if(typeof t=="object"){const{zoomIn:e=[],zoomOut:n=[],reset:s=[]}=t;this.shortcut.bind(e,r=>this.zoom(10,r,this.options.animation)),this.shortcut.bind(n,r=>this.zoom(-10,r,this.options.animation)),this.shortcut.bind(s,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return(0,et.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.context.canvas.getContainer())===null||t===void 0||t.removeEventListener(x.WHEEL,this.preventDefault),super.destroy()}}Gs.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Xs=_(74355),sg=_(97011),rg=_(75346),og=_(92889),ag=_(8007),cg=_(67453),lg=_(71233),dg=_(87722),hg=_(32352),ug=_(58278),fg=_(49559),gg=_(83221),pg=_(42457),vg=_(88083),Gc=_(91391),yg=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Ks extends $s{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const t=this.context.model.getRootsData();if(!(nn(t)||t.length>2))return t[0]}formatSize(t){const e=typeof t=="function"?t:()=>t;return n=>De(e(n))}doLayout(t,e){const{hGap:n,getRibSep:s,vGap:r,nodeSize:o,height:a}=e,{model:c}=this.context,l=this.formatSize(o);let d=l(t)[0]+s(t);const h=(b,E=0)=>{var S;return E+=n*((b.children||[]).length+1),(S=b.children)===null||S===void 0||S.forEach(O=>{var A;(A=c.getNodeLikeDatum(O).children)===null||A===void 0||A.forEach(z=>{const U=c.getNodeLikeDatum(z);E=h(U,E)})}),E},u=b=>{if(b.depth===1)return d;const E=c.getParentData(b.id,"tree");if(oi(b)){const S=c.getParentData(E.id,"tree"),O=p(b)-p(S);return u(E)+O*n/r}else{const S=(E.children||[]).indexOf(b.id),O=c.getNodeData((E.children||[]).slice(S));return f(E)-O.reduce((A,N)=>A+h(N),0)-l(E)[0]/2}},f=(0,Gc.Z)(b=>{if(Po(b))return l(b)[0]/2;const E=c.getParentData(b.id,"tree");if(oi(b))return u(b)+h(b)+l(b)[0]/2;{const S=p(b)-p(E),O=n/r;return u(b)+S*O}},b=>b.id),g=b=>p(c.getParentData(b,"tree")),p=(0,Gc.Z)(b=>{if(Po(b))return a/2;if(oi(b)){const E=c.getParentData(b.id,"tree"),S=E.children.indexOf(b.id);if(S===0)return g(E.id)+r;const O=c.getNodeLikeDatum(E.children[S-1]);if(nn(O.children))return p(O)+r;const A=c.getDescendantsData(O.id);return Math.max(...A.map(N=>oi(N)?g(N.id):p(N)))+r}else{if(nn(b.children))return g(b.id)+r;const E=c.getNodeLikeDatum(b.children.slice(-1)[0]);if(nn(E.children))return p(E)+r;const S=c.getDescendantsData(b.id).slice(-1)[0];return(oi(S)?g(S.id):p(S))+r}},b=>b.id);let v=0;const y={nodes:[],edges:[]},m=b=>{var E;(E=b.children)===null||E===void 0||E.forEach(z=>m(c.getNodeLikeDatum(z)));const S=p(b),O=f(b);if(y.nodes.push({id:b.id,x:O,y:S}),Po(b))return;const A=c.getRelatedEdgesData(b.id,"in")[0],N=[u(b),oi(b)?S:g(b.id)];y.edges.push({id:w(A),controlPoints:[N],relatedNodeId:b.id}),v=Math.max(v,O+s(b)),b.depth===1&&(d=v)};return m(t),y}placeAlterative(t,e){const n=(e.children||[]).filter((a,c)=>c%2!==0);if(n.length===0)return t;const{model:s}=this.context,r=t.nodes.find(a=>a.id===e.id).y,o=a=>{const c=s.getAncestorsData(a,"tree");if(nn(c))return!1;const l=c.length===1?a:c[c.length-2].id;return n.includes(l)};t.nodes.forEach(a=>{o(a.id)&&(a.y=2*r-a.y)}),t.edges.forEach(a=>{o(a.relatedNodeId)&&(a.controlPoints=a.controlPoints.map(c=>[c[0],2*r-c[1]]))})}rightToLeft(t,e){return t.nodes.forEach(n=>n.x=e.width-n.x),t.edges.forEach(n=>{n.controlPoints=n.controlPoints.map(s=>[e.width-s[0],s[1]])}),t}execute(t,e){return yg(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},Ks.defaultOptions),this.options),e),{direction:s,nodeSize:r}=n,o=this.getRoot();if(!o)return t;const a=this.formatSize(r);n.vGap||(n.vGap=Math.max(...(t.nodes||[]).map(u=>a(u)[1]))),n.hGap||(n.hGap=Math.max(...(t.nodes||[]).map(u=>a(u)[0])));let c=this.doLayout(o,n);this.placeAlterative(c,o),s==="RL"&&(c=this.rightToLeft(c,n));const{model:l}=this.context,d=[],h=[];return c.nodes.forEach(u=>{const{id:f,x:g,y:p}=u,v=l.getNodeLikeDatum(f);d.push(Xc(v,{x:g,y:p}))}),c.edges.forEach(u=>{const{id:f,controlPoints:g}=u,p=l.getEdgeDatum(f);h.push(Xc(p,{controlPoints:g}))}),{nodes:d,edges:h}})}}Ks.defaultOptions={direction:"RL",getRibSep:()=>60};const Xc=(i,t)=>Object.assign(Object.assign({},i),{style:Object.assign(Object.assign({},i.style||{}),t)}),Po=i=>i.depth===0,oi=i=>(i.depth||(i.depth=0))%2===0;var mg=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class qs extends $s{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){const n=typeof e=="function"?e:()=>e;return t.reduce((s,r)=>{const[o,a]=De(n(r))||[0,0];return[Math.max(s[0],o),Math.max(s[1],a)]},[0,0])}validate(t){const{nodes:e=[],edges:n=[]}=t,s={},r={},o={};e.forEach(u=>{s[u.id]=0,r[u.id]=0,o[u.id]=[]}),n.forEach(u=>{s[u.target]++,r[u.source]++,o[u.source].push(u.target)});const a=new Set,c=u=>{a.has(u)||(a.add(u),o[u].forEach(c))};if(c(e[0].id),a.size!==e.length)return!1;const l=e.filter(u=>s[u.id]===0),d=e.filter(u=>r[u.id]===0);return!(l.length!==1||d.length!==1||e.filter(u=>s[u.id]===1&&r[u.id]===1).length!==e.length-2)}execute(t,e){return mg(this,void 0,void 0,function*(){var n;if(!this.validate(t))return t;const{nodeSize:s,padding:r,sortBy:o,cols:a,colGap:c,rowGap:l,clockwise:d,width:h,height:u}=Object.assign({},qs.defaultOptions,this.options,e),[f,g,p,v]=je(r),y=this.formatSize(t.nodes||[],s),m=Math.ceil((t.nodes||[]).length/a);let b=c||(h-v-g-a*y[0])/(a-1),E=l||(u-f-p-m*y[1])/(m-1);return(E===1/0||E<0)&&(E=0),(b===1/0||b<0)&&(b=0),{nodes:((o?(n=t.nodes)===null||n===void 0?void 0:n.sort(o):bg(t))||[]).map((A,N)=>{const z=Math.floor(N/a),U=N%a,J=d?z%2===0?U:a-1-U:z%2===0?a-1-U:U,G=v+J*(y[0]+b)+y[0]/2,vt=f+z*(y[1]+E)+y[1]/2;return{id:A.id,style:{x:G,y:vt}}})}})}}qs.defaultOptions={padding:0,cols:5,clockwise:!0};function bg(i){const{nodes:t=[],edges:e=[]}=i,n={},s={};t.forEach(a=>{n[a.id]=0,s[a.id]=[]}),e.forEach(a=>{n[a.target]++,s[a.source].push(a.target)});const r=[],o=[];for(t.forEach(a=>{n[a.id]===0&&r.push(a.id)});r.length>0;){const a=r.shift(),c=t.find(l=>l.id===a);o.push(c),s[a].forEach(l=>{n[l]--,n[l]===0&&r.push(l)})}return o}const Eg=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],xg=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],Sg=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],Og=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],wg=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];var _o=_(73959);class oe extends ao{}function ai(i,t=!0,e){const n=document.createElement("div");return n.setAttribute("class",`g6-${i}`),Object.assign(n.style,{position:"absolute",display:"block"}),t&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),e&&Object.assign(n.style,e),n}function Ro(i,t="div",e={},n="",s=document.body){const r=document.getElementById(i);r&&r.remove();const o=document.createElement(t);return o.innerHTML=n,o.id=i,Object.assign(o.style,e),s.appendChild(o),o}var Cg=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Qs extends oe{constructor(t,e){super(t,Object.assign({},Qs.defaultOptions,e)),this.$element=ai("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return Cg(this,void 0,void 0,function*(){e.update.call(this,t),Object.assign(this.$element.style,(0,_o.Z)(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}Qs.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function ko(i,t,e,n,s,r){const o=i,a=t,c=e-o,l=n-a;let d=s-o,h=r-a,u=d*c+h*l,f=0;u<=0?f=0:(d=c-d,h=l-h,u=d*c+h*l,u<=0?f=0:f=u*u/(c*c+l*l));const g=d*d+h*h-f;return g<0?0:g}function Sn(i,t,e,n){return(i-e)*(i-e)+(t-n)*(t-n)}function Kc(i,t,e,n,s){return Sn(i,t,e,n)<s*s}function Dg(i){if(!Number.isFinite(i))return e=>e;if(i===0)return Math.round;const t=Math.pow(10,i);return e=>Math.round(e*t)/t}function qc(i){const t=Math.min(i.x1,i.x2),e=Math.max(i.x1,i.x2),n=Math.min(i.y1,i.y2),s=Math.max(i.y1,i.y2);return{x:t,y:n,x2:e,y2:s,width:e-t,height:s-n}}class ne{constructor(t,e,n,s){this.x1=t,this.y1=e,this.x2=n,this.y2=s}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new ne(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;const n=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return t<=n}distSquare(t,e){return ko(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}}var zt;(function(i){i[i.POINT=1]="POINT",i[i.PARALLEL=2]="PARALLEL",i[i.COINCIDENT=3]="COINCIDENT",i[i.NONE=4]="NONE"})(zt||(zt={}));class jo{constructor(t,e=0,n=0){this.state=t,this.x=e,this.y=n}}function Js(i,t){const e=(t.x2-t.x1)*(i.y1-t.y1)-(t.y2-t.y1)*(i.x1-t.x1),n=(i.x2-i.x1)*(i.y1-t.y1)-(i.y2-i.y1)*(i.x1-t.x1),s=(t.y2-t.y1)*(i.x2-i.x1)-(t.x2-t.x1)*(i.y2-i.y1);if(s){const r=e/s,o=n/s;return 0<=r&&r<=1&&0<=o&&o<=1?new jo(zt.POINT,i.x1+r*(i.x2-i.x1),i.y1+r*(i.y2-i.y1)):new jo(zt.NONE)}return new jo(e===0||n===0?zt.COINCIDENT:zt.PARALLEL)}function Qc(i,t){const e=(t.x2-t.x1)*(i.y1-t.y1)-(t.y2-t.y1)*(i.x1-t.x1),n=(i.x2-i.x1)*(i.y1-t.y1)-(i.y2-i.y1)*(i.x1-t.x1),s=(t.y2-t.y1)*(i.x2-i.x1)-(t.x2-t.x1)*(i.y2-i.y1);if(s){const r=e/s,o=n/s;if(0<=r&&r<=1&&0<=o&&o<=1)return r}return Number.POSITIVE_INFINITY}function Tg(i,t){function e(s,r,o,a){let c=Qc(t,new ne(s,r,o,a));return c=Math.abs(c-.5),c>=0&&c<=1?1:0}let n=e(i.x,i.y,i.x2,i.y);return n+=e(i.x,i.y,i.x,i.y2),n>1||(n+=e(i.x,i.y2,i.x2,i.y2),n>1)?!0:(n+=e(i.x2,i.y,i.x2,i.y2),n>0)}var Ft;(function(i){i[i.LEFT=0]="LEFT",i[i.TOP=1]="TOP",i[i.RIGHT=2]="RIGHT",i[i.BOTTOM=3]="BOTTOM"})(Ft||(Ft={}));function tr(i,t,e){const n=new Set;return i.width<=0?(n.add(Ft.LEFT),n.add(Ft.RIGHT)):t<i.x?n.add(Ft.LEFT):t>i.x+i.width&&n.add(Ft.RIGHT),i.height<=0?(n.add(Ft.TOP),n.add(Ft.BOTTOM)):e<i.y?n.add(Ft.TOP):e>i.y+i.height&&n.add(Ft.BOTTOM),n}function Jc(i,t){let e=t.x1,n=t.y1;const s=t.x2,r=t.y2,o=Array.from(tr(i,s,r));if(o.length===0)return!0;let a=tr(i,e,n);for(;a.size!==0;){for(const c of o)if(a.has(c))return!1;if(a.has(Ft.RIGHT)||a.has(Ft.LEFT)){let c=i.x;a.has(Ft.RIGHT)&&(c+=i.width),n=n+(c-e)*(r-n)/(s-e),e=c}else{let c=i.y;a.has(Ft.BOTTOM)&&(c+=i.height),e=e+(c-n)*(s-e)/(r-n),n=c}a=tr(i,e,n)}return!0}function Mg(i,t){let e=Number.POSITIVE_INFINITY,n=0;function s(r,o,a,c){let l=Qc(t,new ne(r,o,a,c));l=Math.abs(l-.5),l>=0&&l<=1&&(n++,l<e&&(e=l))}return s(i.x,i.y,i.x2,i.y),s(i.x,i.y,i.x,i.y2),n>1||(s(i.x,i.y2,i.x2,i.y2),n>1)?e:(s(i.x2,i.y,i.x2,i.y2),n===0?-1:e)}function Ag(i,t){let e=0;const n=Js(i,new ne(t.x,t.y,t.x2,t.y));e+=n.state===zt.POINT?1:0;const s=Js(i,new ne(t.x,t.y,t.x,t.y2));e+=s.state===zt.POINT?1:0;const r=Js(i,new ne(t.x,t.y2,t.x2,t.y2));e+=r.state===zt.POINT?1:0;const o=Js(i,new ne(t.x2,t.y,t.x2,t.y2));return e+=o.state===zt.POINT?1:0,{top:n,left:s,bottom:r,right:o,count:e}}class ae{constructor(t,e,n,s){this.x=t,this.y=e,this.width=n,this.height=s}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new ae(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new ae(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),s=Math.max(this.x2,t.x+t.width),r=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=s-e,this.height=r-n}addPoint(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),s=Math.max(this.x2,t.x),r=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=s-e,this.height=r-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return this.area<=0||t.width<=0||t.height<=0?!1:t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;const n=tr(this,t,e);return n.has(Ft.TOP)?n.has(Ft.LEFT)?Sn(t,e,this.x,this.y):n.has(Ft.RIGHT)?Sn(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(Ft.BOTTOM)?n.has(Ft.LEFT)?Sn(t,e,this.x,this.y2):n.has(Ft.RIGHT)?Sn(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(Ft.LEFT)?(this.x-t)*(this.x-t):n.has(Ft.RIGHT)?(t-this.x2)*(t-this.x2):0}}function Lg(i){if(i.length===0)return null;const t=i[0],e=new ae(t.x,t.y,0,0);for(const n of i)e.addPoint(n);return e}class er{constructor(t,e,n){this.cx=t,this.cy=e,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(t){return new er(t.cx,t.cy,t.radius)}containsPt(t,e){return Sn(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const n=Sn(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;const s=Math.sqrt(n)-this.radius;return s*s}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Wn{constructor(t,e=0,n=0,s=0,r=0,o=10,a=10,c=new Float32Array(Math.max(0,o*a)).fill(0)){this.pixelGroup=t,this.i=e,this.j=n,this.pixelX=s,this.pixelY=r,this.width=o,this.height=a,this.area=c}createSub(t,e){return new Wn(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new Wn(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new Wn(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),n=this.scaleY(t.y),s=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),r=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup)),o=s-e,a=r-n;return new ae(e,n,o,a)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const n=Math.ceil(e/this.pixelGroup),s=this.boundX(t.x-n),r=this.boundY(t.y-n),o=this.boundX(t.x2+n),a=this.boundY(t.y2+n),c=o-s,l=a-r;return new ae(s,r,c,l)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}set(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}incArea(t,e){if(t.width<=0||t.height<=0||e===0)return;const n=this.width,s=t.width,r=Math.max(0,t.i),o=Math.max(0,t.j),a=Math.min(t.i+t.width,n),c=Math.min(t.j+t.height,this.height);if(!(c<=0||a<=0||r>=n||c>=this.height))for(let l=o;l<c;l++){const d=(l-t.j)*s,h=l*n;for(let u=r;u<a;u++){const f=t.area[u-t.i+d];f!==0&&(this.area[u+h]+=e*f)}}}fill(t){this.area.fill(t)}fillArea(t,e){const n=t.x+t.y*this.width;for(let s=0;s<t.height;s++){const r=n+s*this.width;this.area.fill(e,r,r+t.width)}}fillHorizontalLine(t,e,n,s){const r=t+e*this.width;this.area.fill(s,r,r+n)}fillVerticalLine(t,e,n,s){const r=t+e*this.width;for(let o=0;o<n;o++)this.area[r+o*this.width]=s}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const n=e*this.width;for(let s=0;s<this.width;s++){const r=this.area[n+s];t+=r.toFixed(1).padStart(6),t+=" "}t+=`
`}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const n=this.area.reduce((o,a)=>Math.min(o,a),Number.POSITIVE_INFINITY),s=this.area.reduce((o,a)=>Math.max(o,a),Number.NEGATIVE_INFINITY),r=o=>(o-n)/(s-n);t.scale(this.pixelGroup,this.pixelGroup);for(let o=0;o<this.width;o++)for(let a=0;a<this.height;a++){const c=this.area[o+a*this.width];t.fillStyle=`rgba(0, 0, 0, ${r(c)})`,t.fillRect(o,a,1,1)}t.restore()}drawThreshold(t,e,n=!0){if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let r=0;r<this.height;r++){const o=this.area[s+r*this.width];t.fillStyle=o>e?"black":"white",t.fillRect(s,r,1,1)}t.restore()}}}function tl(i,t){const e=n=>({x:n.x-t,y:n.y-t,width:n.width+2*t,height:n.height+2*t});return Array.isArray(i)?i.map(e):e(i)}function el(i,t,e){return nl(Object.assign(qc(i),{distSquare:(n,s)=>ko(i.x1,i.y1,i.x2,i.y2,n,s)}),t,e)}function nl(i,t,e){const n=tl(i,e),s=t.scale(n),r=t.createSub(s,n);return Ng(r,t,e,(o,a)=>i.distSquare(o,a)),r}function Ng(i,t,e,n){const s=e*e;for(let r=0;r<i.height;r++)for(let o=0;o<i.width;o++){const a=t.invertScaleX(i.i+o),c=t.invertScaleY(i.j+r),l=n(a,c);if(l===0){i.set(o,r,s);continue}if(l<s){const d=e-Math.sqrt(l);i.set(o,r,d*d)}}return i}function Ig(i,t,e){const n=t.scale(i),s=t.addPadding(n,e),r=t.createSub(s,{x:i.x-e,y:i.y-e}),o=n.x-s.x,a=n.y-s.y,c=s.x2-n.x2,l=s.y2-n.y2,d=s.width-o-c,h=s.height-a-l,u=e*e;r.fillArea({x:o,y:a,width:d+1,height:h+1},u);const f=[0],g=Math.max(a,o,c,l);{const m=t.invertScaleX(n.x+n.width/2);for(let b=1;b<g;b++){const E=t.invertScaleY(n.y-b),S=i.distSquare(m,E);if(S<u){const O=e-Math.sqrt(S);f.push(O*O)}else break}}const p=[],v=Math.max(o,c),y=Math.max(a,c);for(let m=1;m<v;m++){const b=t.invertScaleX(n.x-m),E=[];for(let S=1;S<y;S++){const O=t.invertScaleY(n.y-S),A=i.distSquare(b,O);if(A<u){const N=e-Math.sqrt(A);E.push(N*N)}else E.push(0)}p.push(E)}for(let m=1;m<Math.min(a,f.length);m++){const b=f[m];r.fillHorizontalLine(o,a-m,d+1,b)}for(let m=1;m<Math.min(l,f.length);m++){const b=f[m];r.fillHorizontalLine(o,a+h+m,d+1,b)}for(let m=1;m<Math.min(o,f.length);m++){const b=f[m];r.fillVerticalLine(o-m,a,h+1,b)}for(let m=1;m<Math.min(l,f.length);m++){const b=f[m];r.fillVerticalLine(o+d+m,a,h+1,b)}for(let m=1;m<o;m++){const b=p[m-1],E=o-m;for(let S=1;S<a;S++)r.set(E,a-S,b[S-1]);for(let S=1;S<l;S++)r.set(E,a+h+S,b[S-1])}for(let m=1;m<c;m++){const b=p[m-1],E=o+d+m;for(let S=1;S<a;S++)r.set(E,a-S,b[S-1]);for(let S=1;S<l;S++)r.set(E,a+h+S,b[S-1])}return r}function Rm(i,t,e,n){return{x:i,y:t,width:e,height:n}}function km(i,t,e){return{cx:i,cy:t,radius:e}}function jm(i,t,e,n){return{x1:i,y1:t,x2:e,y2:n}}function _t(i,t){return{x:i,y:t}}function Pg(i,t,e,n){if(i.length===0)return[];const s=Bg(i);return s.map((r,o)=>{const a=s.slice(0,o);return _g(t,r,a,e,n)}).flat()}function _g(i,t,e,n,s){const r=_t(t.cx,t.cy),o=jg(r,e,i);if(o==null)return[];const a=new ne(r.x,r.y,o.cx,o.cy),c=Rg(a,i,n,s);return kg(c,i)}function Rg(i,t,e,n){const s=[],r=[];r.push(i);let o=!0;for(let a=0;a<e&&o;a++)for(o=!1;!o&&r.length>0;){const c=r.pop(),l=il(t,c),d=l?Ag(c,l):null;if(!l||!d||d.count!==2){o||s.push(c);continue}let h=n,u=ir(l,h,d,!0),f=On(u,r)||On(u,s),g=nr(u,t);for(;!f&&g&&h>=1;)h/=1.5,u=ir(l,h,d,!0),f=On(u,r)||On(u,s),g=nr(u,t);if(u&&!f&&!g&&(r.push(new ne(c.x1,c.y1,u.x,u.y)),r.push(new ne(u.x,u.y,c.x2,c.y2)),o=!0),o)continue;h=n,u=ir(l,h,d,!1);let p=On(u,r)||On(u,s);for(g=nr(u,t);!p&&g&&h>=1;)h/=1.5,u=ir(l,h,d,!1),p=On(u,r)||On(u,s),g=nr(u,t);u&&!p&&(r.push(new ne(c.x1,c.y1,u.x,u.y)),r.push(new ne(u.x,u.y,c.x2,c.y2)),o=!0),o||s.push(c)}for(;r.length>0;)s.push(r.pop());return s}function kg(i,t){const e=[];for(;i.length>0;){const n=i.pop();if(i.length===0){e.push(n);break}const s=i.pop(),r=new ne(n.x1,n.y1,s.x2,s.y2);il(t,r)?(e.push(n),i.push(s)):i.push(r)}return e}function jg(i,t,e){let n=Number.POSITIVE_INFINITY;return t.reduce((s,r)=>{const o=Sn(i.x,i.y,r.cx,r.cy);if(o>n)return s;const a=new ne(i.x,i.y,r.cx,r.cy),c=zg(e,a);return o*(c+1)*(c+1)<n&&(s=r,n=o*(c+1)*(c+1)),s},null)}function Bg(i){if(i.length<2)return i;let t=0,e=0;return i.forEach(n=>{t+=n.cx,e+=n.cy}),t/=i.length,e/=i.length,i.map(n=>{const s=t-n.cx,r=e-n.cy,o=s*s+r*r;return[n,o]}).sort((n,s)=>n[1]-s[1]).map(n=>n[0])}function nr(i,t){return t.some(e=>e.containsPt(i.x,i.y))}function On(i,t){return t.some(e=>!!(Kc(e.x1,e.y1,i.x,i.y,.001)||Kc(e.x2,e.y2,i.x,i.y,.001)))}function il(i,t){let e=Number.POSITIVE_INFINITY,n=null;for(const s of i){if(!Jc(s,t))continue;const r=Mg(s,t);r>=0&&r<e&&(n=s,e=r)}return n}function zg(i,t){return i.reduce((e,n)=>Jc(n,t)&&Tg(n,t)?e+1:e,0)}function ir(i,t,e,n){const s=e.top,r=e.left,o=e.bottom,a=e.right;if(n){if(r.state===zt.POINT){if(s.state===zt.POINT)return _t(i.x-t,i.y-t);if(o.state===zt.POINT)return _t(i.x-t,i.y2+t);const u=i.width*i.height;return i.width*((r.y-i.y+(a.y-i.y))*.5)<u*.5?r.y>a.y?_t(i.x-t,i.y-t):_t(i.x2+t,i.y-t):r.y<a.y?_t(i.x-t,i.y2+t):_t(i.x2+t,i.y2+t)}if(a.state===zt.POINT){if(s.state===zt.POINT)return _t(i.x2+t,i.y-t);if(o.state===zt.POINT)return _t(i.x2+t,i.y2+t)}const d=i.height*i.width;return i.height*((s.x-i.x+(a.x-i.x))*.5)<d*.5?s.x>o.x?_t(i.x-t,i.y-t):_t(i.x-t,i.y2+t):s.x<o.x?_t(i.x2+t,i.y-t):_t(i.x2+t,i.y2+t)}if(r.state===zt.POINT){if(s.state===zt.POINT)return _t(i.x2+t,i.y2+t);if(o.state===zt.POINT)return _t(i.x2+t,i.y-t);const d=i.height*i.width;return i.width*((r.y-i.y+(a.y-i.y))*.5)<d*.5?r.y>a.y?_t(i.x2+t,i.y2+t):_t(i.x-t,i.y2+t):r.y<a.y?_t(i.x2+t,i.y-t):_t(i.x-t,i.y-t)}if(a.state===zt.POINT){if(s.state===zt.POINT)return _t(i.x-t,i.y2+t);if(o.state===zt.POINT)return _t(i.x-t,i.y-t)}const c=i.height*i.width;return i.height*((s.x-i.x+(a.x-i.x))*.5)<c*.5?s.x>o.x?_t(i.x2+t,i.y2+t):_t(i.x2+t,i.y-t):s.x<o.x?_t(i.x-t,i.y2+t):_t(i.x-t,i.y-t)}function Fg(i,t,e,n){if(!(i.closed?e<i.length:e<i.length-1))return!1;const r=i.get(t),o=i.get(e+1);for(let a=t+1;a<=e;a++){const c=i.get(a);if(ko(r.x,r.y,o.x,o.y,c.x,c.y)>n)return!1}return!0}function $g(i=0){return t=>{if(i<0||t.length<3)return t;const e=[];let n=0;const s=i*i;for(;n<t.length;){let r=n+1;for(;Fg(t,n,r,s);)r++;e.push(t.get(n)),n=r}return new Zn(e)}}function Wg(i,t){switch(i){case-2:return(((-t+3)*t-3)*t+1)/6;case-1:return((3*t-6)*t*t+4)/6;case 0:return(((-3*t+3)*t+3)*t+1)/6;case 1:return t*t*t/6;default:throw new Error("unknown error")}}function Zg(i=6){function r(o,a,c){let l=0,d=0;for(let h=-2;h<=1;h++){const u=o.get(a+h),f=Wg(h,c);l+=f*u.x,d+=f*u.y}return{x:l,y:d}}return o=>{if(o.length<3)return o;const a=[],c=o.closed,l=o.length+3-1+(c?0:2);a.push(r(o,2-(c?0:2),0));for(let d=2-(c?0:2);d<l;d++)for(let h=1;h<=i;h++)a.push(r(o,d,h/i));return new Zn(a)}}function Vg(i=8){return t=>{let e=i,n=t.length;if(e>1)for(n=Math.floor(t.length/e);n<3&&e>1;)e-=1,n=Math.floor(t.length/e);const s=[];for(let r=0,o=0;o<n;o++,r+=e)s.push(t.get(r));return new Zn(s)}}class Zn{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(e.length===0)return"";const n=typeof t=="function"?t:Dg(t);let s="M";for(const r of e)s+=`${n(r.x)},${n(r.y)} L`;return s=s.slice(0,-1),this.closed&&(s+=" Z"),s}draw(t){const e=this.points;if(e.length!==0){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const n of e)t.lineTo(n.x,n.y);this.closed&&t.closePath()}}sample(t){return Vg(t)(this)}simplify(t){return $g(t)(this)}bSplines(t){return Zg(t)(this)}apply(t){return t(this)}containsElements(t){const e=Lg(this.points);return e?t.every(n=>e.containsPt(n.cx,n.cy)&&this.withinArea(n.cx,n.cy)):!1}withinArea(t,e){if(this.length===0)return!1;let n=0;const s=this.points[0],r=new ne(s.x,s.y,s.x,s.y);for(let o=1;o<this.points.length;o++){const a=this.points[o];r.x1=r.x2,r.y1=r.y2,r.x2=a.x,r.y2=a.y,r.cuts(t,e)&&n++}return r.x1=r.x2,r.y1=r.y2,r.x2=s.x,r.y2=s.y,r.cuts(t,e)&&n++,n%2===1}}class Hg{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(this.count===0)return!1;const e=this.arr[0];return e!=null&&e.x===t.x&&e.y===t.y}path(){return new Zn(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}const ki=0,sr=1,rr=2,Bo=3;function Yg(i,t){const e=(Math.floor(i.width)+Math.floor(i.height))*2,n=new Hg(e);function s(c,l,d,h){const u=i.get(c,l);return Number.isNaN(u)?Number.NaN:u>t?d+h:d}function r(c,l){let d=ki;return d=s(c,l,d,1),d=s(c+1,l,d,2),d=s(c,l+1,d,4),d=s(c+1,l+1,d,8),Number.isNaN(d)?-1:d}let o=sr;function a(c,l){let d=c,h=l,u=i.invertScaleX(d),f=i.invertScaleY(h);for(let g=0;g<i.width*i.height;g++){const p={x:u,y:f};if(n.contains(p)){if(n.isFirst(p))return!0}else n.add(p);const v=r(d,h);switch(v){case-1:return!0;case 0:case 3:case 2:case 7:o=rr;break;case 12:case 14:case 4:o=Bo;break;case 6:o=o===ki?Bo:rr;break;case 1:case 13:case 5:o=ki;break;case 9:o=o===rr?ki:sr;break;case 10:case 8:case 11:o=sr;break;default:return console.warn("Marching squares invalid state: "+v),!0}switch(o){case ki:h--,f-=i.pixelGroup;break;case sr:h++,f+=i.pixelGroup;break;case Bo:d--,u-=i.pixelGroup;break;case rr:d++,u+=i.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+v),!0}}return!0}for(let c=0;c<i.width;c++)for(let l=0;l<i.height;l++){if(i.get(c,l)<=t)continue;const d=r(c,l);if(!(d<0||d===15)&&a(c,l))return n.path()}return null}const or={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function ji(i){return i!=null&&typeof i.radius=="number"}function sl(i,t){if(ji(i)!==ji(t))return!1;if(ji(i)){const n=t;return i.cx===n.cx&&i.cy===n.cy&&i.radius===n.radius}const e=t;return i.x===e.x&&i.y===e.y&&i.width===e.width&&i.height===e.height}var Ve;(function(i){i[i.MEMBERS=0]="MEMBERS",i[i.NON_MEMBERS=1]="NON_MEMBERS",i[i.EDGES=2]="EDGES"})(Ve||(Ve={}));class zo{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new ae(0,0,0,0),this.potentialArea=new Wn(1,0,0,0,0,0,0),this.o=Object.assign({},or,t)}pushMember(...t){if(t.length!==0){this.dirty.add(Ve.MEMBERS);for(const e of t)this.members.push({raw:e,obj:ji(e)?er.from(e):ae.from(e),area:null})}}removeMember(t){const e=this.members.findIndex(n=>sl(n.raw,t));return e<0?!1:(this.members.splice(e,1),this.dirty.add(Ve.MEMBERS),!0)}removeNonMember(t){const e=this.nonMembers.findIndex(n=>sl(n.raw,t));return e<0?!1:(this.nonMembers.splice(e,1),this.dirty.add(Ve.NON_MEMBERS),!0)}removeEdge(t){const e=this.edges.findIndex(n=>n.obj.equals(t));return e<0?!1:(this.edges.splice(e,1),this.dirty.add(Ve.NON_MEMBERS),!0)}pushNonMember(...t){if(t.length!==0){this.dirty.add(Ve.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:ji(e)?er.from(e):ae.from(e),area:null})}}pushEdge(...t){if(t.length!==0){this.dirty.add(Ve.EDGES);for(const e of t)this.edges.push({raw:e,obj:ne.from(e),area:null})}}update(){const t=this.dirty.has(Ve.MEMBERS),e=this.dirty.has(Ve.NON_MEMBERS);let n=this.dirty.has(Ve.EDGES);this.dirty.clear();const s=this.members.map(l=>l.obj);if(this.o.virtualEdges&&(t||e)){const l=this.nonMembers.map(u=>u.obj),d=Pg(s,l,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(u=>[u.obj.toString(),u.area]));this.virtualEdges=d.map(u=>{var f;return{raw:u,obj:u,area:(f=h.get(u.toString()))!==null&&f!==void 0?f:null}}),n=!0}let r=!1;if(t||n){const l=this.virtualEdges.concat(this.edges).map(f=>f.obj),d=Gg(s,l),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,u=ae.from(tl(d,h));u.equals(this.activeRegion)||(r=!0,this.activeRegion=u)}if(r){const l=Math.ceil(this.activeRegion.width/this.o.pixelGroup),d=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Wn.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(l!==this.potentialArea.width||d!==this.potentialArea.height)&&(this.potentialArea=Wn.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const o=new Map,a=l=>{if(l.area){const d=`${l.obj.width}x${l.obj.height}x${l.obj instanceof ae?"R":"C"}`;o.set(d,l.area)}},c=l=>{if(l.area)return;const d=`${l.obj.width}x${l.obj.height}x${l.obj instanceof ae?"R":"C"}`;if(o.has(d)){const u=o.get(d);l.area=this.potentialArea.copy(u,{x:l.obj.x-this.o.nodeR1,y:l.obj.y-this.o.nodeR1});return}const h=l.obj instanceof ae?Ig(l.obj,this.potentialArea,this.o.nodeR1):nl(l.obj,this.potentialArea,this.o.nodeR1);l.area=h,o.set(d,h)};this.members.forEach(a),this.nonMembers.forEach(a),this.members.forEach(c),this.nonMembers.forEach(l=>{this.activeRegion.intersects(l.obj)?c(l):l.area=null}),this.edges.forEach(l=>{l.area||(l.area=el(l.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(l=>{l.area||(l.area=el(l.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(this.members.length===0)return new Zn([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,n=this.members.map(a=>a.area),s=this.virtualEdges.concat(this.edges).map(a=>a.area),r=this.nonMembers.filter(a=>a.area!=null).map(a=>a.area),o=this.members.map(a=>a.obj);return Ug(e,n,s,r,a=>a.containsElements(o),t)}}function Ug(i,t,e,n,s,r={}){const o=Object.assign({},or,r);let a=o.threshold,c=o.memberInfluenceFactor,l=o.edgeInfluenceFactor,d=o.nonMemberInfluenceFactor;const h=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),u=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let f=0;f<o.maxMarchingIterations;f++){if(i.clear(),c!==0){const p=c/h;for(const v of t)i.incArea(v,p)}if(l!==0){const p=l/u;for(const v of e)i.incArea(v,p)}if(d!==0){const p=d/h;for(const v of n)i.incArea(v,p)}const g=Yg(i,a);if(g&&s(g))return g;if(a*=.95,f<=o.maxMarchingIterations*.5)c*=1.2,l*=1.2;else if(d!==0&&n.length>0)d*=.8;else break}return new Zn([])}function Gg(i,t){if(i.length===0)return new ae(0,0,0,0);const e=ae.from(i[0]);for(const n of i)e.add(n);for(const n of t)e.add(qc(n));return e}function Bm(i,t=[],e=[],n={}){if(i.length===0)return new Zn([]);const s=new zo(n);return s.pushMember(...i),s.pushNonMember(...t),s.pushEdge(...e),s.compute()}var Xg=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class ar extends oe{constructor(t,e){super(t,(0,kn.Z)({},ar.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:n,bubbleSetOptions:s}=this.parseOptions();(0,Y.Z)(this.bubbleSetOptions,s)||this.init(),this.bubbleSetOptions=Object.assign({},s);const r=Object.assign(Object.assign({},n),{d:this.getPath()});this.shape?this.shape.update(r):(this.shape=new Mi({style:r}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=n=>{if(!this.shape)return;const s=w(n.data);[...this.options.members,...this.options.avoidMembers].includes(s)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(s)}))},this.getPath=n=>{const{graph:s}=this.context,r=this.options.members,o=[...this.members.keys()],a=this.options.avoidMembers,c=[...this.avoidMembers.keys()];if(!n&&(0,Y.Z)(r,o)&&(0,Y.Z)(a,c))return this.path;const{enter:l=[],exit:d=[]}=vn(o,r,v=>v),{enter:h=[],exit:u=[]}=vn(c,a,v=>v);n&&(d.push(n),l.push(n));const f=(v,y,m)=>{v.forEach(b=>{const E=m?this.members:this.avoidMembers,S=m?"pushMember":"pushNonMember",O=m?"removeMember":"removeNonMember";if(y){let A;s.getElementType(b)==="edge"?([A]=qg(s,b),this.bubbleSets.pushEdge(A)):([A]=Kg(s,b),this.bubbleSets[S](A)),E.set(b,A)}else{const A=E.get(b);A&&(s.getElementType(b)==="edge"?this.bubbleSets.removeEdge(A):this.bubbleSets[O](A),E.delete(b))}})};f(d,!1,!0),f(l,!0,!0),f(u,!1,!1),f(h,!0,!1);const p=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=mc(p.points.map(re)),this.path},this.bindEvents(),this.bubbleSets=new zo(this.options)}bindEvents(){this.context.graph.on(P.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(P.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new zo(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const t=this.options,{type:e,key:n,members:s,avoidMembers:r}=t,o=Xg(t,["type","key","members","avoidMembers"]),a=Object.keys(o).reduce((c,l)=>(l in or?c.bubbleSetOptions[l]=o[l]:c.style[l]=o[l],c),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:s,avoidMembers:r},a)}addMember(t){const e=Array.isArray(t)?t:[t];e.some(n=>this.options.avoidMembers.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!e.includes(n))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(n=>!e.includes(n)),this.drawBubbleSets()}updateMember(t){this.options.members=(0,et.Z)(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some(n=>this.options.members.includes(n))&&(this.options.members=this.options.members.filter(n=>!e.includes(n))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(n=>e.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!e.includes(n)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(P.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(P.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}ar.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},or);const Kg=(i,t)=>(Array.isArray(t)?t:[t]).map(n=>{const s=i.getElementRenderBounds(n);return new ae(s.min[0],s.min[1],Je(s),tn(s))}),qg=(i,t)=>(Array.isArray(t)?t:[t]).map(n=>{const s=i.getEdgeData(n),r=i.getElementPosition(s.source),o=i.getElementPosition(s.target);return ne.from({x1:r[0],y1:r[1],x2:o[0],y2:o[1]})});class zm extends null{constructor(t,e){super(t,e),this.setOptions=n=>{const s={cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"},r=(o,a)=>{switch(o){case"projectionMode":return a==="perspective"?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[a];case"aspect":return typeof a=="number"?a:this.getCanvasAspect();default:return a}};Object.entries(s).forEach(([o,a])=>{const c=n[o];if(c!==void 0){const l=r(o,c);this.context.canvas.getCamera()[a](l)}})},this.bindEvents()}update(t){this.setOptions(t),super.update(t)}bindEvents(){this.context.graph.once(GraphEvent.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[t,e]=this.context.viewport.getCanvasSize();return t/e}}function Qg(i){return`
    <ul class="g6-contextmenu-ul">
      ${i.map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}
    </ul>
  `}const Jg=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var rl=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class cr extends oe{constructor(t,e){super(t,Object.assign({},cr.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=n=>{var s;(s=n.preventDefault)===null||s===void 0||s.call(n),this.show(n)},this.onMenuItemClick=n=>{const{onClick:s,trigger:r}=this.options;if(n.target instanceof HTMLElement&&n.target.className.includes("g6-contextmenu-li")){const o=n.target.getAttribute("value");s==null||s(o,n.target,this.targetElement),this.hide()}r!=="click"&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=ai("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),Ro("g6-contextmenu-css","style",{},Jg,document.head)}show(t){return rl(this,void 0,void 0,function*(){const{enable:e,offset:n}=this.options;if(typeof e=="function"&&!e(t)||!e){this.hide();return}const s=yield this.getDOMContent(t);s instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(s)):this.$element.innerHTML=s;const r=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-r.left+n[0]}px`,this.$element.style.top=`${t.client.y-r.top+n[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return rl(this,void 0,void 0,function*(){const{getContent:e,getItems:n}=this.options;return n?Qg(yield n(t)):yield e(t)})}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}cr.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class lr extends oe{constructor(t,e){super(t,Object.assign({},lr.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:n,element:s}=this.context,r=n.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:o,iterRate:a,divRate:c}=this.options;let{lambda:l,divisions:d,iterations:h}=this.options;for(let u=0;u<o;u++){for(let f=0;f<h;f++){const g={};r.forEach(p=>{var v;if(p.source===p.target)return;const y=w(p);g[y]=this.getEdgeForces(p,d,l);for(let m=0;m<d+1;m++)(v=this.edgePoints)[y]||(v[y]=[]),this.edgePoints[y][m]=at(this.edgePoints[y][m],g[y][m])})}l/=2,d*=c,h*=a,this.divideEdges(d)}r.forEach(u=>{const f=w(u),g=s.getElement(f);g==null||g.update({d:wo(this.edgePoints[f])})})},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map(e=>[w(e),jn(qt(e))]))}divideEdges(t){this.context.model.getEdgeData().forEach(n=>{var s;const r=w(n);(s=this.edgePoints)[r]||(s[r]=[]);const o=this.nodeMap[n.source],a=this.nodeMap[n.target];if(t===1)this.edgePoints[r].push(o),this.edgePoints[r].push($e(at(o,a),2)),this.edgePoints[r].push(a);else{const l=(this.edgePoints[r].length===0?It(o,a):sp(this.edgePoints[r]))/(t+1);let d=l;const h=[o];for(let u=1;u<this.edgePoints[r].length;u++){const f=this.edgePoints[r][u-1],g=this.edgePoints[r][u];let p=It(g,f);for(;p>d;){const v=d/p,y=at(f,Fe(Mt(g,f),v));h.push(y),p-=d,d=l}d-=p}h.push(a),this.edgePoints[r]=h}})}getVectorPosition(t){const e=this.nodeMap[t.source],n=this.nodeMap[t.target],[s,r]=Mt(n,e),o=It(e,n);return{source:e,target:n,vx:s,vy:r,length:o}}measureEdgeCompatibility(t,e){const n=this.getVectorPosition(t),s=this.getVectorPosition(e),r=tp(n,s),o=ep(n,s),a=np(n,s),c=ip(n,s);return r*o*a*c}getEdgeBundles(){const t={},e=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((s,r)=>{n.forEach((o,a)=>{var c,l;if(a<=r)return;this.measureEdgeCompatibility(s,o)>=e&&(t[c=w(s)]||(t[c]=[]),t[w(s)].push(o),t[l=w(o)]||(t[l]=[]),t[w(o)].push(s))})}),t}getSpringForce(t,e){const{pre:n,cur:s,next:r}=t;return Fe(Mt(at(n,r),Fe(s,2)),e)}getElectrostaticForce(t,e){nn(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[w(e)];let s=[0,0];return n==null||n.forEach(r=>{const o=this.edgePoints[w(r)][t],a=this.edgePoints[w(e)][t],c=Mt(o,a),l=It(o,a);s=at(s,Fe(c,1/l))}),s}getEdgeForces(t,e,n){const s=this.nodeMap[t.source],r=this.nodeMap[t.target],o=this.options.K/(It(s,r)*(e+1)),a=[[0,0]],c=w(t);for(let l=1;l<e;l++){const d=this.getSpringForce({pre:this.edgePoints[c][l-1],cur:this.edgePoints[c][l],next:this.edgePoints[c][l+1]||[0,0]},o),h=this.getElectrostaticForce(l,t);a.push(Fe(at(d,h),n))}return a.push([0,0]),a}bindEvents(){const{graph:t}=this.context;t.on(P.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:t}=this.context;t.off(P.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}lr.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const tp=(i,t)=>Math.abs(ou([i.vx,i.vy],[t.vx,t.vy])/(i.length*t.length)),ep=(i,t)=>{const e=(i.length+t.length)/2;return 2/(e/Math.min(i.length,t.length)+Math.max(i.length,t.length)/e)},np=(i,t)=>{const e=(i.length+t.length)/2,n=$e(at(i.source,i.target),2),s=$e(at(t.source,t.target),2);return e/(e+It(n,s))},ol=(i,t)=>{if(t.source[0]===t.target[0])return[t.source[0],i[1]];if(t.source[1]===t.target[1])return[i[0],t.source[1]];const e=(t.source[1]-t.target[1])/(t.source[0]-t.target[0]),n=(e*e*t.source[0]+e*(i[1]-t.source[1])+i[0])/(e*e+1),s=e*(n-t.source[0])+t.source[1];return[n,s]},al=(i,t)=>{const e=ol(t.source,i),n=ol(t.target,i),s=$e(at(e,n),2),r=$e(at(i.source,i.target),2);return It(e,n)===0?0:Math.max(0,1-2*It(r,s)/It(e,n))},ip=(i,t)=>Math.min(al(i,t),al(t,i)),sp=i=>{let t=0;for(let e=1;e<i.length;e++)t+=It(i[e],i[e-1]);return t},rp={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},cl=.05;class dr extends oe{constructor(t,e){super(t,Object.assign({},dr.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const s=re(n.canvas);this.renderLens(s),this.renderFocusElements()},this.renderLens=n=>{const s=Object.assign({},rp,this.options.style);this.isLensOn||(this.lens=new zn({style:s}),this.canvas.appendChild(this.lens)),Object.assign(s,We(n),{size:this.r*2}),this.lens.update(s)},this.getFilterData=()=>{const{filter:n}=this.options,{model:s}=this.context,r=s.getData();if(!n)return r;const{nodes:o,edges:a,combos:c}=r;return{nodes:o.filter(l=>n(w(l),"node")),edges:a.filter(l=>n(w(l),"edge")),combos:c.filter(l=>n(w(l),"combo"))}},this.getFocusElements=n=>{const{nodes:s,edges:r}=this.getFilterData(),o=s.filter(l=>It(qt(l),n)<this.r),a=o.map(l=>w(l)),c=r.filter(l=>{const{source:d,target:h}=l,u=a.includes(d),f=a.includes(h);switch(this.options.nodeType){case"both":return u&&f;case"either":return u!==f;case"source":return u&&!f;case"target":return!u&&f;default:return!1}});return{nodes:o,edges:c}},this.renderFocusElements=()=>{const{element:n,graph:s}=this.context;if(!this.isLensOn)return;const r=this.lens.getCenter(),{nodes:o,edges:a}=this.getFocusElements(r),c=new Set,l=d=>{const h=w(d);c.add(h);const u=n.getElement(h);if(!u)return;const f=this.shapes.get(h)||u.cloneNode();f.setPosition(u.getPosition()),f.id=u.id,this.shapes.has(h)?Object.entries(u.attributes).forEach(([v,y])=>{f.style[v]!==y&&(f.style[v]=y)}):(this.canvas.appendChild(f),this.shapes.set(h,f));const g=s.getElementType(h),p=this.getElementStyle(g,d);f.update(p)};o.forEach(l),a.forEach(l),this.shapes.forEach((d,h)=>{c.has(h)||(d.destroy(),this.shapes.delete(h))})},this.scaleRByWheel=n=>{var s;this.options.preventDefault&&n.preventDefault();const{clientX:r,clientY:o,deltaX:a,deltaY:c}=n,{graph:l,canvas:d}=this.context,h=l.getCanvasByClient([r,o]),u=(s=this.lens)===null||s===void 0?void 0:s.getCenter();if(!this.isLensOn||It(h,u)>this.r)return;const{maxR:f,minR:g}=this.options,p=a+c>0?1/(1-cl):1-cl,v=Math.min(...d.getSize())/2;this.r=Math.max(g||0,Math.min(f||v,this.r*p)),this.renderLens(u),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=n=>{var s;const r=re(n.canvas),o=(s=this.lens)===null||s===void 0?void 0:s.getCenter();!this.isLensOn||It(r,o)>this.r||(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const s=re(n.canvas);this.renderLens(s),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const n=t==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof n=="function"?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:s}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(n)&&r.addEventListener(x.CLICK,this.onEdgeFilter),n==="pointermove"?r.addEventListener(x.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(r.addEventListener(x.DRAG_START,this.onDragStart),r.addEventListener(x.DRAG,this.onDrag),r.addEventListener(x.DRAG_END,this.onDragEnd)),s==="wheel"&&((t=this.graphDom)===null||t===void 0||t.addEventListener(x.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:s}=this.options,r=e.getCanvas().getLayer();["click","drag"].includes(n)&&r.removeEventListener(x.CLICK,this.onEdgeFilter),n==="pointermove"?r.removeEventListener(x.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(r.removeEventListener(x.DRAG_START,this.onDragStart),r.removeEventListener(x.DRAG,this.onDrag),r.removeEventListener(x.DRAG_END,this.onDragEnd)),s==="wheel"&&((t=this.graphDom)===null||t===void 0||t.removeEventListener(x.WHEEL,this.scaleRByWheel))}update(t){var e;this.unbindEvents(),super.update(t),this.r=(e=t.r)!==null&&e!==void 0?e:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}dr.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const op={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},ll=.05,dl=.1;class hr extends oe{constructor(t,e){super(t,Object.assign({},hr.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const s=re(n.canvas);this.onMagnify(s)},this.onMagnify=n=>{n.some(isNaN)||(this.renderLens(n),this.renderFocusElements())},this.renderLens=n=>{const s=Object.assign({},op,this.options.style);this.isLensOn||(this.lens=new zn({style:s}),this.canvas.appendChild(this.lens)),Object.assign(s,We(n),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(s)},this.getDPercent=()=>{const{minD:n,maxD:s}=this.options;return`${Math.round((this.d-n)/(s-n)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:n}=this.context,s=this.lens.getCenter(),r=(this.d+1)*this.r,o=new Map,a=new Map;n.getNodeData().forEach(l=>{const d=qt(l),h=It(d,s);if(h>this.r)return;const u=r*h/(this.d*h+this.r),[f,g]=d,[p,v]=s,y=(f-p)/h,m=(g-v)/h,b=[p+u*y,v+u*m],E=w(l),S=this.getNodeStyle(l),O=(0,Li.Z)(n.getElementRenderStyle(E),Object.keys(S));o.set(E,Object.assign(Object.assign({},We(b)),S)),a.set(E,Object.assign(Object.assign({},We(d)),O))}),this.updateStyle(o,a)},this.getNodeStyle=n=>{const{nodeStyle:s}=this.options;return typeof s=="function"?s(n):s},this.updateStyle=(n,s)=>{const{graph:r,element:o}=this.context,{enter:a,exit:c,keep:l}=vn(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(n.keys()),u=>u),d=new Set,h=(u,f)=>{const g=o.getElement(u);g==null||g.update(f),r.getRelatedEdgesData(u).forEach(p=>{d.add(w(p))})};[...a,...l].forEach(u=>{h(u,n.get(u))}),c.forEach(u=>{h(u,this.prevOriginStyleMap.get(u)),this.prevOriginStyleMap.delete(u)}),d.forEach(u=>{const f=o.getElement(u);f==null||f.update({})}),this.prevMagnifiedStyleMap=n,s.forEach((u,f)=>{this.prevOriginStyleMap.has(f)||this.prevOriginStyleMap.set(f,u)})},this.isWheelValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const{clientX:s,clientY:r}=n,o=this.context.graph.getCanvasByClient([s,r]),a=this.lens.getCenter();return!(It(o,a)>this.r)},this.scaleR=n=>{const{maxR:s,minR:r}=this.options,o=n?1/(1-ll):1-ll,a=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(r||0,Math.min(s||a,this.r*o))},this.scaleD=n=>{const{maxD:s,minD:r}=this.options,o=n?this.d+dl:this.d-dl;this.d=Math.max(r,Math.min(s,o))},this.scaleRByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:s,deltaY:r}=n;this.scaleR(s+r>0);const o=this.lens.getCenter();this.onMagnify(o)},this.scaleDByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:s,deltaY:r}=n;this.scaleD(s+r>0);const o=this.lens.getCenter();this.onMagnify(o)},this.isDragValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const s=re(n.canvas),r=this.lens.getCenter();return!(It(s,r)>this.r)},this.isLensDragging=!1,this.onDragStart=n=>{this.isDragValid(n)&&(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const s=re(n.canvas);this.onMagnify(s)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=n=>{if(!this.isLensDragging)return;const{dx:s,dy:r}=n;this.scaleR(s-r>0);const o=this.lens.getCenter();this.onMagnify(o)},this.scaleDByDrag=n=>{if(!this.isLensDragging)return;const{dx:s,dy:r}=n;this.scaleD(s-r>0);const o=this.lens.getCenter();this.onMagnify(o)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:s,scaleDBy:r}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.addEventListener(x.CLICK,this.onCreateFisheye),n==="pointermove"&&o.addEventListener(x.POINTER_MOVE,this.onCreateFisheye),n==="drag"||s==="drag"||r==="drag"){o.addEventListener(x.DRAG_START,this.onDragStart),o.addEventListener(x.DRAG_END,this.onDragEnd);const a=n==="drag"?this.onDrag:s==="drag"?this.scaleRByDrag:this.scaleDByDrag;o.addEventListener(x.DRAG,a)}if(s==="wheel"||r==="wheel"){const a=s==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.addEventListener(x.WHEEL,a,{passive:!1})}}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:s,scaleDBy:r}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.removeEventListener(x.CLICK,this.onCreateFisheye),n==="pointermove"&&o.removeEventListener(x.POINTER_MOVE,this.onCreateFisheye),n==="drag"||s==="drag"||r==="drag"){o.removeEventListener(x.DRAG_START,this.onDragStart),o.removeEventListener(x.DRAG_END,this.onDragEnd);const a=n==="drag"?this.onDrag:s==="drag"?this.scaleRByDrag:this.scaleDByDrag;o.removeEventListener(x.DRAG,a)}if(s==="wheel"||r==="wheel"){const a=s==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.removeEventListener(x.WHEEL,a)}}update(t){var e,n;this.unbindEvents(),super.update(t),this.r=(e=t.r)!==null&&e!==void 0?e:this.r,this.d=(n=t.d)!==null&&n!==void 0?n:this.d,this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&((t=this.lens)===null||t===void 0||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}hr.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class ur extends oe{constructor(t,e){super(t,Object.assign({},ur.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var n,s,r,o;const a=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(a),a?(s=(n=this.options).onEnter)===null||s===void 0||s.call(n):(o=(r=this.options).onExit)===null||o===void 0||o.call(r)},this.shortcut=new ei(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(s=>{document.addEventListener(s,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(e=>{document.removeEventListener(e,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,n;let s,r;t?(s=((e=globalThis.screen)===null||e===void 0?void 0:e.width)||0,r=((n=globalThis.screen)===null||n===void 0?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[s,r]=this.graphSize,this.context.graph.setSize(s,r),this.context.graph.render()}request(){document.fullscreenElement||!ap()||this.$el.requestFullscreen().catch(t=>{F.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}ur.defaultOptions={trigger:{},autoFit:!0};function ap(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}var Fo=_(29348);class fr extends oe{constructor(t,e){super(t,Object.assign({},fr.defaultOptions,e)),this.$element=ai("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=s=>{const{data:{scale:r,origin:o}}=s;if(!r)return;const a=this.currentScale;this.currentScale=r;const c=r/a,l=Fe(o||this.context.graph.getCanvasCenter(),1-c),d=this.baseSize*r,h=Fe(this.offset,c),u=lo(h,d),f=at(u,l);this.$element.style.backgroundSize=`${d}px ${d}px`,this.$element.style.backgroundPosition=`${f[0]}px ${f[1]}px`,this.offset=lo(f,d)},this.followTranslate=s=>{if(!this.options.follow)return;const{data:{translate:r}}=s;r&&this.updateOffset(r)},this.onTransform=s=>{const r=this.parseFollow(this.options.follow);r.zoom&&this.followZoom(s),r.translate&&this.followTranslate(s)},this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(t){super.update(t),t.size!==void 0&&(this.baseSize=t.size),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(P.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{stroke:t,lineWidth:e,border:n,borderLineWidth:s,borderStroke:r,borderStyle:o}=this.options,a=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:n?`${s}px ${o} ${r}`:"none",backgroundImage:`linear-gradient(${t} ${e}px, transparent ${e}px), linear-gradient(90deg, ${t} ${e}px, transparent ${e}px)`,backgroundSize:`${a}px ${a}px`,backgroundRepeat:"repeat"})}updateOffset(t){const e=this.baseSize*this.currentScale;this.offset=lo(at(this.offset,t),e),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(t){var e,n;return(0,Fo.Z)(t)?{translate:t,zoom:t}:{translate:(e=t==null?void 0:t.translate)!==null&&e!==void 0?e:!1,zoom:(n=t==null?void 0:t.zoom)!==null&&n!==void 0?n:!1}}destroy(){this.context.graph.off(P.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}fr.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var $o=_(80216);function Wo(i){const t={Added:new Map,Updated:new Map,Removed:new Map};return i.forEach(e=>{const{type:n,value:s}=e,r=w(s);if(n==="NodeAdded"||n==="EdgeAdded"||n==="ComboAdded")t.Added.set(r,e);else if(n==="NodeUpdated"||n==="EdgeUpdated"||n==="ComboUpdated")if(t.Added.has(r))t.Added.set(r,{type:n.replace("Updated","Added"),value:s});else if(t.Updated.has(r)){const{original:o}=t.Updated.get(r);t.Updated.set(r,{type:n,value:s,original:o})}else t.Removed.has(r)||t.Updated.set(r,e);else(n==="NodeRemoved"||n==="EdgeRemoved"||n==="ComboRemoved")&&(t.Added.has(r)?t.Added.delete(r):(t.Updated.has(r)&&t.Updated.delete(r),t.Removed.set(r,e)))}),[...Array.from(t.Added.values()),...Array.from(t.Updated.values()),...Array.from(t.Removed.values())]}function hl(i){const{NodeAdded:t=[],NodeUpdated:e=[],NodeRemoved:n=[],EdgeAdded:s=[],EdgeUpdated:r=[],EdgeRemoved:o=[],ComboAdded:a=[],ComboUpdated:c=[],ComboRemoved:l=[]}=Qn(i,d=>d.type);return{add:{nodes:t,edges:s,combos:a},update:{nodes:e,edges:r,combos:c},remove:{nodes:n,edges:o,combos:l}}}function ul(i,t){for(const e in i)(0,j.Z)(i[e])&&!Array.isArray(i[e])&&i[e]!==null?(t[e]||(t[e]={}),ul(i[e],t[e])):t[e]===void 0&&(t[e]=ye(e))}function cp(i,t=!1,e){const n={animation:t,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:s,update:r,remove:o}=hl(Wo(i));return["nodes","edges","combos"].forEach(a=>{r[a]&&r[a].forEach(c=>{var l,d;const h=Object.assign({},c.value);let u=Object.assign({},c.original);if(e){const f=e.graph.getElementType(w(c.original)),g=f==="edge"?"stroke":"fill",p=e.element.getElementComputedStyle(f,c.original);u=Object.assign(Object.assign({},c.original),{style:Object.assign({[g]:p[g]},c.original.style)})}ul(h,u),(l=n.current.update)[a]||(l[a]=[]),n.current.update[a].push(h),(d=n.original.update)[a]||(d[a]=[]),n.original.update[a].push(u)}),s[a]&&s[a].forEach(c=>{var l,d;const h=Object.assign({},c.value);(l=n.current.add)[a]||(l[a]=[]),n.current.add[a].push(h),(d=n.original.remove)[a]||(d[a]=[]),n.original.remove[a].push(h)}),o[a]&&o[a].forEach(c=>{var l,d;const h=Object.assign({},c.value);(l=n.current.remove)[a]||(l[a]=[]),n.current.remove[a].push(h),(d=n.original.add)[a]||(d[a]=[]),n.original.add[a].push(h)})}),n}class gr extends oe{constructor(t,e){super(t,Object.assign({},gr.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(s,r=!0)=>{var o,a,c;this.freezed=!0,(a=(o=this.options).executeCommand)===null||a===void 0||a.call(o,s);const l=r?s.original:s.current;this.context.graph.addData(l.add),this.context.graph.updateData(l.update),this.context.graph.removeData(Ha(l.remove,!1)),(c=this.context.element)===null||c===void 0||c.draw({silence:!0,animation:s.animation}),this.freezed=!1},this.addCommand=s=>{var r;if(!this.freezed){if(s.type===P.AFTER_DRAW){const{dataChanges:o=[],animation:a=!0}=s.data;if(!((r=this.context.batch)===null||r===void 0)&&r.isBatching){if(!this.batchChanges)return;this.batchChanges.push(o),this.batchAnimation&&(this.batchAnimation=a);return}this.batchChanges=[o],this.batchAnimation=a}this.undoStackPush(cp(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(pt.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=s=>{const{initiate:r}=s.data;this.batchAnimation=!1,r?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new $o.Z;const{graph:n}=this.context;n.on(P.AFTER_DRAW,this.addCommand),n.on(P.BATCH_START,this.initBatchCommand),n.on(P.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,n,s;const r=this.undoStack.pop();if(r){if(this.executeCommand(r),((e=(t=this.options).beforeAddCommand)===null||e===void 0?void 0:e.call(t,r,!1))===!1)return;this.redoStack.push(r),(s=(n=this.options).afterAddCommand)===null||s===void 0||s.call(n,r,!1),this.notify(pt.UNDO,r)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(pt.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(pt.CANCEL,t)),this}undoStackPush(t){var e,n,s,r;const{stackSize:o}=this.options;o!==0&&this.undoStack.length>=o&&this.undoStack.shift(),((n=(e=this.options).beforeAddCommand)===null||n===void 0?void 0:n.call(e,t,!0))!==!1&&(this.undoStack.push(t),(r=(s=this.options).afterAddCommand)===null||r===void 0||r.call(s,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(pt.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(pt.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:t}=this.context;t.off(P.AFTER_DRAW,this.addCommand),t.off(P.BATCH_START,this.initBatchCommand),t.off(P.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}gr.defaultOptions={stackSize:0};const Zo={toXy(i,t){if(!t)return[...i];const e=t[0].slice(1),n=t[1].slice(1);return i.map(s=>[s[e],s[n]])},fromXy(i,t){if(!t)return[...i];const e=t[0].slice(1),n=t[1].slice(1);return i.map(([s,r])=>({[e]:s,[n]:r}))}};class lp{constructor(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(const n of t){const s=this.coordToCellNum(n[0]),r=this.coordToCellNum(n[1]);this._cells[s]||(this._cells[s]=[]),this._cells[s][r]||(this._cells[s][r]=[]),this._cells[s][r].push(n)}}cellPoints(t,e){var n;return((n=this._cells[t])===null||n===void 0?void 0:n[e])||[]}rangePoints(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),s=this.coordToCellNum(t[2]),r=this.coordToCellNum(t[3]),o=[];for(let a=e;a<=s;a++)for(let c=n;c<=r;c++){const l=this.cellPoints(a,c);for(const d of l)o.push(d)}return o}removePoint(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),s=this._cells[e][n],r=s.findIndex(([o,a])=>o===t[0]&&a===t[1]);return r>-1&&s.splice(r,1),s}trunc(t){return Math.trunc(t)}coordToCellNum(t){return this.trunc(t*this._reverseCellSize)}extendBbox(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}}function dp(i,t){return new lp(i,t)}const fl=+(Math.pow(2,27)+1);function pr(i,t,e){const n=i*t,s=fl*i,r=s-i,o=s-r,a=i-o,c=fl*t,l=c-t,d=c-l,h=t-d,g=n-o*d-a*d-o*h,p=a*h-g;return e?(e[0]=p,e[1]=n,e):[p,n]}function hp(i,t,e){const n=i+t,s=n-i,r=n-s,o=t-s,a=i-r;return e?(e[0]=a+o,e[1]=n,e):[a+o,n]}function up(i,t){const e=i.length;if(e===1){const a=pr(i[0],t);return a[0]?a:[a[1]]}const n=new Array(2*e),s=[.1,.1],r=[.1,.1];let o=0;pr(i[0],t,s),s[0]&&(n[o++]=s[0]);for(let a=1;a<e;++a){pr(i[a],t,r);const c=s[1];hp(c,r[0],s),s[0]&&(n[o++]=s[0]);const l=r[1],d=s[1],h=l+d,u=h-l,f=d-u;s[1]=h,f&&(n[o++]=f)}return s[1]&&(n[o++]=s[1]),o===0&&(n[o++]=0),n.length=o,n}function fp(i,t){const e=i+t,n=e-i,s=e-n,r=t-n,a=i-s+r;return a?[a,e]:[e]}function gp(i,t){const e=i.length|0,n=t.length|0;if(e===1&&n===1)return fp(i[0],-t[0]);const s=e+n,r=new Array(s);let o=0,a=0,c=0;const l=Math.abs;let d=i[a],h=l(d),u=-t[c],f=l(u),g,p;h<f?(p=d,a+=1,a<e&&(d=i[a],h=l(d))):(p=u,c+=1,c<n&&(u=-t[c],f=l(u))),a<e&&h<f||c>=n?(g=d,a+=1,a<e&&(d=i[a],h=l(d))):(g=u,c+=1,c<n&&(u=-t[c],f=l(u)));let v=g+p,y=v-g,m=p-y,b=m,E=v,S,O,A,N,z;for(;a<e&&c<n;)h<f?(g=d,a+=1,a<e&&(d=i[a],h=l(d))):(g=u,c+=1,c<n&&(u=-t[c],f=l(u))),p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S;for(;a<e;)g=d,p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S,a+=1,a<e&&(d=i[a]);for(;c<n;)g=u,p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S,c+=1,c<n&&(u=-t[c]);return b&&(r[o++]=b),E&&(r[o++]=E),o||(r[o++]=0),r.length=o,r}function pp(i,t){const e=i+t,n=e-i,s=e-n,r=t-n,a=i-s+r;return a?[a,e]:[e]}function vp(i,t){const e=i.length|0,n=t.length|0;if(e===1&&n===1)return pp(i[0],t[0]);const s=e+n,r=new Array(s);let o=0,a=0,c=0;const l=Math.abs;let d=i[a],h=l(d),u=t[c],f=l(u),g,p;h<f?(p=d,a+=1,a<e&&(d=i[a],h=l(d))):(p=u,c+=1,c<n&&(u=t[c],f=l(u))),a<e&&h<f||c>=n?(g=d,a+=1,a<e&&(d=i[a],h=l(d))):(g=u,c+=1,c<n&&(u=t[c],f=l(u)));let v=g+p,y=v-g,m=p-y,b=m,E=v,S,O,A,N,z;for(;a<e&&c<n;)h<f?(g=d,a+=1,a<e&&(d=i[a],h=l(d))):(g=u,c+=1,c<n&&(u=t[c],f=l(u))),p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S;for(;a<e;)g=d,p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S,a+=1,a<e&&(d=i[a]);for(;c<n;)g=u,p=b,v=g+p,y=v-g,m=p-y,m&&(r[o++]=m),S=E+v,O=S-E,A=S-O,N=v-O,z=E-A,b=z+N,E=S,c+=1,c<n&&(u=t[c]);return b&&(r[o++]=b),E&&(r[o++]=E),o||(r[o++]=0),r.length=o,r}const gl=5,vr=11102230246251565e-32,yp=(3+16*vr)*vr,mp=(7+56*vr)*vr;function bp(i,t,e,n){return function(r,o,a){const c=i(i(t(o[1],a[0]),t(-a[1],o[0])),i(t(r[1],o[0]),t(-o[1],r[0]))),l=i(t(r[1],a[0]),t(-a[1],r[0])),d=n(c,l);return d[d.length-1]}}function Ep(i,t,e,n){return function(r,o,a,c){const l=i(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),o[2]),i(e(i(t(o[1],c[0]),t(-c[1],o[0])),-a[2]),e(i(t(o[1],a[0]),t(-a[1],o[0])),c[2]))),i(e(i(t(o[1],c[0]),t(-c[1],o[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),c[2])))),d=i(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-a[2]),e(i(t(r[1],a[0]),t(-a[1],r[0])),c[2]))),i(e(i(t(o[1],a[0]),t(-a[1],o[0])),r[2]),i(e(i(t(r[1],a[0]),t(-a[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),a[2])))),h=n(l,d);return h[h.length-1]}}function xp(i,t,e,n){return function(r,o,a,c,l){const d=i(i(i(e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),a[2]),i(e(i(t(a[1],l[0]),t(-l[1],a[0])),-c[2]),e(i(t(a[1],c[0]),t(-c[1],a[0])),l[2]))),o[3]),i(e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),o[2]),i(e(i(t(o[1],l[0]),t(-l[1],o[0])),-c[2]),e(i(t(o[1],c[0]),t(-c[1],o[0])),l[2]))),-a[3]),e(i(e(i(t(a[1],l[0]),t(-l[1],a[0])),o[2]),i(e(i(t(o[1],l[0]),t(-l[1],o[0])),-a[2]),e(i(t(o[1],a[0]),t(-a[1],o[0])),l[2]))),c[3]))),i(e(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),o[2]),i(e(i(t(o[1],c[0]),t(-c[1],o[0])),-a[2]),e(i(t(o[1],a[0]),t(-a[1],o[0])),c[2]))),-l[3]),i(e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),o[2]),i(e(i(t(o[1],l[0]),t(-l[1],o[0])),-c[2]),e(i(t(o[1],c[0]),t(-c[1],o[0])),l[2]))),r[3]),e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-c[2]),e(i(t(r[1],c[0]),t(-c[1],r[0])),l[2]))),-o[3])))),i(i(e(i(e(i(t(o[1],l[0]),t(-l[1],o[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),l[2]))),c[3]),i(e(i(e(i(t(o[1],c[0]),t(-c[1],o[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),c[2]))),-l[3]),e(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),o[2]),i(e(i(t(o[1],c[0]),t(-c[1],o[0])),-a[2]),e(i(t(o[1],a[0]),t(-a[1],o[0])),c[2]))),r[3]))),i(e(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-a[2]),e(i(t(r[1],a[0]),t(-a[1],r[0])),c[2]))),-o[3]),i(e(i(e(i(t(o[1],c[0]),t(-c[1],o[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),c[2]))),a[3]),e(i(e(i(t(o[1],a[0]),t(-a[1],o[0])),r[2]),i(e(i(t(r[1],a[0]),t(-a[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),a[2]))),-c[3]))))),h=i(i(i(e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),a[2]),i(e(i(t(a[1],l[0]),t(-l[1],a[0])),-c[2]),e(i(t(a[1],c[0]),t(-c[1],a[0])),l[2]))),r[3]),e(i(e(i(t(c[1],l[0]),t(-l[1],c[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-c[2]),e(i(t(r[1],c[0]),t(-c[1],r[0])),l[2]))),-a[3])),i(e(i(e(i(t(a[1],l[0]),t(-l[1],a[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-a[2]),e(i(t(r[1],a[0]),t(-a[1],r[0])),l[2]))),c[3]),e(i(e(i(t(a[1],c[0]),t(-c[1],a[0])),r[2]),i(e(i(t(r[1],c[0]),t(-c[1],r[0])),-a[2]),e(i(t(r[1],a[0]),t(-a[1],r[0])),c[2]))),-l[3]))),i(i(e(i(e(i(t(a[1],l[0]),t(-l[1],a[0])),o[2]),i(e(i(t(o[1],l[0]),t(-l[1],o[0])),-a[2]),e(i(t(o[1],a[0]),t(-a[1],o[0])),l[2]))),r[3]),e(i(e(i(t(a[1],l[0]),t(-l[1],a[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-a[2]),e(i(t(r[1],a[0]),t(-a[1],r[0])),l[2]))),-o[3])),i(e(i(e(i(t(o[1],l[0]),t(-l[1],o[0])),r[2]),i(e(i(t(r[1],l[0]),t(-l[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),l[2]))),a[3]),e(i(e(i(t(o[1],a[0]),t(-a[1],o[0])),r[2]),i(e(i(t(r[1],a[0]),t(-a[1],r[0])),-o[2]),e(i(t(r[1],o[0]),t(-o[1],r[0])),a[2]))),-l[3])))),u=n(d,h);return u[u.length-1]}}function yr(i){return(i===3?bp:i===4?Ep:xp)(vp,pr,up,gp)}const Sp=yr(3),Op=yr(4),Vn=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){const s=(t[1]-n[1])*(e[0]-n[0]),r=(t[0]-n[0])*(e[1]-n[1]),o=s-r;let a;if(s>0){if(r<=0)return o;a=s+r}else if(s<0){if(r>=0)return o;a=-(s+r)}else return o;const c=yp*a;return o>=c||o<=-c?o:Sp(t,e,n)},function(t,e,n,s){const r=t[0]-s[0],o=e[0]-s[0],a=n[0]-s[0],c=t[1]-s[1],l=e[1]-s[1],d=n[1]-s[1],h=t[2]-s[2],u=e[2]-s[2],f=n[2]-s[2],g=o*d,p=a*l,v=a*c,y=r*d,m=r*l,b=o*c,E=h*(g-p)+u*(v-y)+f*(m-b),S=(Math.abs(g)+Math.abs(p))*Math.abs(h)+(Math.abs(v)+Math.abs(y))*Math.abs(u)+(Math.abs(m)+Math.abs(b))*Math.abs(f),O=mp*S;return E>O||-E>O?E:Op(t,e,n,s)}];function wp(i){let t=Vn[i.length];return t||(t=Vn[i.length]=yr(i.length)),t.apply(void 0,...i)}function Cp(i,t,e,n,s,r,o){return function(...c){switch(c.length){case 0:case 1:return 0;case 2:return n(c[0],c[1]);case 3:return s(c[0],c[1],c[2]);case 4:return r(c[0],c[1],c[2],c[3]);case 5:return o(c[0],c[1],c[2],c[3],c[4])}return i(c)}}function Dp(){for(;Vn.length<=gl;)Vn.push(yr(Vn.length));const i=Cp(void 0,wp,...Vn);for(let t=0;t<=gl;++t)i[t]=Vn[t];return i}var Bi=Dp();const pl=Bi[3];function Tp(i){const t=i.length;if(t<3){const a=new Array(t);for(let c=0;c<t;++c)a[c]=c;return t===2&&i[0][0]===i[1][0]&&i[0][1]===i[1][1]?[0]:a}const e=new Array(t);for(let a=0;a<t;++a)e[a]=a;e.sort((a,c)=>{const l=i[a][0]-i[c][0];return l||i[a][1]-i[c][1]});const n=[e[0],e[1]],s=[e[0],e[1]];for(let a=2;a<t;++a){const c=e[a],l=i[c];let d=n.length;for(;d>1&&pl(i[n[d-2]],i[n[d-1]],l)<=0;)d-=1,n.pop();for(n.push(c),d=s.length;d>1&&pl(i[s[d-2]],i[s[d-1]],l)>=0;)d-=1,s.pop();s.push(c)}const r=new Array(s.length+n.length-2);let o=0;for(let a=0,c=n.length;a<c;++a)r[o++]=n[a];for(let a=s.length-2;a>0;--a)r[o++]=s[a];return r}function Mp(i,t,e,n){for(let s=0;s<2;++s){const r=i[s],o=t[s],[a,c]=[Math.min(r,o),Math.max(r,o)],l=e[s],d=n[s],[h,u]=[Math.min(l,d),Math.max(l,d)];if(u<a||c<h)return!1}return!0}function Ap(i,t,e,n){const s=Bi(i,e,n),r=Bi(t,e,n);if(s>0&&r>0||s<0&&r<0)return!1;const o=Bi(e,i,t),a=Bi(n,i,t);return o>0&&a>0||o<0&&a<0?!1:s===0&&r===0&&o===0&&a===0?Mp(i,t,e,n):!0}function Lp(i){const t=[i[0]];let e=i[0];for(let n=1;n<i.length;n++){const s=i[n];(e[0]!==s[0]||e[1]!==s[1])&&t.push(s),e=s}return t}function Np(i){return i.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]})}function Vo(i,t){return Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2)}function vl(i,t,e){const n=[t[0]-i[0],t[1]-i[1]],s=[e[0]-i[0],e[1]-i[1]],r=Vo(i,t),o=Vo(i,e);return(n[0]*s[0]+n[1]*s[1])/Math.sqrt(r*o)}function yl(i,t){for(let e=0;e<t.length-1;e++){const n=[t[e],t[e+1]];if(!(i[0][0]===n[0][0]&&i[0][1]===n[0][1]||i[0][0]===n[1][0]&&i[0][1]===n[1][1])&&Ap(i[0],i[1],n[0],n[1]))return!0}return!1}function Ip(i){let t=1/0,e=1/0,n=-1/0,s=-1/0;for(let r=i.length-1;r>=0;r--)i[r][0]<t&&(t=i[r][0]),i[r][1]<e&&(e=i[r][1]),i[r][0]>n&&(n=i[r][0]),i[r][1]>s&&(s=i[r][1]);return[n-t,s-e]}function Pp(i){return[Math.min(i[0][0],i[1][0]),Math.min(i[0][1],i[1][1]),Math.max(i[0][0],i[1][0]),Math.max(i[0][1],i[1][1])]}function _p(i,t,e){let n=null,s=bl,r=bl,o,a;for(let c=0;c<t.length;c++)o=vl(i[0],i[1],t[c]),a=vl(i[1],i[0],t[c]),o>s&&a>r&&!yl([i[0],t[c]],e)&&!yl([i[1],t[c]],e)&&(s=o,r=a,n=t[c]);return n}function ml(i,t,e,n,s){let r=!1;for(let o=0;o<i.length-1;o++){const a=[i[o],i[o+1]],c=a[0][0]+","+a[0][1]+","+a[1][0]+","+a[1][1];if(Vo(a[0],a[1])<t||s.has(c))continue;let l=0,d=Pp(a),h,u,f;do d=n.extendBbox(d,l),h=d[2]-d[0],u=d[3]-d[1],f=_p(a,n.rangePoints(d),i),l++;while(f===null&&(e[0]>h||e[1]>u));h>=e[0]&&u>=e[1]&&s.add(c),f!==null&&(i.splice(o+1,0,f),n.removePoint(f),r=!0)}return r?ml(i,t,e,n,s):i}function Rp(i,t,e){const n=t||20,s=Lp(Np(Zo.toXy(i,e)));if(s.length<4){const h=s.concat([s[0]]);return e?Zo.fromXy(h,e):h}const r=Ip(s),o=[r[0]*El,r[1]*El],a=Tp(s).reverse().map(h=>s[h]);a.push(a[0]);const c=s.filter(function(h){return a.indexOf(h)<0}),l=Math.ceil(1/(s.length/(r[0]*r[1]))),d=ml(a,Math.pow(n,2),o,dp(c,l),new Set);return e?Zo.fromXy(d,e):d}const bl=Math.cos(90/(180/Math.PI)),El=.6;function kp(i,t,e){if(i.length===1)return jp(i[0],t,e);if(i.length===2)return xl(i,t,e);if(i.length===3){const[n,s,r]=uo(i);if(tc(n,s,r))return xl([n,r],t,e)}switch(e){case"smooth":return zp(i,t);case"sharp":return Fp(i,t);case"rounded":default:return Bp(i,t)}}const jp=(i,t,e)=>{if(e==="sharp")return[["M",i[0]-t,i[1]-t],["L",i[0]+t,i[1]-t],["L",i[0]+t,i[1]+t],["L",i[0]-t,i[1]+t],["Z"]];const n=[t,t,0,0,0];return[["M",i[0],i[1]-t],["A",...n,i[0],i[1]+t],["A",...n,i[0],i[1]-t]]},xl=(i,t,e)=>{const n=[t,t,0,0,0],s=e==="sharp"?at(i[0],yn(an(Mt(i[0],i[1])),t)):i[0],r=e==="sharp"?at(i[1],yn(an(Mt(i[1],i[0])),t)):i[1],o=yn(an(hs(Mt(s,r),!1)),t),a=yn(o,-1),c=at(s,o),l=at(r,o),d=at(r,a),h=at(s,a);return e==="sharp"?[["M",c[0],c[1]],["L",l[0],l[1]],["L",d[0],d[1]],["L",h[0],h[1]],["Z"]]:[["M",c[0],c[1]],["L",l[0],l[1]],["A",...n,d[0],d[1]],["L",h[0],h[1]],["A",...n,c[0],c[1]]]},Bp=(i,t)=>{const e=uo(i).map((a,c)=>{const l=(c-2+i.length)%i.length,d=(c-1+i.length)%i.length,h=(c+1)%i.length,u=i[l],f=i[d],g=i[h],p=Mt(u,f),v=Mt(f,a),y=Mt(a,g),m=(A,N)=>co(A,N,!0)<Math.PI,b=m(p,v),E=m(v,y),S=A=>yn(an(hs(A,!1)),t),O=S(v);return[{p:jn(b?at(f,S(p)):at(f,O)),concave:b&&f},{p:jn(E?at(a,S(y)):at(a,O)),concave:E&&a}]}),n=[t,t,0,0,0],s=e.findIndex((a,c)=>!e[(c-1+e.length)%e.length][0].concave&&!e[(c-1+e.length)%e.length][1].concave&&!a[0].concave&&!a[0].concave&&!a[1].concave),r=e.slice(s).concat(e.slice(0,s));let o=[];return r.flatMap((a,c)=>{const l=[],d=r[e.length-1];return c===0&&l.push(["M",...d[1].p]),a[0].concave?o.push(a[0].p,a[1].p):l.push(["A",...n,...a[0].p]),a[1].concave?o.unshift(a[1].p):l.push(["L",...a[1].p]),o.length===3&&(l.pop(),l.push(["C",...o.flat()]),o=[]),l})},zp=(i,t)=>{const e=uo(i).map((n,s)=>{const r=i[(s+1)%i.length];return{p:n,v:an(Mt(r,n))}});return e.forEach((n,s)=>{const r=s>0?s-1:i.length-1,o=e[r].v,a=an(at(o,yn(n.v,co(o,n.v,!0)<Math.PI?1:-1)));n.p=at(n.p,yn(a,t))}),mc(e.map(n=>n.p))},Fp=(i,t)=>{const n=i.map((r,o)=>{const a=i[o===0?i.length-1:o-1],c=Oi(yn(an(hs(Mt(a,r),!1)),t));return[at(a,c),at(r,c)]}).flat();return n.map((r,o)=>{if(o%2===0)return null;const a=[n[(o-1)%n.length],n[o%n.length]],c=[n[(o+1)%n.length],n[(o+2)%n.length]];return ho(a,c,!0)}).filter(Boolean).map((r,o)=>[o===0?"M":"L",r[0],r[1]]).concat([["Z"]])};var $p=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class mr extends oe{constructor(t,e){super(t,Object.assign({},mr.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new Mi({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const n=!(0,Y.Z)(this.optionsCache,this.options);this.shape.update(this.getHullStyle(n))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=n=>{this.shape&&this.options.members.includes(w(n.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(n=!1)=>{const{graph:s}=this.context,r=this.getMember();if(r.length===0)return"";const o=r.map(l=>s.getNodeData(l)),a=Rp(o.map(qt),this.options.concavity).slice(1).reverse(),c=a.flatMap(l=>o.filter(d=>(0,Y.Z)(qt(d),l)).map(w));return(0,Y.Z)(c,this.hullMemberIds)&&!n?this.path:(this.hullMemberIds=c,this.path=kp(a,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(P.AFTER_RENDER,this.drawHull),this.context.graph.on(P.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,{members:n,padding:s,corner:r}=e,o=$p(e,["members","padding","corner"]);return Object.assign(Object.assign({},o),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((n,s)=>{const{halfExtents:r}=t.getElementRenderBounds(s),o=Math.max(r[0],r[1]);return Math.max(n,o)},0)+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(n=>!e.includes(n)),e.some(n=>this.hullMemberIds.includes(n))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=(0,et.Z)(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(P.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}mr.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var Wp=_(76947);function Ho(i){const{width:t,height:e,renderer:n}=i,s=Zp(i),r=new M.Xz({width:t,height:e,container:s,renderer:n||new Ai.Th});return[s,r]}function Zp(i){var t;const{container:e,className:n,graphCanvas:s}=i;if(e)return typeof e=="string"?document.getElementById(e):e;const r=ai(n,!1),{width:o,height:a,containerStyle:c}=i,[l,d]=Vp(i);return Object.assign(r.style,Object.assign({position:"absolute",left:l+"px",top:d+"px",width:o+"px",height:a+"px"},c)),(t=s.getContainer())===null||t===void 0||t.appendChild(r),r}function Vp(i){const{width:t,height:e,placement:n,graphCanvas:s}=i,[r,o]=s.getSize(),[a,c]=qa(n);return[a*(r-t),c*(o-e)]}var Hp=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class br extends oe{constructor(t,e){super(t,Object.assign({},br.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:n}=this.context;n.on(P.AFTER_DRAW,this.createElement)},this.changeState=(n,s)=>{const{graph:r}=this.context,{typePrefix:o}=this,a=(0,Ce.Z)(n,[o,"id"]),c=(0,Ce.Z)(n,[o,"style","labelText"]),[l]=a.split("__"),d=this.fieldMap[l].get(c)||[];r.setElementState(Object.fromEntries(d==null?void 0:d.map(h=>[h,s])))},this.click=n=>{if(this.options.trigger==="hover")return;const s=(0,Ce.Z)(n,[this.typePrefix,"id"]);this.selectedItems.includes(s)?(this.selectedItems=this.selectedItems.filter(r=>r!==s),this.changeState(n,[])):(this.selectedItems.push(s),this.changeState(n,"selected"))},this.mouseleave=n=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(n,[]))},this.mouseenter=n=>{if(this.options.trigger==="click")return;const s=(0,Ce.Z)(n,[this.typePrefix,"id"]);this.selectedItems.includes(s)?this.selectedItems=this.selectedItems.filter(r=>r!==s):(this.selectedItems.push(s),this.changeState(n,"active"))},this.setFieldMap=(n,s,r)=>{if(!n)return;const o=this.fieldMap[r];if(o)if(!o.has(n))o.set(n,[s]);else{const a=o.get(n);a&&(a.push(s),o.set(n,a))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(n,s)=>{if(!n)return[];const{model:r,element:o}=this.context,{nodes:a,edges:c,combos:l}=r.getData(),d={},h=v=>(0,et.Z)(n)?n(v):n,u={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(v,y)=>o==null?void 0:o.getElementComputedStyle(v,y),p=(v,y)=>{v.forEach(m=>{const{id:b}=m,E=(0,Ce.Z)(m,["data",h(m)]),S=(o==null?void 0:o.getElementType(y,m))||"circle",O=g(y,m),A=(y==="edge"?O==null?void 0:O.stroke:O==null?void 0:O.fill)||"#1783ff";b&&E&&E.replace(/\s+/g,"")&&(this.setFieldMap(E,b,y),d[E]||(d[E]={id:`${y}__${b}`,label:E,marker:f[S]||u[y],elementType:y,lineWidth:1,stroke:A,fill:A}))})};switch(s){case"node":p(a,"node");break;case"edge":p(c,"edge");break;case"combo":p(l,"combo");break;default:return[]}return Object.values(d)},this.createElement=()=>{if(this.draw){this.updateElement();return}const n=this.options,{width:s,height:r,nodeField:o,edgeField:a,comboField:c,trigger:l,position:d,container:h,containerStyle:u,className:f}=n,g=Hp(n,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),p=this.getMarkerData(o,"node"),v=this.getMarkerData(a,"edge"),y=this.getMarkerData(c,"combo"),m=[...p,...y,...v],b=Object.assign({width:s,height:r,data:m,itemMarkerLineWidth:({lineWidth:O})=>O,itemMarker:({marker:O})=>O,itemMarkerStroke:({stroke:O})=>O,itemMarkerFill:({fill:O})=>O,gridCol:p.length},g,this.getEvents()),E=new Wp.W({className:"legend",style:b});this.category=E,this.upsertCanvas().appendChild(E),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;(t=this.canvas)===null||t===void 0||t.destroy(),(e=this.container)===null||e===void 0||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const t=this.context.canvas,[e,n]=t.getSize(),{width:s=e,height:r=n,position:o,container:a,containerStyle:c,className:l}=this.options,[d,h]=Ho({width:s,height:r,graphCanvas:t,container:a,containerStyle:c,placement:o,className:"legend"});return this.container=d,l&&d.classList.add(l),this.canvas=h,this.canvas}destroy(){this.clear(),this.context.graph.off(P.AFTER_DRAW,this.createElement),super.destroy()}}br.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Er extends oe{constructor(t,e){super(t,Object.assign({},Er.defaultOptions,e)),this.onDraw=n=>{var s;!((s=n==null?void 0:n.data)===null||s===void 0)&&s.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=n=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(n.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=n=>{if(!this.mask||!this.isMaskDragging)return;const{size:[s,r]}=this.options,{movementX:o,movementY:a}=n,{left:c,top:l,width:d,height:h}=this.mask.style,[,,u,f]=this.maskBBox;let g=parseInt(c)+o,p=parseInt(l)+a,v=parseInt(d),y=parseInt(h);g<0&&(g=0),p<0&&(p=0),g+v>s&&(g=Cn(s-v,0)),p+y>r&&(p=Cn(r-y,0)),v<u&&(o>0?(g=Cn(g-o,0),v=wn(v+o,s)):o<0&&(v=wn(v-o,s))),y<f&&(a>0?(p=Cn(p-a,0),y=wn(y+a,r)):a<0&&(y=wn(y-a,r))),Object.assign(this.mask.style,{left:g+"px",top:p+"px",width:v+"px",height:y+"px"});const m=parseInt(c)-g,b=parseInt(l)-p;if(m===0&&b===0)return;const E=this.context.canvas.getCamera().getZoom(),S=this.canvas.getCamera().getZoom(),O=E/S;this.context.graph.translateBy([m*O,b*O],!1)},this.onMaskDragEnd=n=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(n.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=(0,Gi.Z)(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=(0,zs.Z)(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){const{graph:t}=this.context;t.on(P.AFTER_DRAW,this.onDraw),t.on(P.AFTER_RENDER,this.onRender),t.on(P.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(P.AFTER_DRAW,this.onDraw),t.off(P.AFTER_RENDER,this.onRender),t.off(P.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;const{nodes:s,edges:r,combos:o}=n;return{nodes:s.filter(a=>t(w(a),"node")),edges:r.filter(a=>t(w(a),"edge")),combos:o.filter(a=>t(w(a),"combo"))}}setShapes(t,e){const{nodes:n,edges:s,combos:r}=e,{shape:o}=this.options,{element:a}=this.context;if(o==="key"){const l=new Set,d=h=>{const u=w(h);l.add(u);const f=a.getElement(u);if(!f)return;const g=f.getShape("key"),p=this.shapes.get(u)||g.cloneNode();p.setPosition(g.getPosition()),f.style.zIndex&&(p.style.zIndex=f.style.zIndex),p.id=f.id,this.shapes.has(u)?Object.entries(g.attributes).forEach(([v,y])=>{p.style[v]!==y&&(p.style[v]=y)}):(t.appendChild(p),this.shapes.set(u,p))};s.forEach(d),r.forEach(d),n.forEach(d),this.shapes.forEach((h,u)=>{l.has(u)||(t.removeChild(h),this.shapes.delete(u))});return}const c=(l,d)=>{const u=a.getElement(l).getPosition();return d.setPosition(u),d};t.removeChildren(),s.forEach(l=>t.appendChild(o(w(l),"edge"))),r.forEach(l=>{t.appendChild(c(w(l),o(w(l),"combo")))}),n.forEach(l=>{t.appendChild(c(w(l),o(w(l),"node")))})}initCanvas(){const{renderer:t,size:[e,n]}=this.options;if(this.canvas){const{width:s,height:r}=this.canvas.getConfig();(e!==s||n!==r)&&this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{const{className:s,position:r,container:o,containerStyle:a}=this.options,[c,l]=Ho({renderer:t,width:e,height:n,placement:r,className:"minimap",container:o,containerStyle:a,graphCanvas:this.context.canvas});s&&c.classList.add(s),this.container=c,this.canvas=l}return this.setCamera(),this.canvas}createLandmark(t,e,n){const s=`${t.join(",")}-${e.join(",")}-${n}`;if(this.landmarkMap.has(s))return this.landmarkMap.get(s);const o=this.canvas.getCamera().createLandmark(s,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(s,o),o}setCamera(){var t;const{canvas:e}=this.context,n=(t=this.canvas)===null||t===void 0?void 0:t.getCamera();if(!n)return;const{size:[s,r],padding:o}=this.options,[a,c,l,d]=je(o),{min:h,max:u,center:f}=e.getBounds("elements"),g=u[0]-h[0],p=u[1]-h[1],v=s-d-c,y=r-a-l,m=v/g,b=y/p,E=Math.min(m,b),S=this.createLandmark(f,f,E);n.gotoLandmark(S,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),s=t.getCanvasByViewport(e),r=this.canvas.canvas2Viewport(We(n)),o=this.canvas.canvas2Viewport(We(s)),a=o.x-r.x,c=o.y-r.y;return[r.x,r.y,a,c]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[n,s,r,o]=this.maskBBox;return n<0&&(r=wn(r+n,t),n=0),s<0&&(o=wn(o+s,e),s=0),n+r>t&&(r=Cn(t-n,0)),s+o>e&&(o=Cn(e-s,0)),[wn(n,t),wn(s,e),Cn(r,0),Cn(o,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,n,s]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:s+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),(t=this.mask)===null||t===void 0||t.remove(),super.destroy()}}Er.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const wn=(i,t)=>Math.min(i,t),Cn=(i,t)=>Math.max(i,t);var Yo=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};const Uo={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class xr extends oe{constructor(t,e){super(t,Object.assign({},xr.defaultOptions,e)),this.initSnapline=()=>{const n=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=n.appendChild(new M.x1({style:Object.assign(Object.assign({},Uo),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=n.appendChild(new M.x1({style:Object.assign(Object.assign({},Uo),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(n,s,r)=>Yo(this,void 0,void 0,function*(){const{verticalX:o,horizontalY:a}=r,{tolerance:c}=this.options,{min:[l,d],max:[h,u],center:[f,g]}=s;let p=0,v=0;o!==null&&(ce(h,o)<c&&(p=o-h),ce(l,o)<c&&(p=o-l),ce(f,o)<c&&(p=o-f),p!==0&&(this.isVerticalSticking=!0)),a!==null&&(ce(u,a)<c&&(v=a-u),ce(d,a)<c&&(v=a-d),ce(g,a)<c&&(v=a-g),v!==0&&(this.isHorizontalSticking=!0)),(p!==0||v!==0)&&(yield this.context.graph.translateElementBy({[n]:[p,v]},!1))}),this.enableSnap=n=>{const{target:s}=n,r=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[o,a]=this.getDelta(n);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(o)<=r&&Math.abs(a)<=r)return this.context.graph.translateElementBy({[s.id]:[-o,-a]},!1),!1;if(this.isHorizontalSticking&&Math.abs(a)<=r)return this.context.graph.translateElementBy({[s.id]:[0,-a]},!1),!1;if(this.isVerticalSticking&&Math.abs(o)<=r)return this.context.graph.translateElementBy({[s.id]:[-o,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(n,s)=>{const{tolerance:r,shape:o}=this.options,{min:[a,c],max:[l,d],center:[h,u]}=s;let f=null,g=null,p=null,v=null,y=null,m=null;return this.getNodes().some(b=>{if((0,Y.Z)(n.id,b.id))return!1;const E=Sl(b,o).getRenderBounds(),{min:[S,O],max:[A,N],center:[z,U]}=E;return f===null&&(ce(z,h)<r?f=z:ce(S,a)<r||ce(S,l)<r?f=S:(ce(A,l)<r||ce(A,a)<r)&&(f=A),f!==null&&(g=Math.min(O,c),p=Math.max(N,d))),v===null&&(ce(U,u)<r?v=U:ce(O,c)<r||ce(O,d)<r?v=O:(ce(N,d)<r||ce(N,c)<r)&&(v=N),v!==null&&(y=Math.min(S,a),m=Math.max(A,l))),f!==null&&v!==null}),{verticalX:f,verticalMinY:g,verticalMaxY:p,horizontalY:v,horizontalMinX:y,horizontalMaxX:m}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=n=>Yo(this,void 0,void 0,function*(){const{target:s}=n;if(this.options.autoSnap&&!this.enableSnap(n))return;const r=Sl(s,this.options.shape).getRenderBounds(),o=this.calcSnaplineMetadata(s,r);this.hideSnapline(),(o.verticalX!==null||o.horizontalY!==null)&&this.updateSnapline(o),this.options.autoSnap&&(yield this.autoSnapToLine(s.id,r,o))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,s=(((t=this.context.element)===null||t===void 0?void 0:t.getNodes())||[]).filter(r=>{var o;return Wf(r)&&((o=this.context.viewport)===null||o===void 0?void 0:o.isInViewport(r.getRenderBounds()))});return e?s.filter(r=>e(r)):s}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||Uo.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:n,verticalMaxY:s,horizontalY:r,horizontalMinX:o,horizontalMaxX:a}=t,[c,l]=this.context.canvas.getSize(),{offset:d}=this.options;r!==null?Object.assign(this.horizontalLine.style,{x1:d===1/0?0:o-d,y1:r,x2:d===1/0?c:a+d,y2:r,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",e!==null?Object.assign(this.verticalLine.style,{x1:e,y1:d===1/0?0:n-d,x2:e,y2:d===1/0?l:s+d,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return $e([t.dx,t.dy],e)}bindEvents(){return Yo(this,void 0,void 0,function*(){const{graph:t}=this.context;t.on(St.DRAG_START,this.onDragStart),t.on(St.DRAG,this.onDrag),t.on(St.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:t}=this.context;t.off(St.DRAG_START,this.onDragStart),t.off(St.DRAG,this.onDrag),t.off(St.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;(t=this.horizontalLine)===null||t===void 0||t.destroy(),(e=this.verticalLine)===null||e===void 0||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}xr.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const ce=(i,t)=>Math.abs(i-t),Sl=(i,t)=>typeof t=="function"?t(i):i.getShape(t);var Hn=_(71350),He=_(97289),Sr=_(69210),he=_(20949),Ol=null,Yp=null;function Or(i){return i instanceof Date?i:new Date(i)}function Up(i){for(var t=__read(i,2),e=t[0],n=t[1],s=Ol.indexOf(e),r=Ol.indexOf(n),o="",a=s;a<=r;a+=1)if(o+=Yp[a],a<r){var c="-";a===2?c=" ":a>2&&(c=":"),o+=c}return o}function ue(i,t){var e={YYYY:i.getFullYear(),MM:i.getMonth()+1,DD:i.getDate(),HH:i.getHours(),mm:i.getMinutes(),ss:i.getSeconds()},n=t;return Object.keys(e).forEach(function(s){var r=e[s];n=n.replace(s,s==="YYYY"?"".concat(r):"".concat(r).padStart(2,"0"))}),n}function Fm(i,t){return Or(i).getTime()-Or(t).getTime()}function $m(i,t){var e=__read([Or(i),Or(t)],2),n=e[0],s=e[1];return n.getFullYear()!==s.getFullYear()?"year":n.getMonth()!==s.getMonth()?"month":n.getDay()!==s.getDay()?"day":n.getHours()!==s.getHours()?"hour":n.getMinutes()!==s.getMinutes()?"minute":"second"}function Wm(i,t){var e=new Date(i),n={year:function(s){s.setMonth(0),s.setHours(0,0,0,0)},month:function(s){s.setDate(1),s.setHours(0,0,0,0)},day:function(s){return s.setHours(0,0,0,0)},hour:function(s){return s.setMinutes(0,0,0)},minute:function(s){return s.setSeconds(0,0)},second:function(s){return s.setMilliseconds(0)}};return n[t](e),ue(e,Up(["year",t]))}var Gp=_(6234),Xp=_(99012),zi=_(27475),Lt=_(50885),Kp=_(91715),wl=_(27872),Fi=_(64820),qp=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},t.defaultOptions,e))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new M.UL({})),n.label=n.background.appendChild(new M.ZA({})),n}return Object.defineProperty(t.prototype,"padding",{get:function(){return(0,zi.j)(this.style.padding)},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.style,n=e.label,s=e.value,r=(0,he.zs)(this.attributes,"label");(0,Lt.Ys)(this.label).maybeAppend(".label",function(){return(0,wl.S)(n)}).attr("className","label").styles(r),this.label.attr("__data__",s)},t.prototype.renderBackground=function(){var e=this.label.getBBox(),n=(0,$.CR)(this.padding,4),s=n[0],r=n[1],o=n[2],a=n[3],c=e.width,l=e.height,d=c+a+r,h=l+s+o,u=(0,he.zs)(this.attributes,"background"),f=this.style,g=f.width,p=g===void 0?0:g,v=f.height,y=v===void 0?0:v,m=f.selected;this.background.attr((0,$.pi)((0,$.pi)({},u),{width:Math.max(d,p),height:Math.max(h,y),fill:m?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(a,", ").concat((h-l)/2,")")})},t.prototype.render=function(){this.renderLabel(),this.renderBackground()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("pointerenter",function(){e.style.selected||e.background.attr("fill",e.hoverColor)}),this.addEventListener("pointerleave",function(){e.style.selected||e.background.attr("fill",e.style.backgroundFill)});var n=this;this.addEventListener("click",function(){var s=e.style,r=s.label,o=s.value,a=s.onClick;a==null||a(o,{label:r,value:o},n)})},t.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},t}(Hn.w),Qp=function(i){(0,$.ZT)(t,i);function t(e){var n,s,r=i.call(this,(0,He.n)({},t.defaultOptions,e))||this;r.currentValue=(n=t.defaultOptions.style)===null||n===void 0?void 0:n.defaultValue,r.isPointerInSelect=!1,r.select=r.appendChild(new M.UL({className:"select",style:{cursor:"pointer",width:0,height:0}})),r.dropdown=r.appendChild(new M.UL({className:"dropdown"}));var o=r.style.defaultValue;return o&&(!((s=r.style.options)===null||s===void 0)&&s.some(function(a){return a.value===o}))&&(r.currentValue=o),r}return t.prototype.setValue=function(e){this.currentValue=e,this.render()},t.prototype.getValue=function(){return this.currentValue},Object.defineProperty(t.prototype,"dropdownPadding",{get:function(){return(0,zi.j)(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),t.prototype.renderSelect=function(){var e=this,n,s=this.style,r=s.x,o=s.y,a=s.width,c=s.height,l=s.bordered,d=s.showDropdownIcon,h=(0,he.zs)(this.attributes,"select"),u=(0,he.zs)(this.attributes,"placeholder");this.select.attr((0,$.pi)((0,$.pi)({x:r,y:o,width:a,height:c},h),{fill:"#fff",strokeWidth:l?1:0}));var f=this.dropdownPadding,g=10;d&&(0,Lt.Ys)(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(r+a-g-f[1]-f[3],", ").concat(o+c/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var p=(n=this.style.options)===null||n===void 0?void 0:n.find(function(b){return b.value===e.currentValue}),v=(0,$.pi)({x:r+f[3]},u);(0,Lt.Ys)(this.select).selectAll(".placeholder").data(p?[]:[1]).join(function(b){return b.append("text").attr("className","placeholder").styles(v).style("y",function(){var E=this.getBBox();return o+(c-E.height)/2})},function(b){return b.styles(v)},function(b){return b.remove()});var y=(0,he.zs)(this.attributes,"optionLabel"),m=(0,$.pi)({x:r+f[3]},y);(0,Lt.Ys)(this.select).selectAll(".value").data(p?[p]:[]).join(function(b){return b.append(function(E){return(0,wl.S)(E.label)}).attr("className","value").styles(m).style("y",function(){var E=this.getBBox();return o+(c-E.height)/2})},function(b){return b.styles(m)},function(b){return b.remove()})},t.prototype.renderDropdown=function(){var e=this,n,s,r=this.style,o=r.x,a=r.y,c=r.width,l=r.height,d=r.options,h=r.onSelect,u=r.open,f=(0,he.zs)(this.attributes,"dropdown"),g=(0,he.zs)(this.attributes,"option"),p=this.dropdownPadding;(0,Lt.Ys)(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(d,function(m){return m.value}).join(function(m){return m.append(function(b){return new qp({className:"dropdown-item",style:(0,$.pi)((0,$.pi)((0,$.pi)({},b),g),{width:c-p[1]-p[3],selected:b.value===e.currentValue,onClick:function(E,S,O){e.setValue(E),h==null||h(E,S,O),e.dispatchEvent(new M.Aw("change",{detail:{value:E,option:S,item:O}})),(0,Fi.Cp)(e.dropdown)}})})}).each(function(b,E){var S,O=(S=this.parentNode)===null||S===void 0?void 0:S.children,A=O.reduce(function(N,z,U){return U<E&&(N+=z.getBBox().height),N},0);this.attr("transform","translate(".concat(p[3],", ").concat(p[0]+A,")"))})},function(m){return m.update(function(b){return{selected:b.value===e.currentValue}})},function(m){return m.remove()});var v=(s=(n=this.dropdown.getElementsByClassName("dropdown-container"))===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.getBBox(),y=f.spacing;this.dropdown.attr((0,$.pi)({transform:"translate(".concat(o,", ").concat(a+l+y,")"),width:v.width+p[1]+p[3],height:v.height+p[0]+p[2]},f)),!u&&(0,Fi.Cp)(this.dropdown)},t.prototype.render=function(){this.renderSelect(),this.renderDropdown()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("click",function(n){n.stopPropagation()}),this.select.addEventListener("click",function(){e.dropdown.style.visibility==="visible"?(0,Fi.Cp)(e.dropdown):(0,Fi.$Z)(e.dropdown)}),this.addEventListener("pointerenter",function(){e.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){e.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){e.isPointerInSelect||(0,Fi.Cp)(e.dropdown)})},t.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"\u8BF7\u9009\u62E9",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},t}(Hn.w),Ye=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},{style:{backgroundOpacity:t.backgroundOpacities.default}},t.defaultOptions,e))||this;return n.showBackground=!0,n.background=n.appendChild(new M.UL({})),n.icon=n.appendChild(new M.ZA({})),n}return Object.defineProperty(t.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return(0,zi.j)(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconSize",{get:function(){var e=this.attributes.size,n=(0,$.CR)(this.padding,4),s=n[0],r=n[1],o=n[2],a=n[3];return Math.max(e-Math.max(a+r,s+o),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.attributes,n=e.x,s=e.y,r=e.size,o=r/2,a=(0,he.zs)(this.attributes,"background");this.background.attr((0,$.pi)({x:n-o,y:s-o,width:r,height:r},a))},t.prototype.showIndicator=function(){if(this.label){var e=this.attributes.size,n=this.background.getBBox(),s=n.x,r=n.y;this.indicator.update({x:s+e/2,y:r-5,labelText:this.label,visibility:"visible"})}},t.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},t.prototype.connectedCallback=function(){var e;i.prototype.connectedCallback.call(this);var n=this.attributes.size,s=this.background.getBBox(),r=s.x,o=s.y,a=(e=this.ownerDocument)===null||e===void 0?void 0:e.defaultView;a&&(this.indicator=a.appendChild(new Kp.z({style:{x:r+n/2,y:o-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},t.prototype.disconnectedCallback=function(){this.indicator.destroy()},t.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},t.prototype.bindEvents=function(){var e=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){n==null||n(e)}),this.showBackground){var s=function(){return e.background.attr({opacity:t.backgroundOpacities.default})},r=function(){return e.background.attr({opacity:t.backgroundOpacities.hover})},o=function(){return e.background.attr({opacity:t.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){r(),e.showIndicator()}),this.addEventListener("pointerleave",function(){s(),e.hideIndicator()}),this.addEventListener("pointerdown",function(){o()}),this.addEventListener("pointerup",function(){s()})}},t.tag="IconBase",t.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},t.backgroundOpacities={default:0,hover:.8,active:1},t}(Hn.w),$i=function(i,t){return t===void 0&&(t="#565758"),new M.y$({style:{fill:t,d:"M ".concat(i,",").concat(i," L -").concat(i,",0 L ").concat(i,",-").concat(i," Z"),transformOrigin:"center"}})},Jp=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.arcPath=function(e,n,s){var r=(0,$.CR)([s,s],2),o=r[0],a=r[1],c=function(p){return[e+s*Math.cos(p),n+s*Math.sin(p)]},l=(0,$.CR)(c(-5/4*Math.PI),2),d=l[0],h=l[1],u=(0,$.CR)(c(1/4*Math.PI),2),f=u[0],g=u[1];return"M".concat(d,",").concat(h,",A").concat(o,",").concat(a,",0,1,1,").concat(f,",").concat(g)},Object.defineProperty(t.prototype,"label",{get:function(){return"\u91CD\u7F6E"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this.iconSize,a=this.lineWidth,c=a+.5;(0,Lt.Ys)(this.icon).maybeAppend(".reset","path").styles({stroke:r,lineWidth:a,d:this.arcPath(n,s,o/2-a),markerStart:$i(c,r)})},t}(Ye),t0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u5FEB\u9000"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this.iconSize,a=o/2,c=o/2/Math.pow(3,.5),l=[[n,s],[n,s-c],[n-a,s],[n,s+c],[n,s],[n+a,s-c],[n+a,s+c],[n,s]];(0,Lt.Ys)(this.icon).maybeAppend(".backward","polygon").styles({points:l,fill:r})},t}(Ye),e0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u5FEB\u8FDB"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this.iconSize,a=o/2,c=o/2/Math.pow(3,.5),l=[[n,s],[n,s-c],[n+a,s],[n,s+c],[n,s],[n-a,s-c],[n-a,s+c],[n,s]];(0,Lt.Ys)(this.icon).maybeAppend(".forward","polygon").styles({points:l,fill:r})},t}(Ye),n0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u64AD\u653E"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this.iconSize,a=o/3*Math.pow(3,.5)*.8,c=[[n+a,s],[n-a/2,s-o/2*.8],[n-a/2,s+o/2*.8],[n+a,s]];(0,Lt.Ys)(this.icon).maybeAppend(".play","polygon").styles({points:c,fill:r})},t}(Ye),i0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u6682\u505C"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this.iconSize,a=o/3,c=[[n-a,s-o/2],[n-a,s+o/2],[n-a/2,s+o/2],[n-a/2,s-o/2],[n-a,s-o/2],[n+a/2,s-o/2],[n+a/2,s+o/2],[n+a,s+o/2],[n+a,s-o/2]];(0,Lt.Ys)(this.icon).maybeAppend(".pause","polygon").styles({points:c,fill:r})},t}(Ye),s0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u8303\u56F4\u65F6\u95F4"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this,a=o.iconSize,c=o.lineWidth,l=c;(0,Lt.Ys)(this.icon).maybeAppend(".left-line","line").styles({x1:n-a/2,y1:s-a/2,x2:n-a/2,y2:s+a/2,stroke:r,lineWidth:c}),(0,Lt.Ys)(this.icon).maybeAppend(".right-line","line").styles({x1:n+a/2,y1:s-a/2,x2:n+a/2,y2:s+a/2,stroke:r,lineWidth:c}),(0,Lt.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:n,y1:s,x2:n-a/2+l*2,y2:s,stroke:r,lineWidth:c,markerEnd:$i(c*2,r)}),(0,Lt.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:n,y1:s,x2:n+a/2-l*2,y2:s,stroke:r,lineWidth:c,markerEnd:$i(c*2,r)})},t}(Ye),r0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u5355\u4E00\u65F6\u95F4"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this,a=o.iconSize,c=o.lineWidth;(0,Lt.Ys)(this.icon).maybeAppend(".line","line").styles({x1:n,y1:s-a/2,x2:n,y2:s+a/2,stroke:r,lineWidth:c});var l=c;(0,Lt.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:n-a/2-l*2,y1:s,x2:n-l*2,y2:s,stroke:r,lineWidth:c,markerEnd:$i(c*2,r)}),(0,Lt.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:n+a/2+l*2,y1:s,x2:n+l*2,y2:s,stroke:r,lineWidth:c,markerEnd:$i(c*2,r)})},t}(Ye),Cl=function(i){return[[-i/2,-i/2],[-i/2,i/2],[i/2,i/2]]},o0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u6298\u7EBF\u56FE"},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this,a=o.iconSize,c=o.lineWidth,l=c,d=(a-l*2-c)/4,h=(a-l*2-c)/2,u=(0,$.CR)([n-a/2+l,s+a/2-l*2],2),f=u[0],g=u[1];(0,Lt.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:Cl(a).map(function(p){var v=(0,$.CR)(p,2),y=v[0],m=v[1];return[y+n,m+s]}),stroke:r,lineWidth:c}),(0,Lt.Ys)(this.icon).maybeAppend(".line","polyline").styles({points:[[f,g],[f+d,g-h],[f+d*2,g],[f+d*4,g-h*2]],stroke:r,lineWidth:c})},t}(Ye),a0=function(i){(0,$.ZT)(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return"\u6761\u5F62\u56FE"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.data,n=this.attributes,s=n.x,r=n.y,o=n.color,a=this,c=a.iconSize,l=a.lineWidth,d=l,h=(c-d)/e.length,u=(c-d*2)/4,f=(0,$.CR)([s-c/2+d*2,r+c/2-d],2),g=f[0],p=f[1];(0,Lt.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:Cl(c).map(function(v){var y=(0,$.CR)(v,2),m=y[0],b=y[1];return[m+s,b+r]}),stroke:o,lineWidth:l}),(0,Lt.Ys)(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(v,y){return{value:v,index:y}})).join(function(v){return v.append("line").attr("className","column").style("x1",function(y){var m=y.index;return g+h*m}).style("y1",p).style("x2",function(y){var m=y.index;return g+h*m}).style("y2",function(y){var m=y.value;return p-u*m}).styles({y1:p,stroke:o,lineWidth:l})})},t}(Ye),c0=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.color,o=this,a=o.iconSize,c=o.lineWidth;(0,Lt.Ys)(this.icon).maybeAppend(".split","line").styles({x1:n,y1:s-a/2,x2:n,y2:s+a/2,stroke:r,lineWidth:c})},t}(Ye),Go=function(i){(0,$.ZT)(t,i);function t(){var e=i.apply(this,(0,$.ev)([],(0,$.CR)(arguments),!1))||this;return e.showBackground=!1,e}return Object.defineProperty(t.prototype,"padding",{get:function(){return(0,zi.j)(0)},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.iconSize,n=this.attributes,s=n.x,r=n.y,o=n.speed,a=o===void 0?1:o,c=(0,_o.Z)(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),l=(0,Ri.Z)(e,20,1/0),d=20,h=(0,$.pi)((0,$.pi)({},c),{x:s-l/2,y:r-d/2,width:l,height:d,defaultValue:a,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:e/5,placeholderFontSize:e/2,optionPadding:0,optionLabelFontSize:e/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});(0,Lt.Ys)(this.icon).maybeAppend(".speed",function(){return new Qp({style:h})}).attr("className","speed").each(function(){this.update(h)})},t.tag="SpeedSelect",t}(Ye),Xo=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,e)||this;return n.icon=n.appendChild(new M.ZA({})),n.currentType=n.attributes.type,n}return t.prototype.getType=function(){return this.currentType},t.prototype.render=function(){var e=this,n=this.attributes,s=n.onChange,r=(0,$._T)(n,["onChange"]);(0,Lt.Ys)(this.icon).selectAll(".icon").data([this.currentType]).join(function(o){return o.append(function(a){var c,l=(c=e.toggles.find(function(d){var h=(0,$.CR)(d,1),u=h[0];return u===a}))===null||c===void 0?void 0:c[1];if(!l)throw new Error("Invalid type: ".concat(a));return new l({})}).attr("className","icon").styles(r,!1).update({})},function(o){return o.styles({restStyles:r}).update({})},function(o){return o.remove()})},t.prototype.bindEvents=function(){var e=this,n=this.attributes.onChange;this.addEventListener("click",function(s){s.preventDefault(),s.stopPropagation();var r=(e.toggles.findIndex(function(a){var c=(0,$.CR)(a,1),l=c[0];return l===e.currentType})+1)%e.toggles.length,o=e.toggles[r][0];n==null||n(e.currentType),e.currentType=o,e.render()})},t.tag="ToggleIcon",t}(Hn.w),Ko=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},{style:{type:"play"}},e))||this;return n.toggles=[["play",n0],["pause",i0]],n}return t}(Xo),qo=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},{style:{type:"range"}},e))||this;return n.toggles=[["range",s0],["value",r0]],n}return t}(Xo),Qo=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},{style:{type:"column"}},e))||this;return n.toggles=[["line",o0],["column",a0]],n}return t}(Xo),l0={reset:Jp,speed:Go,backward:t0,playPause:Ko,forward:e0,selectionType:qo,chartType:Qo,split:c0},d0=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},t.defaultOptions,e))||this;return n.background=n.appendChild(new M.UL({})),n.functions=n.appendChild(new M.ZA({})),n}return Object.defineProperty(t.prototype,"padding",{get:function(){return(0,zi.j)(this.attributes.padding)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.style,n=e.x,s=e.y,r=e.width,o=e.height,a=(0,he.zs)(this.attributes,"background");this.background.attr((0,$.pi)({x:n,y:s,width:r,height:o},a))},t.prototype.renderFunctions=function(){var e=this,n,s=this.attributes,r=s.functions,o=s.iconSize,a=s.iconSpacing,c=s.x,l=s.y,d=s.width,h=s.height,u=s.align,f=(0,$.CR)(this.padding,4),g=f[1],p=f[3],v=r.reduce(function(b,E){return b.length&&E.length?b.concat.apply(b,(0,$.ev)(["split"],(0,$.CR)(E),!1)):b.concat.apply(b,(0,$.ev)([],(0,$.CR)(E),!1))},[]),y=v.length*(o+a)-a,m={left:p+o/2,center:(d-y)/2+o/2,right:d-y-p-g+o/2}[u]||0;(n=this.speedSelect)===null||n===void 0||n.destroy(),this.functions.removeChildren(),v.forEach(function(b,E){var S,O=l0[b],A={x:c+E*(o+a)+m,y:l+h/2,size:o};if(O===Go?(A.speed=e.attributes.speed,A.onSelect=function(z){return e.handleFunctionChange(b,{value:z})}):[Ko,qo,Qo].includes(O)?(A.onChange=function(z){return e.handleFunctionChange(b,{value:z})},O===Ko&&(A.type=e.attributes.state==="play"?"pause":"play"),O===qo&&(A.type=e.attributes.selectionType==="range"?"value":"range"),O===Qo&&(A.type=e.attributes.chartType==="line"?"column":"line")):A.onClick=function(){return e.handleFunctionChange(b,{value:b})},O===Go){var N=(S=e.ownerDocument)===null||S===void 0?void 0:S.defaultView;N&&(e.speedSelect=new O({style:(0,$.pi)((0,$.pi)({},A),{zIndex:100})}),N.appendChild(e.speedSelect))}else e.functions.appendChild(new O({style:A}))})},t.prototype.disconnectedCallback=function(){var e;i.prototype.disconnectedCallback.call(this),(e=this.speedSelect)===null||e===void 0||e.destroy()},t.prototype.render=function(){this.renderBackground(),this.renderFunctions()},t.prototype.handleFunctionChange=function(e,n){var s=this.attributes.onChange;s==null||s(e,n)},t.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},t}(Hn.w),h0=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},t.defaultOptions,e))||this;return n.bindEvents(),n}return t.prototype.bindEvents=function(){var e=this;this.addEventListener("mouseenter",function(){e.attr("lineWidth",Math.ceil(+(e.style.r||0)/2))}),this.addEventListener("mouseleave",function(){e.attr("lineWidth",0)})},t.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},t}(M.Cd),u0=function(i){(0,$.ZT)(t,i);function t(e){return i.call(this,(0,He.n)({},t.defaultOptions,e))||this}return t.prototype.renderBackground=function(){var e=this.attributes,n=e.x,s=e.y,r=e.width,o=e.height,a=(0,he.zs)(this.attributes,"background");(0,Lt.Ys)(this).maybeAppend("background","rect").attr("className","background").styles((0,$.pi)({x:n-r/2,y:s-o/2,width:r,height:o},a))},t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,s=e.y,r=e.iconSize,o=(0,he.zs)(this.attributes,"icon"),a=1,c=r/2;(0,Lt.Ys)(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles((0,$.pi)({x1:n-a,y1:s-c,x2:n-a,y2:s+c},o)),(0,Lt.Ys)(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles((0,$.pi)({x1:n+a,y1:s-c,x2:n+a,y2:s+c},o))},t.prototype.renderBorder=function(){var e=this.attributes,n=e.x,s=e.y,r=e.width,o=e.height,a=e.type,c=(0,he.zs)(this.attributes,"border"),l=a==="start"?+r/2:-r/2;(0,Lt.Ys)(this).maybeAppend("border","line").attr("className","border").styles((0,$.pi)({x1:l+n,y1:s-o/2,x2:l+n,y2:s+o/2},c))},t.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},t.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},t}(Hn.w);function f0(i,t){return typeof i=="number"?Dl(i):g0(i,t)}function g0(i,t){var e=new Date(i);switch(t){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(e.getHours())&&e.getMinutes()===0?ue(e,`HH:mm
YYYY-MM-DD`):ue(e,"HH:mm");case"half-day":return e.getHours()<12?`AM
`.concat(ue(e,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(e.getDate())?ue(e,`DD
YYYY-MM`):ue(e,"DD");case"week":return e.getDate()<=7?ue(e,`DD
YYYY-MM`):ue(e,"DD");case"month":return[0,6].includes(e.getMonth())?ue(e,`MM\u6708
YYYY`):ue(e,"MM\u6708");case"season":return[0].includes(e.getMonth())?ue(e,`MM\u6708
YYYY`):ue(e,"MM\u6708");case"year":return ue(e,"YYYY");default:return ue(e,"YYYY-MM-DD HH:mm")}}function Dl(i){var t=String(Math.floor(i/3600)).padStart(2,"0"),e=String(Math.floor(i%3600/60)).padStart(2,"0"),n=String(Math.floor(i%60)).padStart(2,"0");return i<3600?"".concat(e,":").concat(n):"".concat(t,":").concat(e,":").concat(n)}var p0=function(i){(0,$.ZT)(t,i);function t(e){var n=i.call(this,(0,He.n)({},t.defaultOptions,e))||this;n.axis=n.appendChild(new Gp.R({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new Xp.i({style:{onChange:function(h){n.handleSliderChange(h)}}})),n.controller=n.appendChild(new d0({})),n.states={},n.handleSliderChange=function(h){var u=function(){var f=n.states.values;return Array.isArray(f)?(0,$.ev)([],(0,$.CR)(f),!1):f}();n.setBySliderValues(h),n.dispatchOnChange(u)};var s=n.attributes,r=s.selectionType,o=s.chartType,a=s.speed,c=s.state,l=s.playMode,d=s.values;return n.states={chartType:o,playMode:l,selectionType:r,speed:a,state:c},n.setByTimebarValues(d),n}return Object.defineProperty(t.prototype,"data",{get:function(){var e=this.attributes.data,n=function(s,r){return s.time<r.time?-1:s.time>r.time?1:0};return e.sort(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"space",{get:function(){var e=this.attributes,n=e.x,s=e.y,r=e.width,o=e.height,a=e.type,c=e.controllerHeight,l=(0,Ri.Z)(+o-c,0,+o),d=new Sr.b(n,s+ +o-c,+r,c),h,u=0;a==="chart"?(u=35,h=new Sr.b(n,s+l-u,+r,u)):h=new Sr.b;var f=a==="time"?10:l,g=new Sr.b(n,s+(a==="time"?l:l-f),+r,f-u);return{axisBBox:h,controllerBBox:d,timelineBBox:g}},enumerable:!1,configurable:!0}),t.prototype.setBySliderValues=function(e){var n,s,r=this.data,o=(0,$.CR)(Array.isArray(e)?e:[0,e],2),a=o[0],c=o[1],l=r.length,d=r[Math.floor(a*l)],h=r[Math.ceil(c*l)-(Array.isArray(e)?0:1)];this.states.values=[(n=d==null?void 0:d.time)!==null&&n!==void 0?n:r[0].time,(s=h==null?void 0:h.time)!==null&&s!==void 0?s:1/0]},t.prototype.setByTimebarValues=function(e){var n,s,r,o=this.data,a=(0,$.CR)(Array.isArray(e)?e:[void 0,e],2),c=a[0],l=a[1],d=o.find(function(u){var f=u.time;return f===c}),h=o.find(function(u){var f=u.time;return f===l});this.states.values=[(n=d==null?void 0:d.time)!==null&&n!==void 0?n:(s=o[0])===null||s===void 0?void 0:s.time,(r=h==null?void 0:h.time)!==null&&r!==void 0?r:1/0]},t.prototype.setByIndex=function(e){var n,s,r,o,a=this.data,c=(0,$.CR)(e,2),l=c[0],d=c[1];this.states.values=[(s=(n=a[l])===null||n===void 0?void 0:n.time)!==null&&s!==void 0?s:a[0].time,(o=(r=this.data[d])===null||r===void 0?void 0:r.time)!==null&&o!==void 0?o:1/0]},Object.defineProperty(t.prototype,"sliderValues",{get:function(){var e=this.states,n=e.values,s=e.selectionType,r=(0,$.CR)(Array.isArray(n)?n:[void 0,n],2),o=r[0],a=r[1],c=this.data,l=c.length,d=s==="value",h=function(){var f=c.findIndex(function(g){var p=g.time;return p===o});return d?0:f>-1?f/l:0},u=function(){if(a===1/0)return 1;var f=c.findIndex(function(g){var p=g.time;return p===a});return f>-1?f/l:d?.5:1};return[h(),u()]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var e=this.states,n=e.values,s=e.selectionType,r=(0,$.CR)(Array.isArray(n)?n:[this.data[0].time,n],2),o=r[0],a=r[1];return s==="value"?a:[o,a]},enumerable:!1,configurable:!0}),t.prototype.getDatumByRatio=function(e){var n=this.data,s=n.length,r=Math.floor(e*(s-1));return n[r]},Object.defineProperty(t.prototype,"chartHandleIconShape",{get:function(){var e=this.states.selectionType,n=this.space.timelineBBox.height;return e==="range"?function(s){return new u0({style:{type:s,height:n,iconSize:n/6}})}:function(){return new M.x1({style:{x1:0,y1:-n/2,x2:0,y2:n/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),t.prototype.getChartStyle=function(e){var n=this,s=e.x,r=e.y,o=e.width,a=e.height,c=this.states,l=c.selectionType,d=c.chartType,h=this.data,u=this.attributes,f=u.type,g=u.labelFormatter,p=(0,he.zs)(this.attributes,"chart"),v=p.type,y=(0,$._T)(p,["type"]),m=l==="range";if(f==="time")return(0,$.pi)({handleIconShape:function(){return new h0({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:m?-15:0,autoFitLabel:m,handleSpacing:m?-15:0,trackFill:"#edeeef",trackLength:o,trackOpacity:.5,trackRadius:a/2,trackSize:a/2,type:l,values:this.sliderValues,formatter:function(S){if(g)return g(S);var O=n.getDatumByRatio(S).time;return typeof O=="number"?Dl(O):ue(O,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(s,", ").concat(r,")"),zIndex:1},y);var b=l==="range"?5:0,E=h.map(function(S){var O=S.value;return O});return(0,$.pi)({handleIconOffset:b,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:E,sparklineType:d,sparklineScale:.8,trackLength:o,trackSize:a,type:l,values:this.sliderValues,transform:"translate(".concat(s,", ").concat(r,")"),zIndex:1},y)},t.prototype.renderChart=function(e){e===void 0&&(e=this.space.timelineBBox),this.timeline.update(this.getChartStyle(e))},t.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},t.prototype.getAxisStyle=function(e){var n=this.data,s=this.attributes,r=s.interval,o=s.labelFormatter,a=(0,he.zs)(this.attributes,"axis"),c=e.x,l=e.y,d=e.width,h=(0,$.ev)((0,$.ev)([],(0,$.CR)(n),!1),[{time:0}],!1).map(function(f,g,p){var v=f.time;return{label:"".concat(v),value:g/(p.length-1),time:v}}),u=(0,$.pi)({startPos:[c,l],endPos:[c+d,l],data:h,labelFilter:function(f,g){return g<h.length-1},labelFormatter:function(f){var g=f.time;return o?o(g):f0(g,r)}},a);return u},t.prototype.renderAxis=function(e){e===void 0&&(e=this.space.axisBBox);var n=this.attributes.type;n==="chart"&&this.axis.update(this.getAxisStyle(e))},t.prototype.renderController=function(e){e===void 0&&(e=this.space.controllerBBox);var n=this.attributes.type,s=this.states,r=s.state,o=s.speed,a=s.selectionType,c=s.chartType,l=(0,he.zs)(this.attributes,"controller"),d=this,h=(0,$.pi)((0,$.pi)((0,$.pi)({},e),{iconSize:20,speed:o,state:r,selectionType:a,chartType:c,onChange:function(u,f){var g=f.value;switch(u){case"reset":d.internalReset();break;case"speed":d.handleSpeedChange(g);break;case"backward":d.internalBackward();break;case"playPause":g==="play"?d.internalPlay():d.internalPause();break;case"forward":d.internalForward();break;case"selectionType":d.handleSelectionTypeChange(g);break;case"chartType":d.handleChartTypeChange(g);break;default:break}}}),l);n==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},t.prototype.dispatchOnChange=function(e){var n=this.data,s=this.attributes.onChange,r=this.states,o=r.values,a=r.selectionType,c=(0,$.CR)(o,2),l=c[0],d=c[1],h=d===1/0?n.at(-1).time:d,u=a==="range"?[l,h]:h,f=function(g,p){return Array.isArray(g)?Array.isArray(p)?g[0]===p[0]&&(g[1]===p[1]||g[1]===1/0||p[1]===1/0):!1:Array.isArray(p)?!1:g===p};(!e||!f(e,u))&&(s==null||s(a==="range"?[l,h]:h))},t.prototype.internalReset=function(e){var n,s,r=this.states.selectionType;this.internalPause(),this.setBySliderValues(r==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),e||((s=(n=this.attributes)===null||n===void 0?void 0:n.onReset)===null||s===void 0||s.call(n),this.dispatchOnChange())},t.prototype.reset=function(){this.internalReset()},t.prototype.moveSelection=function(e,n){var s=this.data,r=s.length,o=this.states,a=o.values,c=o.selectionType,l=o.playMode,d=(0,$.CR)(a,2),h=d[0],u=d[1],f=s.findIndex(function(b){var E=b.time;return E===h}),g=s.findIndex(function(b){var E=b.time;return E===u});g===-1&&(g=r);var p=e==="backward"?-1:1,v;c==="range"?l==="acc"?(v=[f,g+p],p===-1&&f===g&&(v=[f,r])):v=[f+p,g+p]:v=[f,g+p];var y=function(b){var E=(0,$.CR)(b.sort(function(N,z){return N-z}),2),S=E[0],O=E[1],A=function(N){return(0,Ri.Z)(N,0,r)};return O>r?c==="value"?[0,0]:l==="acc"?[A(S),A(S)]:[0,A(O-S)]:S<0?l==="acc"?[0,A(O)]:[A(S+r-O),r]:[A(S),A(O)]},m=y(v);return this.setByIndex(m),this.updateSelection(),m},t.prototype.internalBackward=function(e){var n,s,r=this.moveSelection("backward",e);return e||((s=(n=this.attributes)===null||n===void 0?void 0:n.onBackward)===null||s===void 0||s.call(n),this.dispatchOnChange()),r},t.prototype.backward=function(){this.internalBackward()},t.prototype.internalPlay=function(e){var n=this,s,r,o=this.data,a=this.attributes.loop,c=this.states.speed,l=c===void 0?1:c;this.playInterval=window.setInterval(function(){var d=n.internalForward();d[1]===o.length&&!a&&(n.internalPause(),n.renderController())},1e3/l),this.states.state="play",!e&&((r=(s=this.attributes)===null||s===void 0?void 0:s.onPlay)===null||r===void 0||r.call(s))},t.prototype.play=function(){this.internalPlay()},t.prototype.internalPause=function(e){var n,s;clearInterval(this.playInterval),this.states.state="pause",!e&&((s=(n=this.attributes)===null||n===void 0?void 0:n.onPause)===null||s===void 0||s.call(n))},t.prototype.pause=function(){this.internalPause()},t.prototype.internalForward=function(e){var n,s,r=this.moveSelection("forward",e);return e||((s=(n=this.attributes)===null||n===void 0?void 0:n.onForward)===null||s===void 0||s.call(n),this.dispatchOnChange()),r},t.prototype.forward=function(){this.internalForward()},t.prototype.handleSpeedChange=function(e){var n,s;this.states.speed=e;var r=this.states.state;r==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(s=(n=this.attributes)===null||n===void 0?void 0:n.onSpeedChange)===null||s===void 0||s.call(n,e)},t.prototype.handleSelectionTypeChange=function(e){var n,s;this.states.selectionType=e,this.renderChart(),(s=(n=this.attributes)===null||n===void 0?void 0:n.onSelectionTypeChange)===null||s===void 0||s.call(n,e)},t.prototype.handleChartTypeChange=function(e){var n,s;this.states.chartType=e,this.renderChart(),(s=(n=this.attributes)===null||n===void 0?void 0:n.onChartTypeChange)===null||s===void 0||s.call(n,e)},t.prototype.render=function(){var e=this.space,n=e.axisBBox,s=e.controllerBBox,r=e.timelineBBox;this.renderController(s),this.renderAxis(n),this.renderChart(r),this.states.state==="play"&&this.internalPlay()},t.prototype.destroy=function(){i.prototype.destroy.call(this),this.internalPause(!0)},t.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},t}(Hn.w);function v0(i){return i instanceof Date}var y0=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})},m0=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};const b0=["timestamp","time","date","datetime"];class wr extends oe{get padding(){return je(this.options.padding)}constructor(t,e){super(t,Object.assign({},wr.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;(t=this.timebar)===null||t===void 0||t.play()}pause(){var t;(t=this.timebar)===null||t===void 0||t.pause()}forward(){var t;(t=this.timebar)===null||t===void 0||t.forward()}backward(){var t;(t=this.timebar)===null||t===void 0||t.backward()}reset(){var t;(t=this.timebar)===null||t===void 0||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=Tl(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:s,data:r,x:o,y:a,width:c,height:l,mode:d}=e,h=m0(e,["onChange","timebarType","data","x","y","width","height","mode"]),u=t.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const p=Object.assign(Object.assign({x:u[0]/2-c/2,y:f,onChange:v=>{const y=((0,qn.Z)(v)?v:[v,v]).map(m=>v0(m)?m.getTime():m);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),n==null||n(y)}},h),{data:r.map(v=>(0,Rt.Z)(v)?{time:v,value:0}:v),width:c,height:l,type:s});this.timebar?this.timebar.update(p):(this.timebar=new p0({style:p}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:t,height:e,position:n}=this.options,s=this.context.canvas,[r]=s.getSize(),[o,,a]=this.padding,[c,l]=Ho({width:r,height:e+o+a,graphCanvas:s,className:"timebar",placement:n});return this.container=c,t&&c.classList.add(t),this.canvas=l,this.canvas}filterElements(t){return y0(this,void 0,void 0,function*(){var e;if(!this.originalData)return;const{elementTypes:n,getTime:s}=this.options,{graph:r,element:o}=this.context,a=Tl(this.originalData);n.forEach(l=>{const d=`${l}s`;a[d]=(this.originalData[d]||[]).filter(h=>{const u=s(h);return!!Ml(u,t)})});const c=[...a.nodes,...a.combos].map(l=>w(l));a.edges=a.edges.filter(l=>{const d=l.source,h=l.target;return c.includes(d)&&c.includes(h)}),r.setData(a),yield(e=o.draw({animation:!1,silence:!0}))===null||e===void 0?void 0:e.finished})}hiddenElements(t){const{graph:e}=this.context,{elementTypes:n,getTime:s}=this.options,r=[],o=[];n.forEach(a=>{var c;const l=`${a}s`;(((c=this.originalData)===null||c===void 0?void 0:c[l])||[]).forEach(h=>{const u=w(h),f=s(h);Ml(f,t)?o.push(u):r.push(u)})}),e.hideElement(r,!1),e.showElement(o,!1)}destroy(){var t,e,n;const{graph:s}=this.context;this.originalData&&s.setData(Object.assign({},this.originalData)),(t=this.timebar)===null||t===void 0||t.destroy(),(e=this.canvas)===null||e===void 0||e.destroy(),(n=this.container)===null||n===void 0||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}wr.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:i=>E0(i,b0,void 0),loop:!1};const Tl=i=>{const{nodes:t=[],edges:e=[],combos:n=[]}=i;return{nodes:[...t],edges:[...e],combos:[...n]}},Ml=(i,t)=>{if((0,Rt.Z)(t))return i===t;const[e,n]=t;return i>=e&&i<=n},E0=(i,t,e)=>{var n;for(let s=0;s<t.length;s++){const r=t[s],o=(n=i.data)===null||n===void 0?void 0:n[r];if(o)return o}return e};function x0(i){const t={top:"unset",right:"unset",bottom:"unset",left:"unset"};return i.split("-").forEach(n=>{t[n]="8px"}),t.flexDirection=i.startsWith("top")||i.startsWith("bottom")?"row":"column",t}const S0=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,O0=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var Al=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Cr extends oe{constructor(t,e){super(t,Object.assign({},Cr.defaultOptions,e)),this.$element=ai("toolbar",!1),this.onToolbarItemClick=s=>{const{onClick:r}=this.options;if(s.target instanceof Element&&s.target.className.includes("g6-toolbar-item")){const o=s.target.getAttribute("value");r==null||r(o,s.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),Ro("g6-toolbar-css","style",{},S0,document.head),Ro("g6-toolbar-svgicon","div",{display:"none"},O0),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return Al(this,void 0,void 0,function*(){e.update.call(this,t);const{className:n,position:s,style:r}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,r,x0(s)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return Al(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(e=>{var n;return`
          <div class="g6-toolbar-item" value="${e.value}" title="${(n=e.title)!==null&&n!==void 0?n:""}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${e.id}"></use>
            </svg>
          </div>`}).join("")})}}Cr.defaultOptions={position:"top-left"};var w0=_(62229),Ll=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Dr extends oe{constructor(t,e){super(t,Object.assign({},Dr.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(n,s)=>{const{enable:r}=this.options;return typeof r=="function"?r(n,s):r},this.onClick=n=>{const{target:{id:s}}=n;this.currentTarget===s?this.hide(n):this.show(n)},this.onPointerMove=n=>{const{target:s}=n;!this.currentTarget||s.id===this.currentTarget||this.show(n)},this.onPointerLeave=n=>{this.hide(n)},this.onCanvasMove=n=>{this.hide(n)},this.onPointerEnter=n=>{this.show(n)},this.showById=n=>Ll(this,void 0,void 0,function*(){const s={target:{id:n}};yield this.show(s)}),this.getElementData=(n,s)=>{const{model:r}=this.context;switch(s){case"node":return r.getNodeData([n]);case"edge":return r.getEdgeData([n]);case"combo":return r.getComboData([n]);default:return[]}},this.show=n=>Ll(this,void 0,void 0,function*(){var s,r;const{client:o,target:{id:a}}=n;if(Ps(n.target))return;const c=this.context.graph.getElementType(a),{getContent:l,title:d}=this.options,h=this.getElementData(a,c);if(!this.tooltipElement||!this.isEnable(n,h))return;let u={};if(l){if(u.content=yield l(n,h),!u.content)return}else{const p=this.context.graph.getElementRenderStyle(a),v=c==="node"?p.fill:p.stroke;u={title:d||c,data:h.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:v}))}}this.currentTarget=a;let f,g;if(o)f=o.x,g=o.y;else{const p=(0,Ce.Z)(h,"0.style",{x:0,y:0});f=p.x,g=p.y}(r=(s=this.options).onOpenChange)===null||r===void 0||r.call(s,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:f,y:g,style:{".tooltip":{visibility:"visible"}}}),u))}),this.hide=n=>{var s,r,o,a,c;if(!n){(r=(s=this.options).onOpenChange)===null||r===void 0||r.call(s,!1),(o=this.tooltipElement)===null||o===void 0||o.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:l,y:d}}=n;(c=(a=this.options).onOpenChange)===null||c===void 0||c.call(a,!1),this.tooltipElement.hide(l,d),this.currentTarget=null},this.initTooltip=()=>{var n;const s=new w0.u({className:"tooltip",style:this.tooltipStyleProps});return(n=this.container)===null||n===void 0||n.appendChild(s.HTMLTooltipElement),s},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.off(n,e[n])})}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.on(n,e[n])})}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:s,left:r}=n.getBoundingClientRect(),{style:o,position:a,enterable:c,container:l={x:-r,y:-s},title:d,offset:h}=this.options,[u,f]=e,[g,p]=t.getSize();return{x:u,y:f,container:l,title:d,bounding:{x:0,y:0,width:g,height:p},position:a,enterable:c,offset:h,style:o}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}Dr.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var Nl=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};let ci;function Il(i,t){return ci||(ci=document.createElement("canvas")),ci.width=i,ci.height=t,ci.getContext("2d").clearRect(0,0,i,t),ci}function C0(i,t,e,n){return Nl(this,void 0,void 0,function*(){const s=Il(i,t),r=s.getContext("2d"),{rotate:o,opacity:a,textFill:c,textFontSize:l,textFontFamily:d,textFontVariant:h,textFontWeight:u,textAlign:f,textBaseline:g}=n;return r.textAlign=f,r.textBaseline=g,r.translate(i/2,t/2),r.font=`${l}px ${d} ${h} ${u}`,o&&r.rotate(o),a&&(r.globalAlpha=a),c&&(r.fillStyle=c,r.fillText(`${e}`,0,0)),s.toDataURL()})}function D0(i,t,e,n){return Nl(this,void 0,void 0,function*(){const s=Il(i,t),r=s.getContext("2d"),{rotate:o,opacity:a}=n;o&&r.rotate(o),a&&(r.globalAlpha=a);const c=new Image;return c.crossOrigin="anonymous",c.src=e,new Promise(l=>{c.onload=function(){const d=i>c.width?(i-c.width)/2:0,h=t>c.height?(t-c.height)/2:0;r.drawImage(c,0,0,c.width,c.height,d,h,i-d*2,t-h*2),l(s.toDataURL())}})})}var T0=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})},M0=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class Tr extends oe{constructor(t,e){super(t,Object.assign({},Tr.defaultOptions,e)),this.$element=ai("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return T0(this,void 0,void 0,function*(){e.update.call(this,t);const n=this.options,{width:s,height:r,text:o,imageURL:a}=n,c=M0(n,["width","height","text","imageURL"]);Object.keys(c).forEach(d=>{d.startsWith("background")&&(this.$element.style[d]=t[d])});const l=a?yield D0(s,r,a,c):yield C0(s,r,o,c);this.$element.style.backgroundImage=`url(${l})`})}destroy(){super.destroy(),this.$element.remove()}}Tr.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const A0=["#7E92B5","#F4664A","#FFBE3A"],L0={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},N0={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function Pl(i){const{bgColor:t,textColor:e,nodeColor:n,nodeColorDisabled:s,nodeStroke:r,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:a=.25,nodeOpacityDisabled:c=.06,nodeIconOpacityInactive:l=.85,nodeOpacityInactive:d=.25,nodeBadgePalette:h=A0,nodePaletteOptions:u=L0,edgeColor:f,edgeColorDisabled:g,edgePaletteOptions:p=N0,comboColor:v,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:b,edgeColorInactive:E}=i;return{background:t,node:{palette:u,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:e,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:r,portStrokeOpacity:.65,size:32,stroke:r,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:a,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:r},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:r,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:d,donutOpacity:d,fillOpacity:d,iconOpacity:l,labelFill:e,labelFillOpacity:d,strokeOpacity:d},disabled:{badgeBackgroundOpacity:.25,donutOpacity:c,fill:s,fillOpacity:c,iconFill:s,iconOpacity:.25,labelFill:e,labelFillOpacity:.25,strokeOpacity:c}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:p,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:t,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:v,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const I0=Pl({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),P0=Pl({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class Dn extends ao{beforeDraw(t,e){return t}afterLayout(t,e){}}class _0 extends Dn{beforeDraw(t){const{model:e}=this.context,n=t.add.combos,s=r=>{const o=[];return r.forEach((a,c)=>{const d=e.getAncestorsData(c,"combo").map(h=>w(h)).reverse();o.push([c,a,d.length])}),new Map(o.sort(([,,a],[,,c])=>c-a).map(([a,c])=>[a,c]))};return t.add.combos=s(n),t.update.combos=s(t.update.combos),t}}function Te(i,t,e,n,s){const r=w(n),o=`${e}s`,a=s?n:i.add[o].get(r)||i.update[o].get(r)||i.remove[o].get(r)||n;Object.entries(i).forEach(([c,l])=>{t===c?l[o].set(r,a):l[o].delete(r)})}function Mr(i,t){return Object.keys(i).every(e=>i[e]===t[e])}class R0 extends Dn{beforeDraw(t,e){if(e.stage==="visibility"||!this.context.model.model.hasTreeStructure(ot))return t;const{model:n}=this.context,{add:s,update:r}=t,o=[...t.update.combos.entries(),...t.add.combos.entries()];for(;o.length;){const[a,c]=o.pop();if(me(c)){const l=n.getDescendantsData(a),d=l.map(w),{internal:h,external:u}=Co(d,f=>n.getRelatedEdgesData(f));l.forEach(f=>{const g=w(f),p=o.findIndex(([y])=>y===g);p!==-1&&o.splice(p,1);const v=n.getElementType(g);Te(t,"remove",v,f)}),h.forEach(f=>Te(t,"remove","edge",f)),u.forEach(f=>{var g;const p=w(f);((g=this.context.element)===null||g===void 0?void 0:g.getElement(p))?r.edges.set(p,f):s.edges.set(p,f)})}else{const l=n.getChildrenData(a),d=l.map(w),{edges:h}=Co(d,u=>n.getRelatedEdgesData(u));[...l,...h].forEach(u=>{var f;const g=w(u),p=n.getElementType(g);((f=this.context.element)===null||f===void 0?void 0:f.getElement(g))?Te(t,"update",p,u):Te(t,"add",p,u),p==="combo"&&o.push([g,u])})}}return t}}const _l=(i,t,e,n)=>{const s=`${e}s`,r=w(n);!i.add[s].has(r)&&!i.update[s].has(r)&&i[t][s].set(w(n),n)};class k0 extends Dn{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(_l(e,"add","node",t),me(t))return;const n=w(t);_l(e,"add","node",t),this.context.model.getRelatedEdgesData(n,"out").forEach(o=>{Te(e,"add","edge",o)}),this.context.model.getChildrenData(n).forEach(o=>{this.handleExpand(o,e)})}beforeDraw(t){const{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(jt))return t;const{add:{nodes:s,edges:r},update:{nodes:o}}=t,a=new Map,c=new Map;s.forEach((d,h)=>{me(d)&&a.set(h,d)}),r.forEach(d=>{if(e.getElementType(d.source)!=="node")return;const h=e.getNodeData(d.source);me(h)&&a.set(d.source,h)}),o.forEach((d,h)=>{const u=this.getElement(h);if(!u)return;const f=u.attributes.collapsed;me(d)?f||a.set(h,d):f&&c.set(h,d)});const l=new Set;return a.forEach((d,h)=>{n.getDescendantsData(h).forEach(f=>{const g=w(f);if(l.has(g))return;Te(t,"remove","node",f),n.getRelatedEdgesData(g).forEach(v=>{Te(t,"remove","edge",v)}),l.add(g)})}),c.forEach((d,h)=>{if(n.getAncestorsData(h,jt).some(me)){Te(t,"remove","node",d);return}this.handleExpand(d,t)}),t}}const Jo=new WeakMap;function Ym(i,t,e){Jo.has(i)||Jo.set(i,{});const n=Jo.get(i);if(!n[t])return n[t]=e,!0;const s=n[t];return Rl(s,e)?!1:(n[t]=e,!0)}const Rl=(i,t,e=2)=>{if(typeof i!="object"||typeof t!="object")return i===t;const n=Object.keys(i),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n){const o=i[r],a=t[r];if(e>1&&typeof o=="object"&&typeof a=="object"){if(!Rl(o,a,e-1))return!1}else if(o!==a)return!1}return!0};function j0(i,t,e,n=!1){const s=Oe[i][t];!n&&s?s!==e&&F.warn(`The extension ${t} of ${i} has been registered before.`):Object.assign(Oe[i],{[t]:e})}var B0=_(74768),z0=_(30853),kl=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})},jl=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};const Bl=["main"],zl=["background","main","label","transient"];function F0(i){return i.main}class Fl{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||F0(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:n,background:s,cursor:r,enableMultiLayer:o}=e,a=jl(e,["renderer","background","cursor","enableMultiLayer"]),c=o?zl:Bl,l=$l(n,c),d=Object.fromEntries(c.map(h=>{const u=new M.Xz(Object.assign(Object.assign({},a),{supportsMutipleCanvasesInOneContainer:o,renderer:l[h],background:o?h==="background"?s:void 0:s}));return[h,u]}));Wl(d),this.extends={config:this.config,renderer:n,renderers:l,layers:d}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(n=>{const s=n.getCamera(),r=s.getPosition(),o=s.getFocalPoint();n.resize(t,e),s.setPosition(r),s.setFocalPoint(o)})}getBounds(t){return bi(Object.values(this.getLayers()).map(e=>t?e.getRoot().childNodes.find(s=>s.classList.includes(t)):e.getRoot()).filter(e=>(e==null?void 0:e.childNodes.length)>0).map(e=>e.getBounds()))}getContainer(){const t=this.extends.config.container;return typeof t=="string"?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;const s=((n=t.style)===null||n===void 0?void 0:n.$layer)||"main";return this.getLayer(s).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=$l(t,this.config.enableMultiLayer?zl:Bl);this.extends.renderers=e,Object.entries(e).forEach(([n,s])=>this.getLayer(n).setRenderer(s)),Wl(this.getLayers())}getCanvasByViewport(t){return re(this.getLayer().viewport2Canvas(We(t)))}getViewportByCanvas(t){return re(this.getLayer().canvas2Viewport(We(t)))}getViewportByClient(t){return re(this.getLayer().client2Viewport(We(t)))}getClientByViewport(t){return re(this.getLayer().viewport2Client(We(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),n=e.client2Viewport(We(t));return re(e.viewport2Canvas(n))}toDataURL(){return kl(this,arguments,void 0,function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:n="viewport"}=t,s=jl(t,["mode"]);let[r,o,a,c]=[0,0,0,0];if(n==="viewport")[a,c]=this.getSize();else if(n==="overall"){const y=this.getBounds(),m=fn(y);[r,o]=y.min,[a,c]=m}const l=(0,z0.L)('<div id="virtual-image"></div>'),d=new M.Xz({width:a,height:c,renderer:new Ai.Th,devicePixelRatio:e,container:l,background:this.extends.config.background});yield d.ready,d.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),d.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),u=d.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);h.translate([f[0]-u.x,f[1]-u.y]),h.scale(1/this.getCamera().getZoom()),d.appendChild(h),d.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),p=d.getCamera();if(n==="viewport")p.setZoom(g.getZoom()),p.setPosition(g.getPosition()),p.setFocalPoint(g.getFocalPoint());else if(n==="overall"){const[y,m,b]=p.getPosition(),[E,S,O]=p.getFocalPoint();p.setPosition([y+r,m+o,b]),p.setFocalPoint([E+r,S+o,O])}const v=d.getContextService();return new Promise(y=>{d.addEventListener(M.$6.RERENDER,()=>kl(this,void 0,void 0,function*(){yield new Promise(b=>setTimeout(b,300));const m=yield v.toDataURL(s);y(m)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()})}}function $l(i,t){return Object.fromEntries(t.map(e=>{const n=(i==null?void 0:i(e))||new Ai.Th;return n instanceof Ai.Th&&n.setConfig({enableDirtyRectangleRendering:!1}),e==="main"?n.registerPlugin(new B0.S({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]}))}function Wl(i){Object.entries(i).forEach(([t,e])=>{const n=e.getContextService().getDomElement();n!=null&&n.style&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,t!=="main"&&(n.style.pointerEvents="none")),n!=null&&n.parentElement&&(n.parentElement.style.display="grid")})}const li=i=>i?parseInt(i):0;function $0(i){const t=getComputedStyle(i),e=i.clientWidth||li(t.width),n=i.clientHeight||li(t.height),s=li(t.paddingLeft)+li(t.paddingRight),r=li(t.paddingTop)+li(t.paddingBottom);return[e-s,n-r]}function Zl(i){if(!i)return[0,0];let t=640,e=480;const[n,s]=$0(i);t=n||t,e=s||e;const r=1,o=1;return[Math.max((0,Rt.Z)(t)?t:r,r),Math.max((0,Rt.Z)(e)?e:o,o)]}class Ar{constructor(t){this.type=t}}class Ut extends Ar{constructor(t,e){super(t),this.data=e}}class Pe extends Ar{constructor(t,e,n,s){super(t),this.animationType=e,this.animation=n,this.data=s}}class di extends Ar{constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class Lr extends Ar{constructor(t,e){super(t),this.data=e}}function Qt(i,t){i.emit(t.type,t)}function W0(i){if(!i)return null;if(i instanceof M.BB)return{type:"canvas",element:i};let t=i;for(;t;){if(Ii(t))return{type:"node",element:t};if(jc(t))return{type:"edge",element:t};if(Do(t))return{type:"combo",element:t};t=t.parentElement}return null}function Vl(i){var t;return((t=i==null?void 0:i.style)===null||t===void 0?void 0:t.zIndex)||0}const hi="cachedStyle",Nr=i=>`__${i}__`;function Z0(i,t){const e=Array.isArray(t)?t:[t];(0,Ce.Z)(i,hi)||(0,vs.Z)(i,hi,{}),e.forEach(n=>{(0,vs.Z)((0,Ce.Z)(i,hi),Nr(n),i.attributes[n])})}function Hl(i,t){return(0,Ce.Z)(i,[hi,Nr(t)])}function V0(i,t){return Nr(t)in((0,Ce.Z)(i,hi)||{})}function Um(i,t,e){set(i,[hi,Nr(t)],e)}class H0{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var s,r,o;(s=e==null?void 0:e.before)===null||s===void 0||s.call(e);const a=this.getTasks().map(([l,d])=>{var h,u,f;const{element:g,elementType:p,stage:v}=l,y=Nn(this.context.options,p,v,t);(h=d==null?void 0:d.before)===null||h===void 0||h.call(d);const m=y.length?In(g,this.inferStyle(l,n),y):null;return m?((u=d==null?void 0:d.beforeAnimate)===null||u===void 0||u.call(d,m),m.finished.then(()=>{var b,E;(b=d==null?void 0:d.afterAnimate)===null||b===void 0||b.call(d,m),(E=d==null?void 0:d.after)===null||E===void 0||E.call(d),this.animations.delete(m)})):(f=d==null?void 0:d.after)===null||f===void 0||f.call(d),m}).filter(Boolean);a.forEach(l=>this.animations.add(l));const c=K(a);return c?((r=e==null?void 0:e.beforeAnimate)===null||r===void 0||r.call(e,c),c.finished.then(()=>{var l,d;(l=e==null?void 0:e.afterAnimate)===null||l===void 0||l.call(e,c),(d=e==null?void 0:e.after)===null||d===void 0||d.call(e),this.release()})):(o=e==null?void 0:e.after)===null||o===void 0||o.call(e),c}inferStyle(t,e){var n,s;const{element:r,elementType:o,stage:a,originalStyle:c,updatedStyle:l={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},c),l));const{modifiedStyle:d}=t,h={},u={};if(a==="enter")Object.assign(h,{opacity:0});else if(a==="exit")Object.assign(u,{opacity:0});else if(a==="show")Object.assign(h,{opacity:0}),Object.assign(u,{opacity:(n=Hl(r,"opacity"))!==null&&n!==void 0?n:ye("opacity")});else if(a==="hide")Object.assign(h,{opacity:(s=Hl(r,"opacity"))!==null&&s!==void 0?s:ye("opacity")}),Object.assign(u,{opacity:0});else if(a==="collapse"){const{collapse:f}=e||{},{target:g,descendants:p,position:v}=f;if(o==="node"){if(p.includes(r.id)){const[y,m,b]=v;Object.assign(u,{x:y,y:m,z:b})}}else if(o==="combo"){if(r.id===g||p.includes(r.id)){const[y,m]=v;Object.assign(u,{x:y,y:m,childrenNode:c.childrenNode})}}else o==="edge"&&Object.assign(u,{sourceNode:d.sourceNode,targetNode:d.targetNode})}else if(a==="expand"){const{expand:f}=e||{},{target:g,descendants:p,position:v}=f;if(o==="node"){if(r.id===g||p.includes(r.id)){const[y,m,b]=v;Object.assign(h,{x:y,y:m,z:b})}}else if(o==="combo"){if(r.id===g||p.includes(r.id)){const[y,m,b]=v;Object.assign(h,{x:y,y:m,z:b,childrenNode:d.childrenNode})}}else o==="edge"&&Object.assign(h,{sourceNode:d.sourceNode,targetNode:d.targetNode})}return[Object.keys(h).length>0?Object.assign({},c,h):c,Object.keys(u).length>0?Object.assign({},d,u):d]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;const{canvas:n}=this.context,s=(e=(t=n.document)===null||t===void 0?void 0:t.timeline)===null||e===void 0?void 0:e.animationsWithPromises;s&&(n.document.timeline.animationsWithPromises=s.filter(r=>r.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class Y0{constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,this.batchCount===1&&this.emit(new Ut(P.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Ut(P.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class U0 extends oo{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=e=>{const{target:n}=e,s=W0(n);if(!s)return;const{graph:r,canvas:o}=this.context,{type:a,element:c}=s;if("destroyed"in c&&(Ps(c)||c.destroyed))return;const{type:l,detail:d,button:h}=e,u=Object.assign(Object.assign({},e),{target:c,targetType:a,originalTarget:n});l===x.POINTER_MOVE&&(this.currentTarget!==c&&(this.currentTarget&&r.emit(`${this.currentTargetType}:${x.POINTER_LEAVE}`,Object.assign(Object.assign({},u),{type:x.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),c&&(Object.assign(u,{type:x.POINTER_ENTER}),r.emit(`${a}:${x.POINTER_ENTER}`,u))),this.currentTarget=c,this.currentTargetType=a),l===x.CLICK&&h===2||(r.emit(`${a}:${l}`,u),r.emit(l,u)),l===x.CLICK&&d===2&&(Object.assign(u,{type:x.DBLCLICK}),r.emit(`${a}:${x.DBLCLICK}`,u),r.emit(x.DBLCLICK,u)),l===x.POINTER_DOWN&&h===2&&(Object.assign(u,{type:x.CONTEXT_MENU,preventDefault:()=>{var f;(f=o.getContainer())===null||f===void 0||f.addEventListener(x.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),r.emit(`${a}:${x.CONTEXT_MENU}`,u),r.emit(x.CONTEXT_MENU,u))},this.forwardContainerEvents=e=>{this.context.graph.emit(e.type,e)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[rt.KEY_DOWN,rt.KEY_UP].forEach(n=>{t.addEventListener(n,this.forwardContainerEvents)});const e=this.context.canvas.document;e&&[x.CLICK,x.DBLCLICK,x.POINTER_OVER,x.POINTER_LEAVE,x.POINTER_ENTER,x.POINTER_MOVE,x.POINTER_OUT,x.POINTER_DOWN,x.POINTER_UP,x.CONTEXT_MENU,x.DRAG_START,x.DRAG,x.DRAG_END,x.DRAG_ENTER,x.DRAG_OVER,x.DRAG_LEAVE,x.DROP,x.WHEEL].forEach(n=>{e.addEventListener(n,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[rt.KEY_DOWN,rt.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}function G0(i,t){t===void 0&&(t=new Map);var e=[];if(Array.isArray(i))for(var n=0,s=i.length;n<s;n++){var r=i[n];t.has(r)||(e.push(r),t.set(r,!0))}return e}var Wi=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function Tn(i,t){const{data:e,style:n}=i,s=Wi(i,["data","style"]),{data:r,style:o}=t,a=Wi(t,["data","style"]),c=Object.assign(Object.assign({},s),a);return(e||r)&&Object.assign(c,{data:Object.assign(Object.assign({},e),r)}),(n||o)&&Object.assign(c,{style:Object.assign(Object.assign({},n),o)}),c}function ta(i){const{data:t,style:e}=i,s=Wi(i,["data","style"]);return t&&(s.data=Object.assign({},t)),e&&(s.style=Object.assign({},e)),s}function Gm(i){return!get(i,["nodes","length"])&&!get(i,["edges","length"])&&!get(i,["combos","length"])}function ui(i={},t={}){const{states:e=[],data:n={},style:s={},children:r=[]}=i,o=Wi(i,["states","data","style","children"]),{states:a=[],data:c={},style:l={},children:d=[]}=t,h=Wi(t,["states","data","style","children"]),u=(g,p)=>g.length!==p.length?!1:g.every((v,y)=>v===p[y]),f=(g,p)=>{const v=Object.keys(g),y=Object.keys(p);return v.length!==y.length?!1:v.every(m=>g[m]===p[m])};return!(!f(o,h)||!u(r,d)||!u(e,a)||!f(n,c)||!f(s,l))}var X0=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function ea(i){const{id:t=w(i),style:e,data:n}=i,s=X0(i,["id","style","data"]),r=Object.assign(Object.assign({},i),{style:Object.assign({},e),data:Object.assign({},n)});return pd(i)?Object.assign({id:t,data:r},s):{id:t,data:r}}function ie(i){return i.data}function K0(i){if(i.hasTreeStructure(jt))return;i.attachTreeStructure(jt);const t=i.getAllEdges();for(const e of t){const{source:n,target:s}=e;i.setParent(s,n,jt)}}class q0{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new No.k}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===T.NodeUpdated||e===T.EdgeUpdated||e===T.ComboUpdated){const{value:n,original:s}=t;this.changes.push({value:ta(n),original:ta(s),type:e})}else this.changes.push({value:ta(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,n)=>{const s=ie(n);return this.isCombo(w(s))||(t===void 0||t.includes(w(s)))&&e.push(s),e},[])}getEdgeDatum(t){return ie(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,n)=>{const s=ie(n);return(t===void 0||t.includes(w(s)))&&e.push(s),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,n)=>{const s=ie(n);return this.isCombo(w(s))&&(t===void 0||t.includes(w(s)))&&e.push(s),e},[])}getRootsData(t=jt){return this.model.getRoots(t).map(ie)}getAncestorsData(t,e){const{model:n}=this;return!n.hasNode(t)||!n.hasTreeStructure(e)?[]:n.getAncestors(t,e).map(ie)}getDescendantsData(t){const e=this.getElementDataById(t),n=[];return ni(e,s=>{s!==e&&n.push(s)},s=>this.getChildrenData(w(s)),"TB"),n}getParentData(t,e){const{model:n}=this;if(!e){F.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(t)||!n.hasTreeStructure(e))return;const s=n.getParent(t,e);return s?ie(s):void 0}getChildrenData(t){const e=this.getElementType(t)==="node"?jt:ot,{model:n}=this;return!n.hasNode(t)||!n.hasTreeStructure(e)?[]:n.getChildren(t,e).map(ie)}getElementsDataByType(t){return t==="node"?this.getNodeData():t==="edge"?this.getEdgeData():t==="combo"?this.getComboData():[]}getElementDataById(t){return this.getElementType(t)==="edge"?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){const e=this.model.getNode(t);return ie(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,n)=>{const s=ie(n);return t?t.includes(w(s))&&e.push(s):e.push(s),e},[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter(s=>{var r;return(r=s.states)===null||r===void 0?void 0:r.includes(e)})}getElementState(t){var e;return((e=this.getElementDataById(t))===null||e===void 0?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(ie)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(ie)}setData(t){const{nodes:e=[],edges:n=[],combos:s=[]}=t,{nodes:r,edges:o,combos:a}=this.getData(),c=vn(r,e,h=>w(h),ui),l=vn(o,n,h=>w(h),ui),d=vn(a,s,h=>w(h),ui);this.batch(()=>{const h={nodes:c.enter,edges:l.enter,combos:d.enter};this.addData(h),this.computeZIndex(h,"add",!0);const u={nodes:c.update,edges:l.update,combos:d.update};this.updateData(u),this.computeZIndex(u,"update",!0);const f={nodes:c.exit.map(w),edges:l.exit.map(w),combos:d.exit.map(w)};this.removeData(f)})}addData(t){const{nodes:e,edges:n,combos:s}=t;this.batch(()=>{this.addComboData(s),this.addNodeData(e),this.addEdgeData(n)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(e=>(this.pushChange({value:e,type:T.NodeAdded}),ea(e)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(e=>(this.pushChange({value:e,type:T.EdgeAdded}),ea(e)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(ot)||e.attachTreeStructure(ot),e.addNodes(t.map(n=>(this.comboIds.add(w(n)),this.pushChange({value:n,type:T.ComboAdded}),ea(n)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){const n=this.getNodeLikeDatum(t),s=e.map(w);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...s]}]),this.addEdgeData(s.map(r=>({source:t,target:r})))}computeZIndex(t,e,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:s=[],edges:r=[],combos:o=[]}=t;o.forEach(a=>{var c,l,d;const h=w(a);if(e==="add"&&(0,Rt.Z)((c=a.style)===null||c===void 0?void 0:c.zIndex)||e==="update"&&!("combo"in a))return;const u=this.getParentData(h,ot),f=u?((d=(l=u.style)===null||l===void 0?void 0:l.zIndex)!==null&&d!==void 0?d:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:h,style:{zIndex:f}}])})}),s.forEach(a=>{var c,l,d;const h=w(a);if(e==="add"&&(0,Rt.Z)((c=a.style)===null||c===void 0?void 0:c.zIndex)||e==="update"&&!("combo"in a)&&!("children"in a))return;let u=0;const f=this.getParentData(h,ot);if(f)u=(((l=f.style)===null||l===void 0?void 0:l.zIndex)||0)+1;else{const g=this.getParentData(h,jt);g&&(u=((d=g==null?void 0:g.style)===null||d===void 0?void 0:d.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:h,style:{zIndex:u}}])})}),r.forEach(a=>{var c,l,d,h,u;if((0,Rt.Z)((c=a.style)===null||c===void 0?void 0:c.zIndex))return;let{id:f,source:g,target:p}=a;if(!f)f=w(a);else{const m=this.getEdgeDatum(f);g=m.source,p=m.target}if(!g||!p)return;const v=((d=(l=this.getNodeLikeDatum(g))===null||l===void 0?void 0:l.style)===null||d===void 0?void 0:d.zIndex)||0,y=((u=(h=this.getNodeLikeDatum(p))===null||h===void 0?void 0:h.style)===null||u===void 0?void 0:u.zIndex)||0;this.updateEdgeData([{id:w(a),style:{zIndex:Math.max(v,y)-1}}])})})}getFrontZIndex(t){var e;const n=this.getElementType(t),s=this.getElementDataById(t),r=this.getData();if(Object.assign(r,{[`${n}s`]:r[`${n}s`].filter(o=>w(o)!==t)}),n==="combo"&&!me(s)){const o=new Set(this.getAncestorsData(t,ot).map(w));r.nodes=r.nodes.filter(a=>!o.has(w(a))),r.combos=r.combos.filter(a=>!o.has(w(a))),r.edges=r.edges.filter(({source:a,target:c})=>!o.has(a)&&!o.has(c))}return Math.max(((e=s.style)===null||e===void 0?void 0:e.zIndex)||0,0,...Object.values(r).flat().map(o=>{var a;return(((a=o==null?void 0:o.style)===null||a===void 0?void 0:a.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach(n=>{const s=w(n),r=cs(n);r!==void 0&&(e.hasTreeStructure(ot)||e.attachTreeStructure(ot),r===null&&this.refreshComboData(s),this.setParent(s,cs(n),ot));const o=n.children||[];if(o.length){e.hasTreeStructure(jt)||e.attachTreeStructure(jt);const a=o.filter(c=>e.hasNode(c));a.forEach(c=>this.setParent(c,s,jt)),a.length!==o.length&&this.updateNodeData([{id:s,children:a}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:n,combos:s}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(s),this.updateEdgeData(n)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{const n=[];t.forEach(s=>{const r=w(s),o=ie(e.getNode(r));if(ui(o,s))return;const a=Tn(o,s);this.pushChange({value:a,original:o,type:T.NodeUpdated}),e.mergeNodeData(r,a),n.push(a)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:t},"update")}refreshData(){const{nodes:t,edges:e,combos:n}=this.getData();t.forEach(s=>{this.pushChange({value:s,original:s,type:T.NodeUpdated})}),e.forEach(s=>{this.pushChange({value:s,original:s,type:T.EdgeUpdated})}),n.forEach(s=>{this.pushChange({value:s,original:s,type:T.ComboUpdated})})}syncNodeLikeDatum(t){const{model:e}=this,n=w(t);if(!e.hasNode(n))return;const s=ie(e.getNode(n)),r=Tn(s,t);e.mergeNodeData(n,r)}syncEdgeDatum(t){const{model:e}=this,n=w(t);if(!e.hasEdge(n))return;const s=ie(e.getEdge(n)),r=Tn(s,t);e.mergeEdgeData(n,r)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{t.forEach(n=>{const s=w(n),r=ie(e.getEdge(s));if(ui(r,n))return;n.source&&r.source!==n.source&&e.updateEdgeSource(s,n.source),n.target&&r.target!==n.target&&e.updateEdgeTarget(s,n.target);const o=Tn(r,n);this.pushChange({value:o,original:r,type:T.EdgeUpdated}),e.mergeEdgeData(s,o)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch(()=>{const n=[];t.forEach(s=>{const r=w(s),o=ie(e.getNode(r));if(ui(o,s))return;const a=Tn(o,s);this.pushChange({value:a,original:o,type:T.ComboUpdated}),e.mergeNodeData(r,a),n.push(a)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:t},"update")}setParent(t,e,n,s=!0){if(t===e)return;const r=this.getNodeLikeDatum(t),o=cs(r);if(o!==e&&n===ot){const a={id:t,combo:e};this.isCombo(t)?this.syncNodeLikeDatum(a):this.syncNodeLikeDatum(a)}this.model.setParent(t,e,n),s&&n===ot&&G0([o,e]).forEach(a=>{a!==void 0&&this.refreshComboData(a)})}refreshComboData(t){const e=this.getComboData([t])[0],n=this.getAncestorsData(t,ot);e&&this.pushChange({value:e,original:e,type:T.ComboUpdated}),n.forEach(s=>{this.pushChange({value:s,original:s,type:T.ComboUpdated})})}getElementPosition(t){const e=this.getElementDataById(t);return qt(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const n=this.getElementPosition(t),s=at(n,[...e,0].slice(0,3));this.translateNodeTo(t,s)}translateNodeTo(t,e){const[n=0,s=0,r=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:n,y:s,z:r}}])})}translateComboBy(t,e){const[n=0,s=0,r=0]=e;if([n,s,r].some(isNaN)||[n,s,r].every(c=>c===0))return;const o=this.getComboData([t])[0];if(!o)return;const a=new Set;ni(o,c=>{const l=w(c);if(a.has(l))return;a.add(l);const[d,h,u]=qt(c),f=Tn(c,{style:{x:d+n,y:h+s,z:u+r}});this.pushChange({value:f,original:c,type:this.isCombo(l)?T.ComboUpdated:T.NodeUpdated}),this.model.mergeNodeData(l,f)},c=>this.getChildrenData(w(c)),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;const[s=0,r=0,o=0]=e,a=(n=this.getComboData([t]))===null||n===void 0?void 0:n[0];if(!a)return;const[c,l,d]=qt(a),h=s-c,u=r-l,f=o-d;ni(a,g=>{const p=w(g),[v,y,m]=qt(g),b=Tn(g,{style:{x:v+h,y:y+u,z:m+f}});this.pushChange({value:b,original:g,type:this.isCombo(p)?T.ComboUpdated:T.NodeUpdated}),this.model.mergeNodeData(p,b)},g=>this.getChildrenData(w(g)),"BT")}removeData(t){const{nodes:e,edges:n,combos:s}=t;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(s),this.latestRemovedComboIds=new Set(s)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.removeEdgeData(this.getRelatedEdgesData(e).map(w)),this.pushChange({value:this.getNodeData([e])[0],type:T.NodeRemoved}),this.removeNodeLikeHierarchy(e)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(e=>this.pushChange({value:this.getEdgeData([e])[0],type:T.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.pushChange({value:this.getComboData([e])[0],type:T.ComboRemoved}),this.removeNodeLikeHierarchy(e),this.comboIds.delete(e)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(ot)){const e=cs(this.getNodeLikeDatum(t));this.setParent(t,void 0,ot,!1),this.model.getChildren(t,ot).forEach(n=>{const s=ie(n),r=w(s);this.setParent(w(s),e,ot,!1);const o=Tn(s,{id:w(s),combo:e});this.pushChange({value:o,original:s,type:this.isCombo(r)?T.ComboUpdated:T.NodeUpdated}),this.model.mergeNodeData(w(s),o)}),(0,X.Z)(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(D(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map(s=>s.id)),t.removeNodes(e.map(s=>s.id)),this.context={}}}var Zi=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Q0{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:t}=this.context;this.container=t.appendChild(new M.ZA({className:"elements"}))}}emit(t,e){e.silence||Qt(this.context.graph,t)}forEachElementData(t){Bn.forEach(e=>{const n=this.context.model.getElementsDataByType(e);t(e,n)})}getElementType(t,e){var n;const{options:s,graph:r}=this.context,o=((n=s[t])===null||n===void 0?void 0:n.type)||e.type;return o?typeof o=="string"?o:o.call(r,e):t==="edge"?"line":"circle"}getTheme(t){return q(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:n={}}=this.getTheme(t);return Object.assign({},...e.map(s=>n[s]||{}))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,n)=>{var s,r;const o=Object.assign({},hc((s=this.getTheme(e))===null||s===void 0?void 0:s.palette),hc((r=t[e])===null||r===void 0?void 0:r.palette));o!=null&&o.field&&Object.assign(this.paletteStyle,Su(n,o))})}getPaletteStyle(t,e){const n=this.paletteStyle[e];return n?t==="edge"?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;const{options:s}=this.context,r=((n=s[t])===null||n===void 0?void 0:n.style)||{};"transform"in r&&Array.isArray(r.transform)&&(r.transform=[...r.transform]),this.defaultStyle[w(e.datum)]=dc(r,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData((n,s)=>{const r=s.length;for(let o=0;o<r;o++){const a=s[o];(t===void 0||t.includes(w(a)))&&this.computeElementDefaultStyle(n,{datum:a,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch(e){return[]}}getElementStateStyle(t,e,n){var s,r;const{options:o}=this.context,a=((r=(s=o[t])===null||s===void 0?void 0:s.state)===null||r===void 0?void 0:r[e])||{};return dc(a,n)}computeElementStatesStyle(t,e,n){this.stateStyle[w(n.datum)]=Object.assign({},...e.map(s=>this.getElementStateStyle(t,s,n)))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData((n,s)=>{const r=s.length;for(let o=0;o<r;o++){const a=s[o];if(t===void 0||t.includes(w(a))){const c=this.getElementState(w(a));this.computeElementStatesStyle(n,c,{datum:a,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[w(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){const n=w(e),s=this.getThemeStyle(t),r=this.getPaletteStyle(t,n),o=e.style||{},a=this.getDefaultStyle(n),c=this.getThemeStateStyle(t,this.getElementState(n)),l=this.getStateStyle(n),d=Object.assign({},s,r,o,a,c,l);if(t==="combo"){const h=this.context.model.getChildrenData(n),f=!!d.collapsed?[]:h.map(w).filter(g=>this.getElement(g));Object.assign(d,{childrenNode:f,childrenData:h})}return d}getDrawData(t){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:n="draw",stage:s=n}=t;return this.markDestroyElement(e.drawData),this.computeStyle(s),{type:n,stage:s,data:e}}draw(t={animation:!0}){const e=this.getDrawData(t);if(!e)return;const{data:{drawData:{add:n,update:s,remove:r}}}=e;return this.destroyElements(r,t),this.createElements(n,t),this.updateElements(s,t),this.setAnimationTask(t,e)}preLayoutDraw(){return Zi(this,arguments,void 0,function*(t={animation:!0}){var e,n;const s=this.getDrawData(t);if(!s)return;const{data:{drawData:r}}=s;yield(n=(e=this.context.layout)===null||e===void 0?void 0:e.preLayout)===null||n===void 0?void 0:n.call(e,r);const{add:o,update:a,remove:c}=r;return this.destroyElements(c,t),this.createElements(o,t),this.updateElements(a,t),this.setAnimationTask(t,s)})}setAnimationTask(t,e){const{animation:n,silence:s}=t,{data:{dataChanges:r,drawData:o},stage:a,type:c}=e;return this.context.animation.animate(n,s?{}:{before:()=>this.emit(new Ut(P.BEFORE_DRAW,{dataChanges:r,animation:n,stage:a,render:c==="render"}),t),beforeAnimate:l=>this.emit(new Pe(P.BEFORE_ANIMATE,C.DRAW,l,o),t),afterAnimate:l=>this.emit(new Pe(P.AFTER_ANIMATE,C.DRAW,l,o),t),after:()=>this.emit(new Ut(P.AFTER_DRAW,{dataChanges:r,animation:n,stage:a,render:c==="render",firstRender:this.context.graph.rendered===!1}),t)})}computeChangesAndDrawData(t){const{model:e}=this.context,n=e.getChanges(),s=Wo(n);if(s.length===0)return null;const{NodeAdded:r=[],NodeUpdated:o=[],NodeRemoved:a=[],EdgeAdded:c=[],EdgeUpdated:l=[],EdgeRemoved:d=[],ComboAdded:h=[],ComboUpdated:u=[],ComboRemoved:f=[]}=Qn(s,y=>y.type),g=y=>new Map(y.map(m=>{const b=m.value;return[w(b),b]})),p={add:{nodes:g(r),edges:g(c),combos:g(h)},update:{nodes:g(o),edges:g(l),combos:g(u)},remove:{nodes:g(a),edges:g(d),combos:g(f)}},v=this.transformData(p,t);return e.clearChanges(),{dataChanges:n,drawData:v}}transformData(t,e){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((s,r)=>r.beforeDraw(s,e),t)}createElement(t,e,n){var s;const r=w(e);if(this.getElement(r))return;const a=this.getElementType(t,e),c=this.getElementComputedStyle(t,e),l=te(t,a);if(!l)return F.warn(`The element ${a} of ${t} is not registered.`);this.emit(new di(P.BEFORE_ELEMENT_CREATE,t,e),n);const d=this.container.appendChild(new l({id:r,context:this.context,style:c}));this.shapeTypeMap[r]=a,this.elementMap[r]=d;const{stage:h="enter"}=n;(s=this.context.animation)===null||s===void 0||s.add({element:d,elementType:t,stage:h,originalStyle:Object.assign({},d.attributes),updatedStyle:c},{after:()=>{var u;this.emit(new di(P.AFTER_ELEMENT_CREATE,t,e),n),(u=d.onCreate)===null||u===void 0||u.call(d)}})}createElements(t,e){const{nodes:n,edges:s,combos:r}=t;[["node",n],["combo",r],["edge",s]].forEach(([a,c])=>{c.forEach(l=>this.createElement(a,l,e))})}getUpdateStageStyle(t,e,n){const{stage:s="update"}=n;if(s==="translate")if(t==="node"||t==="combo"){const{style:{x:r=0,y:o=0,z:a=0}={}}=e;return{x:r,y:o,z:a}}else return{};return this.getElementComputedStyle(t,e)}updateElement(t,e,n){var s;const r=w(e),{stage:o="update"}=n,a=this.getElement(r);if(!a)return()=>null;this.emit(new di(P.BEFORE_ELEMENT_UPDATE,t,e),n);const c=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[r]!==c&&(a.destroy(),delete this.shapeTypeMap[r],delete this.elementMap[r],this.createElement(t,e,{animation:!1,silence:!0}));const d=o!=="visibility"?o:l.visibility==="hidden"?"hide":"show";d==="hide"&&delete l.visibility,(s=this.context.animation)===null||s===void 0||s.add({element:a,elementType:t,stage:d,originalStyle:Object.assign({},a.attributes),updatedStyle:l},{before:()=>{const h=this.elementMap[r];o!=="collapse"&&Lo(h,l),o==="visibility"&&(V0(h,"opacity")||Z0(h,"opacity"),this.visibilityCache.set(h,d==="show"?"visible":"hidden"),d==="show"&&Rn(h,"visible"))},after:()=>{var h;const u=this.elementMap[r];o==="collapse"&&Lo(u,l),d==="hide"&&Rn(u,this.visibilityCache.get(u)),this.emit(new di(P.AFTER_ELEMENT_UPDATE,t,e),n),(h=u.onUpdate)===null||h===void 0||h.call(u)}})}updateElements(t,e){const{nodes:n,edges:s,combos:r}=t;[["node",n],["combo",r],["edge",s]].forEach(([a,c])=>{c.forEach(l=>this.updateElement(a,l,e))})}markDestroyElement(t){Object.values(t.remove).forEach(e=>{e.forEach(n=>{const s=w(n),r=this.getElement(s);r&&Hf(r)})})}destroyElement(t,e,n){var s;const{stage:r="exit"}=n,o=w(e),a=this.elementMap[o];if(!a)return()=>null;this.emit(new di(P.BEFORE_ELEMENT_DESTROY,t,e),n),(s=this.context.animation)===null||s===void 0||s.add({element:a,elementType:t,stage:r,originalStyle:Object.assign({},a.attributes),updatedStyle:{}},{after:()=>{var c;this.clearElement(o),a.destroy(),(c=a.onDestroy)===null||c===void 0||c.call(a),this.emit(new di(P.AFTER_ELEMENT_DESTROY,t,e),n)}})}destroyElements(t,e){const{nodes:n,edges:s,combos:r}=t;[["combo",r],["edge",s],["node",n]].forEach(([a,c])=>{c.forEach(l=>this.destroyElement(a,l,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var n,s;const r=(n=t.nodes)===null||n===void 0?void 0:n.find(o=>w(o)===e);if(r){const o=qt(this.context.model.getNodeLikeDatum(e)),a=qt(r),c=Mt(o,a);(s=t.nodes)===null||s===void 0||s.forEach(l=>{var d,h,u;!((d=l.style)===null||d===void 0)&&d.x&&(l.style.x+=c[0]),!((h=l.style)===null||h===void 0)&&h.y&&(l.style.y+=c[1]),!((u=l.style)===null||u===void 0)&&u.z&&(l.style.z+=c[2]||0)})}}collapseNode(t,e){return Zi(this,void 0,void 0,function*(){var n;const{animation:s,align:r}=e,{model:o,layout:a}=this.context,c=this.computeChangesAndDrawData({stage:"collapse",animation:s});if(!c)return;this.markDestroyElement(c.drawData);const l=yield a.simulate();r&&this.alignLayoutResultToElement(l,t),o.updateData(l);const d=this.computeChangesAndDrawData({stage:"collapse",animation:s});if(!d)return;const{drawData:h}=d,{add:u,remove:f,update:g}=h;this.markDestroyElement(h);const p={animation:s,stage:"collapse",data:h};this.destroyElements(f,p),this.createElements(u,p),this.updateElements(g,p),yield(n=this.context.animation.animate(s,{beforeAnimate:v=>this.emit(new Pe(P.BEFORE_ANIMATE,C.COLLAPSE,v,h),p),afterAnimate:v=>this.emit(new Pe(P.AFTER_ANIMATE,C.COLLAPSE,v,h),p)},{collapse:{target:t,descendants:Array.from(f.nodes).map(([,v])=>w(v)),position:qt(g.nodes.get(t))}}))===null||n===void 0?void 0:n.finished})}expandNode(t,e){return Zi(this,void 0,void 0,function*(){var n;const{model:s,layout:r}=this.context,{animation:o,align:a}=e,c=qt(s.getNodeData([t])[0]),l=this.computeChangesAndDrawData({stage:"expand",animation:o});if(!l)return;const{drawData:{add:d}}=l;this.createElements(d,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();const h=yield r.simulate();a&&this.alignLayoutResultToElement(h,t),s.updateData(h),this.computeStyle("expand");const u=this.computeChangesAndDrawData({stage:"collapse",animation:o});if(!u)return;const{drawData:f}=u,{update:g}=f,p={animation:o,stage:"expand",data:f};d.edges.forEach(v=>g.edges.set(w(v),v)),d.nodes.forEach(v=>g.nodes.set(w(v),v)),this.updateElements(g,p),yield(n=this.context.animation.animate(o,{beforeAnimate:v=>this.emit(new Pe(P.BEFORE_ANIMATE,C.EXPAND,v,f),p),afterAnimate:v=>this.emit(new Pe(P.AFTER_ANIMATE,C.EXPAND,v,f),p)},{expand:{target:t,descendants:Array.from(d.nodes).map(([,v])=>w(v)),position:c}}))===null||n===void 0?void 0:n.finished})}collapseCombo(t,e){return Zi(this,void 0,void 0,function*(){var n;const{model:s,element:r}=this.context;if(s.getAncestorsData(t,ot).some(p=>me(p)))return;const o=r.getElement(t),a=o.getComboPosition(Object.assign(Object.assign({},o.attributes),{collapsed:!0})),c=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!c)return;const{dataChanges:l,drawData:d}=c;this.markDestroyElement(d);const{update:h,remove:u}=d,f={animation:e,stage:"collapse",data:d};this.destroyElements(u,f),this.updateElements(h,f);const g=p=>Array.from(p).map(([,v])=>w(v));yield(n=this.context.animation.animate(e,{before:()=>this.emit(new Ut(P.BEFORE_DRAW,{dataChanges:l,animation:e}),f),beforeAnimate:p=>this.emit(new Pe(P.BEFORE_ANIMATE,C.COLLAPSE,p,d),f),afterAnimate:p=>this.emit(new Pe(P.AFTER_ANIMATE,C.COLLAPSE,p,d),f),after:()=>this.emit(new Ut(P.AFTER_DRAW,{dataChanges:l,animation:e}),f)},{collapse:{target:t,descendants:[...g(u.nodes),...g(u.combos)],position:a}}))===null||n===void 0?void 0:n.finished})}expandCombo(t,e){return Zi(this,void 0,void 0,function*(){var n;const{model:s}=this.context,r=qt(s.getComboData([t])[0]);this.computeStyle("expand");const o=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!o)return;const{dataChanges:a,drawData:c}=o,{add:l,update:d}=c,h={animation:e,stage:"expand",data:c,target:t};this.createElements(l,h),this.updateElements(d,h);const u=f=>Array.from(f).map(([,g])=>w(g));yield(n=this.context.animation.animate(e,{before:()=>this.emit(new Ut(P.BEFORE_DRAW,{dataChanges:a,animation:e}),h),beforeAnimate:f=>this.emit(new Pe(P.BEFORE_ANIMATE,C.EXPAND,f,c),h),afterAnimate:f=>this.emit(new Pe(P.AFTER_ANIMATE,C.EXPAND,f,c),h),after:()=>this.emit(new Ut(P.AFTER_DRAW,{dataChanges:a,animation:e}),h)},{expand:{target:t,descendants:[...u(l.nodes),...u(l.combos)],position:r}}))===null||n===void 0?void 0:n.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}const Yl=Symbol("Comlink.proxy"),J0=Symbol("Comlink.endpoint"),Ul=Symbol("Comlink.releaseProxy"),na=Symbol("Comlink.finalizer"),Ir=Symbol("Comlink.thrown"),Gl=i=>typeof i=="object"&&i!==null||typeof i=="function",tv={canHandle:i=>Gl(i)&&i[Yl],serialize(i){const{port1:t,port2:e}=new MessageChannel;return Kl(i,t),[e,[e]]},deserialize(i){return i.start(),Ql(i)}},ev={canHandle:i=>Gl(i)&&Ir in i,serialize({value:i}){let t;return i instanceof Error?t={isError:!0,value:{message:i.message,name:i.name,stack:i.stack}}:t={isError:!1,value:i},[t,[]]},deserialize(i){throw i.isError?Object.assign(new Error(i.value.message),i.value):i.value}},Xl=new Map([["proxy",tv],["throw",ev]]);function nv(i,t){for(const e of i)if(t===e||e==="*"||e instanceof RegExp&&e.test(t))return!0;return!1}function Kl(i,t=globalThis,e=["*"]){t.addEventListener("message",function n(s){if(!s||!s.data)return;if(!nv(e,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:r,type:o,path:a}=Object.assign({path:[]},s.data),c=(s.data.argumentList||[]).map(Yn);let l;try{const d=a.slice(0,-1).reduce((u,f)=>u[f],i),h=a.reduce((u,f)=>u[f],i);switch(o){case"GET":l=h;break;case"SET":d[a.slice(-1)[0]]=Yn(s.data.value),l=!0;break;case"APPLY":l=h.apply(d,c);break;case"CONSTRUCT":{const u=new h(...c);l=cv(u)}break;case"ENDPOINT":{const{port1:u,port2:f}=new MessageChannel;Kl(i,f),l=av(u,[u])}break;case"RELEASE":l=void 0;break;default:return}}catch(d){l={value:d,[Ir]:0}}Promise.resolve(l).catch(d=>({value:d,[Ir]:0})).then(d=>{const[h,u]=kr(d);t.postMessage(Object.assign(Object.assign({},h),{id:r}),u),o==="RELEASE"&&(t.removeEventListener("message",n),ql(t),na in i&&typeof i[na]=="function"&&i[na]())}).catch(d=>{const[h,u]=kr({value:new TypeError("Unserializable return value"),[Ir]:0});t.postMessage(Object.assign(Object.assign({},h),{id:r}),u)})}),t.start&&t.start()}function iv(i){return i.constructor.name==="MessagePort"}function ql(i){iv(i)&&i.close()}function Ql(i,t){const e=new Map;return i.addEventListener("message",function(s){const{data:r}=s;if(!r||!r.id)return;const o=e.get(r.id);if(o)try{o(r)}finally{e.delete(r.id)}}),ia(i,e,[],t)}function Pr(i){if(i)throw new Error("Proxy has been released and is not useable")}function Jl(i){return fi(i,new Map,{type:"RELEASE"}).then(()=>{ql(i)})}const _r=new WeakMap,Rr="FinalizationRegistry"in globalThis&&new FinalizationRegistry(i=>{const t=(_r.get(i)||0)-1;_r.set(i,t),t===0&&Jl(i)});function sv(i,t){const e=(_r.get(t)||0)+1;_r.set(t,e),Rr&&Rr.register(i,t,i)}function rv(i){Rr&&Rr.unregister(i)}function ia(i,t,e=[],n=function(){}){let s=!1;const r=new Proxy(n,{get(o,a){if(Pr(s),a===Ul)return()=>{rv(r),Jl(i),t.clear(),s=!0};if(a==="then"){if(e.length===0)return{then:()=>r};const c=fi(i,t,{type:"GET",path:e.map(l=>l.toString())}).then(Yn);return c.then.bind(c)}return ia(i,t,[...e,a])},set(o,a,c){Pr(s);const[l,d]=kr(c);return fi(i,t,{type:"SET",path:[...e,a].map(h=>h.toString()),value:l},d).then(Yn)},apply(o,a,c){Pr(s);const l=e[e.length-1];if(l===J0)return fi(i,t,{type:"ENDPOINT"}).then(Yn);if(l==="bind")return ia(i,t,e.slice(0,-1));const[d,h]=td(c);return fi(i,t,{type:"APPLY",path:e.map(u=>u.toString()),argumentList:d},h).then(Yn)},construct(o,a){Pr(s);const[c,l]=td(a);return fi(i,t,{type:"CONSTRUCT",path:e.map(d=>d.toString()),argumentList:c},l).then(Yn)}});return sv(r,i),r}function ov(i){return Array.prototype.concat.apply([],i)}function td(i){const t=i.map(kr);return[t.map(e=>e[0]),ov(t.map(e=>e[1]))]}const ed=new WeakMap;function av(i,t){return ed.set(i,t),i}function cv(i){return Object.assign(i,{[Yl]:!0})}function Xm(i,t=globalThis,e="*"){return{postMessage:(n,s)=>i.postMessage(n,e,s),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function kr(i){for(const[t,e]of Xl)if(e.canHandle(i)){const[n,s]=e.serialize(i);return[{type:"HANDLER",name:t,value:n},s]}return[{type:"RAW",value:i},ed.get(i)||[]]}function Yn(i){switch(i.type){case"HANDLER":return Xl.get(i.name).deserialize(i.value);case"RAW":return i.value}}function fi(i,t,e,n){return new Promise(s=>{const r=lv();t.set(r,s),i.start&&i.start(),i.postMessage(Object.assign({id:r},e),n)})}function lv(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class dv extends $o.Z{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=Ql(new Worker(new URL(_.p+_.u(5394),_.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var t;return(0,$.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const e=this.layout.options,{onTick:n}=e,s=(0,$._T)(e,["onTick"]),r={};Object.keys(s).forEach(l=>{(0,et.Z)(s[l])||(r[l]=s[l])});const o={layout:{id:this.layout.id,options:r,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},a=new Float32Array([0]),[c]=yield this.proxy.calculateLayout(o,[a]);return c})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[Ul]()}isRunning(){return this.running}}var nd=_(11749),gi=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})},hv=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};class uv{get presetOptions(){return{animation:!!Xe(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(t){return gi(this,void 0,void 0,function*(){var e,n,s,r;const{graph:o,model:a}=this.context,{add:c}=t;Qt(o,new Ut(P.BEFORE_LAYOUT,{type:"pre"}));const l=yield(e=this.context.layout)===null||e===void 0?void 0:e.simulate();(n=l==null?void 0:l.nodes)===null||n===void 0||n.forEach(d=>{const h=w(d),u=c.nodes.get(h);a.syncNodeLikeDatum(d),u&&Object.assign(u.style,d.style)}),(s=l==null?void 0:l.edges)===null||s===void 0||s.forEach(d=>{const h=w(d),u=c.edges.get(h);a.syncEdgeDatum(d),u&&Object.assign(u.style,d.style)}),(r=l==null?void 0:l.combos)===null||r===void 0||r.forEach(d=>{const h=w(d),u=c.combos.get(h);a.syncNodeLikeDatum(d),u&&Object.assign(u.style,d.style)}),Qt(o,new Ut(P.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t)})}postLayout(){return gi(this,arguments,void 0,function*(t=this.options){if(!t)return;const e=Array.isArray(t)?t:[t],{graph:n}=this.context;Qt(n,new Ut(P.BEFORE_LAYOUT,{type:"post"}));for(let s=0;s<e.length;s++){const r=e[s],o=this.getLayoutData(r),a=Object.assign(Object.assign({},this.presetOptions),r);Qt(n,new Ut(P.BEFORE_STAGE_LAYOUT,{options:a,index:s}));const c=yield this.stepLayout(o,a,s);Qt(n,new Ut(P.AFTER_STAGE_LAYOUT,{options:a,index:s})),r.animation||this.updateElementPosition(c,!1)}Qt(n,new Ut(P.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(t,e){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(s=>s.afterLayout(t,e))}simulate(){return gi(this,void 0,void 0,function*(){if(!this.options)return{};const t=Array.isArray(this.options)?this.options:[this.options];let e={};for(let n=0;n<t.length;n++){const s=t[n],r=this.getLayoutData(s);e=yield this.stepLayout(r,Object.assign(Object.assign(Object.assign({},this.presetOptions),s),{animation:!1}),n)}return e})}stepLayout(t,e,n){return gi(this,void 0,void 0,function*(){return qf(e)?yield this.treeLayout(t,e,n):yield this.graphLayout(t,e,n)})}graphLayout(t,e,n){return gi(this,void 0,void 0,function*(){const{animation:s,enableWorker:r,iterations:o=300}=e,a=this.initGraphLayout(e);if(!a)return{};if(this.instances[n]=a,this.instance=a,r){const l=a;return this.supervisor=new dv(l.graphData2LayoutModel(t),l.instance,{iterations:o}),Ws(yield this.supervisor.execute())}if((0,nd.h)(a))return s?yield a.execute(t,{onTick:l=>{this.updateElementPosition(l,!1)}}):(a.execute(t),a.stop(),a.tick(o));const c=yield a.execute(t);if(s){const l=this.updateElementPosition(c,s);yield l==null?void 0:l.finished}return c})}treeLayout(t,e,n){return gi(this,void 0,void 0,function*(){const{type:s,animation:r}=e,o=te("layout",s);if(!o)return{};const{nodes:a=[],edges:c=[]}=t,l=new No.k({nodes:a.map(g=>({id:w(g),data:g.data||{}})),edges:c.map(g=>({id:w(g),source:g.source,target:g.target,data:g.data||{}}))});K0(l);const d={nodes:[],edges:[]},h={nodes:[],edges:[]};l.getRoots(jt).forEach(g=>{ni(g,b=>{b.children=l.getSuccessors(b.id)},b=>l.getSuccessors(b.id),"TB");const p=o(g,e),{x:v,y,z:m=0}=p;ni(p,b=>{const{id:E,x:S,y:O,z:A=0}=b;d.nodes.push({id:E,style:{x:v,y,z:m}}),h.nodes.push({id:E,style:{x:S,y:O,z:A}})},b=>b.children,"TB")});const f=this.inferTreeLayoutOffset(h);if(id(h,f),r){id(d,f),this.updateElementPosition(d,!1);const g=this.updateElementPosition(h,r);yield g==null?void 0:g.finished}return h})}inferTreeLayoutOffset(t){var e;let[n,s]=[1/0,-1/0],[r,o]=[1/0,-1/0];(e=t.nodes)===null||e===void 0||e.forEach(p=>{const{x:v=0,y=0}=p.style||{};n=Math.min(n,v),s=Math.max(s,v),r=Math.min(r,y),o=Math.max(o,y)});const{canvas:a}=this.context,c=a.getSize(),[l,d]=a.getCanvasByViewport([0,0]),[h,u]=a.getCanvasByViewport(c);if(n>=l&&s<=h&&r>=d&&o<=u)return[0,0];const f=(l+h)/2,g=(d+u)/2;return[f-(n+s)/2,g-(r+o)/2]}stopLayout(){this.instance&&(0,nd.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:s=!1}=t,{nodes:r,edges:o,combos:a}=this.context.model.getData(),{element:c,model:l}=this.context,d=p=>c.getElement(p),h=n?p=>{var v;return!s&&(((v=p.style)===null||v===void 0?void 0:v.visibility)==="hidden"||l.getAncestorsData(p.id,jt).some(me)||l.getAncestorsData(p.id,ot).some(me))?!1:e(p)}:p=>{const v=w(p),y=d(v);return!y||Ps(y)?!1:e(p)},u=r.filter(h),f=new Map(u.map(p=>[w(p),p]));a.forEach(p=>f.set(w(p),p));const g=o.filter(({source:p,target:v})=>f.has(p)&&f.has(v));return{nodes:u,edges:g,combos:a}}initGraphLayout(t){var e;const{element:n,viewport:s}=this.context,{type:r,enableWorker:o,animation:a,iterations:c}=t,l=hv(t,["type","enableWorker","animation","iterations"]),[d,h]=s.getCanvasSize(),u=[d/2,h/2],f=(e=t==null?void 0:t.nodeSize)!==null&&e!==void 0?e:m=>{const b=n==null?void 0:n.getElement(m.id);return b?b.attributes.size:n==null?void 0:n.getElementComputedStyle("node",m).size},g=te("layout",r);if(!g)return F.warn(`The layout of ${r} is not registered.`);const p=Object.getPrototypeOf(g.prototype)===$s.prototype?g:Jf(g,this.context),v=new p(this.context),y={nodeSize:f,width:d,height:h,center:u};switch(v.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:d/2,y:h/2,z:0}});break;default:break}return(0,kn.Z)(v.options,y,l),v}updateElementPosition(t,e){const{model:n,element:s}=this.context;return s?(n.updateData(t),s.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},(t=this.supervisor)===null||t===void 0||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const id=(i,t)=>{var e;const[n,s]=t;(e=i.nodes)===null||e===void 0||e.forEach(r=>{if(r.style){const{x:o=0,y:a=0}=r.style;r.style.x=o+n,r.style.y=a+s}else r.style={x:n,y:s}})};function fv(i){return[gv].reduce((e,n)=>n(e),i)}function gv(i){return!i.layout||Array.isArray(i.layout)||"preLayout"in i.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(i.layout.type)&&(i.layout.preLayout=!0),i}class pv extends oo{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;F.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const n=this.extensions.find(s=>s.type===t);if(n)return this.extensionMap[n.key]}}const jr=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class vv extends oo{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...jr.slice(0,jr.length-1),...t,jr[jr.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var Vi=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class yv{get padding(){return je(this.context.options.padding)}get paddingOffset(){const[t,e,n,s]=this.padding,[r,o,a]=[(s-e)/2,(t-n)/2,0];return[r,o,a]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,n]=this.paddingOffset,{zoom:s,rotation:r,x:o=e,y:a=n}=t.options;this.transform({mode:"absolute",scale:s,translate:[o,a],rotate:r},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{const r=Object.entries(t.getLayers()).filter(([a])=>!["main"].includes(a)).map(([,a])=>a.getCamera()),o=e[n];if(typeof o=="function")return(...a)=>{const c=o.apply(e,a);return r.forEach(l=>{l[n].apply(l,a)}),c}}})}createLandmark(t){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,t)}getAnimation(t){const e=Xe(this.context.options,t);return e?(0,Li.Z)(Object.assign({},e),["easing","duration"]):!1}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:n,translate:s=[]}=t,r=this.getZoom(),o=e.getPosition(),a=e.getFocalPoint(),[c,l]=this.getCanvasCenter(),[d=0,h=0,u=0]=s,f=$e([-d,-h,-u],r);return n==="relative"?{position:at(o,f),focalPoint:at(a,f)}:{position:at([c,l,o[2]],f),focalPoint:at([c,l,a[2]],f)}}getRotateOptions(t){const{mode:e,rotate:n=0}=t;return{roll:e==="relative"?this.camera.getRoll()+n:n}}getZoomOptions(t){const{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:s,scale:r=1}=t;return(0,Ri.Z)(s==="relative"?n*r:r,...e)}transform(t,e){return Vi(this,void 0,void 0,function*(){const{graph:n}=this.context,{translate:s,rotate:r,scale:o,origin:a}=t;this.cancelAnimation();const c=this.getAnimation(e);if(Qt(n,new Lr(P.BEFORE_TRANSFORM,t)),!r&&o&&!s&&a&&!c){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),a),Qt(n,new Lr(P.AFTER_TRANSFORM,t));return}const l={};if(s&&Object.assign(l,this.getTranslateOptions(t)),(0,Rt.Z)(r)&&Object.assign(l,this.getRotateOptions(t)),(0,Rt.Z)(o)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),c)return Qt(n,new Pe(P.BEFORE_ANIMATE,C.TRANSFORM,null,t)),new Promise(d=>{this.transformResolver=d,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},c),{onfinish:()=>{Qt(n,new Pe(P.AFTER_ANIMATE,C.TRANSFORM,null,t)),Qt(n,new Lr(P.AFTER_TRANSFORM,t)),this.transformResolver=void 0,d()}}))});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),Qt(n,new Lr(P.AFTER_TRANSFORM,t))})}fitView(t,e){return Vi(this,void 0,void 0,function*(){const[n,s,r,o]=this.padding,{when:a="always",direction:c="both"}=t||{},[l,d]=this.context.canvas.getSize(),h=l-o-s,u=d-n-r,f=this.context.canvas.getBounds(),g=this.getBBoxInViewport(f),[p,v]=fn(g),y=c==="x"&&p>=h||c==="y"&&v>=u||c==="both"&&p>=h&&v>=u;if(a==="overflow"&&!y)return yield this.fitCenter({animation:e});const m=h/p,b=u/v,E=c==="x"?m:c==="y"?b:Math.min(m,b),S=this.getAnimation(e);yield this.transform({mode:"relative",scale:E,translate:at(Mt(this.getCanvasCenter(),this.getBBoxInViewport(f).center),$e(this.paddingOffset,E))},S)})}fitCenter(t){return Vi(this,void 0,void 0,function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t){return Vi(this,arguments,void 0,function*(e,n={}){const{element:s}=this.context;if(!s)return;const r=a=>n.shapes?a.getShape(n.shapes).getRenderBounds():a.getRenderBounds(),o=bi(e.map(a=>r(s.getElement(a))));yield this.focus(o,n)})}focus(t,e){return Vi(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(t.center),s=e.position||this.getCanvasCenter(),r=Mt(s,n);yield this.transform({mode:"relative",translate:at(r,this.paddingOffset)},e.animation)})}getBBoxInViewport(t){const{min:e,max:n}=t,{graph:s}=this.context,[r,o]=s.getViewportByCanvas(e),[a,c]=s.getViewportByCanvas(n),l=new M.mN;return l.setMinMax([r,o,0],[a,c,0]),l}isInViewport(t,e=!1,n=0){const{graph:s}=this.context,r=this.getCanvasSize(),[o,a]=s.getCanvasByViewport([0,0]),[c,l]=s.getCanvasByViewport(r);let d=new M.mN;return d.setMinMax([o,a,0],[c,l,0]),n&&(d=pn(d,n)),Jn(t)?Be(t,d):e?md(t,d):d.intersects(t)}cancelAnimation(){var t,e;!((t=this.camera.landmarks)===null||t===void 0)&&t.length&&this.camera.cancelLandmarkAnimation(),(e=this.transformResolver)===null||e===void 0||e.call(this)}}var Nt=function(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{l(n.next(d))}catch(h){o(h)}}function c(d){try{l(n.throw(d))}catch(h){o(h)}}function l(d){d.done?r(d.value):s(d.value).then(a,c)}l((n=n.apply(i,t||[])).next())})};class Br extends $o.Z{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new q0},this.isCollapsingExpanding=!1,this.onResize=(0,zs.Z)(()=>{this.resize()},300),this._setOptions(Object.assign({},Br.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&((e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,fv(t)),e){const{data:u}=t;u&&this.addData(u);return}const{behaviors:n,combo:s,data:r,edge:o,layout:a,node:c,plugins:l,theme:d,transforms:h}=t;n&&this.setBehaviors(n),r&&this.setData(r),c&&this.setNode(c),o&&this.setEdge(o),s&&this.setCombo(s),a&&this.setLayout(a),d&&this.setTheme(d),l&&this.setPlugins(l),h&&this.setTransforms(h)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=(0,et.Z)(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=(0,et.Z)(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=(0,et.Z)(t)?t(this.getBehaviors()):t,(e=this.context.behavior)===null||e===void 0||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=(0,et.Z)(t)?t(this.getPlugins()):t,(e=this.context.plugin)===null||e===void 0||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=(0,et.Z)(t)?t(this.getTransforms()):t,(e=this.context.transform)===null||e===void 0||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(e=>this.context.model.getElementDataById(e)):this.context.model.getElementDataById(t)}getNodeData(t){return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData((0,et.Z)(t)?t(this.getData()):t)}addData(t){this.context.model.addData((0,et.Z)(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData((0,et.Z)(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData((0,et.Z)(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData((0,et.Z)(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData((0,et.Z)(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData((0,et.Z)(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData((0,et.Z)(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData((0,et.Z)(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData((0,et.Z)(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData((0,et.Z)(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData((0,et.Z)(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData((0,et.Z)(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return Nt(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;const{container:e="container",width:n,height:s,renderer:r,cursor:o,background:a,canvas:c,devicePixelRatio:l=(t=globalThis.devicePixelRatio)!==null&&t!==void 0?t:1}=this.options;if(e instanceof Fl)this.context.canvas=e,o&&e.setCursor(o),r&&e.setRenderer(r),yield e.ready;else{const d=(0,ti.Z)(e)?document.getElementById(e):e,h=Zl(d);this.emit(P.BEFORE_CANVAS_INIT,{container:d,width:n,height:s});const u=Object.assign(Object.assign({},c),{container:d,width:n||h[0],height:s||h[1],background:a,renderer:r,cursor:o,devicePixelRatio:l}),f=new Fl(u);this.context.canvas=f,yield f.ready,this.emit(P.AFTER_CANVAS_INIT,{canvas:f})}})}updateCanvas(t){var e,n;const{renderer:s,cursor:r,height:o,width:a}=t,c=this.context.canvas;c&&(s&&(this.emit(P.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),c.setRenderer(s),this.emit(P.AFTER_RENDERER_CHANGE,{renderer:s})),r&&c.setCursor(r),((0,Rt.Z)(a)||(0,Rt.Z)(o))&&this.setSize((e=a!=null?a:this.options.width)!==null&&e!==void 0?e:0,(n=o!=null?o:this.options.height)!==null&&n!==void 0?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new Y0(this.context)),this.context.plugin||(this.context.plugin=new pv(this.context)),this.context.viewport||(this.context.viewport=new yv(this.context)),this.context.transform||(this.context.transform=new vv(this.context)),this.context.element||(this.context.element=new Q0(this.context)),this.context.animation||(this.context.animation=new H0(this.context)),this.context.layout||(this.context.layout=new uv(this.context)),this.context.behavior||(this.context.behavior=new U0(this.context))}prepare(){return Nt(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(D("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return Nt(this,void 0,void 0,function*(){if(yield this.prepare(),Qt(this,new Ut(P.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&Qf(this.options.layout)){const t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}this.rendered=!0,Qt(this,new Ut(P.AFTER_RENDER))})}draw(){return Nt(this,void 0,void 0,function*(){var t;yield this.prepare(),yield(t=this.context.element.draw())===null||t===void 0?void 0:t.finished})}layout(t){return Nt(this,void 0,void 0,function*(){yield this.context.layout.postLayout(t)})}stopLayout(){this.context.layout.stopLayout()}clear(){return Nt(this,void 0,void 0,function*(){const{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),e==null||e.clear()})}destroy(){var t;Qt(this,new Ut(P.BEFORE_DESTROY));const{layout:e,animation:n,element:s,model:r,canvas:o,behavior:a,plugin:c}=this.context;c==null||c.destroy(),a==null||a.destroy(),e==null||e.destroy(),n==null||n.destroy(),s==null||s.destroy(),r.destroy(),o==null||o.destroy(),this.options={},this.context={},this.off(),(t=globalThis.removeEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,Qt(this,new Ut(P.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var n;const s=Zl((n=this.context.canvas)===null||n===void 0?void 0:n.getContainer()),r=[t||s[0],e||s[1]];if(!this.context.canvas)return;const o=this.context.canvas.getSize();(0,Y.Z)(r,o)||(Qt(this,new Ut(P.BEFORE_SIZE_CHANGE,{size:r})),this.context.canvas.resize(...r),Qt(this,new Ut(P.AFTER_SIZE_CHANGE,{size:r})))}fitView(t,e){return Nt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.fitView(t,e)})}fitCenter(t){return Nt(this,void 0,void 0,function*(){var e;yield(e=this.context.viewport)===null||e===void 0?void 0:e.fitCenter({animation:t})})}autoFit(){return Nt(this,void 0,void 0,function*(){const{autoFit:t}=this.context.options;if(t)if((0,ti.Z)(t))t==="view"?yield this.fitView():t==="center"&&(yield this.fitCenter());else{const{type:e,animation:n}=t;e==="view"?yield this.fitView(t.options,n):e==="center"&&(yield this.fitCenter(n))}})}focusElement(t,e){return Nt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.focusElements(Array.isArray(t)?t:[t],{animation:e})})}zoomBy(t,e,n){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)})}zoomTo(t,e,n){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)})}rotateTo(t,e,n){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return Nt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return Mt([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return Nt(this,arguments,void 0,function*(n,s,r=!0){var o,a;const[c,l]=(0,j.Z)(n)?[n,(o=s)!==null&&o!==void 0?o:!0]:[{[n]:s},r];Object.entries(c).forEach(([d,h])=>this.context.model.translateNodeLikeBy(d,h)),yield(a=this.context.element.draw({animation:l,stage:"translate"}))===null||a===void 0?void 0:a.finished})}translateElementTo(t,e){return Nt(this,arguments,void 0,function*(n,s,r=!0){var o,a;const[c,l]=(0,j.Z)(n)?[n,(o=s)!==null&&o!==void 0?o:!0]:[{[n]:s},r];Object.entries(c).forEach(([d,h])=>this.context.model.translateNodeLikeTo(d,h)),yield(a=this.context.element.draw({animation:l,stage:"translate"}))===null||a===void 0?void 0:a.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return(0,_o.Z)(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return Nt(this,arguments,void 0,function*(n,s,r=!0){var o,a;const[c,l]=(0,j.Z)(n)?[n,(o=s)!==null&&o!==void 0?o:!0]:[{[n]:s},r],d={nodes:[],edges:[],combos:[]};Object.entries(c).forEach(([f,g])=>{const p=this.getElementType(f);d[`${p}s`].push({id:f,style:{visibility:g}})});const{model:h,element:u}=this.context;h.preventUpdateNodeLikeHierarchy(()=>{h.updateData(d)}),yield(a=u.draw({animation:l,stage:"visibility"}))===null||a===void 0?void 0:a.finished})}showElement(t,e){return Nt(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(s=>[s,"visible"])),e)})}hideElement(t,e){return Nt(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(s=>[s,"hidden"])),e)})}getElementVisibility(t){var e,n;const s=this.context.element.getElement(t);return(n=(e=s==null?void 0:s.style)===null||e===void 0?void 0:e.visibility)!==null&&n!==void 0?n:"visible"}setElementZIndex(t,e){return Nt(this,void 0,void 0,function*(){var n;const s={nodes:[],edges:[],combos:[]},r=(0,j.Z)(t)?t:{[t]:e};Object.entries(r).forEach(([c,l])=>{const d=this.getElementType(c);s[`${d}s`].push({id:c,style:{zIndex:l}})});const{model:o,element:a}=this.context;o.preventUpdateNodeLikeHierarchy(()=>o.updateData(s)),yield(n=a.draw({animation:!1,stage:"zIndex"}))===null||n===void 0?void 0:n.finished})}frontElement(t){return Nt(this,void 0,void 0,function*(){const e=Array.isArray(t)?t:[t],{model:n}=this.context,s={};e.map(r=>{const o=n.getFrontZIndex(r);if(n.getElementType(r)==="combo"){const c=n.getAncestorsData(r,ot).at(-1)||this.getComboData(r),l=[c,...n.getDescendantsData(w(c))],d=o-Vl(c);l.forEach(u=>{s[w(u)]=this.getElementZIndex(w(u))+d});const{internal:h}=Co(l.map(w),u=>n.getRelatedEdgesData(u));h.forEach(u=>{const f=w(u);s[f]=this.getElementZIndex(f)+d})}else s[r]=o}),yield this.setElementZIndex(s)})}getElementZIndex(t){return Vl(this.context.model.getElementDataById(t))}setElementState(t,e){return Nt(this,arguments,void 0,function*(n,s,r=!0){var o,a;const[c,l]=(0,j.Z)(n)?[n,(o=s)!==null&&o!==void 0?o:!0]:[{[n]:s},r],d=u=>u?Array.isArray(u)?u:[u]:[],h={nodes:[],edges:[],combos:[]};Object.entries(c).forEach(([u,f])=>{const g=this.getElementType(u);h[`${g}s`].push({id:u,states:d(f)})}),this.updateData(h),yield(a=this.context.element.draw({animation:l,stage:"state"}))===null||a===void 0?void 0:a.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return Nt(this,arguments,void 0,function*(e,n=!0){const{model:s,element:r}=this.context;if(me(s.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const o=s.getElementType(e);yield this.frontElement(e),this.isCollapsingExpanding=!0,this.setElementCollapsibility(e,!0),o==="node"?yield r.collapseNode(e,n):o==="combo"&&(yield r.collapseCombo(e,!!n.animation)),this.isCollapsingExpanding=!1})}expandElement(t){return Nt(this,arguments,void 0,function*(e,n=!0){const{model:s,element:r}=this.context;if(!me(s.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const o=s.getElementType(e);this.isCollapsingExpanding=!0,this.setElementCollapsibility(e,!1),o==="node"?yield r.expandNode(e,n):o==="combo"&&(yield r.expandCombo(e,!!n.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){const n=this.getElementType(t);n==="node"?this.updateNodeData([{id:t,style:{collapsed:e}}]):n==="combo"&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return Nt(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}Br.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var mv=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(e[n[s]]=i[n[s]]);return e};function Km(i,t){const{getNodeData:e=(a,c)=>{if(a.depth=c,!a.children)return a;const{children:l}=a,d=mv(a,["children"]);return Object.assign(Object.assign({},d),{children:l.map(h=>h.id)})},getEdgeData:n=(a,c)=>({source:a.id,target:c.id}),getChildren:s=a=>a.children||[]}=t||{},r=[],o=[];return dfs(i,(a,c)=>{r.push(e(a,c));const l=s(a);for(const d of l)o.push(n(a,d))},a=>s(a),"TB"),{nodes:r,edges:o}}class bv extends Dn{beforeDraw(t){const{add:e,update:n}=t,{model:s}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach(([,r])=>{sd(s,r)}),t}}const sd=(i,t)=>{const{source:e,target:n}=t,s=i.getElementDataById(e),r=i.getElementDataById(n),o=Nc(s,h=>i.getParentData(h,ot)),a=Nc(r,h=>i.getParentData(h,ot)),c=w(o),l=w(a),d={sourceNode:c,targetNode:l};return t.style?Object.assign(t.style,d):t.style=d,t},Ev=(i,t,e)=>{const[n,s]=t,[r,o]=e;if(s===n)return r;const a=(i-n)/(s-n);return r+a*(o-r)},xv=(i,t,e)=>{const[n,s]=t,[r,o]=e,a=Math.log(i-n+1)/Math.log(s-n+1);return r+a*(o-r)},Sv=(i,t,e,n=2)=>{const[s,r]=t,[o,a]=e,c=Math.pow((i-s)/(r-s),n);return o+c*(a-o)},Ov=(i,t,e)=>{const[n,s]=t,[r,o]=e,a=Math.sqrt((i-n)/(s-n));return r+a*(o-r)};class zr extends Dn{constructor(t,e){super(t,(0,kn.Z)({},zr.defaultOptions,e)),this.assignSizeByCentrality=(n,s,r,o,a,c)=>{const l=[s,r],d=[o[0],a[0]],h=[o[1],a[1]],u=[o[2],a[2]],f=(g,p)=>{if(typeof c=="function")return c(g,l,p);switch(c){case"linear":return Ev(g,l,p);case"log":return xv(g,l,p);case"pow":return Sv(g,l,p,2);case"sqrt":return Ov(g,l,p);default:return p[0]}};return[f(n,d),f(n,h),f(n,u)]}}beforeDraw(t){const{model:e}=this.context,n=e.getNodeData(),s=De(this.options.maxSize),r=De(this.options.minSize),o=this.getCentralities(this.options.centrality),a=o.size>0?Math.max(...o.values()):0,c=o.size>0?Math.min(...o.values()):0;return n.forEach(l=>{var d;const h=this.assignSizeByCentrality(o.get(w(l))||0,c,a,r,s,this.options.scale),u=(d=this.context.element)===null||d===void 0?void 0:d.getElement(w(l)),f={size:h};this.assignLabelStyle(f,h,l,u),(!u||!Mr(f,u.attributes))&&Te(t,u?"update":"add","node",(0,kn.Z)(l,{style:f}),!0)}),t}assignLabelStyle(t,e,n,s){var r;const o=s?s.config.style:(r=this.context.element)===null||r===void 0?void 0:r.getElementComputedStyle("node",n);if(Object.assign(t,(0,Li.Z)(o,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const a=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:a,labelLineHeight:a+yd(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,n){const s=Math.min(...t)/2,[r,o]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e];return Math.min(o,Math.max(s,r))}getCentralities(t){const{model:e}=this.context,n=e.getData();if(typeof t=="function")return t(n);const s=e.getRelatedEdgesData.bind(e);return Ya(n,s,t)}}zr.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class Fr extends Dn{constructor(t,e){super(t,Object.assign({},Fr.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=qt(this.ref),{graph:n,model:s}=this.context;(t=s.getData().nodes)===null||t===void 0||t.forEach(o=>{var a;if(w(o)===w(this.ref))return;const c=Xa(Mt(qt(o),e)),l=Math.abs(c)>Math.PI/2,d=!o.children||o.children.length===0,h=w(o),u=(a=this.context.element)===null||a===void 0?void 0:a.getElement(h);if(!u||!u.isVisible())return;const f=De(n.getElementRenderStyle(h).size)[0]/2,g=(d?1:-1)*(f+this.options.offset),p=[["translate",g*Math.cos(c),g*Math.sin(c)],["rotate",l?(0,M.BV)(c)+180:(0,M.BV)(c)]];s.updateNodeData([{id:w(o),style:{labelTextAlign:l===d?"right":"left",labelTextBaseline:"middle",labelTransform:p}}])}),n.draw()}}Fr.defaultOptions={offset:5};const wv="quadratic",rd=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class $r extends Dn{constructor(t,e){super(t,Object.assign({},$r.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=n=>{const{add:{edges:s},update:{nodes:r,edges:o,combos:a},remove:{edges:c}}=n,{model:l}=this.context,d=new Map,h=(g,p)=>{l.getRelatedEdgesData(p).forEach(y=>!d.has(w(y))&&d.set(w(y),y))};r.forEach(h),a.forEach(h);const u=g=>{const p=l.getEdgeData().map(y=>sd(l,y));Cv(g,p,!0).forEach(y=>!d.has(w(y))&&d.set(w(y),y))};if(c.size&&c.forEach(u),s.size&&s.forEach(u),o.size){const g=hl(Wo(l.getChanges())).update.edges;o.forEach(p=>{var v;u(p);const y=(v=g.find(m=>w(m.value)===w(p)))===null||v===void 0?void 0:v.original;y&&!sa(p,y)&&u(y)})}nn(this.options.edges)||d.forEach((g,p)=>!this.options.edges.includes(p)&&d.delete(p));const f=l.getEdgeData().map(w);return new Map([...d].sort((g,p)=>f.indexOf(g[0])-f.indexOf(p[0])))},this.applyBundlingStyle=(n,s,r)=>{const{edgeMap:o,reverses:a}=od(s);o.forEach(c=>{c.forEach((l,d,h)=>{var u;const f=h.length,g=l.style||{};if(l.source===l.target){const y=rd.length;g.loopPlacement=rd[d%y],g.loopDist=Math.floor(d/y)*r+50}else if(f===1)g.curveOffset=0;else{const y=(d%2===0?1:-1)*(a[`${l.source}|${l.target}|${d}`]?-1:1);g.curveOffset=f%2===1?y*Math.ceil(d/2)*r*2:y*(Math.floor(d/2)*r*2+r)}const p=Object.assign(l,{type:wv,style:g}),v=(u=this.context.element)===null||u===void 0?void 0:u.getElement(w(l));(!v||!Mr(p.style,v.attributes))&&Te(n,v?"update":"add","edge",p,!0)})})},this.resetEdgeStyle=n=>{const s=n.style||{},r=this.cacheMergeStyle.get(w(n))||{};return Object.keys(r).forEach(o=>{(0,Y.Z)(s[o],r[o])&&(n[o]?s[o]=n[o]:delete s[o])}),Object.assign(n,{style:s})},this.applyMergingStyle=(n,s)=>{const{edgeMap:r,reverses:o}=od(s);r.forEach(a=>{var c;if(a.length===1){const d=a[0],h=(c=this.context.element)===null||c===void 0?void 0:c.getElement(w(d)),u=this.resetEdgeStyle(d);(!h||!Mr(u,h.attributes))&&Te(n,h?"update":"add","edge",u);return}const l=a.map(({source:d,target:h,style:u={}},f)=>{const{startArrow:g,endArrow:p}=u,v={},[y,m]=o[`${d}|${h}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,Fo.Z)(g)&&(v[y]=g),(0,Fo.Z)(p)&&(v[m]=p),v}).reduce((d,h)=>Object.assign(Object.assign({},d),h),{});a.forEach((d,h,u)=>{var f;if(h!==0){Te(n,"remove","edge",d);return}const g=Object.assign({},(0,et.Z)(this.options.style)?this.options.style(u):this.options.style,{childrenData:u});this.cacheMergeStyle.set(w(d),g);const p=Object.assign(Object.assign({},d),{type:"line",style:Object.assign(Object.assign(Object.assign({},d.style),l),g)}),v=(f=this.context.element)===null||f===void 0?void 0:f.getElement(w(d));(!v||!Mr(p.style,v.attributes))&&Te(n,v?"update":"add","edge",p,!0)})})}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return e.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}$r.defaultOptions={mode:"bundle",distance:15};const od=i=>{const t=new Map,e=new Set,n={},s=new Map;for(const[r,o]of i){if(e.has(r))continue;const{source:a,target:c}=o,l=`${a}-${c}`;t.has(l)||(t.set(l,[]),s.set(l,new Set));const d=t.get(l),h=s.get(l);d&&h&&!h.has(r)&&(d.push(o),h.add(r),e.add(r));for(const[u,f]of i)if(!(e.has(u)||u===r)&&sa(o,f)){const g=t.get(l),p=s.get(l);g&&p&&!p.has(u)&&(g.push(f),p.add(u),a===f.target&&c===f.source&&(n[`${f.source}|${f.target}|${g.length-1}`]=!0),e.add(u))}}return{edgeMap:t,reverses:n}},Cv=(i,t,e)=>t.filter(n=>(e||w(n)!==w(i))&&sa(n,i)),sa=(i,t)=>{const{sourceNode:e,targetNode:n}=i.style||{},{sourceNode:s,targetNode:r}=t.style||{};return e===s&&n===r||e===r&&n===s};class Dv extends Dn{beforeDraw(t,e){const{stage:n}=e;if(n==="visibility")return t;const{model:s}=this.context,{update:{nodes:r,edges:o,combos:a}}=t,c=(l,d)=>{s.getRelatedEdgesData(d).forEach(u=>!o.has(w(u))&&o.set(w(u),u))};return r.forEach(c),a.forEach(c),t}}const Tv={animation:{"combo-collapse":mi,"combo-expand":Hr,"node-collapse":Kn,"node-expand":Ui,"path-in":yi,"path-out":Vr,fade:on,translate:ke},behavior:{"brush-select":Ci,"click-select":ps,"collapse-expand":_s,"create-edge":Bs,"drag-canvas":Fs,"drag-element-force":eg,"drag-element":_i,"fix-element-size":Zs,"focus-element":Vs,"hover-activate":Hs,"lasso-select":ig,"auto-adapt-label":ls,"optimize-viewport-transform":Ys,"scroll-canvas":Us,"zoom-canvas":Gs},combo:{circle:Ku,rect:qu},edge:{cubic:Fn,line:Ls,polyline:Ns,quadratic:Is,"cubic-horizontal":Ts,"cubic-radial":Ms,"cubic-vertical":As},layout:{"antv-dagre":sg.b,"combo-combined":og.u,"compact-box":Xs.compactBox,"d3-force":cg.j,"force-atlas2":dg.E,circular:rg.S,concentric:ag.W,dagre:lg.V,dendrogram:Xs.dendrogram,fishbone:Ks,force:hg.y,fruchterman:ug.O,grid:fg.M,indented:Xs.indented,mds:gg.A,mindmap:Xs.mindmap,radial:pg.D,random:vg._,snake:qs},node:{circle:zn,diamond:$u,ellipse:xs,hexagon:Yu,html:Ss,image:Os,rect:Gu,star:Xu,donut:bs,triangle:ws},palette:{spectral:Eg,tableau:xg,oranges:Sg,greens:Og,blues:wg},theme:{dark:I0,light:P0},plugin:{"bubble-sets":ar,"edge-bundling":lr,"edge-filter-lens":dr,"grid-line":fr,background:Qs,contextmenu:cr,fisheye:hr,fullscreen:ur,history:gr,hull:mr,legend:br,minimap:Er,snapline:xr,timebar:wr,toolbar:Cr,tooltip:Dr,watermark:Tr},transform:{"arrange-draw-order":_0,"collapse-expand-combo":R0,"collapse-expand-node":k0,"get-edge-actual-ends":bv,"map-node-size":zr,"place-radial-labels":Fr,"process-parallel-edges":$r,"update-related-edges":Dv},shape:{circle:M.Cd,ellipse:M.Pj,group:M.ZA,html:M.k9,image:yo,line:M.x1,path:M.y$,polygon:M.mg,polyline:M.aH,rect:M.UL,text:M.xv,label:bn,badge:ii}};function Mv(){Object.entries(Tv).forEach(([i,t])=>{Object.entries(t).forEach(([e,n])=>{j0(i,e,n)})})}Mv();const qm={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"}},74355:function(Xn){(function(_,W){Xn.exports=W()})(typeof self!="undefined"?self:this,function(){return function(dt){var _={};function W(M){if(_[M])return _[M].exports;var V=_[M]={i:M,l:!1,exports:{}};return dt[M].call(V.exports,V,V.exports,W),V.l=!0,V.exports}return W.m=dt,W.c=_,W.d=function(M,V,X){W.o(M,V)||Object.defineProperty(M,V,{configurable:!1,enumerable:!0,get:X})},W.n=function(M){var V=M&&M.__esModule?function(){return M.default}:function(){return M};return W.d(V,"a",V),V},W.o=function(M,V){return Object.prototype.hasOwnProperty.call(M,V)},W.p="",W(W.s=5)}([function(dt,_){function W(M,V,X,Y){return Y===void 0&&(Y="height"),X==="center"?(M[Y]+V[Y])/2:M.height}dt.exports={assign:Object.assign,getHeight:W}},function(dt,_,W){var M=W(3),V=function(){function X(j,k){k===void 0&&(k={});var I=this;I.options=k,I.rootNode=M(j,k)}var Y=X.prototype;return Y.execute=function(){throw new Error("please override this method")},X}();dt.exports=V},function(dt,_,W){var M=W(4),V=["LR","RL","TB","BT","H","V"],X=["LR","RL","H"],Y=function(L){return X.indexOf(L)>-1},j=V[0];dt.exports=function(I,L,T){var C=L.direction||j;if(L.isHorizontal=Y(C),C&&V.indexOf(C)===-1)throw new TypeError("Invalid direction: "+C);if(C===V[0])T(I,L);else if(C===V[1])T(I,L),I.right2left();else if(C===V[2])T(I,L);else if(C===V[3])T(I,L),I.bottom2top();else if(C===V[4]||C===V[5]){var R=M(I,L),Z=R.left,x=R.right;T(Z,L),T(x,L),L.isHorizontal?Z.right2left():Z.bottom2top(),x.translate(Z.x-x.x,Z.y-x.y),I.x=Z.x,I.y=x.y;var rt=I.getBoundingBox();L.isHorizontal?rt.top<0&&I.translate(0,-rt.top):rt.left<0&&I.translate(-rt.left,0)}var wt=L.fixedRoot;return wt===void 0&&(wt=!0),wt&&I.translate(-(I.x+I.width/2+I.hgap),-(I.y+I.height/2+I.vgap)),k(I,L),I};function k(I,L){if(L.radial){var T=L.isHorizontal?["x","y"]:["y","x"],C=T[0],R=T[1],Z={x:1/0,y:1/0},x={x:-1/0,y:-1/0},rt=0;I.DFTraverse(function(pt){rt++;var St=pt.x,ot=pt.y;Z.x=Math.min(Z.x,St),Z.y=Math.min(Z.y,ot),x.x=Math.max(x.x,St),x.y=Math.max(x.y,ot)});var wt=x[R]-Z[R];if(wt===0)return;var P=Math.PI*2/rt;I.DFTraverse(function(pt){var St=(pt[R]-Z[R])/wt*(Math.PI*2-P)+P,ot=pt[C]-I[C];pt.x=Math.cos(St)*ot,pt.y=Math.sin(St)*ot})}}},function(dt,_,W){var M=W(0),V=18,X=V*2,Y=V,j={getId:function(T){return T.id||T.name},getPreH:function(T){return T.preH||0},getPreV:function(T){return T.preV||0},getHGap:function(T){return T.hgap||Y},getVGap:function(T){return T.vgap||Y},getChildren:function(T){return T.children},getHeight:function(T){return T.height||X},getWidth:function(T){var C=T.label||" ";return T.width||C.split("").length*V}};function k(L,T){var C=this;if(C.vgap=C.hgap=0,L instanceof k)return L;C.data=L;var R=T.getHGap(L),Z=T.getVGap(L);return C.preH=T.getPreH(L),C.preV=T.getPreV(L),C.width=T.getWidth(L),C.height=T.getHeight(L),C.width+=C.preH,C.height+=C.preV,C.id=T.getId(L),C.x=C.y=0,C.depth=0,C.children||(C.children=[]),C.addGap(R,Z),C}M.assign(k.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(T,C){var R=this;R.hgap+=T,R.vgap+=C,R.width+=2*T,R.height+=2*C},eachNode:function(T){for(var C=this,R=[C],Z;Z=R.shift();)T(Z),R=Z.children.concat(R)},DFTraverse:function(T){this.eachNode(T)},BFTraverse:function(T){for(var C=this,R=[C],Z;Z=R.shift();)T(Z),R=R.concat(Z.children)},getBoundingBox:function(){var T={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(C){T.left=Math.min(T.left,C.x),T.top=Math.min(T.top,C.y),T.width=Math.max(T.width,C.x+C.width),T.height=Math.max(T.height,C.y+C.height)}),T},translate:function(T,C){T===void 0&&(T=0),C===void 0&&(C=0),this.eachNode(function(R){R.x+=T,R.y+=C,R.x+=R.preH,R.y+=R.preV})},right2left:function(){var T=this,C=T.getBoundingBox();T.eachNode(function(R){R.x=R.x-(R.x-C.left)*2-R.width}),T.translate(C.width,0)},bottom2top:function(){var T=this,C=T.getBoundingBox();T.eachNode(function(R){R.y=R.y-(R.y-C.top)*2-R.height}),T.translate(0,C.height)}});function I(L,T,C){T===void 0&&(T={}),T=M.assign({},j,T);var R=new k(L,T),Z=[R],x;if(!C&&!L.collapsed){for(;x=Z.shift();)if(!x.data.collapsed){var rt=T.getChildren(x.data),wt=rt?rt.length:0;if(x.children=new Array(wt),rt&&wt)for(var P=0;P<wt;P++){var pt=new k(rt[P],T);x.children[P]=pt,Z.push(pt),pt.parent=x,pt.depth=x.depth+1}}}return R}dt.exports=I},function(dt,_,W){var M=W(3);dt.exports=function(V,X){for(var Y=M(V.data,X,!0),j=M(V.data,X,!0),k=V.children.length,I=Math.round(k/2),L=X.getSide||function(Z,x){return x<I?"right":"left"},T=0;T<k;T++){var C=V.children[T],R=L(C,T);R==="right"?j.children.push(C):Y.children.push(C)}return Y.eachNode(function(Z){Z.isRoot()||(Z.side="left")}),j.eachNode(function(Z){Z.isRoot()||(Z.side="right")}),{left:Y,right:j}}},function(dt,_,W){var M={compactBox:W(6),dendrogram:W(8),indented:W(10),mindmap:W(12)};dt.exports=M},function(dt,_,W){function M(C,R){C.prototype=Object.create(R.prototype),C.prototype.constructor=C,V(C,R)}function V(C,R){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,x){return Z.__proto__=x,Z},V(C,R)}var X=W(1),Y=W(7),j=W(2),k=W(0),I=function(C){function R(){return C.apply(this,arguments)||this}M(R,C);var Z=R.prototype;return Z.execute=function(){var rt=this;return j(rt.rootNode,rt.options,Y)},R}(X),L={};function T(C,R){return R=k.assign({},L,R),new I(C,R).execute()}dt.exports=T},function(dt,_){function W(k,I,L,T){T===void 0&&(T=[]);var C=this;C.w=k||0,C.h=I||0,C.y=L||0,C.x=0,C.c=T||[],C.cs=T.length,C.prelim=0,C.mod=0,C.shift=0,C.change=0,C.tl=null,C.tr=null,C.el=null,C.er=null,C.msel=0,C.mser=0}W.fromNode=function(k,I){if(!k)return null;var L=[];return k.children.forEach(function(T){L.push(W.fromNode(T,I))}),I?new W(k.height,k.width,k.x,L):new W(k.width,k.height,k.y,L)};function M(k,I,L){L?k.y+=I:k.x+=I,k.children.forEach(function(T){M(T,I,L)})}function V(k,I){var L=I?k.y:k.x;return k.children.forEach(function(T){L=Math.min(V(T,I),L)}),L}function X(k,I){var L=V(k,I);M(k,-L,I)}function Y(k,I,L){L?I.y=k.x:I.x=k.x,k.c.forEach(function(T,C){Y(T,I.children[C],L)})}function j(k,I,L){L===void 0&&(L=0),I?(k.x=L,L+=k.width):(k.y=L,L+=k.height),k.children.forEach(function(T){j(T,I,L)})}dt.exports=function(k,I){I===void 0&&(I={});var L=I.isHorizontal;function T(B){if(B.cs===0){C(B);return}T(B.c[0]);for(var st=Oe(wt(B.c[0].el),0,null),lt=1;lt<B.cs;++lt){T(B.c[lt]);var D=wt(B.c[lt].er);R(B,lt,st),st=Oe(D,lt,st)}St(B),C(B)}function C(B){B.cs===0?(B.el=B,B.er=B,B.msel=B.mser=0):(B.el=B.c[0].el,B.msel=B.c[0].msel,B.er=B.c[B.cs-1].er,B.mser=B.c[B.cs-1].mser)}function R(B,st,lt){for(var D=B.c[st-1],F=D.mod,q=B.c[st],K=q.mod;D!==null&&q!==null;){wt(D)>lt.low&&(lt=lt.nxt);var ft=F+D.prelim+D.w-(K+q.prelim);ft>0&&(K+=ft,Z(B,st,lt.index,ft));var ye=wt(D),Xe=wt(q);ye<=Xe&&(D=rt(D),D!==null&&(F+=D.mod)),ye>=Xe&&(q=x(q),q!==null&&(K+=q.mod))}!D&&q?P(B,st,q,K):D&&!q&&pt(B,st,D,F)}function Z(B,st,lt,D){B.c[st].mod+=D,B.c[st].msel+=D,B.c[st].mser+=D,jt(B,st,lt,D)}function x(B){return B.cs===0?B.tl:B.c[0]}function rt(B){return B.cs===0?B.tr:B.c[B.cs-1]}function wt(B){return B.y+B.h}function P(B,st,lt,D){var F=B.c[0].el;F.tl=lt;var q=D-lt.mod-B.c[0].msel;F.mod+=q,F.prelim-=q,B.c[0].el=B.c[st].el,B.c[0].msel=B.c[st].msel}function pt(B,st,lt,D){var F=B.c[st].er;F.tr=lt;var q=D-lt.mod-B.c[st].mser;F.mod+=q,F.prelim-=q,B.c[st].er=B.c[st-1].er,B.c[st].mser=B.c[st-1].mser}function St(B){B.prelim=(B.c[0].prelim+B.c[0].mod+B.c[B.cs-1].mod+B.c[B.cs-1].prelim+B.c[B.cs-1].w)/2-B.w/2}function ot(B,st){st+=B.mod,B.x=B.prelim+st,Le(B);for(var lt=0;lt<B.cs;lt++)ot(B.c[lt],st)}function jt(B,st,lt,D){if(lt!==st-1){var F=st-lt;B.c[lt+1].shift+=D/F,B.c[st].shift-=D/F,B.c[st].change-=D-D/F}}function Le(B){for(var st=0,lt=0,D=0;D<B.cs;D++)st+=B.c[D].shift,lt+=st+B.c[D].change,B.c[D].mod+=lt}function Oe(B,st,lt){for(;lt!==null&&B>=lt.low;)lt=lt.nxt;return{low:B,index:st,nxt:lt}}j(k,L);var te=W.fromNode(k,L);return T(te),ot(te,0),Y(te,k,L),X(k,L),k}},function(dt,_,W){function M(C,R){C.prototype=Object.create(R.prototype),C.prototype.constructor=C,V(C,R)}function V(C,R){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,x){return Z.__proto__=x,Z},V(C,R)}var X=W(1),Y=W(9),j=W(2),k=W(0),I=function(C){function R(){return C.apply(this,arguments)||this}M(R,C);var Z=R.prototype;return Z.execute=function(){var rt=this;return rt.rootNode.width=0,j(rt.rootNode,rt.options,Y)},R}(X),L={};function T(C,R){return R=k.assign({},L,R),new I(C,R).execute()}dt.exports=T},function(dt,_,W){var M=W(0);function V(j,k){j===void 0&&(j=0),k===void 0&&(k=[]);var I=this;I.x=I.y=0,I.leftChild=I.rightChild=null,I.height=0,I.children=k}var X={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function Y(j,k,I){I?(k.x=j.x,k.y=j.y):(k.x=j.y,k.y=j.x),j.children.forEach(function(L,T){Y(L,k.children[T],I)})}dt.exports=function(j,k){k===void 0&&(k={}),k=M.assign({},X,k);var I=0;function L(x){if(!x)return null;x.width=0,x.depth&&x.depth>I&&(I=x.depth);var rt=x.children,wt=rt.length,P=new V(x.height,[]);return rt.forEach(function(pt,St){var ot=L(pt);P.children.push(ot),St===0&&(P.leftChild=ot),St===wt-1&&(P.rightChild=ot)}),P.originNode=x,P.isLeaf=x.isLeaf(),P}function T(x){if(x.isLeaf||x.children.length===0)x.drawingDepth=I;else{var rt=x.children.map(function(P){return T(P)}),wt=Math.min.apply(null,rt);x.drawingDepth=wt-1}return x.drawingDepth}var C;function R(x){x.x=x.drawingDepth*k.rankSep,x.isLeaf?(x.y=0,C&&(x.y=C.y+C.height+k.nodeSep,x.originNode.parent!==C.originNode.parent&&(x.y+=k.subTreeSep)),C=x):(x.children.forEach(function(rt){R(rt)}),x.y=(x.leftChild.y+x.rightChild.y)/2)}var Z=L(j);return T(Z),R(Z),Y(Z,j,k.isHorizontal),j}},function(dt,_,W){function M(Z,x){Z.prototype=Object.create(x.prototype),Z.prototype.constructor=Z,V(Z,x)}function V(Z,x){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(rt,wt){return rt.__proto__=wt,rt},V(Z,x)}var X=W(1),Y=W(11),j=W(4),k=W(0),I=["LR","RL","H"],L=I[0],T=function(Z){function x(){return Z.apply(this,arguments)||this}M(x,Z);var rt=x.prototype;return rt.execute=function(){var P=this,pt=P.options,St=P.rootNode;pt.isHorizontal=!0;var ot=pt.indent,jt=ot===void 0?20:ot,Le=pt.dropCap,Oe=Le===void 0?!0:Le,te=pt.direction,B=te===void 0?L:te,st=pt.align;if(B&&I.indexOf(B)===-1)throw new TypeError("Invalid direction: "+B);if(B===I[0])Y(St,jt,Oe,st);else if(B===I[1])Y(St,jt,Oe,st),St.right2left();else if(B===I[2]){var lt=j(St,pt),D=lt.left,F=lt.right;Y(D,jt,Oe,st),D.right2left(),Y(F,jt,Oe,st);var q=D.getBoundingBox();F.translate(q.width,0),St.x=F.x-St.width/2}return St},x}(X),C={};function R(Z,x){return x=k.assign({},C,x),new T(Z,x).execute()}dt.exports=R},function(dt,_,W){var M=W(0);function V(X,Y,j,k,I){var L=(typeof j=="function"?j(X):j)*X.depth;if(!k)try{if(X.id===X.parent.children[0].id){X.x+=L,X.y=Y?Y.y:0;return}}catch(R){}if(X.x+=L,Y){if(X.y=Y.y+M.getHeight(Y,X,I),Y.parent&&X.parent.id!==Y.parent.id){var T=Y.parent,C=T.y+M.getHeight(T,X,I);X.y=C>X.y?C:X.y}}else X.y=0}dt.exports=function(X,Y,j,k){var I=null;X.eachNode(function(L){V(L,I,Y,j,k),I=L})}},function(dt,_,W){function M(C,R){C.prototype=Object.create(R.prototype),C.prototype.constructor=C,V(C,R)}function V(C,R){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,x){return Z.__proto__=x,Z},V(C,R)}var X=W(1),Y=W(13),j=W(2),k=W(0),I=function(C){function R(){return C.apply(this,arguments)||this}M(R,C);var Z=R.prototype;return Z.execute=function(){var rt=this;return j(rt.rootNode,rt.options,Y)},R}(X),L={};function T(C,R){return R=k.assign({},L,R),new I(C,R).execute()}dt.exports=T},function(dt,_,W){var M=W(0);function V(j,k){var I=0;return j.children.length?j.children.forEach(function(L){I+=V(L,k)}):I=j.height,j._subTreeSep=k.getSubTreeSep(j.data),j.totalHeight=Math.max(j.height,I)+2*j._subTreeSep,j.totalHeight}function X(j){var k=j.children,I=k.length;if(I){k.forEach(function(x){X(x)});var L=k[0],T=k[I-1],C=T.y-L.y+T.height,R=0;if(k.forEach(function(x){R+=x.totalHeight}),C>j.height)j.y=L.y+C/2-j.height/2;else if(k.length!==1||j.height>R){var Z=j.y+(j.height-C)/2-L.y;k.forEach(function(x){x.translate(0,Z)})}else j.y=(L.y+L.height/2+T.y+T.height/2)/2-j.height/2}}var Y={getSubTreeSep:function(){return 0}};dt.exports=function(j,k){k===void 0&&(k={}),k=M.assign({},Y,k),j.parent={x:0,width:0,height:0,y:0},j.BFTraverse(function(I){I.x=I.parent.x+I.parent.width}),j.parent=null,V(j,k),j.startY=0,j.y=j.totalHeight/2-j.height/2,j.eachNode(function(I){var L=I.children,T=L.length;if(T){var C=L[0];if(C.startY=I.startY+I._subTreeSep,T===1)C.y=I.y+I.height/2-C.height/2;else{C.y=C.startY+C.totalHeight/2-C.height/2;for(var R=1;R<T;R++){var Z=L[R];Z.startY=L[R-1].startY+L[R-1].totalHeight,Z.y=Z.startY+Z.totalHeight/2-Z.height/2}}}}),X(j)}}])})},78581:function(Xn,dt,_){"use strict";_.d(dt,{Z:function(){return lt}});var W=_(75271),M=_(82187),V=_.n(M),X=_(94212),Y=_(13817),j=_(55921),k=_(25519),I=_(24410),L=_(83509);const T=D=>{const{componentCls:F,calc:q}=D;return{[F]:Object.assign(Object.assign({},(0,k.Wf)(D)),{margin:0,padding:0,listStyle:"none",[`${F}-item`]:{position:"relative",margin:0,paddingBottom:D.itemPaddingBottom,fontSize:D.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:D.itemHeadSize,insetInlineStart:q(q(D.itemHeadSize).sub(D.tailWidth)).div(2).equal(),height:`calc(100% - ${(0,j.bf)(D.itemHeadSize)})`,borderInlineStart:`${(0,j.bf)(D.tailWidth)} ${D.lineType} ${D.tailColor}`},"&-pending":{[`${F}-item-head`]:{fontSize:D.fontSizeSM,backgroundColor:"transparent"},[`${F}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:D.itemHeadSize,height:D.itemHeadSize,backgroundColor:D.dotBg,border:`${(0,j.bf)(D.dotBorderWidth)} ${D.lineType} transparent`,borderRadius:"50%","&-blue":{color:D.colorPrimary,borderColor:D.colorPrimary},"&-red":{color:D.colorError,borderColor:D.colorError},"&-green":{color:D.colorSuccess,borderColor:D.colorSuccess},"&-gray":{color:D.colorTextDisabled,borderColor:D.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:q(D.itemHeadSize).div(2).equal(),insetInlineStart:q(D.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:D.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:q(q(D.fontSize).mul(D.lineHeight).sub(D.fontSize)).mul(-1).add(D.lineWidth).equal(),marginInlineStart:q(D.margin).add(D.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${F}-item-tail`]:{display:"none"},[`> ${F}-item-content`]:{minHeight:q(D.controlHeightLG).mul(1.2).equal()}}},[`&${F}-alternate,
        &${F}-right,
        &${F}-label`]:{[`${F}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:q(D.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:q(D.tailWidth).div(2).equal()}},"&-left":{[`${F}-item-content`]:{insetInlineStart:`calc(50% - ${(0,j.bf)(D.marginXXS)})`,width:`calc(50% - ${(0,j.bf)(D.marginSM)})`,textAlign:"start"}},"&-right":{[`${F}-item-content`]:{width:`calc(50% - ${(0,j.bf)(D.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${F}-right`]:{[`${F}-item-right`]:{[`${F}-item-tail,
            ${F}-item-head,
            ${F}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(0,j.bf)(q(q(D.itemHeadSize).add(D.tailWidth)).div(2).equal())})`},[`${F}-item-content`]:{width:`calc(100% - ${(0,j.bf)(q(D.itemHeadSize).add(D.marginXS).equal())})`}}},[`&${F}-pending
        ${F}-item-last
        ${F}-item-tail`]:{display:"block",height:`calc(100% - ${(0,j.bf)(D.margin)})`,borderInlineStart:`${(0,j.bf)(D.tailWidth)} dotted ${D.tailColor}`},[`&${F}-reverse
        ${F}-item-last
        ${F}-item-tail`]:{display:"none"},[`&${F}-reverse ${F}-item-pending`]:{[`${F}-item-tail`]:{insetBlockStart:D.margin,display:"block",height:`calc(100% - ${(0,j.bf)(D.margin)})`,borderInlineStart:`${(0,j.bf)(D.tailWidth)} dotted ${D.tailColor}`},[`${F}-item-content`]:{minHeight:q(D.controlHeightLG).mul(1.2).equal()}},[`&${F}-label`]:{[`${F}-item-label`]:{position:"absolute",insetBlockStart:q(q(D.fontSize).mul(D.lineHeight).sub(D.fontSize)).mul(-1).add(D.tailWidth).equal(),width:`calc(50% - ${(0,j.bf)(D.marginSM)})`,textAlign:"end"},[`${F}-item-right`]:{[`${F}-item-label`]:{insetInlineStart:`calc(50% + ${(0,j.bf)(D.marginSM)})`,width:`calc(50% - ${(0,j.bf)(D.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${F}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},C=D=>({tailColor:D.colorSplit,tailWidth:D.lineWidthBold,dotBorderWidth:D.wireframe?D.lineWidthBold:D.lineWidth*3,dotBg:D.colorBgContainer,itemPaddingBottom:D.padding*1.25});var R=(0,I.I$)("Timeline",D=>{const F=(0,L.IX)(D,{itemHeadSize:10,customHeadPaddingVertical:D.paddingXXS,paddingInlineEnd:2});return[T(F)]},C),Z=function(D,F){var q={};for(var K in D)Object.prototype.hasOwnProperty.call(D,K)&&F.indexOf(K)<0&&(q[K]=D[K]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ft=0,K=Object.getOwnPropertySymbols(D);ft<K.length;ft++)F.indexOf(K[ft])<0&&Object.prototype.propertyIsEnumerable.call(D,K[ft])&&(q[K[ft]]=D[K[ft]]);return q},rt=D=>{var{prefixCls:F,className:q,color:K="blue",dot:ft,pending:ye=!1,position:Xe,label:Ke,children:Nn}=D,Rt=Z(D,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:qe}=W.useContext(X.E_),Xt=qe("timeline",F),In=V()(`${Xt}-item`,{[`${Xt}-item-pending`]:ye},q),on=/blue|red|green|gray/.test(K||"")?void 0:K,ke=V()(`${Xt}-item-head`,{[`${Xt}-item-head-custom`]:!!ft,[`${Xt}-item-head-${K}`]:!on});return W.createElement("li",Object.assign({},Rt,{className:In}),Ke&&W.createElement("div",{className:`${Xt}-item-label`},Ke),W.createElement("div",{className:`${Xt}-item-tail`}),W.createElement("div",{className:ke,style:{borderColor:on,color:on}},ft),W.createElement("div",{className:`${Xt}-item-content`},Nn))},wt=_(35979),P=_(79400),pt=function(D,F){var q={};for(var K in D)Object.prototype.hasOwnProperty.call(D,K)&&F.indexOf(K)<0&&(q[K]=D[K]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ft=0,K=Object.getOwnPropertySymbols(D);ft<K.length;ft++)F.indexOf(K[ft])<0&&Object.prototype.propertyIsEnumerable.call(D,K[ft])&&(q[K[ft]]=D[K[ft]]);return q},ot=D=>{var{prefixCls:F,className:q,pending:K=!1,children:ft,items:ye,rootClassName:Xe,reverse:Ke=!1,direction:Nn,hashId:Rt,pendingDot:qe,mode:Xt=""}=D,In=pt(D,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const on=(Kt,et)=>Xt==="alternate"?Kt==="right"?`${F}-item-right`:Kt==="left"?`${F}-item-left`:et%2===0?`${F}-item-left`:`${F}-item-right`:Xt==="left"?`${F}-item-left`:Xt==="right"?`${F}-item-right`:Kt==="right"?`${F}-item-right`:"",ke=(0,wt.Z)(ye||[]),Kn=typeof K=="boolean"?null:K;K&&ke.push({pending:!!K,dot:qe||W.createElement(P.Z,null),children:Kn}),Ke&&ke.reverse();const Ui=ke.length,yi=`${F}-item-last`,Vr=ke.filter(Kt=>!!Kt).map((Kt,et)=>{var qn;const Yr=et===Ui-2?yi:"",Ur=et===Ui-1?yi:"",{className:Qn}=Kt,Gi=pt(Kt,["className"]);return W.createElement(rt,Object.assign({},Gi,{className:V()([Qn,!Ke&&K?Yr:Ur,on((qn=Kt==null?void 0:Kt.position)!==null&&qn!==void 0?qn:"",et)]),key:(Kt==null?void 0:Kt.key)||et}))}),mi=ke.some(Kt=>!!(Kt!=null&&Kt.label)),Hr=V()(F,{[`${F}-pending`]:!!K,[`${F}-reverse`]:!!Ke,[`${F}-${Xt}`]:!!Xt&&!mi,[`${F}-label`]:mi,[`${F}-rtl`]:Nn==="rtl"},q,Xe,Rt);return W.createElement("ul",Object.assign({},In,{className:Hr}),Vr)},jt=_(81626);function Le(D,F){return D&&Array.isArray(D)?D:(0,jt.Z)(F).map(q=>{var K,ft;return Object.assign({children:(ft=(K=q==null?void 0:q.props)===null||K===void 0?void 0:K.children)!==null&&ft!==void 0?ft:""},q.props)})}var Oe=Le,te=function(D,F){var q={};for(var K in D)Object.prototype.hasOwnProperty.call(D,K)&&F.indexOf(K)<0&&(q[K]=D[K]);if(D!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ft=0,K=Object.getOwnPropertySymbols(D);ft<K.length;ft++)F.indexOf(K[ft])<0&&Object.prototype.propertyIsEnumerable.call(D,K[ft])&&(q[K[ft]]=D[K[ft]]);return q};const B=D=>{const{getPrefixCls:F,direction:q,timeline:K}=W.useContext(X.E_),{prefixCls:ft,children:ye,items:Xe,className:Ke,style:Nn}=D,Rt=te(D,["prefixCls","children","items","className","style"]),qe=F("timeline",ft),Xt=(0,Y.Z)(qe),[In,on,ke]=R(qe,Xt),Kn=Oe(Xe,ye);return In(W.createElement(ot,Object.assign({},Rt,{className:V()(K==null?void 0:K.className,Ke,ke,Xt),style:Object.assign(Object.assign({},K==null?void 0:K.style),Nn),prefixCls:qe,direction:q,items:Kn,hashId:on})))};B.Item=rt;var st=B,lt=st}}]);
