"use strict";(self.webpackChunkcognik_web_app=self.webpackChunkcognik_web_app||[]).push([[8609],{71769:function(ae,I,r){r.r(I),r.d(I,{default:function(){return ge}});var R=r(26068),o=r.n(R),O=r(90228),l=r.n(O),Z=r(87999),d=r.n(Z),_=r(48305),v=r.n(_),C=r(86487);function M(D,S){return F.apply(this,arguments)}function F(){return F=d()(l()().mark(function D(S,L){return l()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,C.request)("/api/public/v1/builder/job/submit",o()({data:S,method:"POST"},L||{})));case 1:case"end":return m.stop()}},D)})),F.apply(this,arguments)}function w(D,S){return j.apply(this,arguments)}function j(){return j=d()(l()().mark(function D(S,L){return l()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,C.request)("/api/v1/datas/getLlmSelect",o()({method:"GET",params:o()({},S)},L||{})).then(function(A){return{data:A.result}}));case 1:case"end":return m.stop()}},D)})),j.apply(this,arguments)}var N=r(67709),E=r(66918),p=r(14378),c=r(37520),h=r(15837),T=r(91592),i=r(45343),y=r(29808),se=r(16331),le=r(69230),ie=r(84336),oe=r(77758),W=r(68658),G=r(83616),H=r(71158),V=r(78422),ce=r(34937),x=r(75271),pe=r(26551),de=(0,pe.kc)(function(){return{card:{marginBottom:"24px"},result:{maxWidth:"560px",margin:"0 auto",padding:"24px 0 8px"}}}),me=de,fe=r(39530),ve=r(13564),u=r(52676),he=function(){var S=me(),L=S.styles,K=(0,C.useSearchParams)(),m=v()(K,2),A=m[0],Oe=m[1],Ee=le.ZP.useMessage(),X=v()(Ee,2),Q=X[0],be=X[1],Ce=(0,x.useState)([]),Y=v()(Ce,2),k=Y[0],Fe=Y[1],je=(0,x.useState)(!1),q=v()(je,2),ye=q[0],ee=q[1],Se=(0,x.useState)({dataSourceConfig_structure:"unstructuredContent",type:"FILE_EXTRACT",splitConfig_splitLength:2e3,receiverMode:"alipay",jobName:""}),re=v()(Se,2),g=re[0],z=re[1],Be=(0,x.useState)(0),ue=v()(Be,2),_e=ue[0],xe=ue[1],De=(0,x.useState)([]),te=v()(De,2),Pe=te[0],Te=te[1],ne=(0,x.useRef)(),Ae=ie.Z.useToken(),J=Ae.token,Ue=J.colorBgContainer,$e=J.colorFillAlter,Ie=J.borderRadiusLG,Le={background:$e,borderRadius:Ie,border:"none"};return(0,u.jsxs)(N._z,{content:"\u5C06\u4E00\u4E2A\u5197\u957F\u6216\u7528\u6237\u4E0D\u719F\u6089\u7684\u8868\u5355\u4EFB\u52A1\u5206\u6210\u591A\u4E2A\u6B65\u9AA4\uFF0C\u6307\u5BFC\u7528\u6237\u5B8C\u6210\u3002",children:[be,(0,u.jsx)(oe.Z,{variant:"outlined",children:(0,u.jsxs)(E.L0,{formRef:ne,current:_e,onCurrentChange:xe,submitter:{render:function(t,a){return t.step===1?[(0,u.jsx)(W.ZP,{loading:ye,type:"primary",onClick:function(){var e,n,b={projectId:Number.parseInt(A.get("projectId")||"0"),jobName:g.jobName,type:g.type,createUser:"openspg",lifeCycle:"ONCE",action:"UPSERT",computingConf:"",dependence:"INDEPENDENT",cron:"0 0 0 * * ?",fileUrl:(e=g.fileUrl[0])===null||e===void 0||(e=e.response)===null||e===void 0?void 0:e.result,dataSourceType:(n=g.fileUrl[0])===null||n===void 0||(n=n.name)===null||n===void 0||(n=n.split("."))===null||n===void 0||(n=n.pop())===null||n===void 0?void 0:n.toUpperCase(),extension:JSON.stringify({splitConfig:{splitLength:g.splitConfig_splitLength,semanticSplit:!!g.splitConfig_semanticSplit}})};ee(!0),(0,fe.Eq)(b).then(function(U){U.success&&(Fe(U.result.map(function(B,$){return{id:$,content:B}})),ee(!1))})},children:"\u9884\u89C8\u62BD\u53D6\u7ED3\u679C"},"preview"),(0,u.jsx)(W.ZP,{onClick:function(){var e;return(e=t.onPre)===null||e===void 0?void 0:e.call(t)},children:"\u4E0A\u4E00\u6B65"},"pre"),(0,u.jsx)(W.ZP,{type:"primary",onClick:function(){var e;return(e=t.onSubmit)===null||e===void 0?void 0:e.call(t)},children:"\u4E0B\u4E00\u6B65"},"goToTree")]:a}},onFinish:function(){var f=d()(l()().mark(function t(a){var s,e,n,b,U,B,$;return l()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return U={jobName:a.jobName,type:a.type,lifeCycle:"ONCE",action:"UPSERT",projectId:Number.parseInt(A.get("projectId")||"0"),createUser:"openspg",dataSourceType:(s=a.fileUrl[0])===null||s===void 0||(s=s.name)===null||s===void 0||(s=s.split("."))===null||s===void 0||(s=s.pop())===null||s===void 0?void 0:s.toUpperCase(),fileUrl:(e=a.fileUrl[0])===null||e===void 0||(e=e.response)===null||e===void 0?void 0:e.result,extension:JSON.stringify({dataSourceConfig:{columns:[],type:"UPLOAD",fileName:(n=a.fileUrl[0])===null||n===void 0?void 0:n.name,fileUrl:(b=a.fileUrl[0])===null||b===void 0||(b=b.response)===null||b===void 0?void 0:b.result,ignoreHeader:!0,structure:!1},splitConfig:{splitLength:a.splitConfig_splitLength,semanticSplit:!!a.splitConfig_semanticSplit},extractConfig:{llm:JSON.stringify(Pe.find(function(Re){return Re.llm_id===a.extractConfig_llm})||""),llmPrompt:"",autoSchema:!0,autoWrite:!0}})},P.next=3,M(U);case 3:return B=P.sent,B.success?(($=ne.current)===null||$===void 0||$.resetFields(),Q.success("\u521B\u5EFA\u6210\u529F")):Q.error((0,u.jsxs)("div",{style:{maxWidth:"300px"},children:[(0,u.jsx)(G.Z.Title,{level:3,children:B.errorCode}),(0,u.jsx)(G.Z.Paragraph,{copyable:!0,ellipsis:{rows:5},children:B.errorMessage})]})),P.abrupt("return",B.success);case 6:case"end":return P.stop()}},t)}));return function(t){return f.apply(this,arguments)}}(),children:[(0,u.jsxs)(E.L0.StepForm,{title:"\u57FA\u7840\u914D\u7F6E",initialValues:g,onFinish:function(){var f=d()(l()().mark(function t(a){return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return z(function(n){return o()(o()({},n),a)}),e.abrupt("return",!0);case 2:case"end":return e.stop()}},t)}));return function(t){return f.apply(this,arguments)}}(),children:[(0,u.jsx)(p.Z,{label:"\u77E5\u8BC6\u540D\u79F0",name:"jobName",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u77E5\u8BC6\u540D\u79F0"}],placeholder:"\u8BF7\u8F93\u5165\u77E5\u8BC6\u540D\u79F0"}),(0,u.jsx)(c.Z.Group,{name:"type",label:"\u6570\u636E\u6E90",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"}],options:[{label:"\u672C\u5730\u6587\u4EF6",value:"FILE_EXTRACT"},{label:"\u8BED\u96C0\u6587\u6863/\u77E5\u8BC6\u5E93",value:"YUQUE_EXTRACT"},{label:"\u6279\u91CF\u6570\u636E",value:"BATCH"},{label:"\u5B9E\u65F6\u6570\u636E",value:"STREAM"}]}),(0,u.jsx)(c.Z.Group,{fieldProps:{style:{display:"flex",flexDirection:"column",gap:8}},name:"dataSourceConfig_structure",label:"\u5185\u5BB9\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5185\u5BB9\u7C7B\u578B"}],options:[{label:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("b",{children:"\u7ED3\u6784\u5316\u5185\u5BB9"}),"-\u8868\u683C\u5F62\u5F0F\u5185\u5BB9\uFF0C \u65E0\u9700\u62BD\u53D6\uFF0C \u53EF\u76F4\u63A5\u4E0E\u77E5\u8BC6\u6A21\u578B\u6620\u5C04\u5E76\u5BFC\u5165\u6570\u636E"]}),value:"structuredContent"},{label:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("b",{children:"\u975E\u7ED3\u6784\u5316\u5185\u5BB9"}),"-\u5185\u5BB9\u65E0\u660E\u786E\u7ED3\u6784\uFF0C \u9700\u5927\u6A21\u578B\u62BD\u53D6"]}),value:"unstructuredContent"}]}),(0,u.jsx)(h.Z,{label:"\u4E0A\u4F20\u6587\u4EF6",name:"fileUrl",action:"/api/public/v1/reasoner/dialog/uploadFile",fieldProps:{maxCount:1,showUploadList:{extra:function(t){var a=t.size,s=a===void 0?0:a;return(0,u.jsxs)("span",{style:{color:"#cccccc"},children:["(",(s/1024/1024).toFixed(2),"MB)"]})},showDownloadIcon:!0,showRemoveIcon:!0}},rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u6587\u4EF6"}]}),(0,u.jsxs)(G.Z.Text,{type:"secondary",children:["\u652F\u6301\u62D3\u5C55\u540D:.txt\uFF0C.csv\uFF0C.pdf\uFF0C.md\uFF0C.json\uFF0C.doc\uFF0C.docx",(0,u.jsx)("br",{})," \u6CE8\u610F: \u5355\u6B21\u4EC5\u652F\u6301\u4E0A\u4F201\u4E2A\u6587\u4EF6\uFF0C\u5355\u4E2A\u6587\u4EF6\u5927\u5C0F\u5728200MB\u4EE5\u5185"]})]}),(0,u.jsx)(E.L0.StepForm,{initialValues:g,title:"\u5206\u6BB5\u914D\u7F6E/\u6620\u5C04\u914D\u7F6E",onFinish:function(){var f=d()(l()().mark(function t(a){return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return z(function(n){return o()(o()({},n),a)}),e.abrupt("return",!0);case 2:case"end":return e.stop()}},t)}));return function(t){return f.apply(this,arguments)}}(),children:(0,u.jsxs)(H.Z,{children:[(0,u.jsxs)(H.Z,{vertical:!0,children:[(0,u.jsx)(T.Z,{label:"\u5206\u6BB5\u6700\u5927\u957F\u5EA6",name:"splitConfig_splitLength",min:100,fieldProps:{precision:0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u6BB5\u6700\u5927\u957F\u5EA6"}]}),(0,u.jsx)(i.Z.Group,{name:"splitConfig_semanticSplit",layout:"vertical",label:"\u5206\u6BB5\u5904\u7406",options:[{label:"\u6839\u636E\u6587\u6863\u8BED\u4E49\u5207\u5206\u6587\u6863\uFF08\u6309\u8BED\u4E49\u5207\u5206\u53EF\u80FD\u8017\u65F6\u8F83\u957F\uFF0C\u6BB5\u843D\u957F\u5EA6\u53EF\u80FD\u5C0F\u4E8E\u5206\u6BB5\u6700\u5927\u957F\u5EA6\uFF09",value:"1"}]})]}),k&&k.length>0&&(0,u.jsx)(V.Z,{style:{maxWidth:"50%"},pagination:{pageSize:5},size:"small",header:!1,footer:!1,bordered:!0,dataSource:k,renderItem:function(t){return(0,u.jsx)(V.Z.Item,{children:(0,u.jsx)(ce.Z,{bordered:!1,defaultActiveKey:["1"],expandIcon:function(s){var e=s.isActive;return(0,u.jsx)(ve.Z,{rotate:e?90:0})},style:{background:Ue,width:"100%"},items:[{key:"item-"+t.id,label:"\u5206\u6BB5"+t.id,children:(0,u.jsx)("p",{children:t.content}),style:Le}]})})}})]})}),(0,u.jsxs)(E.L0.StepForm,{initialValues:g,title:"\u62BD\u53D6\u914D\u7F6E/\u5BFC\u5165\u914D\u7F6E",onFinish:function(){var f=d()(l()().mark(function t(a){return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return z(function(n){return o()(o()({},n),a)}),e.abrupt("return",!0);case 2:case"end":return e.stop()}},t)}));return function(t){return f.apply(this,arguments)}}(),children:[(0,u.jsx)(y.Z,{name:"extractConfig_llm",label:"\u62BD\u53D6\u6A21\u578B",request:d()(l()().mark(function f(){var t,a;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=A.get("projectId"),t){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,w({projectId:Number.parseInt(t)});case 5:return a=e.sent,Te(a.data),e.abrupt("return",a.data.map(function(n){return{label:n.model+" ("+n.desc+")",value:n.llm_id}}));case 8:case"end":return e.stop()}},f)})),placeholder:"\u8BF7\u9009\u62E9\u62BD\u53D6\u6A21\u578B",rules:[{required:!0,message:"Please select your country!"}]}),(0,u.jsx)(se.Z,{name:"computingConf",label:"\u811A\u672C\u914D\u7F6E",placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u914D\u7F6E"})]})]})})]})},ge=he},39530:function(ae,I,r){r.d(I,{Eq:function(){return M},Ij:function(){return w},J1:function(){return N},nR:function(){return v}});var R=r(90228),o=r.n(R),O=r(26068),l=r.n(O),Z=r(87999),d=r.n(Z),_=r(86487);function v(p,c){return C.apply(this,arguments)}function C(){return C=d()(o()().mark(function p(c,h){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,_.request)("/api/public/v1/builder/job/get",l()({method:"GET",params:l()({},c)},h||{})).then(function(y){return{data:y.result}}));case 1:case"end":return i.stop()}},p)})),C.apply(this,arguments)}function M(p,c){return F.apply(this,arguments)}function F(){return F=d()(o()().mark(function p(c,h){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,_.request)("/api/public/v1/builder/job/split/preview",l()({data:c,method:"POST"},h||{})));case 1:case"end":return i.stop()}},p)})),F.apply(this,arguments)}function w(p,c){return j.apply(this,arguments)}function j(){return j=d()(o()().mark(function p(c,h){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,_.request)("/api/public/v1/builder/job/schema/diff",l()({data:c,method:"POST"},h||{})).then(function(y){return{data:y.result}}));case 1:case"end":return i.stop()}},p)})),j.apply(this,arguments)}function N(p,c){return E.apply(this,arguments)}function E(){return E=d()(o()().mark(function p(c,h){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,_.request)("/api/v1/schemas/graph/".concat(c.projectId),l()({method:"GET",params:l()({},c)},h||{})).then(function(y){return{data:y.result}}));case 1:case"end":return i.stop()}},p)})),E.apply(this,arguments)}}}]);
