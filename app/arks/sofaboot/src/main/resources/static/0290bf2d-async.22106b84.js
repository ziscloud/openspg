(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_open-semantic-graph"]||[]).push([["0290bf2d"],{"0b69d691":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{getEntityDetail:function(){return a;},getEnumValues:function(){return l;},getLlmSelect:function(){return o;},getOneHopGraph:function(){return i;},getSampleData:function(){return u;},search:function(){return d;}});var r=n("05ecbb5b");async function a(e,t){return(0,r.request)("/v1/datas/getEntityDetail",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}});}async function l(e,t){let{name:n}=e;return(0,r.request)(`/v1/datas/getEnumValues/${n}`,{method:"GET",params:{...e},...t||{}});}async function o(e,t){return(0,r.request)("/v1/datas/getLlmSelect",{method:"GET",params:{...e},...t||{}});}async function i(e,t){return(0,r.request)("/v1/datas/getOneHopGraph",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}});}async function u(e,t){return(0,r.request)("/v1/datas/getSampleData",{method:"GET",params:{...e},...t||{}});}async function d(e,t){return(0,r.request)("/v1/datas/search",{method:"GET",params:{...e},...t||{}});}},"1a998156":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.e(t,{CONSTRAINT_TYPE:function(){return o;},INFO_COLUMN:function(){return r;},RELATION_CATEGORY:function(){return i;},RELATION_DIRECTION:function(){return l;},RULE_TYPE:function(){return a;},baseSchemePropertyNameMap:function(){return g;},infoColumnMapping:function(){return m;},relationDirectionMapping:function(){return y;},ruleTypeMapping:function(){return h;}});var r,a,l,o,i,u,d,s,c,f,p=n("777fffbe")._(n("f02131d0"));(u=r||(r={}))[u.NAME=0]="NAME",u[u.DESCRIPTION=1]="DESCRIPTION",u[u.MODIFY_TIME=2]="MODIFY_TIME",u[u.KNOWLEDGE_COUNT=3]="KNOWLEDGE_COUNT",u[u.SOURCE=4]="SOURCE",u[u.TARGET=5]="TARGET",u[u.RELATION_DIRECTION=6]="RELATION_DIRECTION";let m={0:p.default.get({id:"spg.src.constants.knowledgeBuild.Name",dm:"\u540D\u79F0"}),1:p.default.get({id:"spg.src.constants.knowledgeBuild.Description",dm:"\u63CF\u8FF0"}),2:p.default.get({id:"spg.src.constants.knowledgeBuild.LastEditTime",dm:"\u6700\u8FD1\u7F16\u8F91\u65F6\u95F4"}),3:p.default.get({id:"spg.src.constants.knowledgeBuild.CumulativeQuantityOfKnowledge",dm:"\u77E5\u8BC6\u7D2F\u79EF\u6570\u91CF"}),4:p.default.get({id:"spg.src.constants.knowledgeBuild.StartingPoint",dm:"\u8D77\u70B9"}),5:p.default.get({id:"spg.src.constants.knowledgeBuild.End",dm:"\u7EC8\u70B9"}),6:p.default.get({id:"spg.src.constants.knowledgeBuild.RelationshipType",dm:"\u5173\u7CFB\u7C7B\u578B"})};(d=a||(a={})).RELATION="RELATION",d.PROPERTY="PROPERTY",d.CONCEPT="CONCEPT";let h={RELATION:{name:"RELATION",nameZh:p.default.get({id:"spg.src.constants.knowledgeBuild.RelationshipRules",dm:"\u5173\u7CFB\u89C4\u5219"})},PROPERTY:{name:"PROPERTY",nameZh:p.default.get({id:"spg.src.constants.knowledgeBuild.AttributeRules",dm:"\u5C5E\u6027\u89C4\u5219"})},CONCEPT:{name:"CONCEPT",nameZh:p.default.get({id:"spg.src.constants.knowledgeBuild.ConceptRules",dm:"\u6982\u5FF5\u89C4\u5219"})}};(s=l||(l={})).TRANSITIVE="TRANSITIVE",s.BOTH="BOTH",s.SINGLE="SINGLE",s.NULL="NULL";let y={TRANSITIVE:p.default.get({id:"spg.src.constants.knowledgeBuild.TransferRelationship",dm:"\u4F20\u9012\u5173\u7CFB"}),BOTH:p.default.get({id:"spg.src.constants.knowledgeBuild.SymmetricRelation",dm:"\u5BF9\u79F0\u5173\u7CFB"}),SINGLE:p.default.get({id:"spg.src.constants.knowledgeBuild.OneWayRelationship",dm:"\u5355\u5411\u5173\u7CFB"}),NULL:p.default.get({id:"spg.src.constants.knowledgeBuild.None",dm:"\u65E0"})};(c=o||(o={})).UNIQUE="UNIQUE",c.REQUIRE="REQUIRE",c.ENUM="ENUM",c.MAXIMUM_LT_OE="MAXIMUM_LT_OE",c.MAXIMUM_LT="MAXIMUM_LT",c.MINIMUM_GT_OE="MINIMUM_GT_OE",c.MINIMUM_GT="MINIMUM_GT",c.REGULAR="REGULAR",c.MULTIVALUE="MULTIVALUE",(f=i||(i={})).BASIC="BASIC_TYPE",f.CONCEPT="CONCEPT_TYPE",f.ENTITY="ENTITY_TYPE",f.EVENT="EVENT_TYPE",f.STANDARD="STANDARD_TYPE",f.ONE_LEVEL="ONE_LEVEL_TYPE";let g={id:"ID",name:p.default.get({id:"spg.src.constants.knowledgeBuild.Name",dm:"\u540D\u79F0"}),description:p.default.get({id:"spg.src.constants.knowledgeBuild.Description",dm:"\u63CF\u8FF0"}),__from_id__:p.default.get({id:"spg.src.constants.knowledgeBuild.StartingPoint",dm:"\u8D77\u70B9"}),__to_id__:p.default.get({id:"spg.src.constants.knowledgeBuild.End",dm:"\u7EC8\u70B9"})};},"4c70c3ed":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"getMixedLocaleFieldValue",{enumerable:!0,get:function(){return a;}});let r=n("777fffbe")._(n("f02131d0")).default.getCurrentLocale(),a=(e={},t)=>{let{fileName:n="name",lang:a=r,fileNameZh:l,onlyLocale:o=!1}=t||{},i=l||n+"Zh",u=e["zh-CN"===a?i:n],d=e["zh-CN"===a?n:i];return d||u?d?u?o?u:`${u}(${d})`:d:u:"-";};},"5e00c259":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"Title",{enumerable:!0,get:function(){return i;}});var r=n("32b7a2cf"),a=n("5b5ed4a9");n("4d0e37ae");var l=n("fc1f4356");let o=a.styled.div`
  .header {
    color: var(--dark-shade-85);
    font-weight: var(--font-medium);
    font-size: ${({$level:e})=>"page"===e?"var(--h1-font-size)":"var(--h3-font-size)"};
    line-height: ${({$level:e})=>"page"===e?"28px":"24px"};
  }
`,i=({className:e,style:t,level:n="page",title:i,titleExtra:u,showBack:d=!1,goBackCb:s,children:c})=>{let f=(0,a.useNavigate)();return(0,r.jsxs)(o,{$level:n,className:e,style:t,children:[(0,r.jsxs)("div",{className:"flex-row mb16",children:[(0,r.jsxs)("div",{className:"header",children:[d&&(0,r.jsx)(a.Icon,{className:"icon mr8 pointer",icon:"ant-design:arrow-left-outlined",onClick:()=>(0,l.isFunction)(s)?s():f(-1)}),i]}),(0,r.jsx)("div",{children:u})]}),(0,r.jsx)("div",{children:c})]});};},"7acbc698":function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"DEFAULT_GRAPH_DATA",{enumerable:!0,get:function(){return r;}});let r={nodes:[],edges:[]};},"7ae1caf7":function(e,t,n){n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return nZ;}});var r,a,l,o,i,u,d,s,c,f,p,m,h,y,g,b,v,x,T,I,w,E=n("777fffbe"),N=n("852bbaa9"),S=n("32b7a2cf"),_=n("4c70c3ed"),k=n("a675bf5f"),C=n("7acbc698"),M=n("1a998156"),R=n("bcda4f95"),O=n("bac6942a"),j=n("f02131d0"),L=E._(j),P=n("5b5ed4a9"),A=n("4d0e37ae"),F=N._(A),D=n("fc1f4356"),K=n("73d89cde"),B=n("4a4bb4c2"),U=n("a4474fd3"),G=n("02b696d0"),V=N._(G),W=n("341ea61c"),q=E._(W),z=n("f86e90ef");let Y="__customInitFlag",H=(e,t)=>{let{onFullscreenChange:n,fullscreen:r}=t??{};return(0,z.useUpdateEffect)(()=>{let t=null==e?void 0:e.getPluginInstance("fullscreen");r?null==t||t.request():null==t||t.exit();},[r]),{initFullscreenPlugin:e=>{var t,r,a;let l=e.getPluginInstance("fullscreen"),o=null==l?void 0:null===(t=l.options)||void 0===t?void 0:t.onEnter,i=null==l?void 0:null===(r=l.options)||void 0===r?void 0:r.onExit;null!=l&&null!==(a=l.options)&&void 0!==a&&a[Y]||e.updatePlugin({key:"fullscreen",type:"fullscreen",[Y]:!0,onEnter(){null==n||n(!0),null==o||o();},onExit:()=>{null==n||n(!1),null==i||i();}});}};};var $=n("0b69d691"),X=n("3834a44f");let Z=e=>{var t;let{item:n,...r}=e??{},a={projectId:Number((0,X.useProjectId)()),label:null==n?void 0:n.label,params:{id:(null==n?void 0:null===(t=n.properties)||void 0===t?void 0:t.id)??(null==n?void 0:n.id)}},l=(0,P.useQuery)({queryFn:async()=>{let e=await (0,$.getOneHopGraph)(a);return e.success&&e.result?e.result:Promise.reject(e);},queryKey:["components/AnalysisGraph/useOneDegreeData",a],enabled:!!((null==n?void 0:n.label)&&(null==n?void 0:n.id)),staleTime:0,...r});return{...l,oneDegreeData:null==l?void 0:l.data};},Q=P.styled.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  height: 100%;
`;var J=n("5ef61bc1");let ee=e=>{let{params:t,...n}=e??{},r={projectId:Number((0,X.useProjectId)()),...t},a=(0,P.useQuery)({queryFn:async()=>{let e=await (0,$.getEntityDetail)(r);return e.success&&e.result?e.result:Promise.reject(e);},queryKey:["hooks/useEntitiesData",r],enabled:!!((null==r?void 0:r.projectId)&&r.label),...n});return{...a,entitiesData:null==a?void 0:a.data};};var et=n("e388b5c1"),en=E._(et),er=n("b916d24f"),ea=E._(er),el=n("5661e780"),eo=E._(el),ei=n("9afeebc4"),eu=E._(ei);let ed=P.styled.ol`
  padding-left: 0;
  display: flex;
  row-gap: 24px;
  flex-direction: column;

  .chunkItemContentWrap {
    border: 1px solid #d6d8da;
    border-radius: 8px;
    padding: 16px;
  }
  .chunkItemContent {
    height: 116px;
    overflow: scroll;
    line-height: 24px;
  }
`;eu.default.registerLanguage("plaintext",function(e){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0};});let es="customBasicTab";(I||(I={})).Chunk="Chunk";let ec=e=>{var t,n;let[r,a]=(0,F.useState)(),l=!!(r&&r.from),{entitiesData:o,isInitialLoading:i}=ee({params:{type:"ENTITY",label:null==r?void 0:r.label,params:{id:null==r?void 0:null===(t=r.properties)||void 0===t?void 0:t.id}},enabled:!!((null==r?void 0:r.id)&&(null==r?void 0:r.label)&&!l),staleTime:0,retry:!1}),u=(null==o?void 0:null===(n=o.resultNodes)||void 0===n?void 0:n.filter(e=>{var t;let[n,r]=(null===(t=e.label)||void 0===t?void 0:t.split("."))??[];return r===J.CHUNK_TYPE_NAME;}))??[],d=(e,t)=>{if(!e||!t)return e;let n=e=>(0,S.jsx)("span",{style:{color:"#2f54eb",background:"#167aff17"},children:e}),r=e.split(t);return r.reduce((e,a,l)=>[...e,a,l!==r.length-1?n(t):""],[]);},s=()=>(0,S.jsxs)(en.default.Panel,{header:L.default.get({id:"spg.AnalysisGraph.plugins.DetailDrawer.AssociatedSegments",dm:"\u5173\u8054\u5206\u6BB5"}),children:[i&&(0,S.jsx)(eo.default,{round:!0,active:!0}),!i&&(0,D.isEmpty)(u)&&(0,S.jsx)(ea.default,{image:ea.default.PRESENTED_IMAGE_SIMPLE}),(0,S.jsx)(ed,{children:null==u?void 0:u.map((e,t)=>{var n,r,a;return(0,S.jsxs)("div",{className:"chunkItem",children:[(0,S.jsxs)("p",{style:{marginBottom:8},children:[(0,S.jsxs)("span",{style:{color:"#000a1a7b"},children:[t+1,"\u3001"]}),(0,S.jsx)("a",{children:null===(n=e.properties)||void 0===n?void 0:n.name})]}),(0,S.jsx)("div",{className:"chunkItemContentWrap",children:(0,S.jsx)("div",{className:"chunkItemContent",children:d(null===(r=e.properties)||void 0===r?void 0:r.content,null===(a=e.properties)||void 0===a?void 0:a.name)})})]},t);})})]},"Chunk"),c=[{label:L.default.get({id:"spg.AnalysisGraph.plugins.DetailDrawer.BasicInformation",dm:"\u57FA\u672C\u4FE1\u606F"}),value:es,order:-1,showSearch:!1,content:e=>(a(e),s())}];return(0,S.jsx)(B.DetailDrawer,{tabOptions:c,showDisabledTab:!1,extraDefaultActivePanelKeys:["Chunk"],defaultTabValue:es,...e});};var ef=n("fc7b6873"),ep=E._(ef);let em=e=>{var t;return!(null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.startsWith(U.EXPAND_NODE_PREFIX));},eh=e=>{var t;return{...e,id:(null==e?void 0:null===(t=e.properties)||void 0===t?void 0:t.id)??e.id};},ey=e=>({...e,from:e.fromId??e.from,to:e.toId??e.to,id:e.id??(0,ep.default)()}),eg=e=>{var t,n;return e?{...e,nodes:(0,D.uniqBy)(null==e?void 0:null===(t=e.nodes)||void 0===t?void 0:t.map(eh),"id"),edges:(0,D.uniqBy)(null==e?void 0:null===(n=e.edges)||void 0===n?void 0:n.map(ey),"id")}:e;},eb=F.default.memo(e=>{let{graphData:t,extraStyleConfigs:n,toolbarItems:r,showSearch:a=!0,fullscreen:l,onFullscreenChange:o,onInit:i}=e,u=(0,F.useRef)(),[d,s]=(0,F.useState)(),[c,f]=(0,F.useState)(t),{extraStyleConfigs:p}=(0,k.useSchemaStaticConfig)(),{data:m}=(0,O.useSchemaPropertyNameMap)(),{data:h=C.DEFAULT_GRAPH_DATA}=(0,R.useSchemaData)(),{initFullscreenPlugin:y}=H(u.current,{fullscreen:l,onFullscreenChange:o}),{oneDegreeData:g,isFetching:b}=Z({item:d}),v=(0,F.useMemo)(()=>eg(c),[c]);(0,z.useUpdateEffect)(()=>{f(e=>{if(!e||!g||(0,q.default)(null==g?void 0:g.resultNodes))return e;let{resultNodes:t=[],resultEdges:n=[]}=g;return{nodes:[...e.nodes,...t],edges:[...e.edges,...n]};});},[g]);let x=(0,F.useMemo)(()=>({...M.baseSchemePropertyNameMap,...m}),[m]),T=(0,D.merge)(p,n),I=e=>{s(e);},w=[{key:"openRelationAll",name:L.default.get({id:"spg.components.AnalysisGraph.ExpandOneDegreeRelationshipAll",dm:"\u5C55\u5F00\u4E00\u5EA6\u5173\u7CFB\uFF08\u5168\u90E8\uFF09"}),enable:e=>em(null==e?void 0:e.model),onClick:e=>{var t;(null==e?void 0:null===(t=e.model)||void 0===t?void 0:t.data)&&I(e.model.data);}},B.ContextmenuKey.ExpandNode,B.ContextmenuKey.MergeNode],E=(0,z.useMemoizedFn)(e=>{var t;let n=null===(t=u.current)||void 0===t?void 0:t.getElementData(e.target.id);em(n)&&(null==n?void 0:n.data)&&I(n.data);});return(0,V.useEffect)(()=>()=>{var e;null===(e=u.current)||void 0===e||e.off(B.NodeEvent.DBLCLICK,E);},[]),(0,z.useUpdateEffect)(()=>{f(t);},[t]),(0,S.jsxs)(Q,{children:[(0,S.jsx)(K.OverlaySpin,{spinning:b}),(0,S.jsxs)(B.Graph,{autoFitView:!0,data:v,extraStyleConfigs:T,style:{height:"100%"},locale:(0,P.getLocale)(),mergeType:U.MergeTypeEnum.MERGE_SAME_RELATION,schemaData:h,schemaPropertyNameMap:x,schemaTypeNameMap:x,onInit:e=>{null==i||i(e),u.current=e,e.on(B.NodeEvent.DBLCLICK,E);},onReady:e=>{y(e);},children:[(0,S.jsx)(ec,{getContainer:!l&&document.body}),(0,S.jsx)(B.Toolbar,{items:(()=>{let e=[{key:B.ToolbarKey.ChangeLayout,items:[{id:B.LayoutId.Force2},{id:B.LayoutId.DagreVertical},{id:B.LayoutId.DagreHorizontal},{id:B.LayoutId.Radial}]},B.ToolbarKey.SwitchMerge,B.ToolbarKey.FitView,B.ToolbarKey.FullScreen,B.ToolbarKey.Clear,B.ToolbarKey.ZoomIn,B.ToolbarKey.ZoomOut,B.ToolbarKey.ExportImg];if(Array.isArray(r)){let t=e.map(e=>(0,D.isString)(e)?{key:e}:e),n=(0,D.keyBy)(t,"key");return r.map(e=>(0,D.isString)(e)?n[e]??e:e);}return e;})(),style:{bottom:76,left:16}}),(0,S.jsx)(B.Contextmenu,{items:w}),(0,S.jsx)(B.GraphLegend,{style:{left:48,bottom:30}}),a&&(0,S.jsx)(B.Search,{})]})]});});var ev=n("5e00c259"),ex=n("9e0828f5"),eT=E._(ex),eI=n("d5b565e0"),ew=E._(eI),eE=n("fc1e2430"),eN=E._(eE),eS=n("5b3ac6b1"),e_=E._(eS),ek=n("e169cea0"),eC=E._(ek),eM=n("1043743b"),eR=E._(eM),eO=n("22598e86"),ej=E._(eO),eL=n("e7977e7c"),eP=E._(eL),eA=n("c7f4f8e9"),eF=E._(eA),eD=n("e6fc687f"),eK=E._(eD),eB=n("85d9e535"),eU=E._(eB),eG=n("93b3369a"),eV=n("593c6e64"),eW=n("4ef94126"),eq=n("59b4776c"),ez=E._(eq),eY=n("ddfe20fc"),eH=E._(eY),e$=n("280c328a"),eX=E._(e$),eZ=Number.isNaN||function(e){return"number"==typeof e&&e!=e;};function eQ(e,t){if(e.length!==t.length)return!1;for(var n,r,a=0;a<e.length;a++)if(!((n=e[a])===(r=t[a])||eZ(n)&&eZ(r)))return!1;return!0;}function eJ(e,t){void 0===t&&(t=eQ);var n,r,a=[],l=!1;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return l&&n===this&&t(o,a)||(r=e.apply(this,o),l=!0,n=this,a=o),r;};}var e0=n("3b89c069");E._(e0);var e1="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now();}:function(){return Date.now();};function e2(e){cancelAnimationFrame(e.id);}var e5=-1,e6=null;function e3(e){if(void 0===e&&(e=!1),null===e6||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),a=r.style;a.width="100px",a.height="100px",t.appendChild(r),document.body.appendChild(t),t.scrollLeft>0?e6="positive-descending":(t.scrollLeft=1,e6=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t);}return e6;}var e4=function(e){var t=e.columnIndex;return e.data,e.rowIndex+":"+t;},e9=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance;},e7=function(e,t){var n=e.rowCount,r=t.rowMetadataMap,a=t.estimatedRowHeight,l=t.lastMeasuredRowIndex,o=0;if(l>=n&&(l=n-1),l>=0){var i=r[l];o=i.offset+i.size;}return o+(n-l-1)*a;},e8=function(e,t){var n=e.columnCount,r=t.columnMetadataMap,a=t.estimatedColumnWidth,l=t.lastMeasuredColumnIndex,o=0;if(l>=n&&(l=n-1),l>=0){var i=r[l];o=i.offset+i.size;}return o+(n-l-1)*a;},te=function(e,t,n,r){var a,l,o;if("column"===e?(a=r.columnMetadataMap,l=t.columnWidth,o=r.lastMeasuredColumnIndex):(a=r.rowMetadataMap,l=t.rowHeight,o=r.lastMeasuredRowIndex),n>o){var i=0;if(o>=0){var u=a[o];i=u.offset+u.size;}for(var d=o+1;d<=n;d++){var s=l(d);a[d]={offset:i,size:s},i+=s;}"column"===e?r.lastMeasuredColumnIndex=n:r.lastMeasuredRowIndex=n;}return a[n];},tt=function(e,t,n,r){var a,l;return("column"===e?(a=n.columnMetadataMap,l=n.lastMeasuredColumnIndex):(a=n.rowMetadataMap,l=n.lastMeasuredRowIndex),(l>0?a[l].offset:0)>=r)?tn(e,t,n,l,0,r):tr(e,t,n,Math.max(0,l),r);},tn=function(e,t,n,r,a,l){for(;a<=r;){var o=a+Math.floor((r-a)/2),i=te(e,t,o,n).offset;if(i===l)return o;i<l?a=o+1:i>l&&(r=o-1);}return a>0?a-1:0;},tr=function(e,t,n,r,a){for(var l="column"===e?t.columnCount:t.rowCount,o=1;r<l&&te(e,t,r,n).offset<a;)r+=o,o*=2;return tn(e,t,n,Math.min(r,l-1),Math.floor(r/2),a);},ta=function(e,t,n,r,a,l,o){var i="column"===e?t.width:t.height,u=te(e,t,n,l),d=Math.max(0,Math.min(("column"===e?e8(t,l):e7(t,l))-i,u.offset)),s=Math.max(0,u.offset-i+o+u.size);switch("smart"===r&&(r=a>=s-i&&a<=d+i?"auto":"center"),r){case"start":return d;case"end":return s;case"center":return Math.round(s+(d-s)/2);default:if(a>=s&&a<=d)return a;if(s>d)return s;if(a<s)return s;return d;}},tl=(l=(r={getColumnOffset:function(e,t,n){return te("column",e,t,n).offset;},getColumnStartIndexForOffset:function(e,t,n){return tt("column",e,n,t);},getColumnStopIndexForStartIndex:function(e,t,n,r){for(var a=e.columnCount,l=e.width,o=te("column",e,t,r),i=n+l,u=o.offset+o.size,d=t;d<a-1&&u<i;)u+=te("column",e,++d,r).size;return d;},getColumnWidth:function(e,t,n){return n.columnMetadataMap[t].size;},getEstimatedTotalHeight:e7,getEstimatedTotalWidth:e8,getOffsetForColumnAndAlignment:function(e,t,n,r,a,l){return ta("column",e,t,n,r,a,l);},getOffsetForRowAndAlignment:function(e,t,n,r,a,l){return ta("row",e,t,n,r,a,l);},getRowOffset:function(e,t,n){return te("row",e,t,n).offset;},getRowHeight:function(e,t,n){return n.rowMetadataMap[t].size;},getRowStartIndexForOffset:function(e,t,n){return tt("row",e,n,t);},getRowStopIndexForStartIndex:function(e,t,n,r){for(var a=e.rowCount,l=e.height,o=te("row",e,t,r),i=n+l,u=o.offset+o.size,d=t;d<a-1&&u<i;)u+=te("row",e,++d,r).size;return d;},initInstanceProps:function(e,t){var n={columnMetadataMap:{},estimatedColumnWidth:e.estimatedColumnWidth||50,estimatedRowHeight:e.estimatedRowHeight||50,lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,rowMetadataMap:{}};return t.resetAfterColumnIndex=function(e,n){void 0===n&&(n=!0),t.resetAfterIndices({columnIndex:e,shouldForceUpdate:n});},t.resetAfterRowIndex=function(e,n){void 0===n&&(n=!0),t.resetAfterIndices({rowIndex:e,shouldForceUpdate:n});},t.resetAfterIndices=function(e){var r=e.columnIndex,a=e.rowIndex,l=e.shouldForceUpdate;"number"==typeof r&&(n.lastMeasuredColumnIndex=Math.min(n.lastMeasuredColumnIndex,r-1)),"number"==typeof a&&(n.lastMeasuredRowIndex=Math.min(n.lastMeasuredRowIndex,a-1)),t._getItemStyleCache(-1),(void 0===l||l)&&t.forceUpdate();},n;},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.columnWidth,e.rowHeight;}}).getColumnOffset,o=r.getColumnStartIndexForOffset,i=r.getColumnStopIndexForStartIndex,u=r.getColumnWidth,d=r.getEstimatedTotalHeight,s=r.getEstimatedTotalWidth,c=r.getOffsetForColumnAndAlignment,f=r.getOffsetForRowAndAlignment,p=r.getRowHeight,m=r.getRowOffset,h=r.getRowStartIndexForOffset,y=r.getRowStopIndexForStartIndex,g=r.initInstanceProps,b=r.shouldResetStyleCacheOnItemSizeChange,v=r.validateProps,(a=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=g(n.props,(0,eH.default)(n)),n._resetIsScrollingTimeoutId=null,n._outerRef=void 0,n.state={instance:(0,eH.default)(n),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof n.props.initialScrollLeft?n.props.initialScrollLeft:0,scrollTop:"number"==typeof n.props.initialScrollTop?n.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},n._callOnItemsRendered=void 0,n._callOnItemsRendered=eJ(function(e,t,r,a,l,o,i,u){return n.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:r,overscanRowStopIndex:a,visibleColumnStartIndex:l,visibleColumnStopIndex:o,visibleRowStartIndex:i,visibleRowStopIndex:u});}),n._callOnScroll=void 0,n._callOnScroll=eJ(function(e,t,r,a,l){return n.props.onScroll({horizontalScrollDirection:r,scrollLeft:e,scrollTop:t,verticalScrollDirection:a,scrollUpdateWasRequested:l});}),n._getItemStyle=void 0,n._getItemStyle=function(e,t){var r,a=n.props,o=a.columnWidth,i=a.direction,d=a.rowHeight,s=n._getItemStyleCache(b&&o,b&&i,b&&d),c=e+":"+t;if(s.hasOwnProperty(c))r=s[c];else{var f=l(n.props,t,n._instanceProps),h="rtl"===i;s[c]=r={position:"absolute",left:h?void 0:f,right:h?f:void 0,top:m(n.props,e,n._instanceProps),height:p(n.props,e,n._instanceProps),width:u(n.props,t,n._instanceProps)};}return r;},n._getItemStyleCache=void 0,n._getItemStyleCache=eJ(function(e,t,n){return{};}),n._onScroll=function(e){var t=e.currentTarget,r=t.clientHeight,a=t.clientWidth,l=t.scrollLeft,o=t.scrollTop,i=t.scrollHeight,u=t.scrollWidth;n.setState(function(e){if(e.scrollLeft===l&&e.scrollTop===o)return null;var t=n.props.direction,d=l;if("rtl"===t)switch(e3()){case"negative":d=-l;break;case"positive-descending":d=u-a-l;}d=Math.max(0,Math.min(d,u-a));var s=Math.max(0,Math.min(o,i-r));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<l?"forward":"backward",scrollLeft:d,scrollTop:s,verticalScrollDirection:e.scrollTop<o?"forward":"backward",scrollUpdateWasRequested:!1};},n._resetIsScrollingDebounced);},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e);},n._resetIsScrollingDebounced=function(){var e,t,r;null!==n._resetIsScrollingTimeoutId&&e2(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=(e=n._resetIsScrolling,t=e1(),r={id:requestAnimationFrame(function n(){e1()-t>=150?e.call(null):r.id=requestAnimationFrame(n);})});},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},function(){n._getItemStyleCache(-1);});},n;}t.prototype=Object.create(e.prototype),t.prototype.constructor=t,(0,eX.default)(t,e),t.getDerivedStateFromProps=function(e,t){return e9(e,t),v(e),null;};var n=t.prototype;return n.scrollTo=function(e){var t=e.scrollLeft,n=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==n&&(n=Math.max(0,n)),this.setState(function(e){return(void 0===t&&(t=e.scrollLeft),void 0===n&&(n=e.scrollTop),e.scrollLeft===t&&e.scrollTop===n)?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:n,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<n?"forward":"backward"};},this._resetIsScrollingDebounced);},n.scrollToItem=function(e){var t=e.align,n=void 0===t?"auto":t,r=e.columnIndex,a=e.rowIndex,l=this.props,o=l.columnCount,i=l.height,u=l.rowCount,p=l.width,m=this.state,h=m.scrollLeft,y=m.scrollTop,g=function(e){if(void 0===e&&(e=!1),-1===e5||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),e5=t.offsetWidth-t.clientWidth,document.body.removeChild(t);}return e5;}();void 0!==r&&(r=Math.max(0,Math.min(r,o-1))),void 0!==a&&(a=Math.max(0,Math.min(a,u-1)));var b=d(this.props,this._instanceProps),v=s(this.props,this._instanceProps)>p?g:0,x=b>i?g:0;this.scrollTo({scrollLeft:void 0!==r?c(this.props,r,n,h,this._instanceProps,x):h,scrollTop:void 0!==a?f(this.props,a,n,y,this._instanceProps,v):y});},n.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,n=e.initialScrollTop;if(null!=this._outerRef){var r=this._outerRef;"number"==typeof t&&(r.scrollLeft=t),"number"==typeof n&&(r.scrollTop=n);}this._callPropsCallbacks();},n.componentDidUpdate=function(){var e=this.props.direction,t=this.state,n=t.scrollLeft,r=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("rtl"===e)switch(e3()){case"negative":a.scrollLeft=-n;break;case"positive-ascending":a.scrollLeft=n;break;default:var l=a.clientWidth,o=a.scrollWidth;a.scrollLeft=o-l-n;}else a.scrollLeft=Math.max(0,n);a.scrollTop=Math.max(0,r);}this._callPropsCallbacks();},n.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&e2(this._resetIsScrollingTimeoutId);},n.render=function(){var e=this.props,t=e.children,n=e.className,r=e.columnCount,a=e.direction,l=e.height,o=e.innerRef,i=e.innerElementType,u=e.innerTagName,c=e.itemData,f=e.itemKey,p=void 0===f?e4:f,m=e.outerElementType,h=e.outerTagName,y=e.rowCount,g=e.style,b=e.useIsScrolling,v=e.width,x=this.state.isScrolling,T=this._getHorizontalRangeToRender(),I=T[0],w=T[1],E=this._getVerticalRangeToRender(),N=E[0],S=E[1],_=[];if(r>0&&y)for(var k=N;k<=S;k++)for(var C=I;C<=w;C++)_.push((0,V.createElement)(t,{columnIndex:C,data:c,isScrolling:b?x:void 0,key:p({columnIndex:C,data:c,rowIndex:k}),rowIndex:k,style:this._getItemStyle(k,C)}));var M=d(this.props,this._instanceProps),R=s(this.props,this._instanceProps);return(0,V.createElement)(m||h||"div",{className:n,onScroll:this._onScroll,ref:this._outerRefSetter,style:(0,ez.default)({position:"relative",height:l,width:v,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},g)},(0,V.createElement)(i||u||"div",{children:_,ref:o,style:{height:M,pointerEvents:x?"none":void 0,width:R}}));},n._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,n=e.onItemsRendered,r=e.onScroll,a=e.rowCount;if("function"==typeof n&&t>0&&a>0){var l=this._getHorizontalRangeToRender(),o=l[0],i=l[1],u=l[2],d=l[3],s=this._getVerticalRangeToRender(),c=s[0],f=s[1],p=s[2],m=s[3];this._callOnItemsRendered(o,i,c,f,u,d,p,m);}if("function"==typeof r){var h=this.state,y=h.horizontalScrollDirection,g=h.scrollLeft,b=h.scrollTop,v=h.scrollUpdateWasRequested,x=h.verticalScrollDirection;this._callOnScroll(g,b,y,x,v);}},n._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,n=e.overscanColumnCount,r=e.overscanColumnsCount,a=e.overscanCount,l=e.rowCount,u=this.state,d=u.horizontalScrollDirection,s=u.isScrolling,c=u.scrollLeft,f=n||r||a||1;if(0===t||0===l)return[0,0,0,0];var p=o(this.props,c,this._instanceProps),m=i(this.props,p,c,this._instanceProps);return[Math.max(0,p-(s&&"backward"!==d?1:Math.max(1,f))),Math.max(0,Math.min(t-1,m+(s&&"forward"!==d?1:Math.max(1,f)))),p,m];},n._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,n=e.overscanCount,r=e.overscanRowCount,a=e.overscanRowsCount,l=e.rowCount,o=this.state,i=o.isScrolling,u=o.verticalScrollDirection,d=o.scrollTop,s=r||a||n||1;if(0===t||0===l)return[0,0,0,0];var c=h(this.props,d,this._instanceProps),f=y(this.props,c,d,this._instanceProps);return[Math.max(0,c-(i&&"backward"!==u?1:Math.max(1,s))),Math.max(0,Math.min(l-1,f+(i&&"forward"!==u?1:Math.max(1,s)))),c,f];},t;}(V.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},a),to=function(e,t,n){var r=e.itemSize,a=n.itemMetadataMap,l=n.lastMeasuredIndex;if(t>l){var o=0;if(l>=0){var i=a[l];o=i.offset+i.size;}for(var u=l+1;u<=t;u++){var d=r(u);a[u]={offset:o,size:d},o+=d;}n.lastMeasuredIndex=t;}return a[t];},ti=function(e){var t=e.rowKey;return{getRowKey:(0,V.useCallback)(function(e,n){return(0,eG.isFunction)(t)?null==t?void 0:t(e):t?e[t]:n;},[t])};},tu=n("f5597950"),td=E._(tu),ts="_selectionColumn",tc=function(e){var t=e.rowSelection,n=e.columns,r=void 0===n?[]:n,a=e.dataSource,l=void 0===a?[]:a,o=ti(e).getRowKey,i=(0,z.useControllableValue)(t,{defaultValue:[],defaultValuePropName:"defaultSelectedRowKeys",valuePropName:"selectedRowKeys",trigger:"onChange"}),u=(0,ej.default)(i,2),d=u[0],s=u[1],c=(0,V.useMemo)(function(){return d.length>0&&d.length<l.length;},[l.length,d.length]),f=(0,V.useMemo)(function(){return d.length>=l.length;},[l.length,d.length]),p=(0,z.useMemoizedFn)(function(e){s(function(){return e.target.checked?(0,eG.uniq)(l.map(function(e){return o(e);})):[];});}),m=(0,z.useMemoizedFn)(function(e,t){s(function(n){return e.target.checked?(0,eG.uniq)([].concat((0,e_.default)(n),[o(t)])):(0,eG.uniq)(n.filter(function(e){return e!==o(t);}));});});return{column:(0,V.useMemo)(function(){if(t&&r.length)return{title:(0,S.jsx)(td.default,{indeterminate:c,onChange:p,checked:f}),width:38,className:"ant-table-selection-column",key:ts,fixed:r.some(function(e){return"left"===e.fixed;})?"left":void 0,render:function(e,t){return(0,S.jsx)(td.default,{checked:d.includes(o(t)),onChange:function(e){return m(e,t);}});}};},[r,f,o,m,c,p,t,d]),extraDataSource:(0,V.useMemo)(function(){return l.map(function(e){return(0,eR.default)((0,eC.default)({},ts,null),e);});},[l])};},tf=["children"],tp=function(e){return(null==e?void 0:e.key)||(null==e?void 0:e.dataIndex)||"";},tm=n("e37edd9f"),th=E._(tm),ty=n("ff92314f"),tg=E._(ty),tb=n("2ed4c134"),tv=E._(tb),tx=n("8f891262"),tT=E._(tx),tI=n("673e678e"),tw=E._(tI),tE=n("2b798761"),tN=E._(tE),tS=function(e){return function(t){var n=t.destroyOnClose,r=t.visible,a=t.open,l=t.afterOpenChange,o=(0,V.useState)(!1),i=(0,ej.default)(o,2),u=i[0],d=i[1];return(0,V.useEffect)(function(){(r||a)&&d(!1);},[r,a]),n&&u?(0,S.jsx)(S.Fragment,{}):(0,S.jsx)(e,(0,eR.default)({afterOpenChange:function(e){null==l||l(e),e||d(!0);}},t));};},t_=n("5f54387e"),tk=E._(t_),tC=n("59502761"),tM=E._(tC),tR=n("6053b44d"),tO=V.default.memo(function(e){var t=e.title,n=e.treeData,r=void 0===n?[]:n,a=e.className,l=e.style,o=e.onChange,i=(0,eV.useIntl)().formatMessage,u=(0,V.useState)([]),d=(0,ej.default)(u,2),s=d[0],c=d[1],f="akg-components-analysis-property-card",p=(0,V.useMemo)(function(){return r.reduce(function(e,t){var n,r=(null===(n=t.children)||void 0===n?void 0:n.map(function(e){return e.key;}))||[];return[].concat((0,e_.default)(e),(0,e_.default)(r));},[]);},[r]),m=s.length>=p.length,h=!m&&0!==s.length;return(0,z.useUpdateEffect)(function(){null==o||o(s);},[s,o]),(0,S.jsxs)("div",{className:(0,eU.default)(f,a),style:(0,eR.default)({},l),children:[(0,S.jsx)("div",{className:"".concat(f,"-head"),children:void 0===t?"":t}),(0,S.jsxs)("div",{className:"".concat(f,"-content"),children:[(0,S.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,S.jsx)(td.default,{indeterminate:h,onChange:function(){c(s.length<p.length?p:[]);},checked:m,style:{marginRight:"12px"}}),i({id:"analysis-property-table.all-properties"})]}),(0,S.jsx)(tM.default,{checkable:!0,defaultExpandAll:!0,treeData:r,selectable:!1,onCheck:function(e){Array.isArray(e)&&c(e);},checkedKeys:s,titleRender:function(e){var t,n=((null===(t=e.property)||void 0===t?void 0:t.secret)||{}).status;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"".concat(f,"-tree-node-title"),children:e.title}),n&&(0,S.jsx)(tk.default,{color:tR.SecretStatusMap[n].color,children:i({id:tR.SecretStatusMap[n].localeId})})]});}})]})]});});tO.displayName="ApplyTreeCard";var tj=V.default.createContext({schemaTypeNameMap:{},schemaPropertyNameMap:{}}),tL=n("6465f56d"),tP=n("b1f78f70"),tA=n("3351fe66"),tF=n("a3e36212"),tD=function(e){return!!e.fromId;},tK=function(e,t){return!e||!t||e===t;},tB=function(e,t){return[].concat((0,e_.default)(e.entities),(0,e_.default)(e.relations)).find(function(e){return e.id===t;});},tU=function(e,t){var n,r;return(null===(n=tB(e,t))||void 0===n?void 0:n.name)||(null===(r=tB(e,t))||void 0===r?void 0:r.properties.name)||"";},tG=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.propertySeparator,a={sField:["fromType"],pField:["label","typeName"],oField:["toType"]};return Object.keys(a).forEach(function(t){var r=a[t];n[t]||r.forEach(function(r){e[r]&&(n[t]=r);});}),"".concat((0,tP.getSpo)(e,n)).concat(void 0===r?"-":r).concat(t);},tV=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.propertySeparator;return"".concat(e).concat(void 0===r?".":r).concat(t);},tW=function(e){return tG(e.instance,e.name,{propertySeparator:"."});},tq=function(e){var t=e.entities,n=e.relations,r=function(e){var t=(0,eR.default)({},e);t.properties=(0,eR.default)({},null==t?void 0:t.properties);var n=t.properties;return t.name&&!n.name&&(n.name=t.name),!t.name&&n.name&&(t.name=n.name),t;};return{entities:t.map(r).filter(function(e){var t;return e.name&&(null===(t=e.properties)||void 0===t?void 0:t.nodeType)!==tR.EntityType.BRUNCH&&e.nodeType!==tR.EntityType.BRUNCH;}),relations:n.filter(function(e){return t.some(function(t){return t.id===e.toId;})&&t.some(function(t){return t.id===e.fromId;});}).map(function(t){var n,a,l=r(t).properties.name;return(0,eR.default)((0,eR.default)({},t),{},{name:l,fromType:t.fromType||(null===(n=tB(e,t.fromId))||void 0===n?void 0:n.label)||"",toType:t.toType||(null===(a=tB(e,t.toId))||void 0===a?void 0:a.label)||""});})};},tz=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=a.columnsOrder,o=a.linkedProperties,i=t.label,u=t.id,d=t.encryptedProperties,s=void 0===d?{}:d,c=(0,eR.default)({},e);return Object.keys(c).map(function(e){var d=null==o?void 0:o[e],f=(r||[]).find(function(n){return null!=d&&d.instance&&null!=d&&d.property?tG(n,n.property)===tG(d.instance,d.property):tG(n,n.property)===tG(t,e);}),p=tG(t,e),m=(0,tP.getSpo)(t,{sField:"fromType",pField:"label",oField:"toType"});return{name:e,instanceId:String(u),type:a.type||tR.PropertyType.OWN,label:i,key:tV(u,e),value:String(c[e]),encryptedValue:s[e],schemaType:tD(t)?"relation":"entity",linkedProperty:d,typeKey:m,typePropertyKey:p,columnsOrder:(0,eG.isFunction)(l)?l(e):l||0,instance:t,rowIndex:n,secret:f};});},tY=function(e,t,n){var r=e.entities,a=e.relations;return[].concat((0,e_.default)(r),(0,e_.default)(a)).reduce(function(r,l,o){var i=l.properties,u={};!tD(l)&&n&&(u=a.filter(function(e){return e.fromId===l.id&&!l.properties[e.label];}).reduce(function(t,n){return(0,eR.default)((0,eR.default)({},t),{},(0,eC.default)({},n.label,tU(e,n.toId)));},{}));var d={},s={};if(tD(l)){var c=tB(e,l.fromId),f=tB(e,l.toId);d=(0,eC.default)((0,eC.default)((0,eC.default)((0,eC.default)({},tR.BuildInPropertyName.FromName,tU(e,l.fromId)),tR.BuildInPropertyName.FromId,(null==c?void 0:c.properties.id)||""),tR.BuildInPropertyName.ToName,tU(e,l.toId)),tR.BuildInPropertyName.ToId,(null==f?void 0:f.properties.id)||""),s=(0,eC.default)((0,eC.default)((0,eC.default)((0,eC.default)({},tR.BuildInPropertyName.FromName,{propertyKey:tV((null==c?void 0:c.id)||"","name"),instance:c,property:"name"}),tR.BuildInPropertyName.FromId,{propertyKey:tV((null==c?void 0:c.id)||"","id"),instance:c,property:"id"}),tR.BuildInPropertyName.ToName,{propertyKey:tV((null==f?void 0:f.id)||"","name"),instance:f,property:"name"}),tR.BuildInPropertyName.ToId,{propertyKey:tV((null==f?void 0:f.id)||"","id"),instance:f,property:"id"});}var p=(0,eC.default)({},tR.BuildInPropertyName.Id,l.id);tD(l)&&Object.assign(p,{relationTypeName:l.label});var m=(0,eC.default)({},tR.BuildInPropertyName.TypeName,l.label),h=tz(d,l,o,t,{type:tR.PropertyType.POINT,columnsOrder:3,linkedProperties:s}),y=tz(p,l,o,t,{type:tR.PropertyType.EXTRA,columnsOrder:2}),g=tz(i,l,o,t,{type:tR.PropertyType.OWN,columnsOrder:function(e){return["name","id"].includes(e)?1:0;}}),b=tz(u,l,o,t,{type:tR.PropertyType.OUT,columnsOrder:-1}),v=tz(m,l,o,t,{type:tR.PropertyType.EXTRA,columnsOrder:4});return[].concat((0,e_.default)(r),(0,e_.default)(h),(0,e_.default)(y),(0,e_.default)(g),(0,e_.default)(b),(0,e_.default)(v));},[]);},tH=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.schemaType,r=void 0===n?"entity":n,a=t.typeName,l=void 0===a?"":a,o=e.filter(function(e){return e.schemaType===r&&tK(l,e.label);});return Object.values((0,eG.groupBy)(o,function(e){return e.instanceId;})).sort(function(e,t){var n=(0,ej.default)(e,1)[0],r=(0,ej.default)(t,1)[0];return n.rowIndex-r.rowIndex;}).map(function(e){return e.reduce(function(e,t){return(0,eR.default)((0,eR.default)({},e),{},(0,eC.default)({},t.name,t.value));},{});});},t$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.schemaType,r=void 0===n?tR.SchemaType.ENTITY:n,a=t.typeName,l=void 0===a?"":a,o=t.fixLeft,i=void 0!==o&&o,u=t.excludes,d=t.unorderedKeys,s=t.schemaPropertyNameMap,c=void 0===s?{}:s,f=t.locale,p=void 0===f?tL.LanguageEnum.ZH_CN:f,m=t.renderAction,h=t.renderExtra,y=t.renderTitle,g=t.onCellDoubleClick,b=t.onItemNameClick,v=(0,eW.getIntl)(p).formatMessage,x=[].concat([tR.BuildInPropertyName.Id],(0,e_.default)(void 0===u?[]:u)),T=[].concat(["id","name"],(0,e_.default)(void 0===d?[]:d)),I=r===tR.SchemaType.ENTITY?["name"]:["relationTypeName"],w=e.filter(function(e){return e.schemaType===r&&tK(l,e.label);});w=(w=(0,eG.uniqBy)(w,"name")).filter(function(e){return!x.includes(e.name);});var E=(w=(0,eG.orderBy)(w,["columnsOrder"],["desc"])).map(function(e,t){var n={name:e.name,nameZh:c[tW(e)]||c[e.name]},r=tD(e.instance)&&e.type===tR.PropertyType.POINT||e.type===tR.PropertyType.EXTRA?(0,eW.getLocaleFieldValue)(n,{locale:p}):(0,eW.getMixedLocaleFieldValue)(n,{locale:p});return{title:function(e){function t(t){return e.apply(this,arguments);}return t.toString=function(){return e.toString();},t;}(function(e){var n;return(0,S.jsx)(tF.Tooltip,{title:r,placement:"topLeft",children:null!==(n=null==y?void 0:y(r,t,e))&&void 0!==n?n:r});}),titleText:r,width:0===t?175:160,ellipsis:{showTitle:!1},fixed:!t&&!!i&&"left",dataIndex:e.name,key:e.name,sortDirections:["descend","ascend"],sorter:!T.includes(e.name)&&0!==t&&(0,tA.getTableSorter)(e.name),render:function(t,n,a){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(tF.Tooltip,{title:t,children:I.includes(e.name)&&b?(0,S.jsx)("a",{onDoubleClick:function(e){null==g||g(r,t,n,e);},onClick:function(){return null==b?void 0:b(n);},children:t}):(0,S.jsx)("span",{onDoubleClick:function(e){null==g||g(r,t,n,e);},children:t})}),(0,S.jsx)("span",{children:null==h?void 0:h(t,n,a,e.name)})]});}};}),N={title:v({id:"global.operate"}),width:90,fixed:"right",render:m};return N.render&&E.push(N),E;},tX=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.schemaType,r=t.schemaTypeNameMap,a=void 0===r?{}:r,l=t.schemaPropertyNameMap,o=void 0===l?{}:l,i=t.locale,u=e.filter(function(e){return e.secret&&(void 0===n||e.schemaType===n);}).map(function(e){var t,n={name:e.name,nameZh:o[tW(e)]||o[e.name]},r=e.type===tR.PropertyType.OWN,a=(0,eW.getMixedLocaleFieldValue)(n,{locale:i}),l=(0,eW.getLocaleFieldValue)(n,{locale:i});return{title:r?a:l,key:tV(e.instanceId,e.name),secretStatus:null===(t=e.secret)||void 0===t?void 0:t.status,property:e};}),d=(0,eG.groupBy)((0,eG.uniqBy)(u,function(e){var t;return null===(t=e.property)||void 0===t?void 0:t.typePropertyKey;}),function(e){var t;return null===(t=e.property)||void 0===t?void 0:t.typeKey;});return Object.keys(d).map(function(e){var t,n=(null===(t=d[e][0].property)||void 0===t?void 0:t.label)||"",r={name:n,nameZh:a[n]};return{title:(0,eW.getMixedLocaleFieldValue)(r,{locale:i}),key:e,children:d[e],checkable:!1};});},tZ=function(e,t){return e.map(function(e){return null==e?void 0:e[t];}).join("");},tQ=["propertyData","onSubmit","onClose"],tJ=V.default.memo(function(e){var t,n,r=e.propertyData,a=e.onSubmit,l=e.onClose,o=(0,eP.default)(e,tQ),i=(0,eV.useIntl)(),u=i.formatMessage,d=i.locale,s=tT.default.useForm(),c=(0,ej.default)(s,1)[0],f=(0,V.useState)([]),p=(0,ej.default)(f,2),m=p[0],h=p[1],y=(0,V.useState)([]),g=(0,ej.default)(y,2),b=g[0],v=g[1],x=(0,V.useState)(!1),T=(0,ej.default)(x,2),I=T[0],w=T[1],E=(0,V.useContext)(tj),N=E.schemaTypeNameMap,_=E.schemaPropertyNameMap,k="akg-components-analysis-property-drawer",C=tX(r,{schemaType:"entity",schemaTypeNameMap:N,schemaPropertyNameMap:_,locale:d}),M=tX(r,{schemaType:"relation",schemaTypeNameMap:N,schemaPropertyNameMap:_,locale:d}),R=(t=(0,tg.default)((0,th.default)().mark(function e(){var t,n,l,o;return(0,th.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.validateFields();case 3:return t=e.sent,n=r.filter(function(e){var t;return[].concat((0,e_.default)(m),(0,e_.default)(b)).includes(e.key)&&(null===(t=e.secret)||void 0===t?void 0:t.status)===tR.SecretStatus.NONE;}).map(function(e){return e.linkedProperty?r.find(function(t){var n;return t.key===(null===(n=e.linkedProperty)||void 0===n?void 0:n.propertyKey);}):e;}),o=Object.keys(l=(0,eG.groupBy)(n,function(e){return null==e?void 0:e.typeKey;})).map(function(e){var t,n,r=l[e];return{typeId:(null===(t=r[0])||void 0===t||null===(t=t.secret)||void 0===t?void 0:t.typeId)||"",typeKey:e,typeName:(null===(n=r[0])||void 0===n?void 0:n.label)||"",properties:(0,eG.uniq)(r.map(function(e){return(null==e?void 0:e.name)||"";}))};}),w(!0),e.next=10,null==a?void 0:a((0,eR.default)((0,eR.default)({},t),{},{types:o}));case 10:w(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),null!==e.t0&&void 0!==e.t0&&e.t0.errorFields[0].name.includes("reason")&&tN.default.error(null===e.t0||void 0===e.t0?void 0:e.t0.errorFields[0].errors.join(","));case 16:case"end":return e.stop();}},e,null,[[0,13]]);})),function(){return t.apply(this,arguments);});return(0,S.jsxs)(tv.default,(0,eR.default)((0,eR.default)({title:(0,S.jsxs)("div",{className:"".concat(k,"-title-container"),children:[(0,S.jsx)("div",{className:"".concat(k,"-title-main"),children:u({id:"analysis-property-table.applying.title"})}),(0,S.jsx)("div",{className:"".concat(k,"-title-sub"),children:u({id:"analysis-property-table.applying.tip"})})]}),width:480,placement:"right",footer:(n=0===M.length&&0===C.length,(0,S.jsxs)("div",{className:"".concat(k,"-footer"),children:[(0,S.jsx)(ew.default,{onClick:l,children:u({id:"global.cancel"})}),(0,S.jsx)(ew.default,{type:"primary",onClick:R,loading:I,disabled:n,children:u({id:"analysis-property-table.applying.process.submit"})})]})),onClose:l},o),{},{children:[(0,S.jsx)("h2",{className:(0,eU.default)("".concat(k,"-title-main"),"".concat(k,"-content-title")),children:u({id:"analysis-property-table.applying.content.title"})}),(0,S.jsxs)("section",{className:"".concat(k,"-properties"),children:[0!==C.length&&(0,S.jsx)(tO,{style:{marginBottom:"16px"},title:u({id:"analysis-property-table.sensitive-entity"}),treeData:C,onChange:h}),0!==M.length&&(0,S.jsx)(tO,{title:u({id:"analysis-property-table.sensitive-relation"}),treeData:M,onChange:v}),0===C.length&&0===M.length&&(0,S.jsx)(ea.default,{description:u({id:"analysis-property-table.applying.data.empty"})})]}),(0,S.jsx)("h2",{className:(0,eU.default)("".concat(k,"-title-main"),"".concat(k,"-content-title")),children:u({id:"analysis-property-table.applying.reason.title"})}),(0,S.jsx)("section",{children:(0,S.jsx)(tT.default,{layout:"vertical",requiredMark:"optional",form:c,name:"applyForm",children:(0,S.jsx)(tT.default.Item,{label:u({id:"analysis-property-table.applying.reason.view-purpose"}),name:"reason",rules:[{required:!0,min:10,message:u({id:"analysis-property-table.applying.reason.rule"})}],children:(0,S.jsx)(tw.default.TextArea,{placeholder:u({id:"analysis-property-table.applying.reason.placeholder"}),autoSize:{minRows:4,maxRows:6}})})})}),(0,S.jsx)("h2",{className:(0,eU.default)("".concat(k,"-title-main"),"".concat(k,"-content-title")),children:u({id:"analysis-property-table.applying.expire.title"})}),(0,S.jsx)("section",{children:(0,S.jsx)("p",{children:u({id:"analysis-property-table.applying.expire.content"},{red:function(e){return(0,S.jsx)("span",{style:{color:"rgb(215,87,45)"},children:e});}})})})]}));});tJ.displayName="ApplySecretDrawer";var t0=tS(tJ),t1=n("249809ea"),t2=E._(t1),t5=n("0c8a2b89"),t6=E._(t5),t3=["schemaType","dataSource"],t4=V.default.memo(function(e){var t=(0,eV.useIntl)().formatMessage,n=e.schemaType,r=void 0===n?tR.SchemaType.ENTITY:n,a=e.dataSource,l=void 0===a?[]:a,o=(0,eP.default)(e,t3),i=(0,V.useMemo)(function(){return r===tR.SchemaType.ENTITY?l.map(function(e){var t=null==e?void 0:e.name;return(0,eR.default)((0,eR.default)({},e),{},{searchKey:String(null!=t?t:""),label:(0,S.jsx)(t6.default,{title:t,children:t}),value:null==e?void 0:e._id});}):r===tR.SchemaType.RELATION?l.map(function(e){var t,n=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:null==e?void 0:e.relationTypeName,r=(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:n}),(0,S.jsx)("div",{children:"".concat(null==e?void 0:e._fromName," \u2192 ").concat(null==e?void 0:e._toName)})]});return(0,eR.default)((0,eR.default)({},e),{},{searchKey:"".concat(null==e?void 0:e._fromName," ").concat(n," ").concat(null==e?void 0:e._toName),label:(0,S.jsx)(t6.default,{title:r,children:r}),value:null==e?void 0:e._id});}):[];},[l,r]);return(0,S.jsx)(eN.default,(0,eR.default)({mode:"multiple",allowClear:!0,showSearch:!0,options:i,filterOption:function(e,t){return String(null==t?void 0:t.searchKey).toLowerCase().includes(e.toLowerCase());},placeholder:t({id:r===tR.SchemaType.ENTITY?"analysis-property-table.select-entity":"analysis-property-table.select-relation"})},o));}),t9=["schemaType"],t7=V.default.memo(function(e){var t=(0,eV.useIntl)().formatMessage,n=e.schemaType,r=void 0===n?tR.SchemaType.ENTITY:n,a=(0,eP.default)(e,t9);return(0,S.jsx)(eN.default,(0,eR.default)({showSearch:!0,filterOption:function(e,t){var n;return String(null!==(n=null==t?void 0:t.key)&&void 0!==n?n:null==t?void 0:t.label).toLowerCase().includes(e.toLowerCase());},placeholder:t({id:r===tR.SchemaType.ENTITY?"analysis-property-table.select-entity-type":"analysis-property-table.select-relation-type"})},a));}),t8=["entityOrRelationDataSource"],ne=V.default.memo(function(e){var t=e.schemaType,n=void 0===t?tR.SchemaType.ENTITY:t,r=e.typeSelectProps,a=e.entityOrRelationSelectProps,l=null!=a?a:{},o=l.entityOrRelationDataSource,i=(0,eP.default)(l,t8);return(0,S.jsxs)(t2.default,{style:{marginTop:"24px"},direction:"horizontal",children:[(0,S.jsx)(t7,(0,eR.default)((0,eR.default)({},r),{},{style:{width:"170px"},schemaType:n})),(0,S.jsx)(t4,(0,eR.default)((0,eR.default)({},i),{},{schemaType:n,style:{width:"280px"},dataSource:void 0===o?[]:o}))]});}),nt=n("fe5d4d35"),nn=n("6d1765ea"),nr=E._(nn),na=["schemaType","originData","tableDataRecord","schemaPropertyNameMap"],nl=["kgId","label"],no=nr.default.Text,ni=nr.default.Paragraph,nu=tS(V.default.memo(function(e){var t=(0,eV.useIntl)().formatMessage,n=e.schemaType,r=void 0===n?tR.SchemaType.ENTITY:n,a=e.originData,l=e.tableDataRecord,o=e.schemaPropertyNameMap,i=void 0===o?{}:o,u=(0,eP.default)(e,na),d=(0,V.useMemo)(function(){var e,t,n=null==l?void 0:l._id;return r===tR.SchemaType.ENTITY?null==a||null===(e=a.entities)||void 0===e?void 0:e.find(function(e){return(null==e?void 0:e.id)===n;}):r===tR.SchemaType.RELATION?null==a||null===(t=a.relations)||void 0===t?void 0:t.find(function(e){return(null==e?void 0:e.id)===n;}):void 0;},[r,a,l]),s=(0,eG.omit)((0,eR.default)({},null==d?void 0:d.properties),[].concat(nl)),c=(0,z.useSetState)({noEmptyPropertyValue:!1}),f=(0,ej.default)(c,2),p=f[0],m=f[1],h=p.noEmptyPropertyValue,y=(0,V.useMemo)(function(){return[{title:t({id:"analysis-property-table.property-name-zh"}),ellipsis:!0,dataIndex:"propertyNameZh",render:function(e){return(0,S.jsx)(no,{ellipsis:{tooltip:e},children:e});}},{title:t({id:"analysis-property-table.property-name-en"}),ellipsis:!0,dataIndex:"propertyNameEn",render:function(e){return(0,S.jsx)(no,{ellipsis:{tooltip:e},children:e});}},{title:t({id:"analysis-property-table.property-value"}),dataIndex:"propertyValue",render:function(e){return(0,S.jsx)(ni,{ellipsis:{rows:1,tooltip:e,expandable:!0,symbol:t({id:"global.expand"})},children:e});}}];},[t]),g=function(){if(r===tR.SchemaType.ENTITY){var e;return null!==(e=null==d?void 0:d.label)&&void 0!==e?e:"";}return r===tR.SchemaType.RELATION?(0,tP.getSpo)((0,eR.default)({},d),{sField:"fromType",pField:"label",oField:"toType"}):"";}(),b=(0,V.useMemo)(function(){return Object.entries(s).filter(function(e){var t=(0,ej.default)(e,2),n=(t[0],t[1]);return!h||n;}).map(function(e){var t=(0,ej.default)(e,2),n=t[0],r=t[1];return{propertyNameZh:i["".concat(g,".").concat(n)]||i[n],propertyNameEn:n,propertyValue:r};}).sort(function(e,t){return Number(!!t.propertyNameZh)-Number(!!e.propertyNameZh);});},[s,h,i,g]);return(0,S.jsx)(nt.Drawer,(0,eR.default)((0,eR.default)({},u),{},{children:(0,S.jsxs)("div",{style:{width:"100%",height:"100px",padding:"24px 12px"},children:[(0,S.jsx)("header",{className:"header",children:(0,S.jsx)(td.default,{value:h,onChange:function(e){return m({noEmptyPropertyValue:e.target.checked});},children:(0,S.jsx)(eV.FormattedMessage,{id:"analysis-property-table.property-not-empty-value"})})}),(0,S.jsx)(eF.default,{style:{marginTop:"24px"},rowKey:function(e){return e.propertyNameEn;},columns:y,dataSource:b,pagination:!1})]})}));})),nd=n("c60e02e5"),ns=E._(nd),nc=n("c3ef8c6b"),nf=function(){var e=(0,V.useState)({}),t=(0,ej.default)(e,2),n=t[0],r=t[1],a=(0,eV.useIntl)().formatMessage;return{copyModal:(0,V.useMemo)(function(){return{open:function(e,t){r({title:e,children:t,open:!0});}};},[]),copyContextHolder:(0,S.jsx)(ns.default,(0,eR.default)({onCancel:function(){return r({open:!1});},footer:[(0,S.jsx)(ew.default,{onClick:function(){return r({open:!1});},children:a({id:"global.cancel"})},"cancel"),(0,S.jsx)(nc.CopyToClipboard,{text:String(n.children),onCopy:function(){r({open:!1}),tN.default.success(a({id:"analysis-property-table.copy-success"}));},children:(0,S.jsx)(ew.default,{type:"primary",children:a({id:"global.copy"})},"ok")},"okClipboard")]},n))};},np=function(){var e=(0,V.useState)(!1),t=(0,ej.default)(e,2),n=t[0],r=t[1],a=(0,V.useState)(),l=(0,ej.default)(a,2);return{detailsState:{open:n,openDrawer:function(){return r(!0);},closeDrawer:function(){return r(!1);}},tableDataRecord:l[0],setTableDataRecord:l[1]};},nm=n("177a3ac5"),nh=E._(nm),ny=function(e){return"number"==typeof e||!!(0,eG.isString)(e)&&!!e.match(/^-?([1-9]\d*(\.\d*)?|0(\.\d*[1-9]\d*)?)$/);},ng=function(e){if(!(0,eG.isString)(e))return!1;var t=e.split("**").every(function(e){return ny(e);}),n=e.split(",").every(function(e){return ny(e);});return ny(e)||t||n;},nb=function(e){var t="\u5BFC\u51FA\u6570\u636E.csv";return e&&(t=e.indexOf(".csv")>0?e:e+".csv"),t;},nv=function(e,t){var n=[],r=[];return t&&t.length>0&&t.forEach(function(e){r.push(e.dataIndex),n.push((0,eG.isFunction)(e.title)?e.titleText:e.title);}),e&&e.length>0?{data:e,title:n,titleForKey:r}:{};},nx=function(e,t){var n=e.data,r=void 0===n?[]:n,a=e.titleForKey,l=void 0===a?[]:a,o=e.title,i=e.showPureNumber,u=void 0!==i&&i,d=[];o&&o.length>0&&d.push(o.join(",")+"\n");for(var s=0;s<r.length;s++){for(var c=[],f=0;f<l.length;f++){var p=String(l[f]),m=r[s][p]||"",h=!ng(m)||u?"":"	";"object"===(0,nh.default)(m)&&(m=JSON.stringify(m)),m=(m=String(m)).replaceAll('"',"'"),c.push('"'.concat(h).concat(m,'"'));}d.push(c.join(",")+"\n");}var y=document.createElement("a");y.download=t;var g=new Blob(["\uFEFF"+d.join("")],{type:"text/csv"});return y.href=URL.createObjectURL(g),y.click(),d;},nT="ALL_PROPERTIES",nI=function(e){return String(e.key||e.dataIndex);},nw=function(e){var t,n=e.schemaType,r=void 0===n?tR.SchemaType.ENTITY:n,a=e.propertyData,l=void 0===a?[]:a,o=e.typeSelectProps,i=e.selectedRows,u=void 0===i?[]:i,d=e.columns,s=void 0===d?[]:d,c=null!=o?o:{},f=c.value,p=c.options,m=(0,eV.useIntl)().formatMessage,h=(0,V.useState)(!1),y=(0,ej.default)(h,2),g=y[0],b=y[1],v=tT.default.useForm(),x=(0,ej.default)(v,1)[0],T=tT.default.useWatch("typeName",x),I=tT.default.useWatch("entityOrRelationItem",x),w=tT.default.useWatch("properties",x),E=(0,V.useMemo)(function(){return u.map(function(e){return e._id;});},[u]),N=(0,V.useMemo)(function(){return tH(l,{schemaType:r,typeName:T});},[l,r,T]),_=(0,V.useMemo)(function(){var e={label:m({id:"global.all"}),value:nT},t=s.map(function(e){return{label:e.titleText||e.title,value:nI(e),disabled:null==w?void 0:w.includes(nT)};});return[e].concat((0,e_.default)(t));},[s,w,m]),k=(0,V.useMemo)(function(){return null!=w&&w.includes(nT)?s:s.filter(function(e){return null==w?void 0:w.includes(nI(e));});},[w,s]),C=(0,V.useMemo)(function(){return r===tR.SchemaType.ENTITY?{label:m({id:"analysis-property-table.entity-type"}),validatorMessage:m({id:"analysis-property-table.select-entity-type"})}:{label:m({id:"analysis-property-table.relation-type"}),validatorMessage:m({id:"analysis-property-table.select-relation-type"})};},[r,m]),M=(0,V.useMemo)(function(){return r===tR.SchemaType.ENTITY?{label:m({id:"analysis-property-table.entity"}),validatorMessage:m({id:"analysis-property-table.select-entity"})}:{label:m({id:"analysis-property-table.relation"}),validatorMessage:m({id:"analysis-property-table.select-relation"})};},[r,m]),R=(0,V.useMemo)(function(){return{open:function(){b(!0);}};},[]),O=function(){if(Array.isArray(I)){var e=N.filter(function(e){return I.includes(e._id);}),t=nb(m({id:"analysis-property-table.result-table"}));nx(nv(e,k),t);}},j=(t=(0,tg.default)((0,th.default)().mark(function e(){return(0,th.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.validateFields();case 2:O(),b(!1);case 4:case"end":return e.stop();}},e);})),function(){return t.apply(this,arguments);});return{downloadModal:R,downloadContextHolder:(0,S.jsx)(ns.default,{open:g,title:m({id:"analysis-property-table.download"}),destroyOnClose:!0,onCancel:function(){return b(!1);},okButtonProps:{onClick:j},children:(0,S.jsxs)(tT.default,{form:x,preserve:!1,requiredMark:!1,labelAlign:"left",labelCol:{span:4},wrapperCol:{span:20},initialValues:{typeName:f,entityOrRelationItem:E},children:[(0,S.jsx)(tT.default.Item,{name:"typeName",label:C.label,rules:[{validator:function(e,t){return void 0===t?Promise.reject(C.validatorMessage):Promise.resolve();}}],children:(0,S.jsx)(t7,{schemaType:r,options:void 0===p?[]:p,onChange:function(){return x.setFieldsValue({entityOrRelationItem:[]});}})}),(0,S.jsx)(tT.default.Item,{name:"entityOrRelationItem",label:M.label,rules:[{required:!0,message:M.validatorMessage}],children:(0,S.jsx)(t4,{schemaType:r,dataSource:N})}),(0,S.jsx)(tT.default.Item,{name:"properties",label:m({id:"analysis-property-table.download.select-property"}),rules:[{required:!0,message:m({id:"validator.select.empty.x"},{content:m({id:"global.property"})})}],children:(0,S.jsx)(eN.default,{allowClear:!0,options:_,mode:"multiple",filterOption:function(e,t){var n;return String(null!==(n=null==t?void 0:t.key)&&void 0!==n?n:null==t?void 0:t.label).toLowerCase().includes(e.toLowerCase());},placeholder:m({id:"validator.select.empty.x"},{content:m({id:"global.property"})})})})]})})};},nE=function(e,t){var n=t.dataSource,r=(0,V.useState)([]),a=(0,ej.default)(r,2),l=a[0],o=a[1],i=(0,z.useControllableValue)(e,{defaultValuePropName:"defaultSelectedRowKeys",valuePropName:"selectedRowKeys",defaultValue:[]}),u=(0,ej.default)(i,2),d=u[0],s=u[1];(0,V.useEffect)(function(){o(n.filter(function(e){return null==d?void 0:d.includes(e[tR.TABLE_KEY_FIELD]);}));},[n,d]);var c=(0,eR.default)({selectedRowKeys:d,onChange:function(e){s(e);}},e);return{selectedRowKeys:d,selectedRows:l,rowSelection:c,clearRowSelection:function(){return s([]);}};},nN=n("1d4ae079"),nS=E._(nN),n_=n("a9235756"),nk=E._(n_),nC=V.forwardRef(function(e,t){return V.createElement(nk.default,(0,ez.default)({},e,{ref:t,icon:nS.default}));}),nM=n("5a2db505"),nR=E._(nM),nO=V.forwardRef(function(e,t){return V.createElement(nk.default,(0,ez.default)({},e,{ref:t,icon:nR.default}));}),nj=n("eb2640b6"),nL=E._(nj),nP=V.forwardRef(function(e,t){return V.createElement(nk.default,(0,ez.default)({},e,{ref:t,icon:nL.default}));}),nA=V.default.memo(function(e){var t=e.tooltip,n=e.status,r=e.onClick;return(0,S.jsxs)("span",{className:"".concat(tR.prefixCls,"-toggle-visible"),children:[n!==tR.SecretVisibleStatus.LOADING&&(0,S.jsx)("span",{onClick:r,children:(0,S.jsxs)(t6.default,{title:t,children:[n===tR.SecretVisibleStatus.VISIBLE&&(0,S.jsx)(nC,{}),n===tR.SecretVisibleStatus.INVISIBLE&&(0,S.jsx)(nO,{})]})}),n===tR.SecretVisibleStatus.LOADING&&(0,S.jsx)(nP,{})]});}),nF=function(e,t){var n,r,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=l.onApplySuccess,i=l.schemaType,u=l.typeName,d=(0,eV.useIntl)().formatMessage,s=(e||{}).getClearText,c=(0,V.useState)([]),f=(0,ej.default)(c,2),p=f[0],m=f[1],h=(0,z.useLatest)(p),y=(0,V.useMemo)(function(){return t.filter(function(e){return e.secret&&e.schemaType===i&&tK(e.label,u);});},[t,i,u]),g=(0,V.useMemo)(function(){return y.filter(function(e){var t;return(null===(t=e.secret)||void 0===t?void 0:t.status)===tR.SecretStatus.AGREE;});},[y]);(0,V.useEffect)(function(){m(function(e){return t.filter(function(e){var t;return(null===(t=e.secret)||void 0===t?void 0:t.status)===tR.SecretStatus.AGREE;}).map(function(t){var n=e.find(function(e){return e.key===t.key;});return(0,eR.default)((0,eR.default)({},n),{},{key:t.key});});});},[t]);var b=(0,V.useCallback)((0,tg.default)((0,th.default)().mark(function e(){var n,r,a;return(0,th.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=p.filter(function(e){var t=e.loading,n=e.clearText,r=e.visible;return!n&&!t&&r;})).length){e.next=3;break;}return e.abrupt("return");case 3:return r=n.map(function(e){var n,r=e.key,a=t.find(function(e){return e.key===r;}),l=t.find(function(e){var t;return e.key===(null==a||null===(t=a.linkedProperty)||void 0===t?void 0:t.propertyKey);})||a;return{instanceId:(null==l?void 0:l.instanceId)||"",typeName:(null==l?void 0:l.label)||"",typeId:(null==l||null===(n=l.secret)||void 0===n?void 0:n.typeId)||"",instanceName:(null==l?void 0:l.instance.name)||"",property:(null==l?void 0:l.name)||"",encryptedValue:(null==l?void 0:l.encryptedValue)||""};}),m(p.map(function(e){return(0,eR.default)((0,eR.default)({},e),{},{loading:!!n.some(function(t){return t.key===e.key;})||e.loading});})),e.next=8,null==s?void 0:s(r);case 8:if(e.t0=e.sent,e.t0){e.next=11;break;}e.t0=[];case 11:a=e.t0,m(h.current.map(function(e){var n=t.find(function(t){return t.key===e.key;}),r=a.find(function(t){var r,a=tV(t.instanceId,t.property);return a===e.key||a===(null==n||null===(r=n.linkedProperty)||void 0===r?void 0:r.propertyKey);}),l=r||e.clearText;return(0,eR.default)((0,eR.default)({},e),{},{clearText:l,loading:!r&&e.loading});}));case 14:case"end":return e.stop();}},e);})),[p,s,h,t]);(0,V.useEffect)(function(){b();},[b]);var v=(0,V.useCallback)(function(e){return e.map(function(e){return Object.keys(e).reduce(function(t,n){var r,a=p.find(function(t){return t.key===tV(e._id,n);}),l=null==a||null===(r=a.clearText)||void 0===r?void 0:r.value,o=null!=a&&a.visible&&l?l:e[n];return(0,eR.default)((0,eR.default)({},t),{},(0,eC.default)({},n,o));},{});});},[p]),x=function(e,t){m(p.map(function(n){return(0,eR.default)((0,eR.default)({},n),{},{visible:e.some(function(e){return e.key===n.key;})?t:n.visible});}));},T=(n=(0,tg.default)((0,th.default)().mark(function e(t,n){return(0,th.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x([t],n);case 1:case"end":return e.stop();}},e);})),function(e,t){return n.apply(this,arguments);}),I=(r=(0,tg.default)((0,th.default)().mark(function e(t,n){var r;return(0,th.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.secret,!n){e.next=10;break;}e.t0=null==r?void 0:r.status,e.next=e.t0===tR.SecretStatus.NONE?5:e.t0===tR.SecretStatus.WAIT?7:9;break;case 5:return tN.default.warning(d({id:"analysis-property-table.permission.deny"})),e.abrupt("return");case 7:return tN.default.warning(d({id:"analysis-property-table.permission.applying"})),e.abrupt("return");case 9:return e.abrupt("break",10);case 10:T(t,n);case 11:case"end":return e.stop();}},e);})),function(e,t){return r.apply(this,arguments);});return{transformDataSource:v,renderSecretExtra:function(e,n,r,a){var l=t.find(function(e){return e.key===tV(n._id,a);}),o=p.some(function(e){var t=e.key,n=e.visible;return t===(null==l?void 0:l.key)&&n;}),i=o?d({id:"analysis-property-table.clear-text.invisible"}):d({id:"analysis-property-table.clear-text.visible"}),u=o?tR.SecretVisibleStatus.VISIBLE:tR.SecretVisibleStatus.INVISIBLE;return p.some(function(e){return e.key===(null==l?void 0:l.key)&&e.loading;})&&(u=tR.SecretVisibleStatus.LOADING),!!(null==l?void 0:l.secret)&&(0,S.jsx)(nA,{tooltip:i,status:u,onClick:function(){return I(l,!o);}});},renderSecretTitle:(0,z.useMemoizedFn)(function(e,t){var n=g.length>0&&g.every(function(e){var t=p.find(function(t){return t.key===e.key;});return(null==t?void 0:t.visible)===!0;}),r=n?d({id:"analysis-property-table.all-clear-text.invisible"}):d({id:"analysis-property-table.all-clear-text.visible"}),a=n?tR.SecretVisibleStatus.VISIBLE:tR.SecretVisibleStatus.INVISIBLE;g.length>0&&g.every(function(e){var t=p.find(function(t){return t.key===e.key;});return(null==t?void 0:t.loading)===!0;})&&(a=tR.SecretVisibleStatus.LOADING);var l=g.filter(function(e){var t=p.find(function(t){return t.key===e.key;});return(null==t?void 0:t.loading)!==!0;}),o=0===t&&y.length>0;return(0,S.jsxs)(S.Fragment,{children:[e,o&&(0,S.jsx)("span",{className:"".concat(tR.prefixCls,"-toggle-visible"),children:(0,S.jsx)(nA,{tooltip:r,status:a,onClick:function(){if(0===g.length){tN.default.warning(d({id:"analysis-property-table.all-clear-text.empty"}));return;}x(l,!n);}})})]});}),applyForPermission:(a=(0,tg.default)((0,th.default)().mark(function t(n){var r,a,l;return(0,th.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(e||{}).submitApplication){t.next=3;break;}return t.abrupt("return");case 3:if(0!==n.types.length){t.next=6;break;}return tN.default.warning(d({id:"analysis-property-table.applying.submit.empty"})),t.abrupt("return");case 6:return t.next=8,r(n);case 8:if(l=(a=t.sent).approvalUrl){t.next=12;break;}return t.abrupt("return");case 12:return tN.default.success(d({id:"analysis-property-table.applying.submit.success"},{url:(0,S.jsx)(ew.default,{type:"link",href:l,target:"_blank",style:{padding:0},children:d({id:"analysis-property-table.applying.process.approval-progress"})})})),null==o||o(a),t.abrupt("return",a);case 15:case"end":return t.stop();}},t);})),function(e){return a.apply(this,arguments);})};},nD=["data","scrollX","scrollY","className","style","rowSecret","plain","fixLeft","schemaTypeNameMap","schemaPropertyNameMap","extraColumnsLeft","extraColumnsRight","rowSelection","enableOptimize","mergeOutEdgePropertiesIntoEntity","showTypeNameColumn"],nK=(x=eF.default,function(e){var t,n,r=e.columns,a=void 0===r?[]:r,l=e.dataSource,o=void 0===l?[]:l,i=e.scroll,u=(0,V.useState)(o),d=(0,ej.default)(u,2),s=d[0],c=d[1],f=ti(e).getRowKey,p=(0,V.useRef)(null),m=(0,V.useRef)(null),h=Number(null==i?void 0:i.y),y=null!==(t=null==a?void 0:a.filter(function(e){return!e.width;}).length)&&void 0!==t?t:0,g=(null!==(n=(0,z.useSize)(m))&&void 0!==n?n:{}).width,b=void 0===g?0:g,v=tc(e),T=v.column,I=v.extraDataSource,w=(0,V.useMemo)(function(){var e,t=null!==(e=null==a?void 0:a.map(function(e){var t;return(0,eR.default)((0,eR.default)({},e),{},{width:null!==(t=e.width)&&void 0!==t?t:Math.floor(b/y)});}))&&void 0!==e?e:[],n=[T].concat((0,e_.default)(t)).filter(Boolean),r=n.reduce(function(e,t){return e+Number.parseInt(String(t.width),10);},0);return r<b&&(n=n.map(function(e){return(0,eR.default)((0,eR.default)({},e),{},{width:Number.parseInt(String(e.width),10)*b/r});})),n;},[a,T,b,y]),E=(0,V.useMemo)(function(){return s.map(function(e){var t=I.find(function(t){return f(t)===f(e);});return(0,eR.default)((0,eR.default)({},e),t);});},[s,f,I]),N=E.reduce(function(e,t,n){return Object.keys(t).forEach(function(r){var a=w.findIndex(function(e){return tp(e)===r;}),l={rowIndex:n,columnIndex:a,data:t[r]};a>=0&&e.push(l);}),e;},[]),_=(0,V.useState)(function(){var e={scrollLeft:0};return Object.defineProperty(e,"scrollLeft",{get:function(){if(p.current){var e;return null===(e=p.current)||void 0===e||null===(e=e.state)||void 0===e?void 0:e.scrollLeft;}return null;},set:function(e){p.current&&p.current.scrollTo({scrollLeft:e});}}),e;}),k=(0,ej.default)(_,1)[0],C=function(){if(p.current){var e;(null===(e=p.current)||void 0===e?void 0:e.resetAfterIndices.bind(e))({columnIndex:0,shouldForceUpdate:!0});}};(0,V.useEffect)(function(){return C;},[b]),(0,z.useUpdateEffect)(function(){var e;null===(e=p.current)||void 0===e||e.resetAfterColumnIndex(0);},[w.length]),(0,z.useUpdateEffect)(function(){c(o);},[o]);var M=function(e,t,n){var r=Number(w[e].width);return t>h&&e===w.length-1?r-n-1:r;},R=function(e){var t,n,r=e.columnIndex,a=e.rowIndex,l=e.className,o=e.style,i=w[r],u=E[a],d=u[tp(i)],s=null===(t=i.render)||void 0===t?void 0:t.call(i,d,u,a),c=null!=s?s:d;return(0,S.jsx)("div",{className:(0,eU.default)("virtual-table-cell",l,i.className,{"virtual-table-cell-last":r===w.length-1,"ant-table-cell-ellipsis":i.ellipsis}),title:(null==i||null===(n=i.ellipsis)||void 0===n?void 0:n.showTitle)===!1?void 0:d,style:o,children:c},tp(i)+f(u));},O=function(e){var t=e.map(function(e){return e.props.rowIndex;}),n=N.filter(function(e){var n=w[e.columnIndex];return t.includes(e.rowIndex)&&n.fixed;}),r=(n=(0,eG.sortBy)(n,function(e){return e.columnIndex+e.rowIndex;})).map(function(e,t){var r,a=e.columnIndex,l=n[0],o=w[a],i=n[t-1],u=(null==i?void 0:i.rowIndex)===e.rowIndex?i:void 0,d=w[Number(null==u?void 0:u.columnIndex)],s={width:o.width,height:54,left:null!==(r=null==d?void 0:d.width)&&void 0!==r?r:0,marginTop:d?-54:void 0,transform:"translate(".concat(0,"px,",54*l.rowIndex,"px)")},c=(0,eU.default)((0,eC.default)({},"ant-table-cell-fix-".concat(o.fixed),o.fixed));return R((0,eR.default)((0,eR.default)({},e),{},{style:s,data:e.data,className:c}));}),a=e.map(function(e){return w[e.props.columnIndex].fixed?null:e;});return(0,S.jsxs)(S.Fragment,{children:[r,a]});},j=V.default.forwardRef(function(e,t){var n=e.children,r=(0,eP.default)(e,tf);return(0,S.jsx)("div",(0,eR.default)((0,eR.default)({ref:t},r),{},{children:O(n)}));});return(0,S.jsx)("div",{ref:m,children:(0,S.jsx)(x,(0,eR.default)((0,eR.default)({},e),{},{columns:w,rowSelection:void 0,components:{body:s.length?function(e,t){var n=t.scrollbarSize,r=t.ref,a=t.onScroll;r.current=k;var l=54*e.length;return e&&c(e),(0,S.jsx)(tl,{ref:p,className:"virtual-grid",columnCount:w.length,columnWidth:function(e){return M(e,l,n);},height:Math.min(l,h),innerElementType:j,rowCount:E.length,rowHeight:function(){return 54;},width:b,onScroll:function(e){return a({scrollLeft:e.scrollLeft});},children:R});}:function(){return(0,S.jsx)(ea.default,{});}}}))});}),nB=V.default.memo(function(e){var t,n=e.data,r=e.scrollX,a=e.scrollY,l=e.className,o=e.style,i=e.rowSecret,u=e.plain,d=e.fixLeft,s=e.schemaTypeNameMap,c=void 0===s?{}:s,f=e.schemaPropertyNameMap,p=void 0===f?{}:f,m=e.extraColumnsLeft,h=void 0===m?[]:m,y=e.extraColumnsRight,g=void 0===y?[]:y,b=e.rowSelection,v=e.enableOptimize,x=e.mergeOutEdgePropertiesIntoEntity,T=void 0===x||x,I=e.showTypeNameColumn,w=void 0!==I&&I,E=(0,eP.default)(e,nD),N=(0,eV.useIntl)(),_=N.formatMessage,k=N.locale,C=(0,z.useControllableValue)(e,tR.SchemaTabControllableOption),M=(0,ej.default)(C,2),R=M[0],O=M[1],j=(0,V.useState)(""),L=(0,ej.default)(j,2),P=L[0],A=L[1],F=(0,V.useState)(!1),D=(0,ej.default)(F,2),K=D[0],B=D[1],U=nf(),G=U.copyModal,W=U.copyContextHolder,q=np(),Y=q.detailsState,H=q.tableDataRecord,$=q.setTableDataRecord,X=(i||{}).secretData,Z=void 0===X?[]:X,Q=tZ(n.entities,"id"),J=tZ(n.relations,"id"),ee=(0,V.useMemo)(function(){return tq(n);},[Q,J]),et=(0,V.useMemo)(function(){return tY(ee,Z,T);},[ee,tZ(Z,"property")]),en=(0,V.useMemo)(function(){var e=["name","id","label","relationTypeName",tR.BuildInPropertyName.FromName,tR.BuildInPropertyName.FromId,tR.BuildInPropertyName.ToName,tR.BuildInPropertyName.ToId,tR.BuildInPropertyName.TypeName].reduce(function(e,t){return(0,eR.default)((0,eR.default)({},e),{},(0,eC.default)({},t,_({id:"analysis-property-table.property.".concat(t)})));},{});return(0,eR.default)((0,eR.default)({},e),p);},[_,p]),er=(0,V.useMemo)(function(){var e={value:"",label:_({id:"global.all"})},t=(R===tR.SchemaType.ENTITY?ee.entities:ee.relations).map(function(e){var t=(0,eR.default)({labelZh:c[e.label]||en[e.label]},e);if(!t.labelZh&&tD(e)){var n=et.find(function(t){return t.typePropertyKey===tG({label:e.fromType},e.label);});n&&(t.labelZh=en[tW(n)]);}return{value:e.label,label:(0,eW.getMixedLocaleFieldValue)(t,{locale:k,fieldName:"label"})};});return(0,eG.uniqBy)([e].concat((0,e_.default)(t)),"value");},[_,R,ee.entities,ee.relations,et,c,en,k]),ea=(0,V.useMemo)(function(){return er.map(function(e){var t=e.label,n=e.value;return{label:t,key:n,value:n};});},[er]),el=(0,V.useState)([]),eo=(0,ej.default)(el,2),ei=eo[0],eu=eo[1],ed=function(e){eu([]),A(e),ex();},es=nF(i||{},et,{schemaType:R,typeName:P,onApplySuccess:function(){B(!1);}}),ec=es.renderSecretExtra,ef=es.renderSecretTitle,ep=es.transformDataSource,em=es.applyForPermission,eh=(0,V.useMemo)(function(){var e=tH(et,{schemaType:R,typeName:P});return i&&(e=ep(e)),e;},[et,R,P,i,ep]),ey=(0,V.useMemo)(function(){return(0,eG.isEmpty)(ei)?eh:eh.filter(function(e){return null==ei?void 0:ei.includes(e._id);});},[eh,ei]),eg=nE(null!=b?b:{},{dataSource:eh}),eb=eg.rowSelection,ev=eg.selectedRows,ex=eg.clearRowSelection,eT=(0,V.useCallback)(function(e){Y.openDrawer(),$(e);},[Y,$]),eI=(0,V.useMemo)(function(){var e=t$(et,{schemaType:R,typeName:P,locale:k,schemaPropertyNameMap:en,fixLeft:d,excludes:w?[]:[tR.BuildInPropertyName.TypeName],renderTitle:function(e,t,n){return i&&ef(e,t,n);},renderExtra:function(e,t,n,r){return i&&ec(e,t,n,r);},onCellDoubleClick:function(e,t){G.open(String(e),t);},onItemNameClick:u?void 0:eT});return[].concat((0,e_.default)(h),(0,e_.default)(e),(0,e_.default)(g));},[et,R,P,k,en,d,h,g,i,G,u,ef,ec,eT]),eE=eI.reduce(function(e,t){return e+Number.parseInt(String(t.width),10);},0),eN={value:P,options:ea},eS={entityOrRelationDataSource:eh},ek=nw({schemaType:R,propertyData:et,typeSelectProps:eN,entityOrRelationSelectProps:eS,selectedRows:ev,columns:eI}),eM=ek.downloadModal,eO=ek.downloadContextHolder,eL=void 0===v||v?nK:eF.default,eA={title:R===tR.SchemaType.ENTITY?null==H?void 0:H.name:null!==(t=null==H?void 0:H.name)&&void 0!==t?t:null==H?void 0:H.relationTypeName,width:700,open:Y.open,onClose:Y.closeDrawer};return(0,S.jsx)(tj.Provider,{value:{schemaTypeNameMap:c,schemaPropertyNameMap:en},children:(0,S.jsxs)("div",{className:(0,eU.default)(tR.prefixCls,l),style:(0,eR.default)({},o),children:[!u&&(0,S.jsx)(eK.default,{size:"large",className:"".concat(tR.prefixCls,"-schema-tabs"),activeKey:R,onChange:function(e){eu([]),O(e),A(er[0].value),ex();},tabBarExtraContent:{right:i&&(0,S.jsx)(ew.default,{onClick:function(){B(!0);},children:_({id:"analysis-property-table.clear-text.batch-apply"})})},items:[{label:_({id:"global.entity"}),key:tR.SchemaType.ENTITY},{label:_({id:"global.relation"}),key:tR.SchemaType.RELATION,disabled:0===ee.relations.length}]}),!u&&(0,S.jsx)(ne,{schemaType:R,typeSelectProps:(0,eR.default)((0,eR.default)({},eN),{},{onChange:ed}),entityOrRelationSelectProps:(0,eR.default)((0,eR.default)({},eS),{},{value:ei,onChange:eu})}),!u&&(0,S.jsxs)("div",{className:"".concat(tR.prefixCls,"-toolbar-container"),children:[(0,S.jsx)(eK.default,{activeKey:P,onChange:ed,items:ea}),(0,S.jsx)("div",{className:"".concat(tR.prefixCls,"-toolbar-actions"),children:(0,S.jsx)(ew.default,{type:"link",onClick:function(){return eM.open();},children:_({id:"analysis-property-table.download"})})})]}),(0,S.jsx)(eL,(0,eR.default)((0,eR.default)({scroll:{x:r||eE,y:a||500},showSorterTooltip:!1,rowKey:function(e){return e[tR.TABLE_KEY_FIELD];},pagination:!1,rowSelection:eb},E),{},{expandable:{childrenColumnName:"___children"},dataSource:ey,columns:eI})),(0,S.jsx)(t0,{propertyData:et,visible:K,destroyOnClose:!0,onSubmit:em,onClose:function(){return B(!1);}}),W,eO,(0,S.jsx)(nu,(0,eR.default)((0,eR.default)({},eA),{},{schemaType:R,originData:ee,tableDataRecord:H,schemaPropertyNameMap:en}))]})});});nB.displayName="AnalysisPropertyTable";var nU=n("d8620b1c"),nG=n("073a1148"),nV=N._(nG);let nW=P.styled.div`
  display: flex;
  margin-bottom: 16px;

  .searchFieldsWrapper {
    display: flex;
    padding: 22px 25px 25px;
    border-radius: 12px;
    background-color: #fff;
    background: #ffffff;
    border-radius: 8px;
    box-shadow: 0px 0px 1px 0px #00000014, 0px 1px 2px 0px #190f0f12,
      0px 2px 4px 0px #0000000d;
  }

  .knowledgeNameField {
    margin-bottom: 0;
  }

  .typeSelector {
    align-self: flex-end;
    width: 226px !important;
  }

  .nameInput {
    align-self: flex-end;
    width: 226px;
  }

  .matchOption {
    align-self: center;
    min-width: 156px;
    white-space: nowrap;
  }

  .optionDescription {
    color: #525964;
    font-size: 14px;
  }

  .buttonGroup {
    display: flex;
    align-self: center;
    margin-left: 16px;
  }

  .resetButton {
    border-color: #d6d8da;
    background-color: #fff;
    color: #525964;
  }

  .searchButton {
    margin-left: 8px;
    border: none;
  }
`,nq={label:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.All",dm:"\u5168\u90E8"}),value:"all"};(T=w||(w={})).knowledgeType="label",T.knowledgeName="queryStr",T.matchExactOnly="matchExactOnly";let nz=e=>{let{onFinish:t}=e,[n]=tT.default.useForm(),{data:r}=(0,R.useSchemaData)(),a=(0,F.useMemo)(()=>null==r?void 0:r.nodes.map(e=>({label:(0,_.getMixedLocaleFieldValue)(e),value:e.name})),[r]),l={label:nq.value},o=[nq,...a??[]];return(0,S.jsx)(nW,{children:(0,S.jsx)(tT.default,{form:n,layout:"horizontal",onFinish:t,style:{width:"100%"},initialValues:l,children:(0,S.jsxs)("div",{className:"searchFieldsWrapper",children:[(0,S.jsx)(tT.default.Item,{name:"label",label:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.TypeOfKnowledge",dm:"\u77E5\u8BC6\u7C7B\u578B"}),className:"knowledgeNameField",style:{marginRight:24},children:(0,S.jsx)(eN.default,{options:o,className:"typeSelector"})}),(0,S.jsx)(tT.default.Item,{name:"queryStr",label:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.NameOfKnowledge",dm:"\u77E5\u8BC6\u540D\u79F0"}),className:"knowledgeNameField",rules:[{required:!0}],requiredMark:"optional",children:(0,S.jsx)(tw.default,{className:"nameInput",placeholder:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.PleaseEnterAKnowledgeName",dm:"\u8BF7\u8F93\u5165\u77E5\u8BC6\u540D\u79F0"})})}),(0,S.jsx)(tT.default.Item,{className:"knowledgeNameField",style:{marginLeft:"auto"},children:(0,S.jsxs)("div",{className:"buttonGroup",children:[(0,S.jsx)(ew.default,{className:"resetButton",onClick:()=>{n.resetFields();},children:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.Reset",dm:"\u91CD\u7F6E"})}),(0,S.jsx)(ew.default,{type:"primary",htmlType:"submit",className:"searchButton",children:L.default.get({id:"spg.KnowledgeExploration.components.ExplorationFilter.Check",dm:"\u67E5\u8BE2"})})]})})]})})});},nY=P.styled.div`
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;

  .main {
    flex: 1;
    background: #ffffff;
    padding-inline: 24px;
    padding-bottom: 24px;
    border-radius: 8px;
    box-shadow: 0px 0px 1px 0px #00000014, 0px 1px 2px 0px #190f0f12,
      0px 2px 4px 0px #0000000d;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  .listContainer {
    padding-bottom: 0;
  }

  .titleWrap {
    display: flex;
    align-items: center;
    column-gap: 8px;
  }

  .titleRow {
    display: flex;
    height: 64px;
    align-items: center;
    justify-content: space-between;
  }

  .title {
    font-size: 16;
    font-weight: 500;
  }

  .typeFilterWrap {
    display: flex;
    column-gap: 8px;
  }

  .tableWrapper {
    flex: 1;
  }

  .loadMoreWrap {
    display: flex;
    margin-right: 16px;
    order: -1;
    align-items: center;
    column-gap: 16px;
  }

  .empty {
    margin: 0;
    padding: 32px;
  }

  .graphContainer {
    top: 0;
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: #fff;
    padding: 0;
    z-index: 2;

    .graphContainerTitle {
      position: absolute;
      left: 24px;
      top: 16px;
      z-index: 3;
    }
  }

  .ant-btn-primary[disabled],
  .ant-btn-primary[disabled]:hover {
    color: #fff;
    border-color: #2f54eb;
    background: #2f54eb;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.12);
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
    opacity: 0.5;
  }
`,nH={},n$=[],nX={queryStr:"",label:"",page:1,size:50,matchExactOnly:!1},nZ=()=>{let e=(0,X.useProjectId)(),t=(0,F.useRef)(null),{height:n}=(0,z.useSize)(t)??{},[r,a]=(0,F.useState)(!1),[l,o]=(0,F.useState)([]),[i,u]=(0,F.useState)(),[d,s]=(0,z.useSetState)(nX),[c,f]=(0,F.useState)(n$),[p,m]=(0,F.useState)(),{data:h=nH}=(0,O.useSchemaPropertyNameMap)(),y={projectId:Number(e),...d},{data:g,isFetching:b}=(0,P.useQuery)({queryFn:async()=>{let e=await (0,$.search)(y);return e.success?e.result:Promise.reject(e);},queryKey:["KnowledgeExploration/search",y],enabled:!!(e&&y.label&&y.queryStr),keepPreviousData:!0}),{results:v=n$}=g??{},x=(0,F.useMemo)(()=>(0,D.keyBy)(c,"id"),[c]),T=(0,F.useMemo)(()=>Object.entries((0,D.groupBy)(c,e=>e.label)).map(([e])=>({label:(0,_.getMixedLocaleFieldValue)({name:e,nameZh:h[e]}),value:e})),[c,h]),I=(0,F.useMemo)(()=>{let e={};return c.forEach(t=>{Object.keys(t.properties??{}).forEach(n=>{e[n]=nV.getPropertyFullName(n,t.label??"",h);});}),e;},[c,h]),w=(0,F.useMemo)(()=>{let e=c;return i&&(e=e.filter(e=>e.label===i)),(0,D.isEmpty)(p)||(e=e.filter(e=>nV.hitConditions(e.properties,p))),e;},[c,i,p]),E=(0,F.useMemo)(()=>({nodes:l.map(e=>x[String(e)]),edges:[]}),[l]),N=()=>{s(e=>({page:e.page+1}));};return(0,z.useUpdateEffect)(()=>{f(n$);},[d.label,d.queryStr,d.size,d.matchExactOnly]),(0,z.useUpdateEffect)(()=>{let e=v.map(e=>{var t,n;return{id:e.docId??(null===(t=e.fields)||void 0===t?void 0:t.id)??"",name:(null===(n=e.fields)||void 0===n?void 0:n.name)??"",label:e.label??"",properties:e.fields??{}};});f(t=>t.concat(e));},[v]),(0,S.jsxs)(nY,{children:[(0,S.jsx)(nz,{onFinish:e=>{s(e);}}),(0,S.jsxs)("main",{className:"main listContainer",children:[(0,S.jsx)(K.OverlaySpin,{spinning:b}),(0,S.jsxs)("div",{className:"titleRow",children:[(0,S.jsxs)("div",{className:"titleWrap",children:[(0,S.jsx)("div",{className:"title",children:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.KnowledgeList",dm:"\u77E5\u8BC6\u5217\u8868"})}),(0,S.jsx)(eT.default,{count:w.length??0,color:"#00000013",style:{color:"#000a1aae"}})]}),!(0,D.isEmpty)(c)&&(0,S.jsxs)("div",{className:"typeFilterWrap",children:[(0,S.jsx)(eN.default,{allowClear:!0,style:{width:228,marginRight:16},placeholder:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.CanBeFilteredByKnowledge",dm:"\u53EF\u6309\u77E5\u8BC6\u7C7B\u578B\u7B5B\u9009"}),options:T,value:i,onChange:u}),(0,S.jsx)(nU.PropertyFilterPopover,{propertyNames:I,onChange:m,children:(0,S.jsx)(ew.default,{type:"default",children:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.Filter",dm:"\u7B5B\u9009"})})}),(0,S.jsx)(ew.default,{type:"primary",disabled:!l.length,onClick:()=>a(!0),children:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.CanvasProfiler",dm:"\u753B\u5E03\u63A2\u67E5"})})]})]}),!(0,D.isEmpty)(w)&&(0,S.jsx)("div",{className:"tableWrapper",ref:t,children:n&&(0,S.jsx)(nB,{plain:!0,showTypeNameColumn:!0,schemaTypeNameMap:h,schemaPropertyNameMap:h,data:{entities:w,relations:[]},rowSelection:{selectedRowKeys:l,onChange:e=>o(e)},pagination:{pageSize:(()=>{if(!n)return 9;let e=(n-64-55)/54;return e<=2?2:Math.floor(e);})(),showSizeChanger:!1,showTotal:e=>(0,S.jsxs)("div",{className:"loadMoreWrap",children:[(0,S.jsx)("span",{style:{color:"rgba(0,0,0,0.45)"},children:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.LoadedFrontTotal",dm:"\u5DF2\u52A0\u8F7D\u524D{total}\u6761"},{total:e})}),(null==v?void 0:v.length)>=d.size&&(0,S.jsx)("a",{onClick:N,children:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.LoadMore",dm:"\u52A0\u8F7D\u66F4\u591A"})})]})}})}),(0,D.isEmpty)(c)&&(0,S.jsx)(ea.default,{className:"empty",description:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.NoKnowledgeListPleaseSearch",dm:"\u6682\u65E0\u77E5\u8BC6\u5217\u8868\uFF0C\u8BF7\u8FDB\u884C\u5148\u67E5\u8BE2\u641C\u7D22"}),image:ea.default.PRESENTED_IMAGE_SIMPLE}),!(0,D.isEmpty)(c)&&(0,D.isEmpty)(w)&&(0,S.jsx)(ea.default,{className:"empty",description:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.NoMatchingResultsPleaseTry",dm:"\u65E0\u7B26\u5408\u6761\u4EF6\u7684\u7ED3\u679C\uFF0C\u8BF7\u5C1D\u8BD5\u66F4\u6362\u7B5B\u9009\u6761\u4EF6"}),image:ea.default.PRESENTED_IMAGE_SIMPLE})]}),r&&(0,S.jsxs)("main",{className:"main graphContainer",children:[(0,S.jsx)(ev.Title,{showBack:!0,className:"graphContainerTitle",level:"block",title:L.default.get({id:"spg.KnowledgeModeling.KnowledgeExploration.Manage.ReturnToTable",dm:"\u8FD4\u56DE\u8868\u683C"}),goBackCb:()=>a(!1)}),(0,S.jsx)(eb,{graphData:E})]})]});};},a675bf5f:function(e,t,n){n.d(t,"__esModule",{value:!0}),n.e(t,{getExtraStyleConfig:function(){return tt;},useSchemaStaticConfig:function(){return tn;}});var r=n("777fffbe"),a=n("5b5ed4a9"),l=n("fc1f4356"),o=n("3834a44f"),i=n("d2dd95e3"),u=r._(i);let d=(...e)=>new d.Color(...e);d.Color=u.default,d.version="2.6.0";var s=n("4e6f4eec"),c=r._(s),f=n("6b30f28c");let{max:p}=Math,m=(...e)=>{let[t,n,r]=(0,f.unpack)(e,"rgb"),a=1-p(t/=255,p(n/=255,r/=255)),l=a<1?1/(1-a):0;return[(1-t-a)*l,(1-n-a)*l,(1-r-a)*l,a];};u.default.prototype.cmyk=function(){return m(this._rgb);},d.cmyk=(...e)=>new u.default(...e,"cmyk"),c.default.format.cmyk=(...e)=>{let[t,n,r,a]=e=(0,f.unpack)(e,"cmyk"),l=e.length>4?e[4]:1;return 1===a?[0,0,0,l]:[t>=1?0:255*(1-t)*(1-a),n>=1?0:255*(1-n)*(1-a),r>=1?0:255*(1-r)*(1-a),l];},c.default.autodetect.push({p:2,test:(...e)=>{if(e=(0,f.unpack)(e,"cmyk"),"array"===(0,f.type)(e)&&4===e.length)return"cmyk";}});let h=e=>Math.round(100*e)/100,y=(...e)=>{let t=(0,f.unpack)(e,"hsla"),n=(0,f.last)(e)||"lsa";return t[0]=h(t[0]||0),t[1]=h(100*t[1])+"%",t[2]=h(100*t[2])+"%","hsla"===n||t.length>3&&t[3]<1?(t[3]=t.length>3?t[3]:1,n="hsla"):t.length=3,`${n}(${t.join(",")})`;},g=(...e)=>{let t,n;let[r,a,l]=e=(0,f.unpack)(e,"rgba");r/=255,a/=255,l/=255;let o=(0,f.min)(r,a,l),i=(0,f.max)(r,a,l),u=(i+o)/2;return(i===o?(t=0,n=Number.NaN):t=u<.5?(i-o)/(i+o):(i-o)/(2-i-o),r==i?n=(a-l)/(i-o):a==i?n=2+(l-r)/(i-o):l==i&&(n=4+(r-a)/(i-o)),(n*=60)<0&&(n+=360),e.length>3&&void 0!==e[3])?[n,t,u,e[3]]:[n,t,u];},{round:b}=Math,v=(...e)=>{let t=(0,f.unpack)(e,"rgba"),n=(0,f.last)(e)||"rgb";return"hsl"==n.substr(0,3)?y(g(t),n):(t[0]=b(t[0]),t[1]=b(t[1]),t[2]=b(t[2]),("rgba"===n||t.length>3&&t[3]<1)&&(t[3]=t.length>3?t[3]:1,n="rgba"),`${n}(${t.slice(0,"rgb"===n?3:4).join(",")})`);},{round:x}=Math,T=(...e)=>{let t,n,r;let[a,l,o]=e=(0,f.unpack)(e,"hsl");if(0===l)t=n=r=255*o;else{let e=[0,0,0],i=[0,0,0],u=o<.5?o*(1+l):o+l-o*l,d=2*o-u,s=a/360;e[0]=s+1/3,e[1]=s,e[2]=s-1/3;for(let t=0;t<3;t++)e[t]<0&&(e[t]+=1),e[t]>1&&(e[t]-=1),6*e[t]<1?i[t]=d+(u-d)*6*e[t]:2*e[t]<1?i[t]=u:3*e[t]<2?i[t]=d+(u-d)*(2/3-e[t])*6:i[t]=d;[t,n,r]=[x(255*i[0]),x(255*i[1]),x(255*i[2])];}return e.length>3?[t,n,r,e[3]]:[t,n,r,1];},I=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,w=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,E=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,N=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,S=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,_=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:k}=Math,C=e=>{let t;if(e=e.toLowerCase().trim(),c.default.format.named)try{return c.default.format.named(e);}catch(e){}if(t=e.match(I)){let e=t.slice(1,4);for(let t=0;t<3;t++)e[t]=+e[t];return e[3]=1,e;}if(t=e.match(w)){let e=t.slice(1,5);for(let t=0;t<4;t++)e[t]=+e[t];return e;}if(t=e.match(E)){let e=t.slice(1,4);for(let t=0;t<3;t++)e[t]=k(2.55*e[t]);return e[3]=1,e;}if(t=e.match(N)){let e=t.slice(1,5);for(let t=0;t<3;t++)e[t]=k(2.55*e[t]);return e[3]=+e[3],e;}if(t=e.match(S)){let e=t.slice(1,4);e[1]*=.01,e[2]*=.01;let n=T(e);return n[3]=1,n;}if(t=e.match(_)){let e=t.slice(1,4);e[1]*=.01,e[2]*=.01;let n=T(e);return n[3]=+t[4],n;}};C.test=e=>I.test(e)||w.test(e)||E.test(e)||N.test(e)||S.test(e)||_.test(e),u.default.prototype.css=function(e){return v(this._rgb,e);},d.css=(...e)=>new u.default(...e,"css"),c.default.format.css=C,c.default.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&"string"===(0,f.type)(e)&&C.test(e))return"css";}}),c.default.format.gl=(...e)=>{let t=(0,f.unpack)(e,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t;},d.gl=(...e)=>new u.default(...e,"gl"),u.default.prototype.gl=function(){let e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]];};let{floor:M}=Math,R=(...e)=>{let t;let[n,r,a]=(0,f.unpack)(e,"rgb"),l=(0,f.min)(n,r,a),o=(0,f.max)(n,r,a),i=o-l;return 0===i?t=Number.NaN:(n===o&&(t=(r-a)/i),r===o&&(t=2+(a-n)/i),a===o&&(t=4+(n-r)/i),(t*=60)<0&&(t+=360)),[t,100*i/255,l/(255-i)*100];};u.default.prototype.hcg=function(){return R(this._rgb);},d.hcg=(...e)=>new u.default(...e,"hcg"),c.default.format.hcg=(...e)=>{let t,n,r;let[a,l,o]=e=(0,f.unpack)(e,"hcg");o*=255;let i=255*l;if(0===l)t=n=r=o;else{360===a&&(a=0),a>360&&(a-=360),a<0&&(a+=360);let e=M(a/=60),u=a-e,d=o*(1-l),s=d+i*(1-u),c=d+i*u,f=d+i;switch(e){case 0:[t,n,r]=[f,c,d];break;case 1:[t,n,r]=[s,f,d];break;case 2:[t,n,r]=[d,f,c];break;case 3:[t,n,r]=[d,s,f];break;case 4:[t,n,r]=[c,d,f];break;case 5:[t,n,r]=[f,d,s];}}return[t,n,r,e.length>3?e[3]:1];},c.default.autodetect.push({p:1,test:(...e)=>{if(e=(0,f.unpack)(e,"hcg"),"array"===(0,f.type)(e)&&3===e.length)return"hcg";}});let O=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,j=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,L=e=>{if(e.match(O)){(4===e.length||7===e.length)&&(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);let t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1];}if(e.match(j)){(5===e.length||9===e.length)&&(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);let t=parseInt(e,16),n=Math.round((255&t)/255*100)/100;return[t>>24&255,t>>16&255,t>>8&255,n];}throw Error(`unknown hex color: ${e}`);},{round:P}=Math,A=(...e)=>{let[t,n,r,a]=(0,f.unpack)(e,"rgba"),l=(0,f.last)(e)||"auto";void 0===a&&(a=1),"auto"===l&&(l=a<1?"rgba":"rgb");let o="000000"+((t=P(t))<<16|(n=P(n))<<8|(r=P(r))).toString(16);o=o.substr(o.length-6);let i="0"+P(255*a).toString(16);switch(i=i.substr(i.length-2),l.toLowerCase()){case"rgba":return`#${o}${i}`;case"argb":return`#${i}${o}`;default:return`#${o}`;}};u.default.prototype.hex=function(e){return A(this._rgb,e);},d.hex=(...e)=>new u.default(...e,"hex"),c.default.format.hex=L,c.default.autodetect.push({p:4,test:(e,...t)=>{if(!t.length&&"string"===(0,f.type)(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex";}});let{cos:F}=Math,{min:D,sqrt:K,acos:B}=Math,U=(...e)=>{let t,[n,r,a]=(0,f.unpack)(e,"rgb"),l=D(n/=255,r/=255,a/=255),o=(n+r+a)/3,i=o>0?1-l/o:0;return 0===i?t=NaN:(t=B(t=(n-r+(n-a))/2/K((n-r)*(n-r)+(n-a)*(r-a))),a>r&&(t=f.TWOPI-t),t/=f.TWOPI),[360*t,i,o];};u.default.prototype.hsi=function(){return U(this._rgb);},d.hsi=(...e)=>new u.default(...e,"hsi"),c.default.format.hsi=(...e)=>{let t,n,r;let[a,l,o]=e=(0,f.unpack)(e,"hsi");return isNaN(a)&&(a=0),isNaN(l)&&(l=0),a>360&&(a-=360),a<0&&(a+=360),(a/=360)<1/3?n=1-((r=(1-l)/3)+(t=(1+l*F(f.TWOPI*a)/F(f.PITHIRD-f.TWOPI*a))/3)):a<2/3?(a-=1/3,r=1-((t=(1-l)/3)+(n=(1+l*F(f.TWOPI*a)/F(f.PITHIRD-f.TWOPI*a))/3))):(a-=2/3,t=1-((n=(1-l)/3)+(r=(1+l*F(f.TWOPI*a)/F(f.PITHIRD-f.TWOPI*a))/3))),[255*(t=(0,f.limit)(o*t*3)),255*(n=(0,f.limit)(o*n*3)),255*(r=(0,f.limit)(o*r*3)),e.length>3?e[3]:1];},c.default.autodetect.push({p:2,test:(...e)=>{if(e=(0,f.unpack)(e,"hsi"),"array"===(0,f.type)(e)&&3===e.length)return"hsi";}}),u.default.prototype.hsl=function(){return g(this._rgb);},d.hsl=(...e)=>new u.default(...e,"hsl"),c.default.format.hsl=T,c.default.autodetect.push({p:2,test:(...e)=>{if(e=(0,f.unpack)(e,"hsl"),"array"===(0,f.type)(e)&&3===e.length)return"hsl";}});let{floor:G}=Math,{min:V,max:W}=Math,q=(...e)=>{let t,n,r;let[a,l,o]=e=(0,f.unpack)(e,"rgb"),i=V(a,l,o),u=W(a,l,o),d=u-i;return r=u/255,0===u?(t=Number.NaN,n=0):(n=d/u,a===u&&(t=(l-o)/d),l===u&&(t=2+(o-a)/d),o===u&&(t=4+(a-l)/d),(t*=60)<0&&(t+=360)),[t,n,r];};u.default.prototype.hsv=function(){return q(this._rgb);},d.hsv=(...e)=>new u.default(...e,"hsv"),c.default.format.hsv=(...e)=>{let t,n,r;let[a,l,o]=e=(0,f.unpack)(e,"hsv");if(o*=255,0===l)t=n=r=o;else{360===a&&(a=0),a>360&&(a-=360),a<0&&(a+=360);let e=G(a/=60),i=a-e,u=o*(1-l),d=o*(1-l*i),s=o*(1-l*(1-i));switch(e){case 0:[t,n,r]=[o,s,u];break;case 1:[t,n,r]=[d,o,u];break;case 2:[t,n,r]=[u,o,s];break;case 3:[t,n,r]=[u,d,o];break;case 4:[t,n,r]=[s,u,o];break;case 5:[t,n,r]=[o,u,d];}}return[t,n,r,e.length>3?e[3]:1];},c.default.autodetect.push({p:2,test:(...e)=>{if(e=(0,f.unpack)(e,"hsv"),"array"===(0,f.type)(e)&&3===e.length)return"hsv";}});var z=n("98b1f5aa"),Y=r._(z),H=n("bc7f47d0"),$=r._(H);u.default.prototype.lab=function(){return(0,$.default)(this._rgb);},d.lab=(...e)=>new u.default(...e,"lab"),c.default.format.lab=Y.default,c.default.autodetect.push({p:2,test:(...e)=>{if(e=(0,f.unpack)(e,"lab"),"array"===(0,f.type)(e)&&3===e.length)return"lab";}});var X=n("126d30f6"),Z=r._(X);let Q=(...e)=>{let[t,n,r]=e=(0,f.unpack)(e,"lch"),[a,l,o]=(0,Z.default)(t,n,r),[i,u,d]=(0,Y.default)(a,l,o);return[i,u,d,e.length>3?e[3]:1];};var J=n("4f82ef41"),ee=r._(J);let et=(...e)=>{let[t,n,r]=(0,f.unpack)(e,"rgb"),[a,l,o]=(0,$.default)(t,n,r);return(0,ee.default)(a,l,o);};u.default.prototype.lch=function(){return et(this._rgb);},u.default.prototype.hcl=function(){return et(this._rgb).reverse();},d.lch=(...e)=>new u.default(...e,"lch"),d.hcl=(...e)=>new u.default(...e,"hcl"),c.default.format.lch=Q,c.default.format.hcl=(...e)=>Q(...(0,f.unpack)(e,"hcl").reverse()),["lch","hcl"].forEach(e=>c.default.autodetect.push({p:2,test:(...t)=>{if(t=(0,f.unpack)(t,e),"array"===(0,f.type)(t)&&3===t.length)return e;}}));let en={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};u.default.prototype.name=function(){let e=A(this._rgb,"rgb");for(let t of Object.keys(en))if(en[t]===e)return t.toLowerCase();return e;},c.default.format.named=e=>{if(en[e=e.toLowerCase()])return L(en[e]);throw Error("unknown color name: "+e);},c.default.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&"string"===(0,f.type)(e)&&en[e.toLowerCase()])return"named";}});let er=(...e)=>{let[t,n,r]=(0,f.unpack)(e,"rgb");return(t<<16)+(n<<8)+r;};u.default.prototype.num=function(){return er(this._rgb);},d.num=(...e)=>new u.default(...e,"num"),c.default.format.num=e=>{if("number"==(0,f.type)(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw Error("unknown num color: "+e);},c.default.autodetect.push({p:5,test:(...e)=>{if(1===e.length&&"number"===(0,f.type)(e[0])&&e[0]>=0&&e[0]<=16777215)return"num";}});let{round:ea}=Math;u.default.prototype.rgb=function(e=!0){return!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(ea);},u.default.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((t,n)=>n<3?!1===e?t:ea(t):t);},d.rgb=(...e)=>new u.default(...e,"rgb"),c.default.format.rgb=(...e)=>{let t=(0,f.unpack)(e,"rgba");return void 0===t[3]&&(t[3]=1),t;},c.default.autodetect.push({p:3,test:(...e)=>{if(e=(0,f.unpack)(e,"rgba"),"array"===(0,f.type)(e)&&(3===e.length||4===e.length&&"number"==(0,f.type)(e[3])&&e[3]>=0&&e[3]<=1))return"rgb";}});let{log:el}=Math,eo=e=>{let t,n,r;let a=e/100;return a<66?(t=255,n=a<6?0:-155.25485562709179-.44596950469579133*(n=a-2)+104.49216199393888*el(n),r=a<20?0:-254.76935184120902+.8274096064007395*(r=a-10)+115.67994401066147*el(r)):(t=351.97690566805693+.114206453784165*(t=a-55)-40.25366309332127*el(t),n=325.4494125711974+.07943456536662342*(n=a-50)-28.0852963507957*el(n),r=255),[t,n,r,1];},{round:ei}=Math,eu=(...e)=>{let t;let n=(0,f.unpack)(e,"rgb"),r=n[0],a=n[2],l=1e3,o=4e4;for(;o-l>.4;){let e=eo(t=(o+l)*.5);e[2]/e[0]>=a/r?o=t:l=t;}return ei(t);};u.default.prototype.temp=u.default.prototype.kelvin=u.default.prototype.temperature=function(){return eu(this._rgb);},d.temp=d.kelvin=d.temperature=(...e)=>new u.default(...e,"temp"),c.default.format.temp=c.default.format.kelvin=c.default.format.temperature=eo;var ed=n("2d8b945d"),es=r._(ed),ec=n("7f9df5e3"),ef=r._(ec);u.default.prototype.oklab=function(){return(0,ef.default)(this._rgb);},d.oklab=(...e)=>new u.default(...e,"oklab"),c.default.format.oklab=es.default,c.default.autodetect.push({p:3,test:(...e)=>{if(e=(0,f.unpack)(e,"oklab"),"array"===(0,f.type)(e)&&3===e.length)return"oklab";}});let ep=(...e)=>{let[t,n,r]=(0,f.unpack)(e,"rgb"),[a,l,o]=(0,ef.default)(t,n,r);return(0,ee.default)(a,l,o);};u.default.prototype.oklch=function(){return ep(this._rgb);},d.oklch=(...e)=>new u.default(...e,"oklch"),c.default.format.oklch=(...e)=>{let[t,n,r]=e=(0,f.unpack)(e,"lch"),[a,l,o]=(0,Z.default)(t,n,r),[i,u,d]=(0,es.default)(a,l,o);return[i,u,d,e.length>3?e[3]:1];},c.default.autodetect.push({p:3,test:(...e)=>{if(e=(0,f.unpack)(e,"oklch"),"array"===(0,f.type)(e)&&3===e.length)return"oklch";}}),u.default.prototype.alpha=function(e,t=!1){return void 0!==e&&"number"===(0,f.type)(e)?t?(this._rgb[3]=e,this):new u.default([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3];},u.default.prototype.clipped=function(){return this._rgb._clipped||!1;};var em=n("95f38a02"),eh=r._(em);u.default.prototype.darken=function(e=1){let t=this.lab();return t[0]-=eh.default.Kn*e,new u.default(t,"lab").alpha(this.alpha(),!0);},u.default.prototype.brighten=function(e=1){return this.darken(-e);},u.default.prototype.darker=u.default.prototype.darken,u.default.prototype.brighter=u.default.prototype.brighten,u.default.prototype.get=function(e){let[t,n]=e.split("."),r=this[t]();if(!n)return r;{let e=t.indexOf(n)-("ok"===t.substr(0,2)?2:0);if(e>-1)return r[e];throw Error(`unknown channel ${n} in mode ${t}`);}};let{pow:ey}=Math;u.default.prototype.luminance=function(e,t="rgb"){if(void 0!==e&&"number"===(0,f.type)(e)){if(0===e)return new u.default([0,0,0,this._rgb[3]],"rgb");if(1===e)return new u.default([255,255,255,this._rgb[3]],"rgb");let n=this.luminance(),r=20,a=(n,l)=>{let o=n.interpolate(l,.5,t),i=o.luminance();return!(1e-7>Math.abs(e-i))&&r--?i>e?a(n,o):a(o,l):o;},l=(n>e?a(new u.default([0,0,0]),this):a(this,new u.default([255,255,255]))).rgb();return new u.default([...l,this._rgb[3]]);}return eg(...this._rgb.slice(0,3));};let eg=(e,t,n)=>.2126*(e=eb(e))+.7152*(t=eb(t))+.0722*(n=eb(n)),eb=e=>(e/=255)<=.03928?e/12.92:ey((e+.055)/1.055,2.4);var ev={},ex=(e,t,n=.5,...r)=>{let a=r[0]||"lrgb";if(ev[a]||r.length||(a=Object.keys(ev)[0]),!ev[a])throw Error(`interpolation mode ${a} is not defined`);return"object"!==(0,f.type)(e)&&(e=new u.default(e)),"object"!==(0,f.type)(t)&&(t=new u.default(t)),ev[a](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()));};u.default.prototype.mix=u.default.prototype.interpolate=function(e,t=.5,...n){return ex(this,e,t,...n);},u.default.prototype.premultiply=function(e=!1){let t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new u.default([t[0]*n,t[1]*n,t[2]*n,n],"rgb");},u.default.prototype.saturate=function(e=1){let t=this.lch();return t[1]+=eh.default.Kn*e,t[1]<0&&(t[1]=0),new u.default(t,"lch").alpha(this.alpha(),!0);},u.default.prototype.desaturate=function(e=1){return this.saturate(-e);},u.default.prototype.set=function(e,t,n=!1){let[r,a]=e.split("."),l=this[r]();if(!a)return l;{let e=r.indexOf(a)-("ok"===r.substr(0,2)?2:0);if(e>-1){if("string"==(0,f.type)(t))switch(t.charAt(0)){case"+":case"-":l[e]+=+t;break;case"*":l[e]*=+t.substr(1);break;case"/":l[e]/=+t.substr(1);break;default:l[e]=+t;}else if("number"===(0,f.type)(t))l[e]=t;else throw Error("unsupported value for Color.set");let a=new u.default(l,r);return n?(this._rgb=a._rgb,this):a;}throw Error(`unknown channel ${a} in mode ${r}`);}},u.default.prototype.tint=function(e=.5,...t){return ex(this,"white",e,...t);},u.default.prototype.shade=function(e=.5,...t){return ex(this,"black",e,...t);},ev.rgb=(e,t,n)=>{let r=e._rgb,a=t._rgb;return new u.default(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"rgb");};let{sqrt:eT,pow:eI}=Math;ev.lrgb=(e,t,n)=>{let[r,a,l]=e._rgb,[o,i,d]=t._rgb;return new u.default(eT(eI(r,2)*(1-n)+eI(o,2)*n),eT(eI(a,2)*(1-n)+eI(i,2)*n),eT(eI(l,2)*(1-n)+eI(d,2)*n),"rgb");},ev.lab=(e,t,n)=>{let r=e.lab(),a=t.lab();return new u.default(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"lab");};var ew=(e,t,n,r)=>{let a,l,o,i,d,s,c,f,p,m,h,y;return"hsl"===r?(a=e.hsl(),l=t.hsl()):"hsv"===r?(a=e.hsv(),l=t.hsv()):"hcg"===r?(a=e.hcg(),l=t.hcg()):"hsi"===r?(a=e.hsi(),l=t.hsi()):"lch"===r||"hcl"===r?(r="hcl",a=e.hcl(),l=t.hcl()):"oklch"===r&&(a=e.oklch().reverse(),l=t.oklch().reverse()),("h"===r.substr(0,1)||"oklch"===r)&&([o,d,c]=a,[i,s,f]=l),isNaN(o)||isNaN(i)?isNaN(o)?isNaN(i)?m=Number.NaN:(m=i,(1==c||0==c)&&"hsv"!=r&&(p=s)):(m=o,(1==f||0==f)&&"hsv"!=r&&(p=d)):(y=i>o&&i-o>180?i-(o+360):i<o&&o-i>180?i+360-o:i-o,m=o+n*y),void 0===p&&(p=d+n*(s-d)),h=c+n*(f-c),"oklch"===r?new u.default([h,p,m],r):new u.default([m,p,h],r);};let eE=(e,t,n)=>ew(e,t,n,"lch");ev.lch=eE,ev.hcl=eE,ev.num=(e,t,n)=>{let r=e.num(),a=t.num();return new u.default(r+n*(a-r),"num");},ev.hcg=(e,t,n)=>ew(e,t,n,"hcg"),ev.hsi=(e,t,n)=>ew(e,t,n,"hsi"),ev.hsl=(e,t,n)=>ew(e,t,n,"hsl"),ev.hsv=(e,t,n)=>ew(e,t,n,"hsv"),ev.oklab=(e,t,n)=>{let r=e.oklab(),a=t.oklab();return new u.default(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"oklab");},ev.oklch=(e,t,n)=>ew(e,t,n,"oklch");let{pow:eN,sqrt:eS,PI:e_,cos:ek,sin:eC,atan2:eM}=Math,eR=(e,t)=>{let n=e.length,r=[0,0,0,0];for(let a=0;a<e.length;a++){let l=e[a],o=t[a]/n,i=l._rgb;r[0]+=eN(i[0],2)*o,r[1]+=eN(i[1],2)*o,r[2]+=eN(i[2],2)*o,r[3]+=i[3]*o;}return r[0]=eS(r[0]),r[1]=eS(r[1]),r[2]=eS(r[2]),r[3]>.9999999&&(r[3]=1),new u.default((0,f.clip_rgb)(r));},{pow:eO}=Math;var ej=function(e){let t="rgb",n=d("#ccc"),r=0,a=[0,1],l=[],o=[0,0],i=!1,u=[],s=!1,c=0,p=1,m=!1,h={},y=!0,g=1,b=function(e){if(e=e||["#fff","#000"],"string"===(0,f.type)(e)&&d.brewer&&d.brewer[e.toLowerCase()]&&(e=d.brewer[e.toLowerCase()]),"array"===(0,f.type)(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(let t=0;t<e.length;t++)e[t]=d(e[t]);l.length=0;for(let t=0;t<e.length;t++)l.push(t/(e.length-1));}return w(),u=e;},v=function(e){if(null!=i){let t=i.length-1,n=0;for(;n<t&&e>=i[n];)n++;return n-1;}return 0;},x=e=>e,T=e=>e,I=function(e,r){let a,s;if(null==r&&(r=!1),isNaN(e)||null===e)return n;s=r?e:i&&i.length>2?v(e)/(i.length-2):p!==c?(e-c)/(p-c):1,s=T(s),r||(s=x(s)),1!==g&&(s=eO(s,g)),s=o[0]+s*(1-o[0]-o[1]);let m=Math.floor(1e4*(s=(0,f.limit)(s,0,1)));if(y&&h[m])a=h[m];else{if("array"===(0,f.type)(u))for(let e=0;e<l.length;e++){let n=l[e];if(s<=n||s>=n&&e===l.length-1){a=u[e];break;}if(s>n&&s<l[e+1]){s=(s-n)/(l[e+1]-n),a=d.interpolate(u[e],u[e+1],s,t);break;}}else"function"===(0,f.type)(u)&&(a=u(s));y&&(h[m]=a);}return a;};var w=()=>h={};b(e);let E=function(e){let t=d(I(e));return s&&t[s]?t[s]():t;};return E.classes=function(e){if(null!=e){if("array"===(0,f.type)(e))i=e,a=[e[0],e[e.length-1]];else{let t=d.analyze(a);i=0===e?[t.min,t.max]:d.limits(t,"e",e);}return E;}return i;},E.domain=function(e){if(!arguments.length)return a;c=e[0],p=e[e.length-1],l=[];let t=u.length;if(e.length===t&&c!==p)for(let t of Array.from(e))l.push((t-c)/(p-c));else{for(let e=0;e<t;e++)l.push(e/(t-1));if(e.length>2){let t=e.map((t,n)=>n/(e.length-1)),n=e.map(e=>(e-c)/(p-c));n.every((e,n)=>t[n]===e)||(T=e=>{if(e<=0||e>=1)return e;let r=0;for(;e>=n[r+1];)r++;let a=(e-n[r])/(n[r+1]-n[r]);return t[r]+a*(t[r+1]-t[r]);});}}return a=[c,p],E;},E.mode=function(e){return arguments.length?(t=e,w(),E):t;},E.range=function(e,t){return b(e,t),E;},E.out=function(e){return s=e,E;},E.spread=function(e){return arguments.length?(r=e,E):r;},E.correctLightness=function(e){return null==e&&(e=!0),m=e,w(),x=m?function(e){let t=I(0,!0).lab()[0],n=I(1,!0).lab()[0],r=t>n,a=I(e,!0).lab()[0],l=t+(n-t)*e,o=a-l,i=0,u=1,d=20;for(;Math.abs(o)>.01&&d-- >0;)r&&(o*=-1),o<0?(i=e,e+=(u-e)*.5):(u=e,e+=(i-e)*.5),o=(a=I(e,!0).lab()[0])-l;return e;}:e=>e,E;},E.padding=function(e){return null!=e?("number"===(0,f.type)(e)&&(e=[e,e]),o=e,E):o;},E.colors=function(t,n){arguments.length<2&&(n="hex");let r=[];if(0==arguments.length)r=u.slice(0);else if(1===t)r=[E(.5)];else if(t>1){let e=a[0],n=a[1]-e;r=(function(e,t,n){let r=[],a=0<t,l=n?a?t+1:t-1:t;for(let e=0;a?e<l:e>l;a?e++:e--)r.push(e);return r;})(0,t,!1).map(r=>E(e+r/(t-1)*n));}else{e=[];let t=[];if(i&&i.length>2)for(let e=1,n=i.length,r=1<=n;r?e<n:e>n;r?e++:e--)t.push((i[e-1]+i[e])*.5);else t=a;r=t.map(e=>E(e));}return d[n]&&(r=r.map(e=>e[n]())),r;},E.cache=function(e){return null!=e?(y=e,E):y;},E.gamma=function(e){return null!=e?(g=e,E):g;},E.nodata=function(e){return null!=e?(n=d(e),E):n;},E;};let eL=function(e){let t=[1,1];for(let n=1;n<e;n++){let e=[1];for(let n=1;n<=t.length;n++)e[n]=(t[n]||0)+t[n-1];t=e;}return t;},eP=function(e){let t,n,r,a;if(2===(e=e.map(e=>new u.default(e))).length)[n,r]=e.map(e=>e.lab()),t=function(e){let t=[0,1,2].map(t=>n[t]+e*(r[t]-n[t]));return new u.default(t,"lab");};else if(3===e.length)[n,r,a]=e.map(e=>e.lab()),t=function(e){let t=[0,1,2].map(t=>(1-e)*(1-e)*n[t]+2*(1-e)*e*r[t]+e*e*a[t]);return new u.default(t,"lab");};else if(4===e.length){let l;[n,r,a,l]=e.map(e=>e.lab()),t=function(e){let t=[0,1,2].map(t=>(1-e)*(1-e)*(1-e)*n[t]+3*(1-e)*(1-e)*e*r[t]+3*(1-e)*e*e*a[t]+e*e*e*l[t]);return new u.default(t,"lab");};}else if(e.length>=5){let n,r,a;n=e.map(e=>e.lab()),r=eL(a=e.length-1),t=function(e){let t=1-e,l=[0,1,2].map(l=>n.reduce((n,o,i)=>n+r[i]*t**(a-i)*e**i*o[l],0));return new u.default(l,"lab");};}else throw RangeError("No point in running bezier with only one color.");return t;},eA=(e,t,n)=>{if(!eA[n])throw Error("unknown blend mode "+n);return eA[n](e,t);},eF=e=>(t,n)=>{let r=d(n).rgb(),a=d(t).rgb();return d.rgb(e(r,a));},eD=e=>(t,n)=>{let r=[];return r[0]=e(t[0],n[0]),r[1]=e(t[1],n[1]),r[2]=e(t[2],n[2]),r;};eA.normal=eF(eD(e=>e)),eA.multiply=eF(eD((e,t)=>e*t/255)),eA.screen=eF(eD((e,t)=>255*(1-(1-e/255)*(1-t/255)))),eA.overlay=eF(eD((e,t)=>t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255)))),eA.darken=eF(eD((e,t)=>e>t?t:e)),eA.lighten=eF(eD((e,t)=>e>t?e:t)),eA.dodge=eF(eD((e,t)=>255===e?255:(e=t/255*255/(1-e/255))>255?255:e)),eA.burn=eF(eD((e,t)=>255*(1-(1-t/255)/(e/255))));let{pow:eK,sin:eB,cos:eU}=Math,{floor:eG,random:eV}=Math;var eW=n("649dc35c"),eq=r._(eW);let{log:ez,pow:eY,floor:eH,abs:e$}=Math;function eX(e,t=null){let n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===(0,eq.default)(e)&&(e=Object.values(e)),e.forEach(e=>{t&&"object"===(0,eq.default)(e)&&(e=e[t]),null==e||isNaN(e)||(n.values.push(e),n.sum+=e,e<n.min&&(n.min=e),e>n.max&&(n.max=e),n.count+=1);}),n.domain=[n.min,n.max],n.limits=(e,t)=>eZ(n,e,t),n;}function eZ(e,t="equal",n=7){"array"==(0,eq.default)(e)&&(e=eX(e));let{min:r,max:a}=e,l=e.values.sort((e,t)=>e-t);if(1===n)return[r,a];let o=[];if("c"===t.substr(0,1)&&(o.push(r),o.push(a)),"e"===t.substr(0,1)){o.push(r);for(let e=1;e<n;e++)o.push(r+e/n*(a-r));o.push(a);}else if("l"===t.substr(0,1)){if(r<=0)throw Error("Logarithmic scales are only possible for values > 0");let e=Math.LOG10E*ez(r),t=Math.LOG10E*ez(a);o.push(r);for(let r=1;r<n;r++)o.push(eY(10,e+r/n*(t-e)));o.push(a);}else if("q"===t.substr(0,1)){o.push(r);for(let e=1;e<n;e++){let t=(l.length-1)*e/n,r=eH(t);if(r===t)o.push(l[r]);else{let e=t-r;o.push(l[r]*(1-e)+l[r+1]*e);}}o.push(a);}else if("k"===t.substr(0,1)){let e;let t=l.length,i=Array(t),u=Array(n),d=!0,s=0,c=null;(c=[]).push(r);for(let e=1;e<n;e++)c.push(r+e/n*(a-r));for(c.push(a);d;){for(let e=0;e<n;e++)u[e]=0;for(let e=0;e<t;e++){let t;let r=l[e],a=Number.MAX_VALUE;for(let l=0;l<n;l++){let n=e$(c[l]-r);n<a&&(a=n,t=l),u[t]++,i[e]=t;}}let r=Array(n);for(let e=0;e<n;e++)r[e]=null;for(let n=0;n<t;n++)null===r[e=i[n]]?r[e]=l[n]:r[e]+=l[n];for(let e=0;e<n;e++)r[e]*=1/u[e];d=!1;for(let e=0;e<n;e++)if(r[e]!==c[e]){d=!0;break;}c=r,++s>200&&(d=!1);}let f={};for(let e=0;e<n;e++)f[e]=[];for(let n=0;n<t;n++)f[e=i[n]].push(l[n]);let p=[];for(let e=0;e<n;e++)p.push(f[e][0]),p.push(f[e][f[e].length-1]);p=p.sort((e,t)=>e-t),o.push(p[0]);for(let e=1;e<p.length;e+=2){let t=p[e];isNaN(t)||-1!==o.indexOf(t)||o.push(t);}}return o;}let{sqrt:eQ,pow:eJ,min:e0,max:e1,atan2:e2,abs:e5,cos:e6,sin:e3,exp:e4,PI:e9}=Math,e7={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let e of Object.keys(e7))e7[e.toLowerCase()]=e7[e];Object.assign(d,{average:(e,t="lrgb",n=null)=>{let r=e.length;n||(n=Array.from(Array(r)).map(()=>1));let a=r/n.reduce(function(e,t){return e+t;});if(n.forEach((e,t)=>{n[t]*=a;}),e=e.map(e=>new u.default(e)),"lrgb"===t)return eR(e,n);let l=e.shift(),o=l.get(t),i=[],d=0,s=0;for(let e=0;e<o.length;e++)if(o[e]=(o[e]||0)*n[0],i.push(isNaN(o[e])?0:n[0]),"h"===t.charAt(e)&&!isNaN(o[e])){let t=o[e]/180*e_;d+=ek(t)*n[0],s+=eC(t)*n[0];}let c=l.alpha()*n[0];e.forEach((e,r)=>{let a=e.get(t);c+=e.alpha()*n[r+1];for(let e=0;e<o.length;e++)if(!isNaN(a[e])){if(i[e]+=n[r+1],"h"===t.charAt(e)){let t=a[e]/180*e_;d+=ek(t)*n[r+1],s+=eC(t)*n[r+1];}else o[e]+=a[e]*n[r+1];}});for(let e=0;e<o.length;e++)if("h"===t.charAt(e)){let t=eM(s/i[e],d/i[e])/e_*180;for(;t<0;)t+=360;for(;t>=360;)t-=360;o[e]=t;}else o[e]=o[e]/i[e];return c/=r,new u.default(o,t).alpha(c>.99999?1:c,!0);},bezier:e=>{let t=eP(e);return t.scale=()=>ej(t),t;},blend:eA,cubehelix:function(e=300,t=-1.5,n=1,r=1,a=[0,1]){let l=0,o;"array"===(0,f.type)(a)?o=a[1]-a[0]:(o=0,a=[a,a]);let i=function(i){let u=f.TWOPI*((e+120)/360+t*i),s=eK(a[0]+o*i,r),c=(0!==l?n[0]+i*l:n)*s*(1-s)/2,p=eU(u),m=eB(u);return d((0,f.clip_rgb)([255*(s+c*(-.14861*p+1.78277*m)),255*(s+c*(-.29227*p-.90649*m)),255*(s+1.97294*p*c),1]));};return i.start=function(t){return null==t?e:(e=t,i);},i.rotations=function(e){return null==e?t:(t=e,i);},i.gamma=function(e){return null==e?r:(r=e,i);},i.hue=function(e){return null==e?n:(n=e,"array"===(0,f.type)(n)?0==(l=n[1]-n[0])&&(n=n[1]):l=0,i);},i.lightness=function(e){return null==e?a:("array"===(0,f.type)(e)?(a=e,o=e[1]-e[0]):(a=[e,e],o=0),i);},i.scale=()=>d.scale(i),i.hue(n),i;},mix:ex,interpolate:ex,random:()=>{let e="#";for(let t=0;t<6;t++)e+="0123456789abcdef".charAt(eG(16*eV()));return new u.default(e,"hex");},scale:ej,analyze:eX,contrast:(e,t)=>{e=new u.default(e),t=new u.default(t);let n=e.luminance(),r=t.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05);},deltaE:function(e,t,n=1,r=1,a=1){var l=function(e){return 360*e/(2*e9);},o=function(e){return 2*e9*e/360;};e=new u.default(e),t=new u.default(t);let[i,d,s]=Array.from(e.lab()),[c,f,p]=Array.from(t.lab()),m=(i+c)/2,h=(eQ(eJ(d,2)+eJ(s,2))+eQ(eJ(f,2)+eJ(p,2)))/2,y=.5*(1-eQ(eJ(h,7)/(eJ(h,7)+eJ(25,7)))),g=d*(1+y),b=f*(1+y),v=eQ(eJ(g,2)+eJ(s,2)),x=eQ(eJ(b,2)+eJ(p,2)),T=(v+x)/2,I=l(e2(s,g)),w=l(e2(p,b)),E=I>=0?I:I+360,N=w>=0?w:w+360,S=e5(E-N)>180?(E+N+360)/2:(E+N)/2,_=1-.17*e6(o(S-30))+.24*e6(o(2*S))+.32*e6(o(3*S+6))-.2*e6(o(4*S-63)),k=N-E;k=180>=e5(k)?k:N<=E?k+360:k-360,k=2*eQ(v*x)*e3(o(k)/2);let C=x-v,M=1+.015*eJ(m-50,2)/eQ(20+eJ(m-50,2)),R=1+.045*T,O=1+.015*T*_,j=30*e4(-eJ((S-275)/25,2)),L=-(2*eQ(eJ(T,7)/(eJ(T,7)+eJ(25,7))))*e3(2*o(j));return e1(0,e0(100,eQ(eJ((c-i)/(n*M),2)+eJ(C/(r*R),2)+eJ(k/(a*O),2)+C/(r*R)*L*(k/(a*O)))));},distance:function(e,t,n="lab"){e=new u.default(e),t=new u.default(t);let r=e.get(n),a=t.get(n),l=0;for(let e in r){let t=(r[e]||0)-(a[e]||0);l+=t*t;}return Math.sqrt(l);},limits:eZ,valid:(...e)=>{try{return new u.default(...e),!0;}catch(e){return!1;}},scales:{cool:()=>ej([d.hsl(180,1,.9),d.hsl(250,.7,.4)]),hot:()=>ej(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},input:c.default,colors:en,brewer:e7});var e8=n("02b696d0");let te=e=>({result:{desc:"",errCode:"",errMessage:"",success:!0,value:{entityType_2022081909929860:{storeType:["GEABASE","OFFLINE"],style:{color:"#7dd4a9",icon:"earth"},propertyImportConfig:{}},entityType_2022081909937545:{storeType:["GEABASE","OFFLINE"],style:{color:"#7dd4a9",icon:"earth"},propertyImportConfig:{}},entityType_707000094:{storeType:["OFFLINE"],style:{color:"#773b84",icon:"icon-location"},propertyImportConfig:{}},relationType_2022081909940654:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#7dd4a9"}},entityType_707000091:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-location"},propertyImportConfig:{}},entityType_2022042707115987:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-location"},propertyImportConfig:{}},entityType_2022090210254685:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-time-circle"},propertyImportConfig:{}},entityType_707000096:{storeType:["GEABASE","OFFLINE"],style:{color:"#d95084",icon:"trophy"},propertyImportConfig:{}},entityType_2023011786622911:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-douyin"},propertyImportConfig:{}},entityType_2023031674179591:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-time-circle"},propertyImportConfig:{}},entityType_707000128:{storeType:["OFFLINE"],style:{color:"#4997cc",icon:"icon-time-circle"},propertyImportConfig:{}},entityType_717001915:{storeType:["OFFLINE"],style:{color:"default",icon:"default"},propertyImportConfig:{}},relationType_310002166:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#f19fc2"}},relationType_310002168:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#61708f"}},entityType_2022062708201663:{storeType:["OFFLINE"],style:{color:"#d96c59",icon:"bell"},propertyImportConfig:{}},entityType_709000249:{storeType:["OFFLINE"],style:{color:"default",icon:"earth"},propertyImportConfig:{}},entityType_2022051307408527:{storeType:["OFFLINE"],style:{color:"#82c7e8",icon:"time-circle"},propertyImportConfig:{}},entityType_2021041201591615:{storeType:["OFFLINE"],style:{color:"#d96c59",icon:"default"},propertyImportConfig:{}},entityType_2022051007306817:{storeType:["GEABASE","OFFLINE"],style:{color:"#773b84",icon:"alert"},propertyImportConfig:{}},entityType_2022051007306819:{storeType:["OFFLINE"],style:{color:"default",icon:"error"},propertyImportConfig:{}},relationType_2022071908940364:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#f19fc2"}},entityType_2020051900117533:{storeType:["OFFLINE"],style:{color:"#61708f",icon:"icon-YUAN"},propertyImportConfig:{}},entityType_2021080904358262:{storeType:["OFFLINE"],style:{color:"#edbe45",icon:"default"},propertyImportConfig:{}},entityType_2022101311255736:{storeType:["OFFLINE"],style:{color:"#d96c59",icon:"layout"},propertyImportConfig:{}},entityType_2020051400082972:{storeType:["OFFLINE"],style:{color:"default",icon:"default"},propertyImportConfig:{}},entityType_2022102611489478:{storeType:["OFFLINE"],style:{color:"#6590f2",icon:"default"},propertyImportConfig:{}},relationType_2021050601726121:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#f19fc2"}},entityType_2022041106835958:{storeType:["OFFLINE"],style:{color:"#61708f",icon:"user"},propertyImportConfig:{}},relationType_2020120900865231:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#bbbee3"}},entityType_2023031763460212:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-location"},propertyImportConfig:{}},entityType_2022110911855814:{storeType:["OFFLINE"],style:{color:"default",icon:"default"},propertyImportConfig:{}},relationType_2022081909940651:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#f7c44e"}},relationType_310002171:{importConfig:{channels:["DSL","EXT_DATA_SOURCE","GRAPH_FEATURE","KNOWLEDGE_EDIT"],updateLogic:"LATEST"},style:{color:"#4592f7"}},entityType_2021050501720293:{storeType:["OFFLINE"],style:{color:"default",icon:"icon-time-circle"},propertyImportConfig:{}},entityType_2022110911855813:{storeType:["OFFLINE"],style:{color:"default",icon:"default"},propertyImportConfig:{}}}},traceId:"0b451bfb17098112239636746e58a8"}),tt=e=>{let t={entityType:{},relationType:{}};return e&&Object.keys(e).forEach(n=>{let[r,a=""]=n.split("_");if("entityType"!==r&&"relationType"!==r)return;t[r][a]={...e[n].style||{}};let{icon:l,color:o}=t[r][a];"default"===l&&delete t[r][a].icon,"default"!==o&&d.valid(o)||delete t[r][a].color;}),t;},tn=e=>{let{params:t,defaultExtraStyleConfigs:n,...r}=e??{},i={projectId:(0,o.getProjectId)(),...t},u=(0,a.useQuery)({queryFn:async()=>{let{result:e}=await te(i);if(e.success&&e.value)return e.value;},queryKey:["getStaticConfig",i],staleTime:1/0,...r}),d=(0,e8.useMemo)(()=>tt(u.data),[u.data]);return{staticConfigList:u.data,extraStyleConfigs:(0,l.merge)(n,d),...u};};},bac6942a:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useSchemaPropertyNameMap",{enumerable:!0,get:function(){return o;}});var r=n("48fdd872"),a=n("5b5ed4a9"),l=n("3834a44f");let o=e=>{let{params:t,...n}=e??{},o={projectId:Number((0,l.getProjectId)()),...t};return(0,a.useQuery)({queryFn:async()=>{let e=await (0,r.getSchemaNameMap)(o);return(null==e?void 0:e.success)&&e.result?e.result:Promise.reject(e);},queryKey:["hooks/useSchemaPropertyNameMap",o],enabled:!!o.projectId,staleTime:1/0,...n});};},bcda4f95:function(e,t,n){"use strict";n.d(t,"__esModule",{value:!0}),n.d(t,"useSchemaData",{enumerable:!0,get:function(){return u;}});var r=n("fc5eb767"),a=n("48fdd872"),l=n("5b5ed4a9"),o=n("3834a44f");let i=async e=>{let t=await (0,a.getSchemaAndRelation)(e);if(!t.success||!t.result)return Promise.reject(t);{let e=t.result,n=e.entityTypeDTOList||[],a=e.relationTypeDTOList||[];return(0,r.transformRelationGraphData)({nodes:n.filter(e=>e.name!==r.rootNode.name),edges:a});}},u=e=>{let{params:t,...n}=e??{},r={projectId:Number((0,o.getProjectId)()),...t};return(0,l.useQuery)({queryFn:()=>i(r),queryKey:["hooks/useSchemaData",r],enabled:!!(null==r?void 0:r.projectId),...n});};}}]);
