(self.webpackChunkcognik_web_app=self.webpackChunkcognik_web_app||[]).push([[4037],{57089:function(Me,L,a){"use strict";a.r(L),a.d(L,{default:function(){return ge}});var z=a(67825),R=a.n(z),E=a(90228),c=a.n(E),G=a(26068),p=a.n(G),H=a(87999),M=a.n(H),w=a(48305),B=a.n(w),D=a(55876),V=a(66715),t=a(86487);function K(f,r){return S.apply(this,arguments)}function S(){return S=M()(c()().mark(function f(r,u){return c()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,t.request)("/api/login/captcha",p()({method:"GET",params:p()({},r)},u||{})));case 1:case"end":return x.stop()}},f)})),S.apply(this,arguments)}var Q=a(82851),k=a(20063),J=a(64810),X=a(25616),Z=a(75433),Y=a(38489),q=a(87972),A=a(14378),_=a(77784),ee=a(45343),h=a(69230),ae=a(3839),se=a(72166),te=a(26551),re=a(25778),P=a.n(re),T=a(75271),ne=a(30967),oe=a(99013),e=a(52676),ie=["password"],C=(0,te.kc)(function(f){var r=f.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:r.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:r.borderRadius,":hover":{backgroundColor:r.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),le=function(){var r=C(),u=r.styles;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Q.Z,{className:u.action,onClick:function(){h.ZP.info("\u656C\u8BF7\u671F\u5F85")}},"AlipayCircleOutlined"),(0,e.jsx)(k.Z,{className:u.action,onClick:function(){h.ZP.info("\u656C\u8BF7\u671F\u5F85")}},"TaobaoCircleOutlined"),(0,e.jsx)(J.Z,{className:u.action,onClick:function(){h.ZP.info("\u656C\u8BF7\u671F\u5F85")}},"WeiboCircleOutlined")]})},ue=function(){var r=C(),u=r.styles;return(0,e.jsx)("div",{className:u.lang,"data-lang":!0,children:t.SelectLang&&(0,e.jsx)(t.SelectLang,{})})},I=function(r){var u=r.content;return(0,e.jsx)(ae.Z,{style:{marginBottom:24},message:u,type:"error",showIcon:!0})},ce=function(){var r=(0,T.useState)({}),u=B()(r,2),v=u[0],x=u[1],de=(0,T.useState)("account"),O=B()(de,2),j=O[0],fe=O[1],W=(0,t.useModel)("@@initialState"),y=W.initialState,me=W.setInitialState,pe=C(),he=pe.styles,o=(0,t.useIntl)(),ve=function(){var m=M()(c()().mark(function i(){var l,g;return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,y==null||(l=y.fetchUserInfo)===null||l===void 0?void 0:l.call(y);case 2:g=s.sent,g&&(0,ne.flushSync)(function(){me(function(F){return p()(p()({},F),{},{currentUser:g})})});case 4:case"end":return s.stop()}},i)}));return function(){return m.apply(this,arguments)}}(),xe=function(){var m=M()(c()().mark(function i(l){var g,d,s,F,$,b;return c()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return g=l.password,d=R()(l,ie),n.prev=1,n.next=4,(0,V.x4)(p()(p()({password:P().SHA256(g+"OPENSPG").toString(P().enc.Hex)},d),{},{type:j}));case 4:if(s=n.sent,!s.success){n.next=13;break}return F=o.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),h.ZP.success(F),n.next=10,ve();case 10:return $=new URL(window.location.href).searchParams,window.location.href=$.get("redirect")||"/",n.abrupt("return");case 13:console.log(s),x(s),n.next=22;break;case 17:n.prev=17,n.t0=n.catch(1),b=o.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(n.t0),h.ZP.error(b);case 22:case"end":return n.stop()}},i,null,[[1,17]])}));return function(l){return m.apply(this,arguments)}}(),N=v.status,U=v.type;return(0,e.jsxs)("div",{className:he.container,children:[(0,e.jsx)(t.Helmet,{children:(0,e.jsxs)("title",{children:[o.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",oe.Z.title]})}),(0,e.jsx)(ue,{}),(0,e.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,e.jsxs)(q.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"CogniK",subTitle:o.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[(0,e.jsx)(t.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,e.jsx)(le,{},"icons")],onFinish:function(){var m=M()(c()().mark(function i(l){return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,xe(l);case 2:case"end":return d.stop()}},i)}));return function(i){return m.apply(this,arguments)}}(),children:[(0,e.jsx)(se.Z,{activeKey:j,onChange:fe,centered:!0,items:[{key:"account",label:o.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"mobile",label:o.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),N==="error"&&U==="account"&&(0,e.jsx)(I,{content:o.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),j==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.Z,{name:"account",fieldProps:{size:"large",prefix:(0,e.jsx)(X.Z,{})},placeholder:o.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(A.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},placeholder:o.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),N==="error"&&U==="mobile"&&(0,e.jsx)(I,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),j==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(Y.Z,{})},name:"mobile",placeholder:o.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(_.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},captchaProps:{size:"large"},placeholder:o.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(i,l){return i?"".concat(l," ").concat(o.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):o.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var m=M()(c()().mark(function i(l){var g;return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,K({phone:l});case 2:if(g=s.sent,g){s.next=5;break}return s.abrupt("return");case 5:h.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},i)}));return function(i){return m.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(ee.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,e.jsx)(D.$_,{})]})},ge=ce},96581:function(){}}]);
